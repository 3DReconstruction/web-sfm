/*! jQuery v2.1.4 | (c) 2005, 2015 jQuery Foundation, Inc. | jquery.org/license */
!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){var c=[],d=c.slice,e=c.concat,f=c.push,g=c.indexOf,h={},i=h.toString,j=h.hasOwnProperty,k={},l=a.document,m="2.1.4",n=function(a,b){return new n.fn.init(a,b)},o=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,p=/^-ms-/,q=/-([\da-z])/gi,r=function(a,b){return b.toUpperCase()};n.fn=n.prototype={jquery:m,constructor:n,selector:"",length:0,toArray:function(){return d.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:d.call(this)},pushStack:function(a){var b=n.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return n.each(this,a,b)},map:function(a){return this.pushStack(n.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:c.sort,splice:c.splice},n.extend=n.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||n.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(n.isPlainObject(d)||(e=n.isArray(d)))?(e?(e=!1,f=c&&n.isArray(c)?c:[]):f=c&&n.isPlainObject(c)?c:{},g[b]=n.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},n.extend({expando:"jQuery"+(m+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===n.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){return!n.isArray(a)&&a-parseFloat(a)+1>=0},isPlainObject:function(a){return"object"!==n.type(a)||a.nodeType||n.isWindow(a)?!1:a.constructor&&!j.call(a.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?h[i.call(a)]||"object":typeof a},globalEval:function(a){var b,c=eval;a=n.trim(a),a&&(1===a.indexOf("use strict")?(b=l.createElement("script"),b.text=a,l.head.appendChild(b).parentNode.removeChild(b)):c(a))},camelCase:function(a){return a.replace(p,"ms-").replace(q,r)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,c){var d,e=0,f=a.length,g=s(a);if(c){if(g){for(;f>e;e++)if(d=b.apply(a[e],c),d===!1)break}else for(e in a)if(d=b.apply(a[e],c),d===!1)break}else if(g){for(;f>e;e++)if(d=b.call(a[e],e,a[e]),d===!1)break}else for(e in a)if(d=b.call(a[e],e,a[e]),d===!1)break;return a},trim:function(a){return null==a?"":(a+"").replace(o,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(s(Object(a))?n.merge(c,"string"==typeof a?[a]:a):f.call(c,a)),c},inArray:function(a,b,c){return null==b?-1:g.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;c>d;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,f=0,g=a.length,h=s(a),i=[];if(h)for(;g>f;f++)d=b(a[f],f,c),null!=d&&i.push(d);else for(f in a)d=b(a[f],f,c),null!=d&&i.push(d);return e.apply([],i)},guid:1,proxy:function(a,b){var c,e,f;return"string"==typeof b&&(c=a[b],b=a,a=c),n.isFunction(a)?(e=d.call(arguments,2),f=function(){return a.apply(b||this,e.concat(d.call(arguments)))},f.guid=a.guid=a.guid||n.guid++,f):void 0},now:Date.now,support:k}),n.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){h["[object "+b+"]"]=b.toLowerCase()});function s(a){var b="length"in a&&a.length,c=n.type(a);return"function"===c||n.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a}var t=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u="sizzle"+1*new Date,v=a.document,w=0,x=0,y=ha(),z=ha(),A=ha(),B=function(a,b){return a===b&&(l=!0),0},C=1<<31,D={}.hasOwnProperty,E=[],F=E.pop,G=E.push,H=E.push,I=E.slice,J=function(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1},K="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",L="[\\x20\\t\\r\\n\\f]",M="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",N=M.replace("w","w#"),O="\\["+L+"*("+M+")(?:"+L+"*([*^$|!~]?=)"+L+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+N+"))|)"+L+"*\\]",P=":("+M+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+O+")*)|.*)\\)|)",Q=new RegExp(L+"+","g"),R=new RegExp("^"+L+"+|((?:^|[^\\\\])(?:\\\\.)*)"+L+"+$","g"),S=new RegExp("^"+L+"*,"+L+"*"),T=new RegExp("^"+L+"*([>+~]|"+L+")"+L+"*"),U=new RegExp("="+L+"*([^\\]'\"]*?)"+L+"*\\]","g"),V=new RegExp(P),W=new RegExp("^"+N+"$"),X={ID:new RegExp("^#("+M+")"),CLASS:new RegExp("^\\.("+M+")"),TAG:new RegExp("^("+M.replace("w","w*")+")"),ATTR:new RegExp("^"+O),PSEUDO:new RegExp("^"+P),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+L+"*(even|odd|(([+-]|)(\\d*)n|)"+L+"*(?:([+-]|)"+L+"*(\\d+)|))"+L+"*\\)|)","i"),bool:new RegExp("^(?:"+K+")$","i"),needsContext:new RegExp("^"+L+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+L+"*((?:-\\d)?\\d*)"+L+"*\\)|)(?=[^-]|$)","i")},Y=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,$=/^[^{]+\{\s*\[native \w/,_=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,aa=/[+~]/,ba=/'|\\/g,ca=new RegExp("\\\\([\\da-f]{1,6}"+L+"?|("+L+")|.)","ig"),da=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)},ea=function(){m()};try{H.apply(E=I.call(v.childNodes),v.childNodes),E[v.childNodes.length].nodeType}catch(fa){H={apply:E.length?function(a,b){G.apply(a,I.call(b))}:function(a,b){var c=a.length,d=0;while(a[c++]=b[d++]);a.length=c-1}}}function ga(a,b,d,e){var f,h,j,k,l,o,r,s,w,x;if((b?b.ownerDocument||b:v)!==n&&m(b),b=b||n,d=d||[],k=b.nodeType,"string"!=typeof a||!a||1!==k&&9!==k&&11!==k)return d;if(!e&&p){if(11!==k&&(f=_.exec(a)))if(j=f[1]){if(9===k){if(h=b.getElementById(j),!h||!h.parentNode)return d;if(h.id===j)return d.push(h),d}else if(b.ownerDocument&&(h=b.ownerDocument.getElementById(j))&&t(b,h)&&h.id===j)return d.push(h),d}else{if(f[2])return H.apply(d,b.getElementsByTagName(a)),d;if((j=f[3])&&c.getElementsByClassName)return H.apply(d,b.getElementsByClassName(j)),d}if(c.qsa&&(!q||!q.test(a))){if(s=r=u,w=b,x=1!==k&&a,1===k&&"object"!==b.nodeName.toLowerCase()){o=g(a),(r=b.getAttribute("id"))?s=r.replace(ba,"\\$&"):b.setAttribute("id",s),s="[id='"+s+"'] ",l=o.length;while(l--)o[l]=s+ra(o[l]);w=aa.test(a)&&pa(b.parentNode)||b,x=o.join(",")}if(x)try{return H.apply(d,w.querySelectorAll(x)),d}catch(y){}finally{r||b.removeAttribute("id")}}}return i(a.replace(R,"$1"),b,d,e)}function ha(){var a=[];function b(c,e){return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e}return b}function ia(a){return a[u]=!0,a}function ja(a){var b=n.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function ka(a,b){var c=a.split("|"),e=a.length;while(e--)d.attrHandle[c[e]]=b}function la(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||C)-(~a.sourceIndex||C);if(d)return d;if(c)while(c=c.nextSibling)if(c===b)return-1;return a?1:-1}function ma(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function na(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function oa(a){return ia(function(b){return b=+b,ia(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function pa(a){return a&&"undefined"!=typeof a.getElementsByTagName&&a}c=ga.support={},f=ga.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},m=ga.setDocument=function(a){var b,e,g=a?a.ownerDocument||a:v;return g!==n&&9===g.nodeType&&g.documentElement?(n=g,o=g.documentElement,e=g.defaultView,e&&e!==e.top&&(e.addEventListener?e.addEventListener("unload",ea,!1):e.attachEvent&&e.attachEvent("onunload",ea)),p=!f(g),c.attributes=ja(function(a){return a.className="i",!a.getAttribute("className")}),c.getElementsByTagName=ja(function(a){return a.appendChild(g.createComment("")),!a.getElementsByTagName("*").length}),c.getElementsByClassName=$.test(g.getElementsByClassName),c.getById=ja(function(a){return o.appendChild(a).id=u,!g.getElementsByName||!g.getElementsByName(u).length}),c.getById?(d.find.ID=function(a,b){if("undefined"!=typeof b.getElementById&&p){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},d.filter.ID=function(a){var b=a.replace(ca,da);return function(a){return a.getAttribute("id")===b}}):(delete d.find.ID,d.filter.ID=function(a){var b=a.replace(ca,da);return function(a){var c="undefined"!=typeof a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b}}),d.find.TAG=c.getElementsByTagName?function(a,b){return"undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(a):c.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){while(c=f[e++])1===c.nodeType&&d.push(c);return d}return f},d.find.CLASS=c.getElementsByClassName&&function(a,b){return p?b.getElementsByClassName(a):void 0},r=[],q=[],(c.qsa=$.test(g.querySelectorAll))&&(ja(function(a){o.appendChild(a).innerHTML="<a id='"+u+"'></a><select id='"+u+"-\f]' msallowcapture=''><option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&q.push("[*^$]="+L+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||q.push("\\["+L+"*(?:value|"+K+")"),a.querySelectorAll("[id~="+u+"-]").length||q.push("~="),a.querySelectorAll(":checked").length||q.push(":checked"),a.querySelectorAll("a#"+u+"+*").length||q.push(".#.+[+~]")}),ja(function(a){var b=g.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&q.push("name"+L+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||q.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),q.push(",.*:")})),(c.matchesSelector=$.test(s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector))&&ja(function(a){c.disconnectedMatch=s.call(a,"div"),s.call(a,"[s!='']:x"),r.push("!=",P)}),q=q.length&&new RegExp(q.join("|")),r=r.length&&new RegExp(r.join("|")),b=$.test(o.compareDocumentPosition),t=b||$.test(o.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)while(b=b.parentNode)if(b===a)return!0;return!1},B=b?function(a,b){if(a===b)return l=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===g||a.ownerDocument===v&&t(v,a)?-1:b===g||b.ownerDocument===v&&t(v,b)?1:k?J(k,a)-J(k,b):0:4&d?-1:1)}:function(a,b){if(a===b)return l=!0,0;var c,d=0,e=a.parentNode,f=b.parentNode,h=[a],i=[b];if(!e||!f)return a===g?-1:b===g?1:e?-1:f?1:k?J(k,a)-J(k,b):0;if(e===f)return la(a,b);c=a;while(c=c.parentNode)h.unshift(c);c=b;while(c=c.parentNode)i.unshift(c);while(h[d]===i[d])d++;return d?la(h[d],i[d]):h[d]===v?-1:i[d]===v?1:0},g):n},ga.matches=function(a,b){return ga(a,null,null,b)},ga.matchesSelector=function(a,b){if((a.ownerDocument||a)!==n&&m(a),b=b.replace(U,"='$1']"),!(!c.matchesSelector||!p||r&&r.test(b)||q&&q.test(b)))try{var d=s.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return ga(b,n,null,[a]).length>0},ga.contains=function(a,b){return(a.ownerDocument||a)!==n&&m(a),t(a,b)},ga.attr=function(a,b){(a.ownerDocument||a)!==n&&m(a);var e=d.attrHandle[b.toLowerCase()],f=e&&D.call(d.attrHandle,b.toLowerCase())?e(a,b,!p):void 0;return void 0!==f?f:c.attributes||!p?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},ga.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},ga.uniqueSort=function(a){var b,d=[],e=0,f=0;if(l=!c.detectDuplicates,k=!c.sortStable&&a.slice(0),a.sort(B),l){while(b=a[f++])b===a[f]&&(e=d.push(f));while(e--)a.splice(d[e],1)}return k=null,a},e=ga.getText=function(a){var b,c="",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else while(b=a[d++])c+=e(b);return c},d=ga.selectors={cacheLength:50,createPseudo:ia,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(ca,da),a[3]=(a[3]||a[4]||a[5]||"").replace(ca,da),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||ga.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&ga.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return X.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&V.test(c)&&(b=g(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(ca,da).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=y[a+" "];return b||(b=new RegExp("(^|"+L+")"+a+"("+L+"|$)"))&&y(a,function(a){return b.test("string"==typeof a.className&&a.className||"undefined"!=typeof a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=ga.attr(d,a);return null==e?"!="===b:b?(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e.replace(Q," ")+" ").indexOf(c)>-1:"|="===b?e===c||e.slice(0,c.length+1)===c+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){while(p){l=b;while(l=l[p])if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){k=q[u]||(q[u]={}),j=k[a]||[],n=j[0]===w&&j[1],m=j[0]===w&&j[2],l=n&&q.childNodes[n];while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if(1===l.nodeType&&++m&&l===b){k[a]=[w,n,m];break}}else if(s&&(j=(b[u]||(b[u]={}))[a])&&j[0]===w)m=j[1];else while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if((h?l.nodeName.toLowerCase()===r:1===l.nodeType)&&++m&&(s&&((l[u]||(l[u]={}))[a]=[w,m]),l===b))break;return m-=e,m===d||m%d===0&&m/d>=0}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||ga.error("unsupported pseudo: "+a);return e[u]?e(b):e.length>1?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?ia(function(a,c){var d,f=e(a,b),g=f.length;while(g--)d=J(a,f[g]),a[d]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:ia(function(a){var b=[],c=[],d=h(a.replace(R,"$1"));return d[u]?ia(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),b[0]=null,!c.pop()}}),has:ia(function(a){return function(b){return ga(a,b).length>0}}),contains:ia(function(a){return a=a.replace(ca,da),function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1}}),lang:ia(function(a){return W.test(a||"")||ga.error("unsupported lang: "+a),a=a.replace(ca,da).toLowerCase(),function(b){var c;do if(c=p?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===o},focus:function(a){return a===n.activeElement&&(!n.hasFocus||n.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return Z.test(a.nodeName)},input:function(a){return Y.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:oa(function(){return[0]}),last:oa(function(a,b){return[b-1]}),eq:oa(function(a,b,c){return[0>c?c+b:c]}),even:oa(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:oa(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:oa(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:oa(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=ma(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=na(b);function qa(){}qa.prototype=d.filters=d.pseudos,d.setFilters=new qa,g=ga.tokenize=function(a,b){var c,e,f,g,h,i,j,k=z[a+" "];if(k)return b?0:k.slice(0);h=a,i=[],j=d.preFilter;while(h){(!c||(e=S.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=T.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(R," ")}),h=h.slice(c.length));for(g in d.filter)!(e=X[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?ga.error(a):z(a,i).slice(0)};function ra(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d}function sa(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=x++;return b.first?function(b,c,f){while(b=b[d])if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[w,f];if(g){while(b=b[d])if((1===b.nodeType||e)&&a(b,c,g))return!0}else while(b=b[d])if(1===b.nodeType||e){if(i=b[u]||(b[u]={}),(h=i[d])&&h[0]===w&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function ta(a){return a.length>1?function(b,c,d){var e=a.length;while(e--)if(!a[e](b,c,d))return!1;return!0}:a[0]}function ua(a,b,c){for(var d=0,e=b.length;e>d;d++)ga(a,b[d],c);return c}function va(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function wa(a,b,c,d,e,f){return d&&!d[u]&&(d=wa(d)),e&&!e[u]&&(e=wa(e,f)),ia(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||ua(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:va(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d){j=va(r,n),d(j,[],h,i),k=j.length;while(k--)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l))}if(f){if(e||a){if(e){j=[],k=r.length;while(k--)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}k=r.length;while(k--)(l=r[k])&&(j=e?J(f,l):m[k])>-1&&(f[j]=!(g[j]=l))}}else r=va(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):H.apply(g,r)})}function xa(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],h=g||d.relative[" "],i=g?1:0,k=sa(function(a){return a===b},h,!0),l=sa(function(a){return J(b,a)>-1},h,!0),m=[function(a,c,d){var e=!g&&(d||c!==j)||((b=c).nodeType?k(a,c,d):l(a,c,d));return b=null,e}];f>i;i++)if(c=d.relative[a[i].type])m=[sa(ta(m),c)];else{if(c=d.filter[a[i].type].apply(null,a[i].matches),c[u]){for(e=++i;f>e;e++)if(d.relative[a[e].type])break;return wa(i>1&&ta(m),i>1&&ra(a.slice(0,i-1).concat({value:" "===a[i-2].type?"*":""})).replace(R,"$1"),c,e>i&&xa(a.slice(i,e)),f>e&&xa(a=a.slice(e)),f>e&&ra(a))}m.push(c)}return ta(m)}function ya(a,b){var c=b.length>0,e=a.length>0,f=function(f,g,h,i,k){var l,m,o,p=0,q="0",r=f&&[],s=[],t=j,u=f||e&&d.find.TAG("*",k),v=w+=null==t?1:Math.random()||.1,x=u.length;for(k&&(j=g!==n&&g);q!==x&&null!=(l=u[q]);q++){if(e&&l){m=0;while(o=a[m++])if(o(l,g,h)){i.push(l);break}k&&(w=v)}c&&((l=!o&&l)&&p--,f&&r.push(l))}if(p+=q,c&&q!==p){m=0;while(o=b[m++])o(r,s,g,h);if(f){if(p>0)while(q--)r[q]||s[q]||(s[q]=F.call(i));s=va(s)}H.apply(i,s),k&&!f&&s.length>0&&p+b.length>1&&ga.uniqueSort(i)}return k&&(w=v,j=t),r};return c?ia(f):f}return h=ga.compile=function(a,b){var c,d=[],e=[],f=A[a+" "];if(!f){b||(b=g(a)),c=b.length;while(c--)f=xa(b[c]),f[u]?d.push(f):e.push(f);f=A(a,ya(e,d)),f.selector=a}return f},i=ga.select=function(a,b,e,f){var i,j,k,l,m,n="function"==typeof a&&a,o=!f&&g(a=n.selector||a);if(e=e||[],1===o.length){if(j=o[0]=o[0].slice(0),j.length>2&&"ID"===(k=j[0]).type&&c.getById&&9===b.nodeType&&p&&d.relative[j[1].type]){if(b=(d.find.ID(k.matches[0].replace(ca,da),b)||[])[0],!b)return e;n&&(b=b.parentNode),a=a.slice(j.shift().value.length)}i=X.needsContext.test(a)?0:j.length;while(i--){if(k=j[i],d.relative[l=k.type])break;if((m=d.find[l])&&(f=m(k.matches[0].replace(ca,da),aa.test(j[0].type)&&pa(b.parentNode)||b))){if(j.splice(i,1),a=f.length&&ra(j),!a)return H.apply(e,f),e;break}}}return(n||h(a,o))(f,b,!p,e,aa.test(a)&&pa(b.parentNode)||b),e},c.sortStable=u.split("").sort(B).join("")===u,c.detectDuplicates=!!l,m(),c.sortDetached=ja(function(a){return 1&a.compareDocumentPosition(n.createElement("div"))}),ja(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||ka("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),c.attributes&&ja(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||ka("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),ja(function(a){return null==a.getAttribute("disabled")})||ka(K,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),ga}(a);n.find=t,n.expr=t.selectors,n.expr[":"]=n.expr.pseudos,n.unique=t.uniqueSort,n.text=t.getText,n.isXMLDoc=t.isXML,n.contains=t.contains;var u=n.expr.match.needsContext,v=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,w=/^.[^:#\[\.,]*$/;function x(a,b,c){if(n.isFunction(b))return n.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return n.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(w.test(b))return n.filter(b,a,c);b=n.filter(b,a)}return n.grep(a,function(a){return g.call(b,a)>=0!==c})}n.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?n.find.matchesSelector(d,a)?[d]:[]:n.find.matches(a,n.grep(b,function(a){return 1===a.nodeType}))},n.fn.extend({find:function(a){var b,c=this.length,d=[],e=this;if("string"!=typeof a)return this.pushStack(n(a).filter(function(){for(b=0;c>b;b++)if(n.contains(e[b],this))return!0}));for(b=0;c>b;b++)n.find(a,e[b],d);return d=this.pushStack(c>1?n.unique(d):d),d.selector=this.selector?this.selector+" "+a:a,d},filter:function(a){return this.pushStack(x(this,a||[],!1))},not:function(a){return this.pushStack(x(this,a||[],!0))},is:function(a){return!!x(this,"string"==typeof a&&u.test(a)?n(a):a||[],!1).length}});var y,z=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,A=n.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(c="<"===a[0]&&">"===a[a.length-1]&&a.length>=3?[null,a,null]:z.exec(a),!c||!c[1]&&b)return!b||b.jquery?(b||y).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof n?b[0]:b,n.merge(this,n.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:l,!0)),v.test(c[1])&&n.isPlainObject(b))for(c in b)n.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}return d=l.getElementById(c[2]),d&&d.parentNode&&(this.length=1,this[0]=d),this.context=l,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):n.isFunction(a)?"undefined"!=typeof y.ready?y.ready(a):a(n):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),n.makeArray(a,this))};A.prototype=n.fn,y=n(l);var B=/^(?:parents|prev(?:Until|All))/,C={children:!0,contents:!0,next:!0,prev:!0};n.extend({dir:function(a,b,c){var d=[],e=void 0!==c;while((a=a[b])&&9!==a.nodeType)if(1===a.nodeType){if(e&&n(a).is(c))break;d.push(a)}return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),n.fn.extend({has:function(a){var b=n(a,this),c=b.length;return this.filter(function(){for(var a=0;c>a;a++)if(n.contains(this,b[a]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=u.test(a)||"string"!=typeof a?n(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&n.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?n.unique(f):f)},index:function(a){return a?"string"==typeof a?g.call(n(a),this[0]):g.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(n.unique(n.merge(this.get(),n(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});function D(a,b){while((a=a[b])&&1!==a.nodeType);return a}n.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return n.dir(a,"parentNode")},parentsUntil:function(a,b,c){return n.dir(a,"parentNode",c)},next:function(a){return D(a,"nextSibling")},prev:function(a){return D(a,"previousSibling")},nextAll:function(a){return n.dir(a,"nextSibling")},prevAll:function(a){return n.dir(a,"previousSibling")},nextUntil:function(a,b,c){return n.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return n.dir(a,"previousSibling",c)},siblings:function(a){return n.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return n.sibling(a.firstChild)},contents:function(a){return a.contentDocument||n.merge([],a.childNodes)}},function(a,b){n.fn[a]=function(c,d){var e=n.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=n.filter(d,e)),this.length>1&&(C[a]||n.unique(e),B.test(a)&&e.reverse()),this.pushStack(e)}});var E=/\S+/g,F={};function G(a){var b=F[a]={};return n.each(a.match(E)||[],function(a,c){b[c]=!0}),b}n.Callbacks=function(a){a="string"==typeof a?F[a]||G(a):n.extend({},a);var b,c,d,e,f,g,h=[],i=!a.once&&[],j=function(l){for(b=a.memory&&l,c=!0,g=e||0,e=0,f=h.length,d=!0;h&&f>g;g++)if(h[g].apply(l[0],l[1])===!1&&a.stopOnFalse){b=!1;break}d=!1,h&&(i?i.length&&j(i.shift()):b?h=[]:k.disable())},k={add:function(){if(h){var c=h.length;!function g(b){n.each(b,function(b,c){var d=n.type(c);"function"===d?a.unique&&k.has(c)||h.push(c):c&&c.length&&"string"!==d&&g(c)})}(arguments),d?f=h.length:b&&(e=c,j(b))}return this},remove:function(){return h&&n.each(arguments,function(a,b){var c;while((c=n.inArray(b,h,c))>-1)h.splice(c,1),d&&(f>=c&&f--,g>=c&&g--)}),this},has:function(a){return a?n.inArray(a,h)>-1:!(!h||!h.length)},empty:function(){return h=[],f=0,this},disable:function(){return h=i=b=void 0,this},disabled:function(){return!h},lock:function(){return i=void 0,b||k.disable(),this},locked:function(){return!i},fireWith:function(a,b){return!h||c&&!i||(b=b||[],b=[a,b.slice?b.slice():b],d?i.push(b):j(b)),this},fire:function(){return k.fireWith(this,arguments),this},fired:function(){return!!c}};return k},n.extend({Deferred:function(a){var b=[["resolve","done",n.Callbacks("once memory"),"resolved"],["reject","fail",n.Callbacks("once memory"),"rejected"],["notify","progress",n.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return n.Deferred(function(c){n.each(b,function(b,f){var g=n.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&n.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?n.extend(a,d):d}},e={};return d.pipe=d.then,n.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b=0,c=d.call(arguments),e=c.length,f=1!==e||a&&n.isFunction(a.promise)?e:0,g=1===f?a:n.Deferred(),h=function(a,b,c){return function(e){b[a]=this,c[a]=arguments.length>1?d.call(arguments):e,c===i?g.notifyWith(b,c):--f||g.resolveWith(b,c)}},i,j,k;if(e>1)for(i=new Array(e),j=new Array(e),k=new Array(e);e>b;b++)c[b]&&n.isFunction(c[b].promise)?c[b].promise().done(h(b,k,c)).fail(g.reject).progress(h(b,j,i)):--f;return f||g.resolveWith(k,c),g.promise()}});var H;n.fn.ready=function(a){return n.ready.promise().done(a),this},n.extend({isReady:!1,readyWait:1,holdReady:function(a){a?n.readyWait++:n.ready(!0)},ready:function(a){(a===!0?--n.readyWait:n.isReady)||(n.isReady=!0,a!==!0&&--n.readyWait>0||(H.resolveWith(l,[n]),n.fn.triggerHandler&&(n(l).triggerHandler("ready"),n(l).off("ready"))))}});function I(){l.removeEventListener("DOMContentLoaded",I,!1),a.removeEventListener("load",I,!1),n.ready()}n.ready.promise=function(b){return H||(H=n.Deferred(),"complete"===l.readyState?setTimeout(n.ready):(l.addEventListener("DOMContentLoaded",I,!1),a.addEventListener("load",I,!1))),H.promise(b)},n.ready.promise();var J=n.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===n.type(c)){e=!0;for(h in c)n.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,n.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(n(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f};n.acceptData=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType};function K(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=n.expando+K.uid++}K.uid=1,K.accepts=n.acceptData,K.prototype={key:function(a){if(!K.accepts(a))return 0;var b={},c=a[this.expando];if(!c){c=K.uid++;try{b[this.expando]={value:c},Object.defineProperties(a,b)}catch(d){b[this.expando]=c,n.extend(a,b)}}return this.cache[c]||(this.cache[c]={}),c},set:function(a,b,c){var d,e=this.key(a),f=this.cache[e];if("string"==typeof b)f[b]=c;else if(n.isEmptyObject(f))n.extend(this.cache[e],b);else for(d in b)f[d]=b[d];return f},get:function(a,b){var c=this.cache[this.key(a)];return void 0===b?c:c[b]},access:function(a,b,c){var d;return void 0===b||b&&"string"==typeof b&&void 0===c?(d=this.get(a,b),void 0!==d?d:this.get(a,n.camelCase(b))):(this.set(a,b,c),void 0!==c?c:b)},remove:function(a,b){var c,d,e,f=this.key(a),g=this.cache[f];if(void 0===b)this.cache[f]={};else{n.isArray(b)?d=b.concat(b.map(n.camelCase)):(e=n.camelCase(b),b in g?d=[b,e]:(d=e,d=d in g?[d]:d.match(E)||[])),c=d.length;while(c--)delete g[d[c]]}},hasData:function(a){return!n.isEmptyObject(this.cache[a[this.expando]]||{})},discard:function(a){a[this.expando]&&delete this.cache[a[this.expando]]}};var L=new K,M=new K,N=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,O=/([A-Z])/g;function P(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(O,"-$1").toLowerCase(),c=a.getAttribute(d),"string"==typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:N.test(c)?n.parseJSON(c):c}catch(e){}M.set(a,b,c)}else c=void 0;return c}n.extend({hasData:function(a){return M.hasData(a)||L.hasData(a)},data:function(a,b,c){
return M.access(a,b,c)},removeData:function(a,b){M.remove(a,b)},_data:function(a,b,c){return L.access(a,b,c)},_removeData:function(a,b){L.remove(a,b)}}),n.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=M.get(f),1===f.nodeType&&!L.get(f,"hasDataAttrs"))){c=g.length;while(c--)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=n.camelCase(d.slice(5)),P(f,d,e[d])));L.set(f,"hasDataAttrs",!0)}return e}return"object"==typeof a?this.each(function(){M.set(this,a)}):J(this,function(b){var c,d=n.camelCase(a);if(f&&void 0===b){if(c=M.get(f,a),void 0!==c)return c;if(c=M.get(f,d),void 0!==c)return c;if(c=P(f,d,void 0),void 0!==c)return c}else this.each(function(){var c=M.get(this,d);M.set(this,d,b),-1!==a.indexOf("-")&&void 0!==c&&M.set(this,a,b)})},null,b,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){M.remove(this,a)})}}),n.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=L.get(a,b),c&&(!d||n.isArray(c)?d=L.access(a,b,n.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=n.queue(a,b),d=c.length,e=c.shift(),f=n._queueHooks(a,b),g=function(){n.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return L.get(a,c)||L.access(a,c,{empty:n.Callbacks("once memory").add(function(){L.remove(a,[b+"queue",c])})})}}),n.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?n.queue(this[0],a):void 0===b?this:this.each(function(){var c=n.queue(this,a,b);n._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&n.dequeue(this,a)})},dequeue:function(a){return this.each(function(){n.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=n.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};"string"!=typeof a&&(b=a,a=void 0),a=a||"fx";while(g--)c=L.get(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var Q=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,R=["Top","Right","Bottom","Left"],S=function(a,b){return a=b||a,"none"===n.css(a,"display")||!n.contains(a.ownerDocument,a)},T=/^(?:checkbox|radio)$/i;!function(){var a=l.createDocumentFragment(),b=a.appendChild(l.createElement("div")),c=l.createElement("input");c.setAttribute("type","radio"),c.setAttribute("checked","checked"),c.setAttribute("name","t"),b.appendChild(c),k.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",k.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();var U="undefined";k.focusinBubbles="onfocusin"in a;var V=/^key/,W=/^(?:mouse|pointer|contextmenu)|click/,X=/^(?:focusinfocus|focusoutblur)$/,Y=/^([^.]*)(?:\.(.+)|)$/;function Z(){return!0}function $(){return!1}function _(){try{return l.activeElement}catch(a){}}n.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=L.get(a);if(r){c.handler&&(f=c,c=f.handler,e=f.selector),c.guid||(c.guid=n.guid++),(i=r.events)||(i=r.events={}),(g=r.handle)||(g=r.handle=function(b){return typeof n!==U&&n.event.triggered!==b.type?n.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(E)||[""],j=b.length;while(j--)h=Y.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o&&(l=n.event.special[o]||{},o=(e?l.delegateType:l.bindType)||o,l=n.event.special[o]||{},k=n.extend({type:o,origType:q,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&n.expr.match.needsContext.test(e),namespace:p.join(".")},f),(m=i[o])||(m=i[o]=[],m.delegateCount=0,l.setup&&l.setup.call(a,d,p,g)!==!1||a.addEventListener&&a.addEventListener(o,g,!1)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),n.event.global[o]=!0)}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=L.hasData(a)&&L.get(a);if(r&&(i=r.events)){b=(b||"").match(E)||[""],j=b.length;while(j--)if(h=Y.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o){l=n.event.special[o]||{},o=(d?l.delegateType:l.bindType)||o,m=i[o]||[],h=h[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;while(f--)k=m[f],!e&&q!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&l.teardown.call(a,p,r.handle)!==!1||n.removeEvent(a,o,r.handle),delete i[o])}else for(o in i)n.event.remove(a,o+b[j],c,d,!0);n.isEmptyObject(i)&&(delete r.handle,L.remove(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,i,k,m,o,p=[d||l],q=j.call(b,"type")?b.type:b,r=j.call(b,"namespace")?b.namespace.split("."):[];if(g=h=d=d||l,3!==d.nodeType&&8!==d.nodeType&&!X.test(q+n.event.triggered)&&(q.indexOf(".")>=0&&(r=q.split("."),q=r.shift(),r.sort()),k=q.indexOf(":")<0&&"on"+q,b=b[n.expando]?b:new n.Event(q,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=r.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+r.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:n.makeArray(c,[b]),o=n.event.special[q]||{},e||!o.trigger||o.trigger.apply(d,c)!==!1)){if(!e&&!o.noBubble&&!n.isWindow(d)){for(i=o.delegateType||q,X.test(i+q)||(g=g.parentNode);g;g=g.parentNode)p.push(g),h=g;h===(d.ownerDocument||l)&&p.push(h.defaultView||h.parentWindow||a)}f=0;while((g=p[f++])&&!b.isPropagationStopped())b.type=f>1?i:o.bindType||q,m=(L.get(g,"events")||{})[b.type]&&L.get(g,"handle"),m&&m.apply(g,c),m=k&&g[k],m&&m.apply&&n.acceptData(g)&&(b.result=m.apply(g,c),b.result===!1&&b.preventDefault());return b.type=q,e||b.isDefaultPrevented()||o._default&&o._default.apply(p.pop(),c)!==!1||!n.acceptData(d)||k&&n.isFunction(d[q])&&!n.isWindow(d)&&(h=d[k],h&&(d[k]=null),n.event.triggered=q,d[q](),n.event.triggered=void 0,h&&(d[k]=h)),b.result}},dispatch:function(a){a=n.event.fix(a);var b,c,e,f,g,h=[],i=d.call(arguments),j=(L.get(this,"events")||{})[a.type]||[],k=n.event.special[a.type]||{};if(i[0]=a,a.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,a)!==!1){h=n.event.handlers.call(this,a,j),b=0;while((f=h[b++])&&!a.isPropagationStopped()){a.currentTarget=f.elem,c=0;while((g=f.handlers[c++])&&!a.isImmediatePropagationStopped())(!a.namespace_re||a.namespace_re.test(g.namespace))&&(a.handleObj=g,a.data=g.data,e=((n.event.special[g.origType]||{}).handle||g.handler).apply(f.elem,i),void 0!==e&&(a.result=e)===!1&&(a.preventDefault(),a.stopPropagation()))}return k.postDispatch&&k.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!==this;i=i.parentNode||this)if(i.disabled!==!0||"click"!==a.type){for(d=[],c=0;h>c;c++)f=b[c],e=f.selector+" ",void 0===d[e]&&(d[e]=f.needsContext?n(e,this).index(i)>=0:n.find(e,this,null,[i]).length),d[e]&&d.push(f);d.length&&g.push({elem:i,handlers:d})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button;return null==a.pageX&&null!=b.clientX&&(c=a.target.ownerDocument||l,d=c.documentElement,e=c.body,a.pageX=b.clientX+(d&&d.scrollLeft||e&&e.scrollLeft||0)-(d&&d.clientLeft||e&&e.clientLeft||0),a.pageY=b.clientY+(d&&d.scrollTop||e&&e.scrollTop||0)-(d&&d.clientTop||e&&e.clientTop||0)),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},fix:function(a){if(a[n.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];g||(this.fixHooks[e]=g=W.test(e)?this.mouseHooks:V.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new n.Event(f),b=d.length;while(b--)c=d[b],a[c]=f[c];return a.target||(a.target=l),3===a.target.nodeType&&(a.target=a.target.parentNode),g.filter?g.filter(a,f):a},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==_()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===_()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&n.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(a){return n.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=n.extend(new n.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?n.event.trigger(e,null,b):n.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},n.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)},n.Event=function(a,b){return this instanceof n.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.returnValue===!1?Z:$):this.type=a,b&&n.extend(this,b),this.timeStamp=a&&a.timeStamp||n.now(),void(this[n.expando]=!0)):new n.Event(a,b)},n.Event.prototype={isDefaultPrevented:$,isPropagationStopped:$,isImmediatePropagationStopped:$,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=Z,a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=Z,a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=Z,a&&a.stopImmediatePropagation&&a.stopImmediatePropagation(),this.stopPropagation()}},n.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){n.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!n.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),k.focusinBubbles||n.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){n.event.simulate(b,a.target,n.event.fix(a),!0)};n.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=L.access(d,b);e||d.addEventListener(a,c,!0),L.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=L.access(d,b)-1;e?L.access(d,b,e):(d.removeEventListener(a,c,!0),L.remove(d,b))}}}),n.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==typeof a){"string"!=typeof b&&(c=c||b,b=void 0);for(g in a)this.on(g,b,c,a[g],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=$;else if(!d)return this;return 1===e&&(f=d,d=function(a){return n().off(a),f.apply(this,arguments)},d.guid=f.guid||(f.guid=n.guid++)),this.each(function(){n.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,n(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return(b===!1||"function"==typeof b)&&(c=b,b=void 0),c===!1&&(c=$),this.each(function(){n.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){n.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?n.event.trigger(a,b,c,!0):void 0}});var aa=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ba=/<([\w:]+)/,ca=/<|&#?\w+;/,da=/<(?:script|style|link)/i,ea=/checked\s*(?:[^=]|=\s*.checked.)/i,fa=/^$|\/(?:java|ecma)script/i,ga=/^true\/(.*)/,ha=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ia={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ia.optgroup=ia.option,ia.tbody=ia.tfoot=ia.colgroup=ia.caption=ia.thead,ia.th=ia.td;function ja(a,b){return n.nodeName(a,"table")&&n.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function ka(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function la(a){var b=ga.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function ma(a,b){for(var c=0,d=a.length;d>c;c++)L.set(a[c],"globalEval",!b||L.get(b[c],"globalEval"))}function na(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(L.hasData(a)&&(f=L.access(a),g=L.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j)for(c=0,d=j[e].length;d>c;c++)n.event.add(b,e,j[e][c])}M.hasData(a)&&(h=M.access(a),i=n.extend({},h),M.set(b,i))}}function oa(a,b){var c=a.getElementsByTagName?a.getElementsByTagName(b||"*"):a.querySelectorAll?a.querySelectorAll(b||"*"):[];return void 0===b||b&&n.nodeName(a,b)?n.merge([a],c):c}function pa(a,b){var c=b.nodeName.toLowerCase();"input"===c&&T.test(a.type)?b.checked=a.checked:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue)}n.extend({clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=n.contains(a.ownerDocument,a);if(!(k.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||n.isXMLDoc(a)))for(g=oa(h),f=oa(a),d=0,e=f.length;e>d;d++)pa(f[d],g[d]);if(b)if(c)for(f=f||oa(a),g=g||oa(h),d=0,e=f.length;e>d;d++)na(f[d],g[d]);else na(a,h);return g=oa(h,"script"),g.length>0&&ma(g,!i&&oa(a,"script")),h},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k=b.createDocumentFragment(),l=[],m=0,o=a.length;o>m;m++)if(e=a[m],e||0===e)if("object"===n.type(e))n.merge(l,e.nodeType?[e]:e);else if(ca.test(e)){f=f||k.appendChild(b.createElement("div")),g=(ba.exec(e)||["",""])[1].toLowerCase(),h=ia[g]||ia._default,f.innerHTML=h[1]+e.replace(aa,"<$1></$2>")+h[2],j=h[0];while(j--)f=f.lastChild;n.merge(l,f.childNodes),f=k.firstChild,f.textContent=""}else l.push(b.createTextNode(e));k.textContent="",m=0;while(e=l[m++])if((!d||-1===n.inArray(e,d))&&(i=n.contains(e.ownerDocument,e),f=oa(k.appendChild(e),"script"),i&&ma(f),c)){j=0;while(e=f[j++])fa.test(e.type||"")&&c.push(e)}return k},cleanData:function(a){for(var b,c,d,e,f=n.event.special,g=0;void 0!==(c=a[g]);g++){if(n.acceptData(c)&&(e=c[L.expando],e&&(b=L.cache[e]))){if(b.events)for(d in b.events)f[d]?n.event.remove(c,d):n.removeEvent(c,d,b.handle);L.cache[e]&&delete L.cache[e]}delete M.cache[c[M.expando]]}}}),n.fn.extend({text:function(a){return J(this,function(a){return void 0===a?n.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=a)})},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=ja(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=ja(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?n.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||n.cleanData(oa(c)),c.parentNode&&(b&&n.contains(c.ownerDocument,c)&&ma(oa(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(n.cleanData(oa(a,!1)),a.textContent="");return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return n.clone(this,a,b)})},html:function(a){return J(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!da.test(a)&&!ia[(ba.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(aa,"<$1></$2>");try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(n.cleanData(oa(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,n.cleanData(oa(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=e.apply([],a);var c,d,f,g,h,i,j=0,l=this.length,m=this,o=l-1,p=a[0],q=n.isFunction(p);if(q||l>1&&"string"==typeof p&&!k.checkClone&&ea.test(p))return this.each(function(c){var d=m.eq(c);q&&(a[0]=p.call(this,c,d.html())),d.domManip(a,b)});if(l&&(c=n.buildFragment(a,this[0].ownerDocument,!1,this),d=c.firstChild,1===c.childNodes.length&&(c=d),d)){for(f=n.map(oa(c,"script"),ka),g=f.length;l>j;j++)h=c,j!==o&&(h=n.clone(h,!0,!0),g&&n.merge(f,oa(h,"script"))),b.call(this[j],h,j);if(g)for(i=f[f.length-1].ownerDocument,n.map(f,la),j=0;g>j;j++)h=f[j],fa.test(h.type||"")&&!L.access(h,"globalEval")&&n.contains(i,h)&&(h.src?n._evalUrl&&n._evalUrl(h.src):n.globalEval(h.textContent.replace(ha,"")))}return this}}),n.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){n.fn[a]=function(a){for(var c,d=[],e=n(a),g=e.length-1,h=0;g>=h;h++)c=h===g?this:this.clone(!0),n(e[h])[b](c),f.apply(d,c.get());return this.pushStack(d)}});var qa,ra={};function sa(b,c){var d,e=n(c.createElement(b)).appendTo(c.body),f=a.getDefaultComputedStyle&&(d=a.getDefaultComputedStyle(e[0]))?d.display:n.css(e[0],"display");return e.detach(),f}function ta(a){var b=l,c=ra[a];return c||(c=sa(a,b),"none"!==c&&c||(qa=(qa||n("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=qa[0].contentDocument,b.write(),b.close(),c=sa(a,b),qa.detach()),ra[a]=c),c}var ua=/^margin/,va=new RegExp("^("+Q+")(?!px)[a-z%]+$","i"),wa=function(b){return b.ownerDocument.defaultView.opener?b.ownerDocument.defaultView.getComputedStyle(b,null):a.getComputedStyle(b,null)};function xa(a,b,c){var d,e,f,g,h=a.style;return c=c||wa(a),c&&(g=c.getPropertyValue(b)||c[b]),c&&(""!==g||n.contains(a.ownerDocument,a)||(g=n.style(a,b)),va.test(g)&&ua.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0!==g?g+"":g}function ya(a,b){return{get:function(){return a()?void delete this.get:(this.get=b).apply(this,arguments)}}}!function(){var b,c,d=l.documentElement,e=l.createElement("div"),f=l.createElement("div");if(f.style){f.style.backgroundClip="content-box",f.cloneNode(!0).style.backgroundClip="",k.clearCloneStyle="content-box"===f.style.backgroundClip,e.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",e.appendChild(f);function g(){f.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",f.innerHTML="",d.appendChild(e);var g=a.getComputedStyle(f,null);b="1%"!==g.top,c="4px"===g.width,d.removeChild(e)}a.getComputedStyle&&n.extend(k,{pixelPosition:function(){return g(),b},boxSizingReliable:function(){return null==c&&g(),c},reliableMarginRight:function(){var b,c=f.appendChild(l.createElement("div"));return c.style.cssText=f.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",c.style.marginRight=c.style.width="0",f.style.width="1px",d.appendChild(e),b=!parseFloat(a.getComputedStyle(c,null).marginRight),d.removeChild(e),f.removeChild(c),b}})}}(),n.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var za=/^(none|table(?!-c[ea]).+)/,Aa=new RegExp("^("+Q+")(.*)$","i"),Ba=new RegExp("^([+-])=("+Q+")","i"),Ca={position:"absolute",visibility:"hidden",display:"block"},Da={letterSpacing:"0",fontWeight:"400"},Ea=["Webkit","O","Moz","ms"];function Fa(a,b){if(b in a)return b;var c=b[0].toUpperCase()+b.slice(1),d=b,e=Ea.length;while(e--)if(b=Ea[e]+c,b in a)return b;return d}function Ga(a,b,c){var d=Aa.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function Ha(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2)"margin"===c&&(g+=n.css(a,c+R[f],!0,e)),d?("content"===c&&(g-=n.css(a,"padding"+R[f],!0,e)),"margin"!==c&&(g-=n.css(a,"border"+R[f]+"Width",!0,e))):(g+=n.css(a,"padding"+R[f],!0,e),"padding"!==c&&(g+=n.css(a,"border"+R[f]+"Width",!0,e)));return g}function Ia(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=wa(a),g="border-box"===n.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=xa(a,b,f),(0>e||null==e)&&(e=a.style[b]),va.test(e))return e;d=g&&(k.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+Ha(a,b,c||(g?"border":"content"),d,f)+"px"}function Ja(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=L.get(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&S(d)&&(f[g]=L.access(d,"olddisplay",ta(d.nodeName)))):(e=S(d),"none"===c&&e||L.set(d,"olddisplay",e?c:n.css(d,"display"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}n.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=xa(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=n.camelCase(b),i=a.style;return b=n.cssProps[h]||(n.cssProps[h]=Fa(i,h)),g=n.cssHooks[b]||n.cssHooks[h],void 0===c?g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b]:(f=typeof c,"string"===f&&(e=Ba.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(n.css(a,b)),f="number"),null!=c&&c===c&&("number"!==f||n.cssNumber[h]||(c+="px"),k.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i[b]=c)),void 0)}},css:function(a,b,c,d){var e,f,g,h=n.camelCase(b);return b=n.cssProps[h]||(n.cssProps[h]=Fa(a.style,h)),g=n.cssHooks[b]||n.cssHooks[h],g&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=xa(a,b,d)),"normal"===e&&b in Da&&(e=Da[b]),""===c||c?(f=parseFloat(e),c===!0||n.isNumeric(f)?f||0:e):e}}),n.each(["height","width"],function(a,b){n.cssHooks[b]={get:function(a,c,d){return c?za.test(n.css(a,"display"))&&0===a.offsetWidth?n.swap(a,Ca,function(){return Ia(a,b,d)}):Ia(a,b,d):void 0},set:function(a,c,d){var e=d&&wa(a);return Ga(a,c,d?Ha(a,b,d,"border-box"===n.css(a,"boxSizing",!1,e),e):0)}}}),n.cssHooks.marginRight=ya(k.reliableMarginRight,function(a,b){return b?n.swap(a,{display:"inline-block"},xa,[a,"marginRight"]):void 0}),n.each({margin:"",padding:"",border:"Width"},function(a,b){n.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+R[d]+b]=f[d]||f[d-2]||f[0];return e}},ua.test(a)||(n.cssHooks[a+b].set=Ga)}),n.fn.extend({css:function(a,b){return J(this,function(a,b,c){var d,e,f={},g=0;if(n.isArray(b)){for(d=wa(a),e=b.length;e>g;g++)f[b[g]]=n.css(a,b[g],!1,d);return f}return void 0!==c?n.style(a,b,c):n.css(a,b)},a,b,arguments.length>1)},show:function(){return Ja(this,!0)},hide:function(){return Ja(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){S(this)?n(this).show():n(this).hide()})}});function Ka(a,b,c,d,e){return new Ka.prototype.init(a,b,c,d,e)}n.Tween=Ka,Ka.prototype={constructor:Ka,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(n.cssNumber[c]?"":"px")},cur:function(){var a=Ka.propHooks[this.prop];return a&&a.get?a.get(this):Ka.propHooks._default.get(this)},run:function(a){var b,c=Ka.propHooks[this.prop];return this.options.duration?this.pos=b=n.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):Ka.propHooks._default.set(this),this}},Ka.prototype.init.prototype=Ka.prototype,Ka.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=n.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){n.fx.step[a.prop]?n.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[n.cssProps[a.prop]]||n.cssHooks[a.prop])?n.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},Ka.propHooks.scrollTop=Ka.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},n.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},n.fx=Ka.prototype.init,n.fx.step={};var La,Ma,Na=/^(?:toggle|show|hide)$/,Oa=new RegExp("^(?:([+-])=|)("+Q+")([a-z%]*)$","i"),Pa=/queueHooks$/,Qa=[Va],Ra={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=Oa.exec(b),f=e&&e[3]||(n.cssNumber[a]?"":"px"),g=(n.cssNumber[a]||"px"!==f&&+d)&&Oa.exec(n.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,n.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};function Sa(){return setTimeout(function(){La=void 0}),La=n.now()}function Ta(a,b){var c,d=0,e={height:a};for(b=b?1:0;4>d;d+=2-b)c=R[d],e["margin"+c]=e["padding"+c]=a;return b&&(e.opacity=e.width=a),e}function Ua(a,b,c){for(var d,e=(Ra[b]||[]).concat(Ra["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function Va(a,b,c){var d,e,f,g,h,i,j,k,l=this,m={},o=a.style,p=a.nodeType&&S(a),q=L.get(a,"fxshow");c.queue||(h=n._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,l.always(function(){l.always(function(){h.unqueued--,n.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[o.overflow,o.overflowX,o.overflowY],j=n.css(a,"display"),k="none"===j?L.get(a,"olddisplay")||ta(a.nodeName):j,"inline"===k&&"none"===n.css(a,"float")&&(o.display="inline-block")),c.overflow&&(o.overflow="hidden",l.always(function(){o.overflow=c.overflow[0],o.overflowX=c.overflow[1],o.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],Na.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(p?"hide":"show")){if("show"!==e||!q||void 0===q[d])continue;p=!0}m[d]=q&&q[d]||n.style(a,d)}else j=void 0;if(n.isEmptyObject(m))"inline"===("none"===j?ta(a.nodeName):j)&&(o.display=j);else{q?"hidden"in q&&(p=q.hidden):q=L.access(a,"fxshow",{}),f&&(q.hidden=!p),p?n(a).show():l.done(function(){n(a).hide()}),l.done(function(){var b;L.remove(a,"fxshow");for(b in m)n.style(a,b,m[b])});for(d in m)g=Ua(p?q[d]:0,d,l),d in q||(q[d]=g.start,p&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function Wa(a,b){var c,d,e,f,g;for(c in a)if(d=n.camelCase(c),e=b[d],f=a[c],n.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=n.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function Xa(a,b,c){var d,e,f=0,g=Qa.length,h=n.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=La||Sa(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:n.extend({},b),opts:n.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:La||Sa(),duration:c.duration,tweens:[],createTween:function(b,c){var d=n.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(Wa(k,j.opts.specialEasing);g>f;f++)if(d=Qa[f].call(j,a,k,j.opts))return d;return n.map(k,Ua,j),n.isFunction(j.opts.start)&&j.opts.start.call(a,j),n.fx.timer(n.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}n.Animation=n.extend(Xa,{tweener:function(a,b){n.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],Ra[c]=Ra[c]||[],Ra[c].unshift(b)},prefilter:function(a,b){b?Qa.unshift(a):Qa.push(a)}}),n.speed=function(a,b,c){var d=a&&"object"==typeof a?n.extend({},a):{complete:c||!c&&b||n.isFunction(a)&&a,duration:a,easing:c&&b||b&&!n.isFunction(b)&&b};return d.duration=n.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in n.fx.speeds?n.fx.speeds[d.duration]:n.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){n.isFunction(d.old)&&d.old.call(this),d.queue&&n.dequeue(this,d.queue)},d},n.fn.extend({fadeTo:function(a,b,c,d){return this.filter(S).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=n.isEmptyObject(a),f=n.speed(b,c,d),g=function(){var b=Xa(this,n.extend({},a),f);(e||L.get(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=n.timers,g=L.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&Pa.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));(b||!c)&&n.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=L.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=n.timers,g=d?d.length:0;for(c.finish=!0,n.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),n.each(["toggle","show","hide"],function(a,b){var c=n.fn[b];n.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(Ta(b,!0),a,d,e)}}),n.each({slideDown:Ta("show"),slideUp:Ta("hide"),slideToggle:Ta("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){n.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),n.timers=[],n.fx.tick=function(){var a,b=0,c=n.timers;for(La=n.now();b<c.length;b++)a=c[b],a()||c[b]!==a||c.splice(b--,1);c.length||n.fx.stop(),La=void 0},n.fx.timer=function(a){n.timers.push(a),a()?n.fx.start():n.timers.pop()},n.fx.interval=13,n.fx.start=function(){Ma||(Ma=setInterval(n.fx.tick,n.fx.interval))},n.fx.stop=function(){clearInterval(Ma),Ma=null},n.fx.speeds={slow:600,fast:200,_default:400},n.fn.delay=function(a,b){return a=n.fx?n.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a=l.createElement("input"),b=l.createElement("select"),c=b.appendChild(l.createElement("option"));a.type="checkbox",k.checkOn=""!==a.value,k.optSelected=c.selected,b.disabled=!0,k.optDisabled=!c.disabled,a=l.createElement("input"),a.value="t",a.type="radio",k.radioValue="t"===a.value}();var Ya,Za,$a=n.expr.attrHandle;n.fn.extend({attr:function(a,b){return J(this,n.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){n.removeAttr(this,a)})}}),n.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f)return typeof a.getAttribute===U?n.prop(a,b,c):(1===f&&n.isXMLDoc(a)||(b=b.toLowerCase(),d=n.attrHooks[b]||(n.expr.match.bool.test(b)?Za:Ya)),
void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=n.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void n.removeAttr(a,b))},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(E);if(f&&1===a.nodeType)while(c=f[e++])d=n.propFix[c]||c,n.expr.match.bool.test(c)&&(a[d]=!1),a.removeAttribute(c)},attrHooks:{type:{set:function(a,b){if(!k.radioValue&&"radio"===b&&n.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),Za={set:function(a,b,c){return b===!1?n.removeAttr(a,c):a.setAttribute(c,c),c}},n.each(n.expr.match.bool.source.match(/\w+/g),function(a,b){var c=$a[b]||n.find.attr;$a[b]=function(a,b,d){var e,f;return d||(f=$a[b],$a[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,$a[b]=f),e}});var _a=/^(?:input|select|textarea|button)$/i;n.fn.extend({prop:function(a,b){return J(this,n.prop,a,b,arguments.length>1)},removeProp:function(a){return this.each(function(){delete this[n.propFix[a]||a]})}}),n.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g||!n.isXMLDoc(a),f&&(b=n.propFix[b]||b,e=n.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){return a.hasAttribute("tabindex")||_a.test(a.nodeName)||a.href?a.tabIndex:-1}}}}),k.optSelected||(n.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null}}),n.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){n.propFix[this.toLowerCase()]=this});var ab=/[\t\r\n\f]/g;n.fn.extend({addClass:function(a){var b,c,d,e,f,g,h="string"==typeof a&&a,i=0,j=this.length;if(n.isFunction(a))return this.each(function(b){n(this).addClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(E)||[];j>i;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(ab," "):" ")){f=0;while(e=b[f++])d.indexOf(" "+e+" ")<0&&(d+=e+" ");g=n.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0===arguments.length||"string"==typeof a&&a,i=0,j=this.length;if(n.isFunction(a))return this.each(function(b){n(this).removeClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(E)||[];j>i;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(ab," "):"")){f=0;while(e=b[f++])while(d.indexOf(" "+e+" ")>=0)d=d.replace(" "+e+" "," ");g=a?n.trim(d):"",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):this.each(n.isFunction(a)?function(c){n(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if("string"===c){var b,d=0,e=n(this),f=a.match(E)||[];while(b=f[d++])e.hasClass(b)?e.removeClass(b):e.addClass(b)}else(c===U||"boolean"===c)&&(this.className&&L.set(this,"__className__",this.className),this.className=this.className||a===!1?"":L.get(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(ab," ").indexOf(b)>=0)return!0;return!1}});var bb=/\r/g;n.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=n.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,n(this).val()):a,null==e?e="":"number"==typeof e?e+="":n.isArray(e)&&(e=n.map(e,function(a){return null==a?"":a+""})),b=n.valHooks[this.type]||n.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return b=n.valHooks[e.type]||n.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(bb,""):null==c?"":c)}}}),n.extend({valHooks:{option:{get:function(a){var b=n.find.attr(a,"value");return null!=b?b:n.trim(n.text(a))}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],!(!c.selected&&i!==e||(k.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&n.nodeName(c.parentNode,"optgroup"))){if(b=n(c).val(),f)return b;g.push(b)}return g},set:function(a,b){var c,d,e=a.options,f=n.makeArray(b),g=e.length;while(g--)d=e[g],(d.selected=n.inArray(d.value,f)>=0)&&(c=!0);return c||(a.selectedIndex=-1),f}}}}),n.each(["radio","checkbox"],function(){n.valHooks[this]={set:function(a,b){return n.isArray(b)?a.checked=n.inArray(n(a).val(),b)>=0:void 0}},k.checkOn||(n.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})}),n.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){n.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),n.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var cb=n.now(),db=/\?/;n.parseJSON=function(a){return JSON.parse(a+"")},n.parseXML=function(a){var b,c;if(!a||"string"!=typeof a)return null;try{c=new DOMParser,b=c.parseFromString(a,"text/xml")}catch(d){b=void 0}return(!b||b.getElementsByTagName("parsererror").length)&&n.error("Invalid XML: "+a),b};var eb=/#.*$/,fb=/([?&])_=[^&]*/,gb=/^(.*?):[ \t]*([^\r\n]*)$/gm,hb=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,ib=/^(?:GET|HEAD)$/,jb=/^\/\//,kb=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,lb={},mb={},nb="*/".concat("*"),ob=a.location.href,pb=kb.exec(ob.toLowerCase())||[];function qb(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(E)||[];if(n.isFunction(c))while(d=f[e++])"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function rb(a,b,c,d){var e={},f=a===mb;function g(h){var i;return e[h]=!0,n.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}return g(b.dataTypes[0])||!e["*"]&&g("*")}function sb(a,b){var c,d,e=n.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);return d&&n.extend(!0,a,d),a}function tb(a,b,c){var d,e,f,g,h=a.contents,i=a.dataTypes;while("*"===i[0])i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break}g||(g=e)}f=f||g}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function ub(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];f=k.shift();while(f)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}n.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ob,type:"GET",isLocal:hb.test(pb[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":nb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":n.parseJSON,"text xml":n.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?sb(sb(a,n.ajaxSettings),b):sb(n.ajaxSettings,a)},ajaxPrefilter:qb(lb),ajaxTransport:qb(mb),ajax:function(a,b){"object"==typeof a&&(b=a,a=void 0),b=b||{};var c,d,e,f,g,h,i,j,k=n.ajaxSetup({},b),l=k.context||k,m=k.context&&(l.nodeType||l.jquery)?n(l):n.event,o=n.Deferred(),p=n.Callbacks("once memory"),q=k.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!f){f={};while(b=gb.exec(e))f[b[1].toLowerCase()]=b[2]}b=f[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?e:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(k.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>t)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return c&&c.abort(b),x(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,k.url=((a||k.url||ob)+"").replace(eb,"").replace(jb,pb[1]+"//"),k.type=b.method||b.type||k.method||k.type,k.dataTypes=n.trim(k.dataType||"*").toLowerCase().match(E)||[""],null==k.crossDomain&&(h=kb.exec(k.url.toLowerCase()),k.crossDomain=!(!h||h[1]===pb[1]&&h[2]===pb[2]&&(h[3]||("http:"===h[1]?"80":"443"))===(pb[3]||("http:"===pb[1]?"80":"443")))),k.data&&k.processData&&"string"!=typeof k.data&&(k.data=n.param(k.data,k.traditional)),rb(lb,k,b,v),2===t)return v;i=n.event&&k.global,i&&0===n.active++&&n.event.trigger("ajaxStart"),k.type=k.type.toUpperCase(),k.hasContent=!ib.test(k.type),d=k.url,k.hasContent||(k.data&&(d=k.url+=(db.test(d)?"&":"?")+k.data,delete k.data),k.cache===!1&&(k.url=fb.test(d)?d.replace(fb,"$1_="+cb++):d+(db.test(d)?"&":"?")+"_="+cb++)),k.ifModified&&(n.lastModified[d]&&v.setRequestHeader("If-Modified-Since",n.lastModified[d]),n.etag[d]&&v.setRequestHeader("If-None-Match",n.etag[d])),(k.data&&k.hasContent&&k.contentType!==!1||b.contentType)&&v.setRequestHeader("Content-Type",k.contentType),v.setRequestHeader("Accept",k.dataTypes[0]&&k.accepts[k.dataTypes[0]]?k.accepts[k.dataTypes[0]]+("*"!==k.dataTypes[0]?", "+nb+"; q=0.01":""):k.accepts["*"]);for(j in k.headers)v.setRequestHeader(j,k.headers[j]);if(k.beforeSend&&(k.beforeSend.call(l,v,k)===!1||2===t))return v.abort();u="abort";for(j in{success:1,error:1,complete:1})v[j](k[j]);if(c=rb(mb,k,b,v)){v.readyState=1,i&&m.trigger("ajaxSend",[v,k]),k.async&&k.timeout>0&&(g=setTimeout(function(){v.abort("timeout")},k.timeout));try{t=1,c.send(r,x)}catch(w){if(!(2>t))throw w;x(-1,w)}}else x(-1,"No Transport");function x(a,b,f,h){var j,r,s,u,w,x=b;2!==t&&(t=2,g&&clearTimeout(g),c=void 0,e=h||"",v.readyState=a>0?4:0,j=a>=200&&300>a||304===a,f&&(u=tb(k,v,f)),u=ub(k,u,v,j),j?(k.ifModified&&(w=v.getResponseHeader("Last-Modified"),w&&(n.lastModified[d]=w),w=v.getResponseHeader("etag"),w&&(n.etag[d]=w)),204===a||"HEAD"===k.type?x="nocontent":304===a?x="notmodified":(x=u.state,r=u.data,s=u.error,j=!s)):(s=x,(a||!x)&&(x="error",0>a&&(a=0))),v.status=a,v.statusText=(b||x)+"",j?o.resolveWith(l,[r,x,v]):o.rejectWith(l,[v,x,s]),v.statusCode(q),q=void 0,i&&m.trigger(j?"ajaxSuccess":"ajaxError",[v,k,j?r:s]),p.fireWith(l,[v,x]),i&&(m.trigger("ajaxComplete",[v,k]),--n.active||n.event.trigger("ajaxStop")))}return v},getJSON:function(a,b,c){return n.get(a,b,c,"json")},getScript:function(a,b){return n.get(a,void 0,b,"script")}}),n.each(["get","post"],function(a,b){n[b]=function(a,c,d,e){return n.isFunction(c)&&(e=e||d,d=c,c=void 0),n.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),n._evalUrl=function(a){return n.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},n.fn.extend({wrapAll:function(a){var b;return n.isFunction(a)?this.each(function(b){n(this).wrapAll(a.call(this,b))}):(this[0]&&(b=n(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstElementChild)a=a.firstElementChild;return a}).append(this)),this)},wrapInner:function(a){return this.each(n.isFunction(a)?function(b){n(this).wrapInner(a.call(this,b))}:function(){var b=n(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=n.isFunction(a);return this.each(function(c){n(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){n.nodeName(this,"body")||n(this).replaceWith(this.childNodes)}).end()}}),n.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0},n.expr.filters.visible=function(a){return!n.expr.filters.hidden(a)};var vb=/%20/g,wb=/\[\]$/,xb=/\r?\n/g,yb=/^(?:submit|button|image|reset|file)$/i,zb=/^(?:input|select|textarea|keygen)/i;function Ab(a,b,c,d){var e;if(n.isArray(b))n.each(b,function(b,e){c||wb.test(a)?d(a,e):Ab(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==n.type(b))d(a,b);else for(e in b)Ab(a+"["+e+"]",b[e],c,d)}n.param=function(a,b){var c,d=[],e=function(a,b){b=n.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=n.ajaxSettings&&n.ajaxSettings.traditional),n.isArray(a)||a.jquery&&!n.isPlainObject(a))n.each(a,function(){e(this.name,this.value)});else for(c in a)Ab(c,a[c],b,e);return d.join("&").replace(vb,"+")},n.fn.extend({serialize:function(){return n.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=n.prop(this,"elements");return a?n.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!n(this).is(":disabled")&&zb.test(this.nodeName)&&!yb.test(a)&&(this.checked||!T.test(a))}).map(function(a,b){var c=n(this).val();return null==c?null:n.isArray(c)?n.map(c,function(a){return{name:b.name,value:a.replace(xb,"\r\n")}}):{name:b.name,value:c.replace(xb,"\r\n")}}).get()}}),n.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(a){}};var Bb=0,Cb={},Db={0:200,1223:204},Eb=n.ajaxSettings.xhr();a.attachEvent&&a.attachEvent("onunload",function(){for(var a in Cb)Cb[a]()}),k.cors=!!Eb&&"withCredentials"in Eb,k.ajax=Eb=!!Eb,n.ajaxTransport(function(a){var b;return k.cors||Eb&&!a.crossDomain?{send:function(c,d){var e,f=a.xhr(),g=++Bb;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)f.setRequestHeader(e,c[e]);b=function(a){return function(){b&&(delete Cb[g],b=f.onload=f.onerror=null,"abort"===a?f.abort():"error"===a?d(f.status,f.statusText):d(Db[f.status]||f.status,f.statusText,"string"==typeof f.responseText?{text:f.responseText}:void 0,f.getAllResponseHeaders()))}},f.onload=b(),f.onerror=b("error"),b=Cb[g]=b("abort");try{f.send(a.hasContent&&a.data||null)}catch(h){if(b)throw h}},abort:function(){b&&b()}}:void 0}),n.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return n.globalEval(a),a}}}),n.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),n.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(d,e){b=n("<script>").prop({async:!0,charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&e("error"===a.type?404:200,a.type)}),l.head.appendChild(b[0])},abort:function(){c&&c()}}}});var Fb=[],Gb=/(=)\?(?=&|$)|\?\?/;n.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Fb.pop()||n.expando+"_"+cb++;return this[a]=!0,a}}),n.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(Gb.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Gb.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=n.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Gb,"$1"+e):b.jsonp!==!1&&(b.url+=(db.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||n.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,Fb.push(e)),g&&n.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),n.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||l;var d=v.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=n.buildFragment([a],b,e),e&&e.length&&n(e).remove(),n.merge([],d.childNodes))};var Hb=n.fn.load;n.fn.load=function(a,b,c){if("string"!=typeof a&&Hb)return Hb.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=n.trim(a.slice(h)),a=a.slice(0,h)),n.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(e="POST"),g.length>0&&n.ajax({url:a,type:e,dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?n("<div>").append(n.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,f||[a.responseText,b,a])}),this},n.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){n.fn[b]=function(a){return this.on(b,a)}}),n.expr.filters.animated=function(a){return n.grep(n.timers,function(b){return a===b.elem}).length};var Ib=a.document.documentElement;function Jb(a){return n.isWindow(a)?a:9===a.nodeType&&a.defaultView}n.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=n.css(a,"position"),l=n(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=n.css(a,"top"),i=n.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),n.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},n.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){n.offset.setOffset(this,a,b)});var b,c,d=this[0],e={top:0,left:0},f=d&&d.ownerDocument;if(f)return b=f.documentElement,n.contains(b,d)?(typeof d.getBoundingClientRect!==U&&(e=d.getBoundingClientRect()),c=Jb(f),{top:e.top+c.pageYOffset-b.clientTop,left:e.left+c.pageXOffset-b.clientLeft}):e},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===n.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),n.nodeName(a[0],"html")||(d=a.offset()),d.top+=n.css(a[0],"borderTopWidth",!0),d.left+=n.css(a[0],"borderLeftWidth",!0)),{top:b.top-d.top-n.css(c,"marginTop",!0),left:b.left-d.left-n.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||Ib;while(a&&!n.nodeName(a,"html")&&"static"===n.css(a,"position"))a=a.offsetParent;return a||Ib})}}),n.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b,c){var d="pageYOffset"===c;n.fn[b]=function(e){return J(this,function(b,e,f){var g=Jb(b);return void 0===f?g?g[c]:b[e]:void(g?g.scrollTo(d?a.pageXOffset:f,d?f:a.pageYOffset):b[e]=f)},b,e,arguments.length,null)}}),n.each(["top","left"],function(a,b){n.cssHooks[b]=ya(k.pixelPosition,function(a,c){return c?(c=xa(a,b),va.test(c)?n(a).position()[b]+"px":c):void 0})}),n.each({Height:"height",Width:"width"},function(a,b){n.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){n.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(d===!0||e===!0?"margin":"border");return J(this,function(b,c,d){var e;return n.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?n.css(b,c,g):n.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),n.fn.size=function(){return this.length},n.fn.andSelf=n.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return n});var Kb=a.jQuery,Lb=a.$;return n.noConflict=function(b){return a.$===n&&(a.$=Lb),b&&a.jQuery===n&&(a.jQuery=Kb),n},typeof b===U&&(a.jQuery=a.$=n),n});
//# sourceMappingURL=jquery.min.map
/*! jQuery UI - v1.11.4 - 2015-05-23
* http://jqueryui.com
* Includes: core.js, widget.js, mouse.js, draggable.js
* Copyright 2015 jQuery Foundation and other contributors; Licensed MIT */

(function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)})(function(e){function t(t,s){var n,a,o,r=t.nodeName.toLowerCase();return"area"===r?(n=t.parentNode,a=n.name,t.href&&a&&"map"===n.nodeName.toLowerCase()?(o=e("img[usemap='#"+a+"']")[0],!!o&&i(o)):!1):(/^(input|select|textarea|button|object)$/.test(r)?!t.disabled:"a"===r?t.href||s:s)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}e.ui=e.ui||{},e.extend(e.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({scrollParent:function(t){var i=this.css("position"),s="absolute"===i,n=t?/(auto|scroll|hidden)/:/(auto|scroll)/,a=this.parents().filter(function(){var t=e(this);return s&&"static"===t.css("position")?!1:n.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==i&&a.length?a:e(this[0].ownerDocument||document)},uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,s){return!!e.data(t,s[3])},focusable:function(i){return t(i,!isNaN(e.attr(i,"tabindex")))},tabbable:function(i){var s=e.attr(i,"tabindex"),n=isNaN(s);return(n||s>=0)&&t(i,!n)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(t,i){function s(t,i,s,a){return e.each(n,function(){i-=parseFloat(e.css(t,"padding"+this))||0,s&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),a&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var n="Width"===i?["Left","Right"]:["Top","Bottom"],a=i.toLowerCase(),o={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(t){return void 0===t?o["inner"+i].call(this):this.each(function(){e(this).css(a,s(this,t)+"px")})},e.fn["outer"+i]=function(t,n){return"number"!=typeof t?o["outer"+i].call(this,t):this.each(function(){e(this).css(a,s(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.fn.extend({focus:function(t){return function(i,s){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),s&&s.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var i,s,n=e(this[0]);n.length&&n[0]!==document;){if(i=n.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(s=parseInt(n.css("zIndex"),10),!isNaN(s)&&0!==s))return s;n=n.parent()}return 0}}),e.ui.plugin={add:function(t,i,s){var n,a=e.ui[t].prototype;for(n in s)a.plugins[n]=a.plugins[n]||[],a.plugins[n].push([i,s[n]])},call:function(e,t,i,s){var n,a=e.plugins[t];if(a&&(s||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(n=0;a.length>n;n++)e.options[a[n][0]]&&a[n][1].apply(e.element,i)}};var s=0,n=Array.prototype.slice;e.cleanData=function(t){return function(i){var s,n,a;for(a=0;null!=(n=i[a]);a++)try{s=e._data(n,"events"),s&&s.remove&&e(n).triggerHandler("remove")}catch(o){}t(i)}}(e.cleanData),e.widget=function(t,i,s){var n,a,o,r,h={},l=t.split(".")[0];return t=t.split(".")[1],n=l+"-"+t,s||(s=i,i=e.Widget),e.expr[":"][n.toLowerCase()]=function(t){return!!e.data(t,n)},e[l]=e[l]||{},a=e[l][t],o=e[l][t]=function(e,t){return this._createWidget?(arguments.length&&this._createWidget(e,t),void 0):new o(e,t)},e.extend(o,a,{version:s.version,_proto:e.extend({},s),_childConstructors:[]}),r=new i,r.options=e.widget.extend({},r.options),e.each(s,function(t,s){return e.isFunction(s)?(h[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},n=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,a=this._superApply;return this._super=e,this._superApply=n,t=s.apply(this,arguments),this._super=i,this._superApply=a,t}}(),void 0):(h[t]=s,void 0)}),o.prototype=e.widget.extend(r,{widgetEventPrefix:a?r.widgetEventPrefix||t:t},h,{constructor:o,namespace:l,widgetName:t,widgetFullName:n}),a?(e.each(a._childConstructors,function(t,i){var s=i.prototype;e.widget(s.namespace+"."+s.widgetName,o,i._proto)}),delete a._childConstructors):i._childConstructors.push(o),e.widget.bridge(t,o),o},e.widget.extend=function(t){for(var i,s,a=n.call(arguments,1),o=0,r=a.length;r>o;o++)for(i in a[o])s=a[o][i],a[o].hasOwnProperty(i)&&void 0!==s&&(t[i]=e.isPlainObject(s)?e.isPlainObject(t[i])?e.widget.extend({},t[i],s):e.widget.extend({},s):s);return t},e.widget.bridge=function(t,i){var s=i.prototype.widgetFullName||t;e.fn[t]=function(a){var o="string"==typeof a,r=n.call(arguments,1),h=this;return o?this.each(function(){var i,n=e.data(this,s);return"instance"===a?(h=n,!1):n?e.isFunction(n[a])&&"_"!==a.charAt(0)?(i=n[a].apply(n,r),i!==n&&void 0!==i?(h=i&&i.jquery?h.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+a+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; "+"attempted to call method '"+a+"'")}):(r.length&&(a=e.widget.extend.apply(null,[a].concat(r))),this.each(function(){var t=e.data(this,s);t?(t.option(a||{}),t._init&&t._init()):e.data(this,s,new i(a,this))})),h}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=s++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,i){var s,n,a,o=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(o={},s=t.split("."),t=s.shift(),s.length){for(n=o[t]=e.widget.extend({},this.options[t]),a=0;s.length-1>a;a++)n[s[a]]=n[s[a]]||{},n=n[s[a]];if(t=s.pop(),1===arguments.length)return void 0===n[t]?null:n[t];n[t]=i}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];o[t]=i}return this._setOptions(o),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,i,s){var n,a=this;"boolean"!=typeof t&&(s=i,i=t,t=!1),s?(i=n=e(i),this.bindings=this.bindings.add(i)):(s=i,i=this.element,n=this.widget()),e.each(s,function(s,o){function r(){return t||a.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof o?a[o]:o).apply(a,arguments):void 0}"string"!=typeof o&&(r.guid=o.guid=o.guid||r.guid||e.guid++);var h=s.match(/^([\w:-]*)\s*(.*)$/),l=h[1]+a.eventNamespace,u=h[2];u?n.delegate(u,l,r):i.bind(l,r)})},_off:function(t,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(i).undelegate(i),this.bindings=e(this.bindings.not(t).get()),this.focusable=e(this.focusable.not(t).get()),this.hoverable=e(this.hoverable.not(t).get())},_delay:function(e,t){function i(){return("string"==typeof e?s[e]:e).apply(s,arguments)}var s=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,s){var n,a,o=this.options[t];if(s=s||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],a=i.originalEvent)for(n in a)n in i||(i[n]=a[n]);return this.element.trigger(i,s),!(e.isFunction(o)&&o.apply(this.element[0],[i].concat(s))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(s,n,a){"string"==typeof n&&(n={effect:n});var o,r=n?n===!0||"number"==typeof n?i:n.effect||i:t;n=n||{},"number"==typeof n&&(n={duration:n}),o=!e.isEmptyObject(n),n.complete=a,n.delay&&s.delay(n.delay),o&&e.effects&&e.effects.effect[r]?s[t](n):r!==t&&s[r]?s[r](n.duration,n.easing,a):s.queue(function(i){e(this)[t](),a&&a.call(s[0]),i()})}}),e.widget;var a=!1;e(document).mouseup(function(){a=!1}),e.widget("ui.mouse",{version:"1.11.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){return!0===e.data(i.target,t.widgetName+".preventClickEvent")?(e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!a){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var i=this,s=1===t.which,n="string"==typeof this.options.cancel&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;return s&&!n&&this._mouseCapture(t)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(t)!==!1,!this._mouseStarted)?(t.preventDefault(),!0):(!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),a=!0,!0)):!0}},_mouseMove:function(t){if(this._mouseMoved){if(e.ui.ie&&(!document.documentMode||9>document.documentMode)&&!t.button)return this._mouseUp(t);if(!t.which)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),a=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),e.widget("ui.draggable",e.ui.mouse,{version:"1.11.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?(this.destroyOnClear=!0,void 0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),this._mouseDestroy(),void 0)},_mouseCapture:function(t){var i=this.options;return this._blurActiveElement(t),this.helper||i.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(this._blockFrames(i.iframeFix===!0?"iframe":i.iframeFix),!0):!1)},_blockFrames:function(t){this.iframeBlocks=this.document.find(t).map(function(){var t=e(this);return e("<div>").css("position","absolute").appendTo(t.parent()).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(t){var i=this.document[0];if(this.handleElement.is(t.target))try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()&&e(i.activeElement).blur()}catch(s){}},_mouseStart:function(t){var i=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===e(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(t),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._normalizeRightBottom(),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_refreshOffsets:function(e){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:e.pageX-this.offset.left,top:e.pageY-this.offset.top}},_mouseDrag:function(t,i){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var s=this._uiHash();if(this._trigger("drag",t,s)===!1)return this._mouseUp({}),!1;this.position=s.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var i=this,s=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(s=e.ui.ddmanager.drop(this,t)),this.dropped&&(s=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!s||"valid"===this.options.revert&&s||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,s)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",t)!==!1&&i._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1},_mouseUp:function(t){return this._unblockFrames(),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),this.handleElement.is(t.target)&&this.element.focus(),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(t){var i=this.options,s=e.isFunction(i.helper),n=s?e(i.helper.apply(this.element[0],[t])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),s&&n[0]===this.element[0]&&this._setPositionRelative(),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,s,n=this.options,a=this.document[0];return this.relativeContainer=null,n.containment?"window"===n.containment?(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):"document"===n.containment?(this.containment=[0,0,e(a).width()-this.helperProportions.width-this.margins.left,(e(a).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):n.containment.constructor===Array?(this.containment=n.containment,void 0):("parent"===n.containment&&(n.containment=this.helper[0].parentNode),i=e(n.containment),s=i[0],s&&(t=/(scroll|auto)/.test(i.css("overflow")),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(t?Math.max(s.scrollWidth,s.offsetWidth):s.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(s.scrollHeight,s.offsetHeight):s.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i),void 0):(this.containment=null,void 0)},_convertPositionTo:function(e,t){t||(t=this.position);var i="absolute"===e?1:-1,s=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top)*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)*i}},_generatePosition:function(e,t){var i,s,n,a,o=this.options,r=this._isRootNode(this.scrollParent[0]),h=e.pageX,l=e.pageY;return r&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relativeContainer?(s=this.relativeContainer.offset(),i=[this.containment[0]+s.left,this.containment[1]+s.top,this.containment[2]+s.left,this.containment[3]+s.top]):i=this.containment,e.pageX-this.offset.click.left<i[0]&&(h=i[0]+this.offset.click.left),e.pageY-this.offset.click.top<i[1]&&(l=i[1]+this.offset.click.top),e.pageX-this.offset.click.left>i[2]&&(h=i[2]+this.offset.click.left),e.pageY-this.offset.click.top>i[3]&&(l=i[3]+this.offset.click.top)),o.grid&&(n=o.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,l=i?n-this.offset.click.top>=i[1]||n-this.offset.click.top>i[3]?n:n-this.offset.click.top>=i[1]?n-o.grid[1]:n+o.grid[1]:n,a=o.grid[0]?this.originalPageX+Math.round((h-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,h=i?a-this.offset.click.left>=i[0]||a-this.offset.click.left>i[2]?a:a-this.offset.click.left>=i[0]?a-o.grid[0]:a+o.grid[0]:a),"y"===o.axis&&(h=this.originalPageX),"x"===o.axis&&(l=this.originalPageY)),{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top),left:h-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(t,i,s){return s=s||this._uiHash(),e.ui.plugin.call(this,t,[i,s,this],!0),/^(drag|start|stop)/.test(t)&&(this.positionAbs=this._convertPositionTo("absolute"),s.offset=this.positionAbs),e.Widget.prototype._trigger.call(this,t,i,s)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,i,s){var n=e.extend({},i,{item:s.element});s.sortables=[],e(s.options.connectToSortable).each(function(){var i=e(this).sortable("instance");i&&!i.options.disabled&&(s.sortables.push(i),i.refreshPositions(),i._trigger("activate",t,n))})},stop:function(t,i,s){var n=e.extend({},i,{item:s.element});s.cancelHelperRemoval=!1,e.each(s.sortables,function(){var e=this;e.isOver?(e.isOver=0,s.cancelHelperRemoval=!0,e.cancelHelperRemoval=!1,e._storedCSS={position:e.placeholder.css("position"),top:e.placeholder.css("top"),left:e.placeholder.css("left")},e._mouseStop(t),e.options.helper=e.options._helper):(e.cancelHelperRemoval=!0,e._trigger("deactivate",t,n))})},drag:function(t,i,s){e.each(s.sortables,function(){var n=!1,a=this;a.positionAbs=s.positionAbs,a.helperProportions=s.helperProportions,a.offset.click=s.offset.click,a._intersectsWith(a.containerCache)&&(n=!0,e.each(s.sortables,function(){return this.positionAbs=s.positionAbs,this.helperProportions=s.helperProportions,this.offset.click=s.offset.click,this!==a&&this._intersectsWith(this.containerCache)&&e.contains(a.element[0],this.element[0])&&(n=!1),n})),n?(a.isOver||(a.isOver=1,s._parent=i.helper.parent(),a.currentItem=i.helper.appendTo(a.element).data("ui-sortable-item",!0),a.options._helper=a.options.helper,a.options.helper=function(){return i.helper[0]},t.target=a.currentItem[0],a._mouseCapture(t,!0),a._mouseStart(t,!0,!0),a.offset.click.top=s.offset.click.top,a.offset.click.left=s.offset.click.left,a.offset.parent.left-=s.offset.parent.left-a.offset.parent.left,a.offset.parent.top-=s.offset.parent.top-a.offset.parent.top,s._trigger("toSortable",t),s.dropped=a.element,e.each(s.sortables,function(){this.refreshPositions()}),s.currentItem=s.element,a.fromOutside=s),a.currentItem&&(a._mouseDrag(t),i.position=a.position)):a.isOver&&(a.isOver=0,a.cancelHelperRemoval=!0,a.options._revert=a.options.revert,a.options.revert=!1,a._trigger("out",t,a._uiHash(a)),a._mouseStop(t,!0),a.options.revert=a.options._revert,a.options.helper=a.options._helper,a.placeholder&&a.placeholder.remove(),i.helper.appendTo(s._parent),s._refreshOffsets(t),i.position=s._generatePosition(t,!0),s._trigger("fromSortable",t),s.dropped=!1,e.each(s.sortables,function(){this.refreshPositions()}))})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,i,s){var n=e("body"),a=s.options;n.css("cursor")&&(a._cursor=n.css("cursor")),n.css("cursor",a.cursor)},stop:function(t,i,s){var n=s.options;n._cursor&&e("body").css("cursor",n._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,i,s){var n=e(i.helper),a=s.options;n.css("opacity")&&(a._opacity=n.css("opacity")),n.css("opacity",a.opacity)},stop:function(t,i,s){var n=s.options;n._opacity&&e(i.helper).css("opacity",n._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(e,t,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(t,i,s){var n=s.options,a=!1,o=s.scrollParentNotHidden[0],r=s.document[0];o!==r&&"HTML"!==o.tagName?(n.axis&&"x"===n.axis||(s.overflowOffset.top+o.offsetHeight-t.pageY<n.scrollSensitivity?o.scrollTop=a=o.scrollTop+n.scrollSpeed:t.pageY-s.overflowOffset.top<n.scrollSensitivity&&(o.scrollTop=a=o.scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(s.overflowOffset.left+o.offsetWidth-t.pageX<n.scrollSensitivity?o.scrollLeft=a=o.scrollLeft+n.scrollSpeed:t.pageX-s.overflowOffset.left<n.scrollSensitivity&&(o.scrollLeft=a=o.scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(t.pageY-e(r).scrollTop()<n.scrollSensitivity?a=e(r).scrollTop(e(r).scrollTop()-n.scrollSpeed):e(window).height()-(t.pageY-e(r).scrollTop())<n.scrollSensitivity&&(a=e(r).scrollTop(e(r).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(t.pageX-e(r).scrollLeft()<n.scrollSensitivity?a=e(r).scrollLeft(e(r).scrollLeft()-n.scrollSpeed):e(window).width()-(t.pageX-e(r).scrollLeft())<n.scrollSensitivity&&(a=e(r).scrollLeft(e(r).scrollLeft()+n.scrollSpeed)))),a!==!1&&e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(s,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,i,s){var n=s.options;s.snapElements=[],e(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var t=e(this),i=t.offset();this!==s.element[0]&&s.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:i.top,left:i.left})})},drag:function(t,i,s){var n,a,o,r,h,l,u,d,c,p,f=s.options,m=f.snapTolerance,g=i.offset.left,v=g+s.helperProportions.width,y=i.offset.top,b=y+s.helperProportions.height;for(c=s.snapElements.length-1;c>=0;c--)h=s.snapElements[c].left-s.margins.left,l=h+s.snapElements[c].width,u=s.snapElements[c].top-s.margins.top,d=u+s.snapElements[c].height,h-m>v||g>l+m||u-m>b||y>d+m||!e.contains(s.snapElements[c].item.ownerDocument,s.snapElements[c].item)?(s.snapElements[c].snapping&&s.options.snap.release&&s.options.snap.release.call(s.element,t,e.extend(s._uiHash(),{snapItem:s.snapElements[c].item})),s.snapElements[c].snapping=!1):("inner"!==f.snapMode&&(n=m>=Math.abs(u-b),a=m>=Math.abs(d-y),o=m>=Math.abs(h-v),r=m>=Math.abs(l-g),n&&(i.position.top=s._convertPositionTo("relative",{top:u-s.helperProportions.height,left:0}).top),a&&(i.position.top=s._convertPositionTo("relative",{top:d,left:0}).top),o&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h-s.helperProportions.width}).left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l}).left)),p=n||a||o||r,"outer"!==f.snapMode&&(n=m>=Math.abs(u-y),a=m>=Math.abs(d-b),o=m>=Math.abs(h-g),r=m>=Math.abs(l-v),n&&(i.position.top=s._convertPositionTo("relative",{top:u,left:0}).top),a&&(i.position.top=s._convertPositionTo("relative",{top:d-s.helperProportions.height,left:0}).top),o&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h}).left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l-s.helperProportions.width}).left)),!s.snapElements[c].snapping&&(n||a||o||r||p)&&s.options.snap.snap&&s.options.snap.snap.call(s.element,t,e.extend(s._uiHash(),{snapItem:s.snapElements[c].item})),s.snapElements[c].snapping=n||a||o||r||p)}}),e.ui.plugin.add("draggable","stack",{start:function(t,i,s){var n,a=s.options,o=e.makeArray(e(a.stack)).sort(function(t,i){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(i).css("zIndex"),10)||0)});o.length&&(n=parseInt(e(o[0]).css("zIndex"),10)||0,e(o).each(function(t){e(this).css("zIndex",n+t)}),this.css("zIndex",n+o.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,i,s){var n=e(i.helper),a=s.options;n.css("zIndex")&&(a._zIndex=n.css("zIndex")),n.css("zIndex",a.zIndex)},stop:function(t,i,s){var n=s.options;n._zIndex&&e(i.helper).css("zIndex",n._zIndex)}}),e.ui.draggable});
!function(){var e,t,r,n,i,a=this;!function(){function a(){}function s(e,t){if("."!==e.charAt(0))return e;for(var r=e.split("/"),n=t.split("/").slice(0,-1),i=0,a=r.length;a>i;i++){var s=r[i];if(".."===s)n.pop();else{if("."===s)continue;n.push(s)}}return n.join("/")}if(i=this.Ember=this.Ember||{},"undefined"==typeof i&&(i={}),"undefined"==typeof i.__loader){var o={},u={};e=function(e,t,r){var n={};r?(n.deps=t,n.callback=r):(n.deps=[],n.callback=t),o[e]=n},n=r=t=function(e){var r=u[e];if(void 0!==r)return u[e];if(r===a)return void 0;if(u[e]={},!o[e])throw new Error("Could not find module "+e);for(var n,i=o[e],l=i.deps,c=i.callback,h=[],m=l.length,d=0;m>d;d++)h.push("exports"===l[d]?n={}:t(s(l[d],e)));var f=0===m?c.call(this):c.apply(this,h);return u[e]=n||(void 0===f?a:f)},n._eak_seen=o,i.__loader={define:e,require:r,registry:o}}else e=i.__loader.define,n=r=t=i.__loader.require}(),e("backburner",["backburner/utils","backburner/platform","backburner/binary-search","backburner/deferred-action-queues","exports"],function(e,t,r,n,i){"use strict";function a(e,t){this.queueNames=e,this.options=t||{},this.options.defaultQueue||(this.options.defaultQueue=e[0]),this.instanceStack=[],this._debouncees=[],this._throttlers=[],this._timers=[]}function s(e){return e.onError||e.onErrorTarget&&e.onErrorTarget[e.onErrorMethod]}function o(e){e.begin(),e._autorun=O.setTimeout(function(){e._autorun=null,e.end()})}function u(e,t,r){var n=y();(!e._laterTimer||t<e._laterTimerExpiresAt||e._laterTimerExpiresAt<n)&&(e._laterTimer&&(clearTimeout(e._laterTimer),e._laterTimerExpiresAt<n&&(r=Math.max(0,t-n))),e._laterTimer=O.setTimeout(function(){e._laterTimer=null,e._laterTimerExpiresAt=null,l(e)},r),e._laterTimerExpiresAt=n+r)}function l(e){var t,r,n,i=y();e.run(function(){for(r=w(i,e._timers),t=e._timers.splice(0,r),r=1,n=t.length;n>r;r+=2)e.schedule(e.options.defaultQueue,null,t[r])}),e._timers.length&&u(e,e._timers[0],e._timers[0]-i)}function c(e,t,r){return m(e,t,r)}function h(e,t,r){return m(e,t,r)}function m(e,t,r){for(var n,i=-1,a=0,s=r.length;s>a;a++)if(n=r[a],n[0]===e&&n[1]===t){i=a;break}return i}var d=e.each,f=e.isString,p=e.isFunction,v=e.isNumber,g=e.isCoercableNumber,b=e.wrapInTryCatch,y=e.now,_=t.needsIETryCatchFix,w=r["default"],x=n["default"],C=[].slice,E=[].pop,O=this;if(a.prototype={begin:function(){var e=this.options,t=e&&e.onBegin,r=this.currentInstance;r&&this.instanceStack.push(r),this.currentInstance=new x(this.queueNames,e),t&&t(this.currentInstance,r)},end:function(){var e=this.options,t=e&&e.onEnd,r=this.currentInstance,n=null,i=!1;try{r.flush()}finally{i||(i=!0,this.currentInstance=null,this.instanceStack.length&&(n=this.instanceStack.pop(),this.currentInstance=n),t&&t(r,n))}},run:function(e,t){var r=s(this.options);this.begin(),t||(t=e,e=null),f(t)&&(t=e[t]);var n=C.call(arguments,2),i=!1;if(r)try{return t.apply(e,n)}catch(a){r(a)}finally{i||(i=!0,this.end())}else try{return t.apply(e,n)}finally{i||(i=!0,this.end())}},join:function(e,t){return this.currentInstance?(t||(t=e,e=null),f(t)&&(t=e[t]),t.apply(e,C.call(arguments,2))):this.run.apply(this,arguments)},defer:function(e,t,r){r||(r=t,t=null),f(r)&&(r=t[r]);var n,i=this.DEBUG?new Error:void 0,a=arguments.length;if(a>3){n=new Array(a-3);for(var s=3;a>s;s++)n[s-3]=arguments[s]}else n=void 0;return this.currentInstance||o(this),this.currentInstance.schedule(e,t,r,n,!1,i)},deferOnce:function(e,t,r){r||(r=t,t=null),f(r)&&(r=t[r]);var n,i=this.DEBUG?new Error:void 0,a=arguments.length;if(a>3){n=new Array(a-3);for(var s=3;a>s;s++)n[s-3]=arguments[s]}else n=void 0;return this.currentInstance||o(this),this.currentInstance.schedule(e,t,r,n,!0,i)},setTimeout:function(){function e(){if(b)try{i.apply(o,r)}catch(e){b(e)}else i.apply(o,r)}for(var t=arguments.length,r=new Array(t),n=0;t>n;n++)r[n]=arguments[n];var i,a,o,l,c,h,m=r.length;if(0!==m){if(1===m)i=r.shift(),a=0;else if(2===m)l=r[0],c=r[1],p(c)||p(l[c])?(o=r.shift(),i=r.shift(),a=0):g(c)?(i=r.shift(),a=r.shift()):(i=r.shift(),a=0);else{var d=r[r.length-1];a=g(d)?r.pop():0,l=r[0],h=r[1],p(h)||f(h)&&null!==l&&h in l?(o=r.shift(),i=r.shift()):i=r.shift()}var v=y()+parseInt(a,10);f(i)&&(i=o[i]);var b=s(this.options),_=w(v,this._timers);return this._timers.splice(_,0,v,e),u(this,v,a),e}},throttle:function(e,t){var r,n,i,a,s=this,o=arguments,u=E.call(o);return v(u)||f(u)?(r=u,u=!0):r=E.call(o),r=parseInt(r,10),i=h(e,t,this._throttlers),i>-1?this._throttlers[i]:(a=O.setTimeout(function(){u||s.run.apply(s,o);var r=h(e,t,s._throttlers);r>-1&&s._throttlers.splice(r,1)},r),u&&this.run.apply(this,o),n=[e,t,a],this._throttlers.push(n),n)},debounce:function(e,t){var r,n,i,a,s=this,o=arguments,u=E.call(o);return v(u)||f(u)?(r=u,u=!1):r=E.call(o),r=parseInt(r,10),n=c(e,t,this._debouncees),n>-1&&(i=this._debouncees[n],this._debouncees.splice(n,1),clearTimeout(i[2])),a=O.setTimeout(function(){u||s.run.apply(s,o);var r=c(e,t,s._debouncees);r>-1&&s._debouncees.splice(r,1)},r),u&&-1===n&&s.run.apply(s,o),i=[e,t,a],s._debouncees.push(i),i},cancelTimers:function(){var e=function(e){clearTimeout(e[2])};d(this._throttlers,e),this._throttlers=[],d(this._debouncees,e),this._debouncees=[],this._laterTimer&&(clearTimeout(this._laterTimer),this._laterTimer=null),this._timers=[],this._autorun&&(clearTimeout(this._autorun),this._autorun=null)},hasTimers:function(){return!!this._timers.length||!!this._debouncees.length||!!this._throttlers.length||this._autorun},cancel:function(e){var t=typeof e;if(e&&"object"===t&&e.queue&&e.method)return e.queue.cancel(e);if("function"!==t)return"[object Array]"===Object.prototype.toString.call(e)?this._cancelItem(h,this._throttlers,e)||this._cancelItem(c,this._debouncees,e):void 0;for(var r=0,n=this._timers.length;n>r;r+=2)if(this._timers[r+1]===e)return this._timers.splice(r,2),0===r&&(this._laterTimer&&(clearTimeout(this._laterTimer),this._laterTimer=null),this._timers.length>0&&u(this,this._timers[0],this._timers[0]-y())),!0},_cancelItem:function(e,t,r){var n,i;return r.length<3?!1:(i=e(r[0],r[1],t),i>-1&&(n=t[i],n[2]===r[2])?(t.splice(i,1),clearTimeout(r[2]),!0):!1)}},a.prototype.schedule=a.prototype.defer,a.prototype.scheduleOnce=a.prototype.deferOnce,a.prototype.later=a.prototype.setTimeout,_){var P=a.prototype.run;a.prototype.run=b(P);var S=a.prototype.end;a.prototype.end=b(S)}i["default"]=a}),e("backburner.umd",["./backburner"],function(t){"use strict";var r=t["default"];"function"==typeof e&&e.amd?e(function(){return r}):"undefined"!=typeof module&&module.exports?module.exports=r:"undefined"!=typeof this&&(this.Backburner=r)}),e("backburner/binary-search",["exports"],function(e){"use strict";e["default"]=function(e,t){for(var r,n,i=0,a=t.length-2;a>i;)n=(a-i)/2,r=i+n-n%2,e>=t[r]?i=r+2:a=r;return e>=t[i]?i+2:i}}),e("backburner/deferred-action-queues",["./utils","./queue","exports"],function(e,t,r){"use strict";function n(e,t){var r=this.queues=Object.create(null);this.queueNames=e=e||[],this.options=t,a(e,function(e){r[e]=new s(e,t[e],t)})}function i(e){throw new Error("You attempted to schedule an action in a queue ("+e+") that doesn't exist")}var a=e.each,s=t["default"];n.prototype={schedule:function(e,t,r,n,a,s){var o=this.queues,u=o[e];return u||i(e),a?u.pushUnique(t,r,n,s):u.push(t,r,n,s)},flush:function(){var e,t,r=this.queues,n=this.queueNames,i=0,a=n.length;for(this.options;a>i;){e=n[i],t=r[e];var s=t._queue.length;0===s?i++:(t.flush(!1),i=0)}}},r["default"]=n}),e("backburner/platform",["exports"],function(e){"use strict";var t=function(e,t){try{t()}catch(e){}return!!e}();e.needsIETryCatchFix=t}),e("backburner/queue",["./utils","exports"],function(e,t){"use strict";function r(e,t,r){this.name=e,this.globalOptions=r||{},this.options=t,this._queue=[],this.targetQueues=Object.create(null),this._queueBeingFlushed=void 0}var n=e.isString;r.prototype={push:function(e,t,r,n){var i=this._queue;return i.push(e,t,r,n),{queue:this,target:e,method:t}},pushUniqueWithoutGuid:function(e,t,r,n){for(var i=this._queue,a=0,s=i.length;s>a;a+=4){var o=i[a],u=i[a+1];if(o===e&&u===t)return i[a+2]=r,void(i[a+3]=n)}i.push(e,t,r,n)},targetQueue:function(e,t,r,n,i){for(var a=this._queue,s=0,o=e.length;o>s;s+=4){var u=e[s],l=e[s+1];if(u===r)return a[l+2]=n,void(a[l+3]=i)}e.push(r,a.push(t,r,n,i)-4)},pushUniqueWithGuid:function(e,t,r,n,i){var a=this.targetQueues[e];return a?this.targetQueue(a,t,r,n,i):this.targetQueues[e]=[r,this._queue.push(t,r,n,i)-4],{queue:this,target:t,method:r}},pushUnique:function(e,t,r,n){var i=(this._queue,this.globalOptions.GUID_KEY);if(e&&i){var a=e[i];if(a)return this.pushUniqueWithGuid(a,e,t,r,n)}return this.pushUniqueWithoutGuid(e,t,r,n),{queue:this,target:e,method:t}},invoke:function(e,t,r,n,i){r&&r.length>0?t.apply(e,r):t.call(e)},invokeWithOnError:function(e,t,r,n,i){try{r&&r.length>0?t.apply(e,r):t.call(e)}catch(a){n(a,i)}},flush:function(e){var t=this._queue,r=t.length;if(0!==r){var i,a,s,o,u=this.globalOptions,l=this.options,c=l&&l.before,h=l&&l.after,m=u.onError||u.onErrorTarget&&u.onErrorTarget[u.onErrorMethod],d=m?this.invokeWithOnError:this.invoke;this.targetQueues=Object.create(null);var f=this._queueBeingFlushed=this._queue.slice();this._queue=[],c&&c();for(var p=0;r>p;p+=4)i=f[p],a=f[p+1],s=f[p+2],o=f[p+3],n(a)&&(a=i[a]),a&&d(i,a,s,m,o);h&&h(),this._queueBeingFlushed=void 0,e!==!1&&this._queue.length>0&&this.flush(!0)}},cancel:function(e){var t,r,n,i,a=this._queue,s=e.target,o=e.method,u=this.globalOptions.GUID_KEY;if(u&&this.targetQueues&&s){var l=this.targetQueues[s[u]];if(l)for(n=0,i=l.length;i>n;n++)l[n]===o&&l.splice(n,1)}for(n=0,i=a.length;i>n;n+=4)if(t=a[n],r=a[n+1],t===s&&r===o)return a.splice(n,4),!0;if(a=this._queueBeingFlushed)for(n=0,i=a.length;i>n;n+=4)if(t=a[n],r=a[n+1],t===s&&r===o)return a[n+1]=null,!0}},t["default"]=r}),e("backburner/utils",["exports"],function(e){"use strict";function t(e,t){for(var r=0;r<e.length;r++)t(e[r])}function r(e){return"string"==typeof e}function n(e){return"function"==typeof e}function i(e){return"number"==typeof e}function a(e){return i(e)||o.test(e)}function s(e){return function(){try{return e.apply(this,arguments)}catch(t){throw t}}}var o=/\d+/;e.each=t;var u=Date.now||function(){return(new Date).getTime()};e.now=u,e.isString=r,e.isFunction=n,e.isNumber=i,e.isCoercableNumber=a,e.wrapInTryCatch=s}),e("calculateVersion",[],function(){"use strict";var e=r("fs"),t=r("path");module.exports=function(){var n=r("../package.json").version,i=[n],a=t.join(__dirname,"..",".git"),s=t.join(a,"HEAD");if(n.indexOf("+")>-1){try{if(e.existsSync(s)){var o,u=e.readFileSync(s,{encoding:"utf8"}),l=u.split("/").slice(-1)[0].trim(),c=u.split(" ")[1];if(c){var h=t.join(a,c.trim());o=e.readFileSync(h)}else o=l;i.push(o.slice(0,10))}}catch(m){console.error(m.stack)}return i.join(".")}return n}}),e("container",["exports","container/registry","container/container"],function(e,t,r){"use strict";i.MODEL_FACTORY_INJECTIONS=!1,i.ENV&&"undefined"!=typeof i.ENV.MODEL_FACTORY_INJECTIONS&&(i.MODEL_FACTORY_INJECTIONS=!!i.ENV.MODEL_FACTORY_INJECTIONS),e.Registry=t["default"],e.Container=r["default"]}),e("container/container",["exports","ember-metal/core","ember-metal/keys","ember-metal/dictionary"],function(e,r,n,i){"use strict";function a(e,r){this._registry=e||function(){return p||(p=t("container/registry")["default"]),new p}(),this.cache=i["default"](r&&r.cache?r.cache:null),this.factoryCache=i["default"](r&&r.factoryCache?r.factoryCache:null),this.validationCache=i["default"](r&&r.validationCache?r.validationCache:null)}function s(e,t,r){if(r=r||{},e.cache[t]&&r.singleton!==!1)return e.cache[t];var n=h(e,t);return void 0!==n?(e._registry.getOption(t,"singleton")!==!1&&r.singleton!==!1&&(e.cache[t]=n),n):void 0}function o(e){var t={};if(arguments.length>1){for(var r,n=Array.prototype.slice.call(arguments,1),i=[],a=0,o=n.length;o>a;a++)n[a]&&(i=i.concat(n[a]));for(e._registry.validateInjections(i),a=0,o=i.length;o>a;a++)r=i[a],t[r.property]=s(e,r.fullName)}return t}function u(e,t){var n=e.factoryCache;if(n[t])return n[t];var i=e._registry,a=i.resolve(t);if(void 0!==a){var s=t.split(":")[0];if(!a||"function"!=typeof a.extend||!r["default"].MODEL_FACTORY_INJECTIONS&&"model"===s)return a&&"function"==typeof a._onLookup&&a._onLookup(t),n[t]=a,a;var o=l(e,t),u=c(e,t);u._toString=i.makeToString(a,t);var h=a.extend(o);return h.reopenClass(u),a&&"function"==typeof a._onLookup&&a._onLookup(t),n[t]=h,h}}function l(e,t){var r=e._registry,n=t.split(":"),i=n[0],a=o(e,r.getTypeInjections(i),r.getInjections(t));return a._debugContainerKey=t,a.container=e,a}function c(e,t){var r=e._registry,n=t.split(":"),i=n[0],a=o(e,r.getFactoryTypeInjections(i),r.getFactoryInjections(t));return a._debugContainerKey=t,a}function h(e,t){var r,n,i=u(e,t);if(e._registry.getOption(t,"instantiate")===!1)return i;if(i){if("function"!=typeof i.create)throw new Error("Failed to create an instance of '"+t+"'. Most likely an improperly defined class or an invalid module export.");return n=e.validationCache,n[t]||"function"!=typeof i._lazyInjections||(r=i._lazyInjections(),r=e._registry.normalizeInjectionsHash(r),e._registry.validateInjections(r)),n[t]=!0,"function"==typeof i.extend?i.create():i.create(l(e,t))}}function m(e,t){for(var r,i,a=e.cache,s=n["default"](a),o=0,u=s.length;u>o;o++)r=s[o],i=a[r],e._registry.getOption(r,"instantiate")!==!1&&t(i)}function d(e){m(e,function(e){e.destroy&&e.destroy()}),e.cache.dict=i["default"](null)}function f(e,t){var r=e.cache[t];delete e.factoryCache[t],r&&(delete e.cache[t],r.destroy&&r.destroy())}var p;a.prototype={_registry:null,cache:null,factoryCache:null,validationCache:null,lookup:function(e,t){return s(this,this._registry.normalize(e),t)},lookupFactory:function(e){return u(this,this._registry.normalize(e))},destroy:function(){m(this,function(e){e.destroy&&e.destroy()}),this.isDestroyed=!0},reset:function(e){arguments.length>0?f(this,this._registry.normalize(e)):d(this)}},function(){function e(e){a.prototype[e]=function(){return this._registry[e].apply(this._registry,arguments)}}for(var t=["register","unregister","resolve","normalize","typeInjection","injection","factoryInjection","factoryTypeInjection","has","options","optionsForType"],r=0,n=t.length;n>r;r++)e(t[r])}(),e["default"]=a}),e("container/registry",["exports","ember-metal/core","ember-metal/dictionary","./container"],function(e,t,r,n){"use strict";function i(e){this.fallback=e&&e.fallback?e.fallback:null,this.resolver=e&&e.resolver?e.resolver:function(){},this.registrations=r["default"](e&&e.registrations?e.registrations:null),this._typeInjections=r["default"](null),this._injections=r["default"](null),this._factoryTypeInjections=r["default"](null),this._factoryInjections=r["default"](null),this._normalizeCache=r["default"](null),this._resolveCache=r["default"](null),this._options=r["default"](null),this._typeOptions=r["default"](null)}function a(e,t){var r=e._resolveCache[t];if(r)return r;var n=e.resolver(t)||e.registrations[t];return e._resolveCache[t]=n,n}function s(e,t){return void 0!==e.resolve(t)}var o=/^[^:]+.+:[^:]+$/;i.prototype={fallback:null,resolver:null,registrations:null,_typeInjections:null,_injections:null,_factoryTypeInjections:null,_factoryInjections:null,_normalizeCache:null,_resolveCache:null,_options:null,_typeOptions:null,_defaultContainer:null,container:function(e){var t=new n["default"](this,e);return this.registerContainer(t),t},registerContainer:function(e){this._defaultContainer||(this._defaultContainer=e),this.fallback&&this.fallback.registerContainer(e)},lookup:function(e,t){return this._defaultContainer.lookup(e,t)},lookupFactory:function(e){return this._defaultContainer.lookupFactory(e)},register:function(e,t,r){if(void 0===t)throw new TypeError("Attempting to register an unknown factory: `"+e+"`");var n=this.normalize(e);if(this._resolveCache[n])throw new Error("Cannot re-register: `"+e+"`, as it has already been resolved.");this.registrations[n]=t,this._options[n]=r||{}},unregister:function(e){var t=this.normalize(e);delete this.registrations[t],delete this._resolveCache[t],delete this._options[t]},resolve:function(e){var t=a(this,this.normalize(e));return void 0===t&&this.fallback&&(t=this.fallback.resolve(e)),t},describe:function(e){return e},normalizeFullName:function(e){return e},normalize:function(e){return this._normalizeCache[e]||(this._normalizeCache[e]=this.normalizeFullName(e))},makeToString:function(e,t){return e.toString()},has:function(e){return s(this,this.normalize(e))},optionsForType:function(e,t){this._typeOptions[e]=t},getOptionsForType:function(e){var t=this._typeOptions[e];return void 0===t&&this.fallback&&(t=this.fallback.getOptionsForType(e)),t},options:function(e,t){t=t||{};var r=this.normalize(e);this._options[r]=t},getOptions:function(e){var t=this.normalize(e),r=this._options[t];return void 0===r&&this.fallback&&(r=this.fallback.getOptions(e)),r},getOption:function(e,t){var r=this._options[e];if(r&&void 0!==r[t])return r[t];var n=e.split(":")[0];return r=this._typeOptions[n],r&&void 0!==r[t]?r[t]:this.fallback?this.fallback.getOption(e,t):void 0},option:function(e,t){return this.getOption(e,t)},typeInjection:function(e,t,r){var n=r.split(":")[0];if(n===e)throw new Error("Cannot inject a `"+r+"` on other "+e+"(s).");var i=this._typeInjections[e]||(this._typeInjections[e]=[]);i.push({property:t,fullName:r})},injection:function(e,t,r){this.validateFullName(r);var n=this.normalize(r);if(-1===e.indexOf(":"))return this.typeInjection(e,t,n);var i=this.normalize(e),a=this._injections[i]||(this._injections[i]=[]);a.push({property:t,fullName:n})},factoryTypeInjection:function(e,t,r){var n=this._factoryTypeInjections[e]||(this._factoryTypeInjections[e]=[]);n.push({property:t,fullName:this.normalize(r)})},factoryInjection:function(e,t,r){var n=this.normalize(e),i=this.normalize(r);if(this.validateFullName(r),-1===e.indexOf(":"))return this.factoryTypeInjection(n,t,i);var a=this._factoryInjections[n]||(this._factoryInjections[n]=[]);a.push({property:t,fullName:i})},validateFullName:function(e){if(!o.test(e))throw new TypeError("Invalid Fullname, expected: `type:name` got: "+e);return!0},validateInjections:function(e){if(e)for(var t,r=0,n=e.length;n>r;r++)if(t=e[r].fullName,!this.has(t))throw new Error("Attempting to inject an unknown injection: `"+t+"`")},normalizeInjectionsHash:function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push({property:r,fullName:e[r]});return t},getInjections:function(e){var t=this._injections[e]||[];return this.fallback&&(t=t.concat(this.fallback.getInjections(e))),t},getTypeInjections:function(e){var t=this._typeInjections[e]||[];return this.fallback&&(t=t.concat(this.fallback.getTypeInjections(e))),t},getFactoryInjections:function(e){var t=this._factoryInjections[e]||[];return this.fallback&&(t=t.concat(this.fallback.getFactoryInjections(e))),t},getFactoryTypeInjections:function(e){var t=this._factoryTypeInjections[e]||[];return this.fallback&&(t=t.concat(this.fallback.getFactoryTypeInjections(e))),t}},e["default"]=i}),e("dag-map",["exports"],function(e){"use strict";function t(e,r,n,i){var a,s=e.name,o=e.incoming,u=e.incomingNames,l=u.length;if(n||(n={}),i||(i=[]),!n.hasOwnProperty(s)){for(i.push(s),n[s]=!0,a=0;l>a;a++)t(o[u[a]],r,n,i);r(e,i),i.pop()}}function r(){this.names=[],this.vertices=Object.create(null)}function n(e){this.name=e,this.incoming={},this.incomingNames=[],this.hasOutgoing=!1,this.value=null}r.prototype.add=function(e){if(!e)throw new Error("Can't add Vertex without name");if(void 0!==this.vertices[e])return this.vertices[e];var t=new n(e);return this.vertices[e]=t,this.names.push(e),t},r.prototype.map=function(e,t){this.add(e).value=t},r.prototype.addEdge=function(e,r){function n(e,t){if(e.name===r)throw new Error("cycle detected: "+r+" <- "+t.join(" <- "))}if(e&&r&&e!==r){var i=this.add(e),a=this.add(r);a.incoming.hasOwnProperty(e)||(t(i,n),i.hasOutgoing=!0,a.incoming[e]=i,a.incomingNames.push(e))}},r.prototype.topsort=function(e){var r,n,i={},a=this.vertices,s=this.names,o=s.length;for(r=0;o>r;r++)n=a[s[r]],n.hasOutgoing||t(n,e,i)},r.prototype.addEdges=function(e,t,r,n){var i;if(this.map(e,t),r)if("string"==typeof r)this.addEdge(e,r);else for(i=0;i<r.length;i++)this.addEdge(e,r[i]);if(n)if("string"==typeof n)this.addEdge(n,e);else for(i=0;i<n.length;i++)this.addEdge(n[i],e)},e["default"]=r}),e("dag-map.umd",["./dag-map"],function(t){"use strict";var r=t["default"];"function"==typeof e&&e.amd?e(function(){return r}):"undefined"!=typeof module&&module.exports?module.exports=r:"undefined"!=typeof this&&(this.DAG=r)}),e("dom-helper",["./morph-range","./morph-attr","./dom-helper/build-html-dom","./dom-helper/classes","./dom-helper/prop","exports"],function(e,t,r,n,i,a){"use strict";function s(e){return e&&e.namespaceURI===d&&!f[e.tagName]?d:null}function o(e,t){if("TABLE"===t.tagName){var r=E.exec(e);if(r){var n=r[1];return"tr"===n||"col"===n}}}function u(e,t){var r=t.document.createElement("div");return r.innerHTML="<svg>"+e+"</svg>",r.firstChild.childNodes}function l(e){if(this.document=e||document,!this.document)throw new Error("A document object must be passed to the DOMHelper, or available on the global scope");this.canClone=C,this.namespace=null}var c=e["default"],h=t["default"],m=r.buildHTMLDOM,d=r.svgNamespace,f=r.svgHTMLIntegrationPoints,p=n.addClasses,v=n.removeClasses,g=i.normalizeProperty,b=i.isAttrRemovalValue,y="undefined"==typeof document?!1:document,_=y&&function(e){var t=e.createElement("div");t.appendChild(e.createTextNode(""));var r=t.cloneNode(!0);return 0===r.childNodes.length}(y),w=y&&function(e){var t=e.createElement("input");t.setAttribute("checked","checked");var r=t.cloneNode(!1);return!r.checked}(y),x=y&&(y.createElementNS?function(e){var t=e.createElementNS(d,"svg");return t.setAttribute("viewBox","0 0 100 100"),t.removeAttribute("viewBox"),!t.getAttribute("viewBox")}(y):!0),C=y&&function(e){var t=e.createElement("div");t.appendChild(e.createTextNode(" ")),t.appendChild(e.createTextNode(" "));var r=t.cloneNode(!0);return" "===r.childNodes[0].nodeValue}(y),E=/<([\w:]+)/,O=l.prototype;O.constructor=l,O.getElementById=function(e,t){return t=t||this.document,t.getElementById(e)},O.insertBefore=function(e,t,r){return e.insertBefore(t,r)},O.appendChild=function(e,t){return e.appendChild(t)},O.childAt=function(e,t){for(var r=e,n=0;n<t.length;n++)r=r.childNodes.item(t[n]);return r},O.childAtIndex=function(e,t){for(var r=e.firstChild,n=0;r&&t>n;n++)r=r.nextSibling;return r},O.appendText=function(e,t){return e.appendChild(this.document.createTextNode(t))},O.setAttribute=function(e,t,r){e.setAttribute(t,String(r))},O.setAttributeNS=function(e,t,r,n){e.setAttributeNS(t,r,String(n))},x?O.removeAttribute=function(e,t){e.removeAttribute(t)}:O.removeAttribute=function(e,t){"svg"===e.tagName&&"viewBox"===t?e.setAttribute(t,null):e.removeAttribute(t)},O.setPropertyStrict=function(e,t,r){e[t]=r},O.setProperty=function(e,t,r,n){var i=t.toLowerCase();if(e.namespaceURI===d||"style"===i)b(r)?e.removeAttribute(t):n?e.setAttributeNS(n,t,r):e.setAttribute(t,r);else{var a=g(e,t);a?e[a]=r:b(r)?e.removeAttribute(t):n&&e.setAttributeNS?e.setAttributeNS(n,t,r):e.setAttribute(t,r)}},y&&y.createElementNS?(O.createElement=function(e,t){var r=this.namespace;return t&&(r="svg"===e?d:s(t)),r?this.document.createElementNS(r,e):this.document.createElement(e)},O.setAttributeNS=function(e,t,r,n){e.setAttributeNS(t,r,String(n))}):(O.createElement=function(e){return this.document.createElement(e)},O.setAttributeNS=function(e,t,r,n){e.setAttribute(r,String(n))}),O.addClasses=p,O.removeClasses=v,O.setNamespace=function(e){this.namespace=e},O.detectNamespace=function(e){this.namespace=s(e)},O.createDocumentFragment=function(){return this.document.createDocumentFragment()},O.createTextNode=function(e){return this.document.createTextNode(e)},O.createComment=function(e){return this.document.createComment(e)},O.repairClonedNode=function(e,t,r){if(_&&t.length>0)for(var n=0,i=t.length;i>n;n++){var a=this.document.createTextNode(""),s=t[n],o=this.childAtIndex(e,s);o?e.insertBefore(a,o):e.appendChild(a)}w&&r&&e.setAttribute("checked","checked")},O.cloneNode=function(e,t){var r=e.cloneNode(!!t);return r},O.createAttrMorph=function(e,t,r){return new h(e,t,this,r)},O.createUnsafeAttrMorph=function(e,t,r){var n=this.createAttrMorph(e,t,r);return n.escaped=!1,n},O.createMorph=function(e,t,r,n){if(n&&11===n.nodeType)throw new Error("Cannot pass a fragment as the contextual element to createMorph");n||1!==e.nodeType||(n=e);var i=new c(this,n);return i.firstNode=t,i.lastNode=r,i.state={},i.isDirty=!0,i},O.createUnsafeMorph=function(e,t,r,n){var i=this.createMorph(e,t,r,n);return i.parseTextAsHTML=!0,i},O.createMorphAt=function(e,t,r,n){var i=t===r,a=this.childAtIndex(e,t),s=i?a:this.childAtIndex(e,r);return this.createMorph(e,a,s,n)},O.createUnsafeMorphAt=function(e,t,r,n){var i=this.createMorphAt(e,t,r,n);return i.parseTextAsHTML=!0,i},O.insertMorphBefore=function(e,t,r){var n=this.document.createComment("");return e.insertBefore(n,t),this.createMorph(e,n,n,r)},O.appendMorph=function(e,t){var r=this.document.createComment("");return e.appendChild(r),this.createMorph(e,r,r,t)},O.insertBoundary=function(e,t){var r=null===t?null:this.childAtIndex(e,t);this.insertBefore(e,this.createTextNode(""),r)},O.parseHTML=function(e,t){var r;if(s(t)===d)r=u(e,this);else{var n=m(e,t,this);if(o(e,t)){for(var i=n[0];i&&1!==i.nodeType;)i=i.nextSibling;r=i.childNodes}else r=n}var a=this.document.createDocumentFragment();if(r&&r.length>0){var l=r[0];for("SELECT"===t.tagName&&(l=l.nextSibling);l;){var c=l;l=l.nextSibling,a.appendChild(c)}}return a};var P;O.protocolForURL=function(e){return P||(P=this.document.createElement("a")),P.href=e,P.protocol},a["default"]=l}),e("dom-helper/build-html-dom",["exports"],function(e){"use strict";function t(e,t){t="&shy;"+t,e.innerHTML=t;for(var r=e.childNodes,n=r[0];1===n.nodeType&&!n.nodeName;)n=n.firstChild;if(3===n.nodeType&&"­"===n.nodeValue.charAt(0)){var i=n.nodeValue.slice(1);i.length?n.nodeValue=n.nodeValue.slice(1):n.parentNode.removeChild(n)}return r}function r(e,r){var i=r.tagName,a=r.outerHTML||(new XMLSerializer).serializeToString(r);if(!a)throw"Can't set innerHTML on "+i+" in this browser";e=n(e,r);for(var s=h[i.toLowerCase()],o=a.match(new RegExp("<"+i+"([^>]*)>","i"))[0],u="</"+i+">",l=[o,e,u],c=s.length,m=1+c;c--;)l.unshift("<"+s[c]+">"),l.push("</"+s[c]+">");var d=document.createElement("div");t(d,l.join(""));for(var f=d;m--;)for(f=f.firstChild;f&&1!==f.nodeType;)f=f.nextSibling;for(;f&&f.tagName!==i;)f=f.nextSibling;return f?f.childNodes:[]}function n(e,t){return"SELECT"===t.tagName&&(e="<option></option>"+e),e}var i={foreignObject:1,desc:1,title:1};e.svgHTMLIntegrationPoints=i;var a="http://www.w3.org/2000/svg";e.svgNamespace=a;var s,o="undefined"==typeof document?!1:document,u=o&&function(e){if(void 0!==e.createElementNS){var t=e.createElementNS(a,"title");return t.innerHTML="<div></div>",0===t.childNodes.length||1!==t.childNodes[0].nodeType}}(o),l=o&&function(e){var t=e.createElement("div");return t.innerHTML="<div></div>",t.firstChild.innerHTML="<script></script>",""===t.firstChild.innerHTML}(o),c=o&&function(e){var t=e.createElement("div");return t.innerHTML="Test: <script type='text/x-placeholder'></script>Value","Test:"===t.childNodes[0].nodeValue&&" Value"===t.childNodes[2].nodeValue}(o),h=o&&function(e){var t,r,n=e.createElement("table");try{n.innerHTML="<tbody></tbody>"}catch(i){}finally{r=0===n.childNodes.length}r&&(t={colgroup:["table"],table:[],tbody:["table"],tfoot:["table"],thead:["table"],tr:["table","tbody"]});var a=e.createElement("select");return a.innerHTML="<option></option>",a.childNodes[0]||(t=t||{},t.select=[]),t}(o);s=l?function(e,r,i){return e=n(e,r),r=i.cloneNode(r,!1),t(r,e),r.childNodes}:function(e,t,r){return e=n(e,t),t=r.cloneNode(t,!1),t.innerHTML=e,t.childNodes};var m;m=h||c?function(e,t,n){var i=[],a=[];"string"==typeof e&&(e=e.replace(/(\s*)(<script)/g,function(e,t,r){return i.push(t),r}),e=e.replace(/(<\/script>)(\s*)/g,function(e,t,r){return a.push(r),t}));var o;o=h[t.tagName.toLowerCase()]?r(e,t):s(e,t,n);var u,l,c,m,d=[];for(u=0;u<o.length;u++)if(c=o[u],1===c.nodeType)if("SCRIPT"===c.tagName)d.push(c);else for(m=c.getElementsByTagName("script"),l=0;l<m.length;l++)d.push(m[l]);var f,p,v,g;for(u=0;u<d.length;u++)f=d[u],v=i[u],v&&v.length>0&&(p=n.document.createTextNode(v),f.parentNode.insertBefore(p,f)),g=a[u],g&&g.length>0&&(p=n.document.createTextNode(g),f.parentNode.insertBefore(p,f.nextSibling));return o}:s;var d;d=u?function(e,t,r){return i[t.tagName]?m(e,document.createElement("div"),r):m(e,t,r)}:m,e.buildHTMLDOM=d}),e("dom-helper/classes",["exports"],function(e){"use strict";function t(e){var t=e.getAttribute("class")||"";return""!==t&&" "!==t?t.split(" "):[]}function r(e,t){for(var r=0,n=e.length,i=0,a=t.length,s=new Array(a);n>r;r++)for(i=0;a>i;i++)if(t[i]===e[r]){s[i]=r;break}return s}function n(e,n){for(var i=t(e),a=r(i,n),s=!1,o=0,u=n.length;u>o;o++)void 0===a[o]&&(s=!0,i.push(n[o]));s&&e.setAttribute("class",i.length>0?i.join(" "):"")}function i(e,n){for(var i=t(e),a=r(n,i),s=!1,o=[],u=0,l=i.length;l>u;u++)void 0===a[u]?o.push(i[u]):s=!0;s&&e.setAttribute("class",o.length>0?o.join(" "):"")}var a,s,o="undefined"==typeof document?!1:document,u=o&&function(){var e=document.createElement("div");return e.classList?(e.classList.add("boo"),e.classList.add("boo","baz"),"boo baz"===e.className):!1}();u?(a=function(e,t){e.classList?1===t.length?e.classList.add(t[0]):2===t.length?e.classList.add(t[0],t[1]):e.classList.add.apply(e.classList,t):n(e,t)},s=function(e,t){e.classList?1===t.length?e.classList.remove(t[0]):2===t.length?e.classList.remove(t[0],t[1]):e.classList.remove.apply(e.classList,t):i(e,t)}):(a=n,s=i),e.addClasses=a,e.removeClasses=s}),e("dom-helper/prop",["exports"],function(e){"use strict";function t(e){return null===e||void 0===e}function r(e,t){var r,i=e.tagName,a=n[i];if(!a){a={};for(r in e)a[r.toLowerCase()]=r;n[i]=a}return a[t]}e.isAttrRemovalValue=t;var n={};e.propertyCaches=n,e.normalizeProperty=r}),e("ember-application",["ember-metal/core","ember-runtime/system/lazy_load","ember-application/system/resolver","ember-application/system/application","ember-application/ext/controller"],function(e,t,r,n){"use strict";e["default"].Application=n["default"],e["default"].Resolver=r.Resolver,e["default"].DefaultResolver=r["default"],t.runLoadHooks("Ember.Application",n["default"])}),e("ember-application/ext/controller",["exports","ember-metal/core","ember-metal/property_get","ember-metal/error","ember-metal/utils","ember-metal/computed","ember-runtime/mixins/controller","ember-routing/system/controller_for"],function(e,t,r,n,i,a,s,o){"use strict";function u(e,t,r){var a,s,o,u=[];for(s=0,o=r.length;o>s;s++)a=r[s],-1===a.indexOf(":")&&(a="controller:"+a),t._registry.has(a)||u.push(a);if(u.length)throw new n["default"](i.inspect(e)+" needs [ "+u.join(", ")+" ] but "+(u.length>1?"they":"it")+" could not be found")}var l=a.computed(function(){var e=this;return{needs:r.get(e,"needs"),container:r.get(e,"container"),unknownProperty:function(t){var r,n,a,s=this.needs;for(n=0,a=s.length;a>n;n++)if(r=s[n],r===t)return this.container.lookup("controller:"+t);var o=i.inspect(e)+"#needs does not include `"+t+"`. To access the "+t+" controller from "+i.inspect(e)+", "+i.inspect(e)+" should have a `needs` property that is an array of the controllers it has access to.";throw new ReferenceError(o)},setUnknownProperty:function(t,r){throw new Error("You cannot overwrite the value of `controllers."+t+"` of "+i.inspect(e))}}});s["default"].reopen({concatenatedProperties:["needs"],needs:[],init:function(){var e=r.get(this,"needs"),t=r.get(e,"length");t>0&&(this.container&&u(this,this.container,e),r.get(this,"controllers")),this._super.apply(this,arguments)},controllerFor:function(e){return o["default"](r.get(this,"container"),e)},controllers:l}),e["default"]=s["default"]}),e("ember-application/system/application-instance",["exports","ember-metal/property_set","ember-runtime/system/object","ember-metal/run_loop","container/registry"],function(e,t,r,n,i){
"use strict";e["default"]=r["default"].extend({container:null,applicationRegistry:null,registry:null,customEvents:null,rootElement:null,init:function(){this._super.apply(this,arguments),this.registry=new i["default"]({fallback:this.applicationRegistry,resolver:this.applicationRegistry.resolver}),this.registry.normalizeFullName=this.applicationRegistry.normalizeFullName,this.registry.makeToString=this.applicationRegistry.makeToString,this.container=this.registry.container(),this.registry.register("-application-instance:main",this,{instantiate:!1})},setupRouter:function(e){var r=this.container.lookup("router:main"),n=e.location;n&&t.set(r,"location",n),r._setupLocation(),r.setupRouter(!0)},didCreateRootView:function(e){e.appendTo(this.rootElement)},startRouting:function(){var e=this.container.lookup("router:main");if(e){var t=!!this.registry.resolver.moduleBasedResolver;e.startRouting(t)}},handleURL:function(e){var t=this.container.lookup("router:main");return t.handleURL(e)},setupEventDispatcher:function(){var e=this.container.lookup("event_dispatcher:main");return e.setup(this.customEvents,this.rootElement),e},willDestroy:function(){this._super.apply(this,arguments),n["default"](this.container,"destroy")}})}),e("ember-application/system/application",["exports","dag-map","container/registry","ember-metal","ember-metal/property_get","ember-metal/property_set","ember-runtime/system/lazy_load","ember-runtime/system/namespace","ember-runtime/mixins/deferred","ember-application/system/resolver","ember-metal/platform/create","ember-metal/run_loop","ember-metal/utils","ember-runtime/controllers/controller","ember-metal/enumerable_utils","ember-runtime/controllers/object_controller","ember-runtime/controllers/array_controller","ember-views/system/renderer","dom-helper","ember-views/views/select","ember-routing-views/views/outlet","ember-views/views/view","ember-views/views/metamorph_view","ember-views/system/event_dispatcher","ember-views/system/jquery","ember-routing/system/route","ember-routing/system/router","ember-routing/location/hash_location","ember-routing/location/history_location","ember-routing/location/auto_location","ember-routing/location/none_location","ember-routing/system/cache","ember-application/system/application-instance","ember-extension-support/container_debug_adapter","ember-metal/environment"],function(e,t,r,n,i,a,s,o,u,l,c,h,m,d,f,p,v,g,b,y,_,w,x,C,E,O,P,S,A,N,T,k,M,I,V){"use strict";function j(e){var t=[];for(var r in e)t.push(r);return t}function R(e){function t(e){return n.resolve(e)}var r=e.get("resolver")||e.get("Resolver")||l["default"],n=r.create({namespace:e});return t.describe=function(e){return n.lookupDescription(e)},t.makeToString=function(e,t){return n.makeToString(e,t)},t.normalize=function(e){return n.normalize?n.normalize(e):e},t.__resolver__=n,t}function D(){B||(B=!0,V["default"].hasDOM&&n["default"].libraries.registerCoreLibrary("jQuery",E["default"]().jquery))}function F(){if(n["default"].LOG_VERSION){n["default"].LOG_VERSION=!1;for(var e=n["default"].libraries._registry,t=f["default"].map(e,function(e){return i.get(e,"name.length")}),r=Math.max.apply(this,t),a=0,s=e.length;s>a;a++){var o=e[a];new Array(r-o.name.length+1).join(" ")}}}function L(e,t){return function(t){if(void 0!==this.superclass[e]&&this.superclass[e]===this[e]){var r={};r[e]=c["default"](this[e]),this.reopenClass(r)}this[e][t.name]=t}}var B=!1,H=o["default"].extend(u["default"],{_suppressDeferredDeprecation:!0,rootElement:"body",eventDispatcher:null,customEvents:null,autoboot:!0,init:function(){this._super.apply(this,arguments),this.$||(this.$=E["default"]),this.buildRegistry(),D(),F(),this._readinessDeferrals=1,this.Router=(this.Router||P["default"]).extend(),this.waitForDOMReady(this.buildDefaultInstance())},buildRegistry:function(){var e=this.registry=H.buildRegistry(this);return e},buildInstance:function(){return M["default"].create({customEvents:i.get(this,"customEvents"),rootElement:i.get(this,"rootElement"),applicationRegistry:this.registry})},buildDefaultInstance:function(){var e=this.buildInstance();return this.__deprecatedInstance__=e,this.__container__=e.container,e},waitForDOMReady:function(e){!this.$||this.$.isReady?h["default"].schedule("actions",this,"domReady",e):this.$().ready(h["default"].bind(this,"domReady",e))},deferReadiness:function(){this._readinessDeferrals++},advanceReadiness:function(){this._readinessDeferrals--,0===this._readinessDeferrals&&h["default"].once(this,this.didBecomeReady)},register:function(){this.registry.register.apply(this.registry,arguments)},inject:function(){this.registry.injection.apply(this.registry,arguments)},initialize:function(){},domReady:function(e){if(!this.isDestroyed){var t=this;return this.boot().then(function(){t.runInstanceInitializers(e)}),this}},boot:function(){if(this._bootPromise)return this._bootPromise;var e=new n["default"].RSVP.defer;return this._bootPromise=e.promise,this._bootResolver=e,this.runInitializers(this.registry),s.runLoadHooks("application",this),this.advanceReadiness(),this._bootPromise},reset:function(){function e(){h["default"](t,"destroy"),this.buildDefaultInstance(),h["default"].schedule("actions",this,"domReady")}var t=this.__deprecatedInstance__;this._readinessDeferrals=1,this._bootPromise=null,this._bootResolver=null,h["default"].join(this,e)},runInitializers:function(e){var t=this;this._runInitializer("initializers",function(r,n){var i=n.initialize;i(e,t)})},runInstanceInitializers:function(e){this._runInitializer("instanceInitializers",function(t,r){r.initialize(e)})},_runInitializer:function(e,r){for(var n,a=i.get(this.constructor,e),s=j(a),o=new t["default"],u=0;u<s.length;u++)n=a[s[u]],o.addEdges(n.name,n,n.before,n.after);o.topsort(function(e){r(e.name,e.value)})},didBecomeReady:function(){this.autoboot&&(V["default"].hasDOM&&this.__deprecatedInstance__.setupEventDispatcher(),this.ready(),this.__deprecatedInstance__.startRouting(),n["default"].testing||(n["default"].Namespace.processAll(),n["default"].BOOTED=!0),this.resolve(this)),this._bootResolver.resolve()},ready:function(){return this},resolver:null,Resolver:null,willDestroy:function(){n["default"].BOOTED=!1,this._bootPromise=null,this._bootResolver=null,this.__deprecatedInstance__.destroy()},initializer:function(e){this.constructor.initializer(e)},then:function(){this._super.apply(this,arguments)}});H.reopenClass({initializers:c["default"](null),instanceInitializers:c["default"](null),initializer:L("initializers","initializer"),buildRegistry:function(e){var t=new r["default"];return t.set=a.set,t.resolver=R(e),t.normalizeFullName=t.resolver.normalize,t.describe=t.resolver.describe,t.makeToString=t.resolver.makeToString,t.optionsForType("component",{singleton:!1}),t.optionsForType("view",{singleton:!1}),t.optionsForType("template",{instantiate:!1}),t.optionsForType("helper",{instantiate:!1}),t.register("application:main",e,{instantiate:!1}),t.register("controller:basic",d["default"],{instantiate:!1}),t.register("controller:object",p["default"],{instantiate:!1}),t.register("controller:array",v["default"],{instantiate:!1}),t.register("renderer:-dom",{create:function(){return new g["default"](new b["default"])}}),t.injection("view","renderer","renderer:-dom"),t.register("view:select",y["default"]),t.register("view:-outlet",_.OutletView),t.register("view:default",x["default"]),t.register("view:toplevel",w["default"].extend()),t.register("route:basic",O["default"],{instantiate:!1}),t.register("event_dispatcher:main",C["default"]),t.injection("router:main","namespace","application:main"),t.injection("view:-outlet","namespace","application:main"),t.register("location:auto",N["default"]),t.register("location:hash",S["default"]),t.register("location:history",A["default"]),t.register("location:none",T["default"]),t.injection("controller","target","router:main"),t.injection("controller","namespace","application:main"),t.register("-bucket-cache:main",k["default"]),t.injection("router","_bucketCache","-bucket-cache:main"),t.injection("route","_bucketCache","-bucket-cache:main"),t.injection("controller","_bucketCache","-bucket-cache:main"),t.injection("route","router","router:main"),t.injection("location","rootURL","-location-setting:root-url"),t.register("resolver-for-debugging:main",t.resolver.__resolver__,{instantiate:!1}),t.injection("container-debug-adapter:main","resolver","resolver-for-debugging:main"),t.injection("data-adapter:main","containerDebugAdapter","container-debug-adapter:main"),t.register("container-debug-adapter:main",I["default"]),t}}),e["default"]=H}),e("ember-application/system/resolver",["exports","ember-metal/core","ember-metal/property_get","ember-metal/logger","ember-runtime/system/string","ember-runtime/system/object","ember-runtime/system/namespace","ember-htmlbars/helpers","ember-metal/dictionary"],function(e,t,r,n,i,a,s,o,u){"use strict";var l=a["default"].extend({namespace:null,normalize:t["default"].required(Function),resolve:t["default"].required(Function),parseName:t["default"].required(Function),lookupDescription:t["default"].required(Function),makeToString:t["default"].required(Function),resolveOther:t["default"].required(Function),_logLookup:t["default"].required(Function)});e["default"]=a["default"].extend({namespace:null,init:function(){this._parseNameCache=u["default"](null)},normalize:function(e){var t=e.split(":",2),r=t[0],n=t[1];if("template"!==r){var i=n;return i.indexOf(".")>-1&&(i=i.replace(/\.(.)/g,function(e){return e.charAt(1).toUpperCase()})),n.indexOf("_")>-1&&(i=i.replace(/_(.)/g,function(e){return e.charAt(1).toUpperCase()})),r+":"+i}return e},resolve:function(e){var t,r=this.parseName(e),n=r.resolveMethodName;return this[n]&&(t=this[n](r)),t=t||this.resolveOther(r),r.root&&r.root.LOG_RESOLVER&&this._logLookup(t,r),t},parseName:function(e){return this._parseNameCache[e]||(this._parseNameCache[e]=this._parseName(e))},_parseName:function(e){var t=e.split(":"),n=t[0],a=t[1],o=a,u=r.get(this,"namespace"),l=u;if("template"!==n&&-1!==o.indexOf("/")){var c=o.split("/");o=c[c.length-1];var h=i.capitalize(c.slice(0,-1).join("."));l=s["default"].byName(h)}var m="main"===a?"Main":i.classify(n);if(!o||!n)throw new TypeError("Invalid fullName: `"+e+"`, must be of the form `type:name` ");return{fullName:e,type:n,fullNameWithoutType:a,name:o,root:l,resolveMethodName:"resolve"+m}},lookupDescription:function(e){var t,r=this.parseName(e);return"template"===r.type?"template at "+r.fullNameWithoutType.replace(/\./g,"/"):(t=r.root+"."+i.classify(r.name).replace(/\./g,""),"model"!==r.type&&(t+=i.classify(r.type)),t)},makeToString:function(e,t){return e.toString()},useRouterNaming:function(e){e.name=e.name.replace(/\./g,"_"),"basic"===e.name&&(e.name="")},resolveTemplate:function(e){var r=e.fullNameWithoutType.replace(/\./g,"/");return t["default"].TEMPLATES[r]?t["default"].TEMPLATES[r]:(r=i.decamelize(r),t["default"].TEMPLATES[r]?t["default"].TEMPLATES[r]:void 0)},resolveView:function(e){return this.useRouterNaming(e),this.resolveOther(e)},resolveController:function(e){return this.useRouterNaming(e),this.resolveOther(e)},resolveRoute:function(e){return this.useRouterNaming(e),this.resolveOther(e)},resolveModel:function(e){var t=i.classify(e.name),n=r.get(e.root,t);return n?n:void 0},resolveHelper:function(e){return this.resolveOther(e)||o["default"][e.fullNameWithoutType]},resolveOther:function(e){var t=i.classify(e.name)+i.classify(e.type),n=r.get(e.root,t);return n?n:void 0},resolveMain:function(e){var t=i.classify(e.type);return r.get(e.root,t)},_logLookup:function(e,t){var r,i;r=e?"[✓]":"[ ]",i=t.fullName.length>60?".":new Array(60-t.fullName.length).join("."),n["default"].info(r,t.fullName,i,this.lookupDescription(t.fullName))}}),e.Resolver=l}),e("ember-extension-support",["ember-metal/core","ember-extension-support/data_adapter","ember-extension-support/container_debug_adapter"],function(e,t,r){"use strict";e["default"].DataAdapter=t["default"],e["default"].ContainerDebugAdapter=r["default"]}),e("ember-extension-support/container_debug_adapter",["exports","ember-metal/core","ember-runtime/system/native_array","ember-metal/utils","ember-runtime/system/string","ember-runtime/system/namespace","ember-runtime/system/object"],function(e,t,r,n,i,a,s){"use strict";e["default"]=s["default"].extend({container:null,resolver:null,canCatalogEntriesByType:function(e){return"model"===e||"template"===e?!1:!0},catalogEntriesByType:function(e){var s=r.A(a["default"].NAMESPACES),o=r.A(),u=new RegExp(i.classify(e)+"$");return s.forEach(function(e){if(e!==t["default"])for(var r in e)if(e.hasOwnProperty(r)&&u.test(r)){var a=e[r];"class"===n.typeOf(a)&&o.push(i.dasherize(r.replace(u,"")))}}),o}})}),e("ember-extension-support/data_adapter",["exports","ember-metal/property_get","ember-metal/run_loop","ember-runtime/system/string","ember-runtime/system/namespace","ember-runtime/system/object","ember-runtime/system/native_array","ember-application/system/application"],function(e,t,r,n,i,a,s,o){"use strict";e["default"]=a["default"].extend({init:function(){this._super.apply(this,arguments),this.releaseMethods=s.A()},container:null,containerDebugAdapter:void 0,attributeLimit:3,releaseMethods:s.A(),getFilters:function(){return s.A()},watchModelTypes:function(e,t){var r,n=this.getModelTypes(),i=this,a=s.A();r=n.map(function(e){var r=e.klass,n=i.wrapModelType(r,e.name);return a.push(i.observeModelType(r,t)),n}),e(r);var o=function(){a.forEach(function(e){e()}),i.releaseMethods.removeObject(o)};return this.releaseMethods.pushObject(o),o},_nameToClass:function(e){return"string"==typeof e&&(e=this.container.lookupFactory("model:"+e)),e},watchRecords:function(e,t,r,n){var i,a=this,o=s.A(),u=this.getRecords(e),l=function(e){r([e])},c=u.map(function(e){return o.push(a.observeRecord(e,l)),a.wrapRecord(e)}),h=function(e,r,i,s){for(var u=r;r+s>u;u++){var c=e.objectAt(u),h=a.wrapRecord(c);o.push(a.observeRecord(c,l)),t([h])}i&&n(r,i)},m={didChange:h,willChange:function(){return this}};return u.addArrayObserver(a,m),i=function(){o.forEach(function(e){e()}),u.removeArrayObserver(a,m),a.releaseMethods.removeObject(i)},t(c),this.releaseMethods.pushObject(i),i},willDestroy:function(){this._super.apply(this,arguments),this.releaseMethods.forEach(function(e){e()})},detect:function(e){return!1},columnsForType:function(e){return s.A()},observeModelType:function(e,t){var n=this,i=this.getRecords(e),a=function(){t([n.wrapModelType(e)])},s={didChange:function(){r["default"].scheduleOnce("actions",this,a)},willChange:function(){return this}};i.addArrayObserver(this,s);var o=function(){i.removeArrayObserver(n,s)};return o},wrapModelType:function(e,r){var n,i=this.getRecords(e);return n={name:r||e.toString(),count:t.get(i,"length"),columns:this.columnsForType(e),object:e}},getModelTypes:function(){var e,t=this,r=this.get("containerDebugAdapter");return e=r.canCatalogEntriesByType("model")?r.catalogEntriesByType("model"):this._getObjectsOnNamespaces(),e=s.A(e).map(function(e){return{klass:t._nameToClass(e),name:e}}),e=s.A(e).filter(function(e){return t.detect(e.klass)}),s.A(e)},_getObjectsOnNamespaces:function(){var e=s.A(i["default"].NAMESPACES),t=s.A(),r=this;return e.forEach(function(e){for(var i in e)if(e.hasOwnProperty(i)&&r.detect(e[i])){var a=n.dasherize(i);e instanceof o["default"]||!e.toString()||(a=e+"/"+a),t.push(a)}}),t},getRecords:function(e){return s.A()},wrapRecord:function(e){var t={object:e};return t.columnValues=this.getRecordColumnValues(e),t.searchKeywords=this.getRecordKeywords(e),t.filterValues=this.getRecordFilterValues(e),t.color=this.getRecordColor(e),t},getRecordColumnValues:function(e){return{}},getRecordKeywords:function(e){return s.A()},getRecordFilterValues:function(e){return{}},getRecordColor:function(e){return null},observeRecord:function(e,t){return function(){}}})}),e("ember-htmlbars",["ember-metal/core","ember-template-compiler","ember-htmlbars/system/make-view-helper","ember-htmlbars/system/make_bound_helper","ember-htmlbars/helpers","ember-htmlbars/helpers/view","ember-htmlbars/helpers/component","ember-htmlbars/helpers/yield","ember-htmlbars/helpers/with","ember-htmlbars/helpers/log","ember-htmlbars/helpers/debugger","ember-htmlbars/helpers/bind-attr","ember-htmlbars/helpers/if_unless","ember-htmlbars/helpers/loc","ember-htmlbars/helpers/partial","ember-htmlbars/helpers/template","ember-htmlbars/helpers/input","ember-htmlbars/helpers/text_area","ember-htmlbars/helpers/collection","ember-htmlbars/helpers/each","ember-htmlbars/helpers/unbound","ember-htmlbars/system/bootstrap","ember-htmlbars/compat"],function(e,t,r,n,i,a,s,o,u,l,c,h,m,d,f,p,v,g,b,y,_){"use strict";i.registerHelper("view",a.viewHelper),i.registerHelper("component",s.componentHelper),i.registerHelper("yield",o.yieldHelper),i.registerHelper("with",u.withHelper),i.registerHelper("if",m.ifHelper),i.registerHelper("unless",m.unlessHelper),i.registerHelper("log",l.logHelper),i.registerHelper("debugger",c.debuggerHelper),i.registerHelper("loc",d.locHelper),i.registerHelper("partial",f.partialHelper),i.registerHelper("template",p.templateHelper),i.registerHelper("bind-attr",h.bindAttrHelper),i.registerHelper("bindAttr",h.bindAttrHelperDeprecated),i.registerHelper("input",v.inputHelper),i.registerHelper("textarea",g.textareaHelper),i.registerHelper("collection",b.collectionHelper),i.registerHelper("each",y.eachHelper),i.registerHelper("unbound",_.unboundHelper),e["default"].HTMLBars={_registerHelper:i.registerHelper,template:t.template,compile:t.compile,precompile:t.precompile,makeViewHelper:r["default"],makeBoundHelper:n["default"],registerPlugin:t.registerPlugin}}),e("ember-htmlbars/compat",["exports","ember-metal/core","ember-htmlbars/helpers","ember-htmlbars/compat/helper","ember-htmlbars/compat/handlebars-get","ember-htmlbars/compat/make-bound-helper","ember-htmlbars/compat/register-bound-helper","ember-htmlbars/system/make-view-helper","ember-htmlbars/utils/string"],function(e,t,r,n,i,a,s,o,u){"use strict";var l=t["default"].Handlebars=t["default"].Handlebars||{};l.helpers=r["default"],l.helper=n.handlebarsHelper,l.registerHelper=n.registerHandlebarsCompatibleHelper,l.registerBoundHelper=s["default"],l.makeBoundHelper=a["default"],l.get=i["default"],l.makeViewHelper=o["default"],l.SafeString=u.SafeString,l.Utils={escapeExpression:u.escapeExpression},e["default"]=l}),e("ember-htmlbars/compat/handlebars-get",["exports"],function(e){"use strict";function t(e,t,r){return r.data.view.getStream(t).value()}e["default"]=t}),e("ember-htmlbars/compat/helper",["exports","ember-metal/merge","ember-htmlbars/helpers","ember-views/views/view","ember-views/views/component","ember-htmlbars/system/make-view-helper","ember-htmlbars/compat/make-bound-helper","ember-metal/streams/utils"],function(e,t,r,n,i,a,s,o){"use strict";function u(e){if(o.isStream(e))return"ID";var t=typeof e;return t.toUpperCase()}function l(e){this.helperFunction=function(r,n,i,a){var s,l,c,h=a.data.view,m={hash:{},types:new Array(r.length),hashTypes:{}};t["default"](m,i),t["default"](m,a),m.hash={},i.isBlock&&(m.fn=function(){l=i.template.render(h,a,i.morph.contextualElement)},i.inverse&&(m.inverse=function(){l=i.inverse.render(h,a,i.morph.contextualElement)}));for(var d in n)s=n[d],m.hashTypes[d]=u(s),o.isStream(s)?m.hash[d]=s._label:m.hash[d]=s;for(var f=new Array(r.length),p=0,v=r.length;v>p;p++)s=r[p],m.types[p]=u(s),o.isStream(s)?f[p]=s._label:f[p]=s;return f.push(m),c=e.apply(this,f),i.isBlock?l:c},this.isHTMLBars=!0}function c(e,t){var n;n=t&&t.isHTMLBars?t:new l(t),r["default"][e]=n}function h(e,t){if(n["default"].detect(t))r["default"][e]=a["default"](t);else{var i=m.call(arguments,1),o=s["default"].apply(this,i);r["default"][e]=o}}e.registerHandlebarsCompatibleHelper=c,e.handlebarsHelper=h;var m=[].slice;l.prototype={preprocessArguments:function(){}},e["default"]=l}),e("ember-htmlbars/compat/make-bound-helper",["exports","ember-metal/core","ember-metal/mixin","ember-htmlbars/system/helper","ember-metal/streams/stream","ember-metal/streams/utils"],function(e,t,r,n,i,a){"use strict";function s(e,t){function s(t,n,s,l){function c(){for(var r=a.readArray(t),i=new Array(t.length),s=0,o=t.length;o>s;s++)h=t[s],a.isStream(h)?i[s]=h._label:i[s]=h;return r.push({hash:a.readHash(n),data:{properties:i}}),e.apply(m,r)}var h,m=l.data.view,d=t.length;for(var f in n)r.IS_BINDING.test(f)&&(n[f.slice(0,-7)]=m.getStream(n[f]),delete n[f]);var p=a.scanArray(t)||a.scanHash(n);if(p){var v=new i["default"](c);for(u=0;d>u;u++)h=t[u],a.isStream(h)&&h.subscribe(v.notify,v);for(f in n)h=n[f],a.isStream(h)&&h.subscribe(v.notify,v);if(d>0){var g=t[0];if(a.isStream(g)){var b=function(e){e.value(),v.notify()};for(u=0;u<o.length;u++){var y=g.get(o[u]);y.value(),y.subscribe(b)}}}return v}return c()}for(var o=[],u=1;u<arguments.length;u++)o.push(arguments[u]);return new n["default"](s)}e["default"]=s}),e("ember-htmlbars/compat/register-bound-helper",["exports","ember-htmlbars/helpers","ember-htmlbars/compat/make-bound-helper"],function(e,t,r){"use strict";function n(e,n){var a=i.call(arguments,1),s=r["default"].apply(this,a);t["default"][e]=s}var i=[].slice;e["default"]=n}),e("ember-htmlbars/env",["exports","ember-metal/environment","dom-helper","ember-htmlbars/hooks/inline","ember-htmlbars/hooks/content","ember-htmlbars/hooks/component","ember-htmlbars/hooks/block","ember-htmlbars/hooks/element","ember-htmlbars/hooks/subexpr","ember-htmlbars/hooks/attribute","ember-htmlbars/hooks/concat","ember-htmlbars/hooks/get","ember-htmlbars/hooks/set","ember-htmlbars/helpers"],function(e,t,r,n,i,a,s,o,u,l,c,h,m,d){"use strict";e["default"]={hooks:{get:h["default"],set:m["default"],inline:n["default"],content:i["default"],block:s["default"],element:o["default"],subexpr:u["default"],component:a["default"],attribute:l["default"],concat:c["default"]},helpers:d["default"],useFragmentCache:!0};var f=t["default"].hasDOM?new r["default"]:null;e.domHelper=f}),e("ember-htmlbars/helpers",["exports","ember-metal/platform/create","ember-htmlbars/system/helper"],function(e,t,r){"use strict";function n(e,t){var n;n=t&&t.isHelper?t:new r["default"](t),i[e]=n}e.registerHelper=n;var i=t["default"](null);e["default"]=i}),e("ember-htmlbars/helpers/bind-attr",["exports","ember-metal/core","ember-runtime/system/string","ember-views/attr_nodes/attr_node","ember-views/attr_nodes/legacy_bind","ember-metal/keys","ember-htmlbars/helpers","ember-metal/enumerable_utils","ember-metal/streams/utils","ember-views/streams/class_name_binding"],function(e,t,r,n,i,a,s,o,u,l){"use strict";function c(e,t,r,s){var o=r.element,l=s.data.view,c=t["class"];if(null!==c&&void 0!==c){u.isStream(c)||(c=h(c,l));var m=new n["default"]("class",c);m._morph=s.dom.createAttrMorph(o,"class"),l.appendChild(m)}for(var d,f,p,v,g=a["default"](t),b=0,y=g.length;y>b;b++)d=g[b],"class"!==d&&(f=t[d],p=u.isStream(f)?f:l.getStream(f),v=new i["default"](d,p),v._morph=s.dom.createAttrMorph(o,d),l.appendChild(v))}function h(e,t){var r=e.split(" "),n=o.map(r,function(e){return l.streamifyClassNameBinding(t,e)}),i=u.concat(n," ");return i}function m(){return s["default"]["bind-attr"].helperFunction.apply(this,arguments)}e.bindAttrHelper=c,e.bindAttrHelperDeprecated=m,e["default"]=c}),e("ember-htmlbars/helpers/collection",["exports","ember-metal/core","ember-metal/mixin","ember-runtime/system/string","ember-metal/property_get","ember-views/views/collection_view","ember-views/streams/utils","ember-metal/enumerable_utils","ember-views/streams/class_name_binding","ember-htmlbars/system/merge-view-bindings"],function(e,t,r,n,i,a,s,o,u,l){"use strict";function c(e,t,n,c){var h,m=e[0],d=c.data,f=n.template,p=n.inverse,v=d.view,g=i.get(v,"controller"),b=g&&g.container?g.container:v.container;h=m?s.readViewFactory(m,b):a["default"];var y,_,w={},x=h.proto();_=t.itemView?s.readViewFactory(t.itemView,b):t.itemViewClass?s.readViewFactory(t.itemViewClass,b):x.itemViewClass,"string"==typeof _&&(_=b.lookupFactory("view:"+_)),delete t.itemViewClass,delete t.itemView;for(var C in t)if("itemController"!==C&&"itemClassBinding"!==C&&t.hasOwnProperty(C)&&(y=C.match(/^item(.)(.*)$/))){var E=y[1].toLowerCase()+y[2];r.IS_BINDING.test(C)?w[E]=v._getBindingForStream(t[C]):w[E]=t[C],delete t[C]}f&&(w.template=f,delete n.template);var O;p?(O=i.get(x,"emptyViewClass"),O=O.extend({template:p,tagName:w.tagName})):t.emptyViewClass&&(O=s.readViewFactory(t.emptyViewClass,b)),O&&(t.emptyView=O);var P=l["default"](v,{},w);if(t.itemClassBinding){var S=t.itemClassBinding.split(" ");P.classNameBindings=o.map(S,function(e){return u.streamifyClassNameBinding(v,e)})}return t.itemViewClass=_,t._itemViewProps=P,n.helperName=n.helperName||"collection",c.helpers.view.helperFunction.call(this,[h],t,n,c)}e.collectionHelper=c}),e("ember-htmlbars/helpers/component",["exports","ember-metal/core","ember-metal/streams/utils","ember-views/streams/utils","ember-metal/error","ember-views/views/bound_component_view","ember-htmlbars/system/merge-view-bindings","ember-htmlbars/system/append-templated-view"],function(e,t,r,n,i,a,s,o){"use strict";function u(e,u,l,c){var h=c.data.view,m=e[0],d=h.container||r.read(h._keywords.view).container,f={helperName:l.helperName||"component"};l.template&&(f.template=l.template);var p;if(r.isStream(m))p=a["default"],f={_boundComponentOptions:t["default"].merge(u,f)},f._boundComponentOptions.componentNameStream=m;else{if(p=n.readComponentFactory(m,d),!p)throw new i["default"]('HTMLBars error: Could not find component named "'+m+'".');s["default"](h,f,u)}o["default"](h,l.morph,p,f)}e.componentHelper=u}),e("ember-htmlbars/helpers/debugger",["exports","ember-metal/logger"],function(e,t){"use strict";function r(e,r,n,i){{var a=i.data.view;a.get("context")}t["default"].info("Use `view`, `context`, and `get(<path>)` to debug this template.")}e.debuggerHelper=r}),e("ember-htmlbars/helpers/each",["exports","ember-metal/core","ember-views/views/each"],function(e,t,r){"use strict";function n(e,t,n,i){var a=i.data.view,s="each",o=e[0]||a.getStream(""),u=n.template&&n.template.blockParams;return u&&(t.keyword=!0,t.blockParams=u),t.dataSource=o,n.helperName=n.helperName||s,i.helpers.collection.helperFunction.call(this,[r["default"]],t,n,i)}e.eachHelper=n,e.EachView=r["default"]}),e("ember-htmlbars/helpers/if_unless",["exports","ember-metal/core","ember-metal/streams/conditional","ember-views/streams/should_display","ember-metal/property_get","ember-metal/streams/utils","ember-views/views/bound_if_view","ember-htmlbars/templates/empty"],function(e,t,r,n,i,a,s,o){"use strict";function u(e,t,r,n){var i=r.helperName||"if";return c(!1,i,e,t,r,n)}function l(e,t,r,n){var i=r.helperName||"unless";return c(!0,i,e,t,r,n)}function c(e,t,r,n,i,a){var s=a.data.view;return i.isBlock?h(s,e,t,r,n,i,a):m(s,e,t,r,n,i,a)}function h(e,t,r,u,l,c,h){var m=n["default"](u[0]),d=(t?c.inverse:c.template)||o["default"],f=(t?c.template:c.inverse)||o["default"];if(a.isStream(m))e.appendChild(s["default"],{_morph:c.morph,_context:i.get(e,"context"),conditionStream:m,truthyTemplate:d,falsyTemplate:f,helperName:r});else{var p=m?d:f;if(p)return p.render(e,h,c.morph.contextualElement)}}function m(e,t,i,a){return r["default"](n["default"](a[0]),t?a[2]:a[1],t?a[1]:a[2])}e.ifHelper=u,e.unlessHelper=l}),e("ember-htmlbars/helpers/input",["exports","ember-views/views/checkbox","ember-views/views/text_field","ember-metal/streams/utils","ember-metal/core"],function(e,t,r,n,i){"use strict";function a(e,i,a,s){var o,u=i.on;o=n.read(i.type),"checkbox"===o?(delete i.type,s.helpers.view.helperFunction.call(this,[t["default"]],i,a,s)):(delete i.on,i.onEvent=u||"enter",s.helpers.view.helperFunction.call(this,[r["default"]],i,a,s))}e.inputHelper=a}),e("ember-htmlbars/helpers/loc",["exports","ember-metal/core","ember-runtime/system/string","ember-metal/streams/utils"],function(e,t,r,n){"use strict";function i(e,t,n,i){return r.loc.apply(i.data.view,e)}e.locHelper=i}),e("ember-htmlbars/helpers/log",["exports","ember-metal/logger","ember-metal/streams/utils"],function(e,t,r){"use strict";function n(e,n,i,a){for(var s=t["default"].log,o=[],u=0;u<e.length;u++)o.push(r.read(e[u]));s.apply(s,o)}e.logHelper=n}),e("ember-htmlbars/helpers/partial",["exports","ember-metal/property_get","ember-metal/streams/utils","ember-views/views/bound_partial_view","ember-views/system/lookup_partial"],function(e,t,r,n,i){"use strict";function a(e,a,s,o){var u=o.data.view,l=e[0];if(!r.isStream(l)){var c=i["default"](u,l);return c.render(u,o,s.morph.contextualElement)}u.appendChild(n["default"],{_morph:s.morph,_context:t.get(u,"context"),templateNameStream:l,helperName:s.helperName||"partial"})}e.partialHelper=a}),e("ember-htmlbars/helpers/template",["exports","ember-metal/core"],function(e,t){"use strict";function r(e,t,r,n){return r.helperName=r.helperName||"template",n.helpers.partial.helperFunction.call(this,e,t,r,n)}e.templateHelper=r}),e("ember-htmlbars/helpers/text_area",["exports","ember-metal/core","ember-views/views/text_area"],function(e,t,r){"use strict";function n(e,t,n,i){return i.helpers.view.helperFunction.call(this,[r["default"]],t,n,i)}e.textareaHelper=n}),e("ember-htmlbars/helpers/unbound",["exports","ember-metal/error","ember-metal/mixin","ember-metal/streams/utils","ember-htmlbars/system/lookup-helper"],function(e,t,r,n,i){"use strict";function a(e,r,a,u){if(1===e.length)return n.read(e[0]);a.helperName=a.helperName||"unbound";var l=u.data.view,c=e[0]._label,h=i["default"](c,l,u);if(!h)throw new t["default"]("HTMLBars error: Could not find component or helper named "+c+".");return h.helperFunction.call(this,s(e),o(r,l),a,u)}function s(e){for(var t=e.length,r=new Array(t-1),i=1;t>i;i++)r[i-1]=n.read(e[i]);return r}function o(e,t){var i={};for(var a in e)if(r.IS_BINDING.test(a)){var s=e[a];"string"==typeof s&&(s=t.getStream(s)),i[a.slice(0,-7)]=n.read(s)}else i[a]=n.read(e[a]);return i}e.unboundHelper=a}),e("ember-htmlbars/helpers/view",["exports","ember-metal/core","ember-metal/streams/utils","ember-views/streams/utils","ember-views/views/view","ember-htmlbars/system/merge-view-bindings","ember-htmlbars/system/append-templated-view"],function(e,t,r,n,i,a,s){"use strict";function o(e,t,o,u){var l,c=u.data.view,h=c.container||r.read(c._keywords.view).container;l=0===e.length?h?h.lookupFactory("view:toplevel"):i["default"]:n.readViewFactory(e[0],h);var m={helperName:o.helperName||"view"};o.template&&(m.template=o.template),a["default"](c,m,t),s["default"](c,o.morph,l,m)}e.viewHelper=o}),e("ember-htmlbars/helpers/with",["exports","ember-metal/core","ember-views/views/with_view"],function(e,t,r){"use strict";function n(e,t,n,i){var a,s=i.data.view;a=n.template.blockParams?!0:!1,s.appendChild(r["default"],{_morph:n.morph,withValue:e[0],preserveContext:a,previousContext:s.get("context"),controllerName:t.controller,mainTemplate:n.template,inverseTemplate:n.inverse,helperName:n.helperName||"with"})}e.withHelper=n}),e("ember-htmlbars/helpers/yield",["exports","ember-metal/core","ember-metal/property_get"],function(e,t,r){"use strict";function n(e,t,n,i){for(var a=i.data.view,s=a;s&&!r.get(s,"layout");)s=s._contextView?s._contextView:s._parentView;return s._yield(a,i,n.morph,e)}e.yieldHelper=n}),e("ember-htmlbars/hooks/attribute",["exports","ember-views/attr_nodes/attr_node","ember-metal/error","ember-metal/streams/utils","morph-attr/sanitize-attribute-value"],function(e,t,r,n,i){"use strict";function a(e,a,o,u,l){if(s){var c=new t["default"](u,l);c._morph=a,e.data.view.appendChild(c)}else{if(n.isStream(l))throw new r["default"]("Bound attributes are not yet supported in Ember.js");var h=i["default"](e.dom,o,u,l);e.dom.setProperty(o,u,h)}}var s=!1;s=!0,e["default"]=a}),e("ember-htmlbars/hooks/block",["exports","ember-views/views/simple_bound_view","ember-metal/streams/utils","ember-htmlbars/system/lookup-helper"],function(e,t,r,n){"use strict";function i(e,i,a,s,o,u,l,c){var h=n["default"](s,a,e),m={morph:i,template:l,inverse:c,isBlock:!0},d=h.helperFunction.call(void 0,o,u,m,e);r.isStream(d)?t.appendSimpleBoundView(a,i,d):i.setContent(d);

}e["default"]=i}),e("ember-htmlbars/hooks/component",["exports","ember-metal/core","ember-htmlbars/system/lookup-helper"],function(e,t,r){"use strict";function n(e,t,n,i,a,s){var o=r["default"](i,n,e);return o.helperFunction.call(void 0,[],a,{morph:t,template:s},e)}e["default"]=n}),e("ember-htmlbars/hooks/concat",["exports","ember-metal/streams/utils"],function(e,t){"use strict";function r(e,r){return t.concat(r,"")}e["default"]=r}),e("ember-htmlbars/hooks/content",["exports","ember-views/views/simple_bound_view","ember-metal/streams/utils","ember-htmlbars/system/lookup-helper"],function(e,t,r,n){"use strict";function i(e,i,a,s){var o,u=n["default"](s,a,e);if(u){var l={morph:i,isInline:!0};o=u.helperFunction.call(void 0,[],{},l,e)}else o=a.getStream(s);r.isStream(o)?t.appendSimpleBoundView(a,i,o):i.setContent(o)}e["default"]=i}),e("ember-htmlbars/hooks/element",["exports","ember-metal/core","ember-metal/streams/utils","ember-htmlbars/system/lookup-helper"],function(e,t,r,n){"use strict";function i(e,t,i,a,s,o){var u,l=n["default"](a,i,e);if(l){var c={element:t};u=l.helperFunction.call(void 0,s,o,c,e)}else u=i.getStream(a);var h=r.read(u);if(h)for(var m=h.toString().split(/\s+/),d=0,f=m.length;f>d;d++){var p=m[d].split("="),v=p[0],g=p[1];g=g.replace(/^['"]/,"").replace(/['"]$/,""),e.dom.setAttribute(t,v,g)}}e["default"]=i}),e("ember-htmlbars/hooks/get",["exports"],function(e){"use strict";function t(e,t,r){return t.getStream(r)}e["default"]=t}),e("ember-htmlbars/hooks/inline",["exports","ember-views/views/simple_bound_view","ember-metal/streams/utils","ember-htmlbars/system/lookup-helper"],function(e,t,r,n){"use strict";function i(e,i,a,s,o,u){var l=n["default"](s,a,e),c=l.helperFunction.call(void 0,o,u,{morph:i},e);r.isStream(c)?t.appendSimpleBoundView(a,i,c):i.setContent(c)}e["default"]=i}),e("ember-htmlbars/hooks/set",["exports"],function(e){"use strict";function t(e,t,r,n){t._keywords[r]=n}e["default"]=t}),e("ember-htmlbars/hooks/subexpr",["exports","ember-htmlbars/system/lookup-helper"],function(e,t){"use strict";function r(e,r,n,i,a){var s=t["default"](n,r,e),o={isInline:!0};return s.helperFunction.call(void 0,i,a,o,e)}e["default"]=r}),e("ember-htmlbars/system/append-templated-view",["exports","ember-metal/core","ember-metal/property_get","ember-views/views/view"],function(e,t,r,n){"use strict";function i(e,t,i,a){var s;s=n["default"].detectInstance(i)?i:i.proto();var o=!s.controller;return s.controller&&s.controller.isDescriptor&&(o=!0),!o||s.controllerBinding||a.controller||a.controllerBinding||(a._context=r.get(e,"context")),a._morph=t,e.appendChild(i,a)}e["default"]=i}),e("ember-htmlbars/system/bootstrap",["exports","ember-metal/core","ember-views/component_lookup","ember-views/system/jquery","ember-metal/error","ember-runtime/system/lazy_load","ember-template-compiler/system/compile","ember-metal/environment"],function(e,t,r,n,i,a,s,o){"use strict";function u(e){var r='script[type="text/x-handlebars"], script[type="text/x-raw-handlebars"]';n["default"](r,e).each(function(){var e=n["default"](this),r="text/x-raw-handlebars"===e.attr("type")?n["default"].proxy(Handlebars.compile,Handlebars):s["default"],a=e.attr("data-template-name")||e.attr("id")||"application",o=r(e.html());if(void 0!==t["default"].TEMPLATES[a])throw new i["default"]('Template named "'+a+'" already exists.');t["default"].TEMPLATES[a]=o,e.remove()})}function l(){u(n["default"](document))}function c(e){e.register("component-lookup:main",r["default"])}a.onLoad("Ember.Application",function(e){e.initializer({name:"domTemplates",initialize:o["default"].hasDOM?l:function(){}}),e.initializer({name:"registerComponentLookup",after:"domTemplates",initialize:c})}),e["default"]=u}),e("ember-htmlbars/system/helper",["exports"],function(e){"use strict";function t(e){this.helperFunction=e,this.isHelper=!0,this.isHTMLBars=!0}e["default"]=t}),e("ember-htmlbars/system/lookup-helper",["exports","ember-metal/core","ember-metal/cache","ember-htmlbars/system/make-view-helper","ember-htmlbars/compat/helper"],function(e,t,r,n,i){"use strict";function a(e,t,r){var a=r.helpers[e];if(a)return a;var o=t.container;if(o&&!s.get(e)){var u="helper:"+e;if(a=o.lookup(u),!a){var l=o.lookup("component-lookup:main"),c=l.lookupFactory(e,o);c&&(a=n["default"](c),o._registry.register(u,a))}return a&&!a.isHTMLBars&&(a=new i["default"](a),o._registry.unregister(u),o._registry.register(u,a)),a}}var s=new r["default"](1e3,function(e){return-1===e.indexOf("-")});e["default"]=a,e.ISNT_HELPER_CACHE=s}),e("ember-htmlbars/system/make-view-helper",["exports","ember-metal/core","ember-htmlbars/system/helper"],function(e,t,r){"use strict";function n(e){function t(t,r,n,i){return i.helpers.view.helperFunction.call(this,[e],r,n,i)}return new r["default"](t)}e["default"]=n}),e("ember-htmlbars/system/make_bound_helper",["exports","ember-metal/core","ember-htmlbars/system/helper","ember-metal/streams/stream","ember-metal/streams/utils"],function(e,t,r,n,i){"use strict";function a(e){function t(t,r,a,s){function o(){return e.call(c,i.readArray(t),i.readHash(r),a,s)}var u,l,c=s.data.view,h=t.length,m=i.scanArray(t)||i.scanHash(r);if(m){for(var d=new n["default"](o),f=0;h>f;f++)u=t[f],i.subscribe(u,d.notify,d);for(l in r)u=r[l],i.subscribe(u,d.notify,d);return d}return o()}return new r["default"](t)}e["default"]=a}),e("ember-htmlbars/system/merge-view-bindings",["exports","ember-metal/core","ember-metal/mixin","ember-metal/streams/simple","ember-metal/streams/utils","ember-views/streams/class_name_binding"],function(e,t,r,n,i,a){"use strict";function s(e,t,r){return o(e,t,r),u(e,t,r),t}function o(e,t,n){for(var a in n)if("id"!==a&&"tag"!==a&&"class"!==a&&"classBinding"!==a&&"classNameBindings"!==a&&"attributeBindings"!==a){var s=n[a];r.IS_BINDING.test(a)?"string"==typeof s?t[a]=e._getBindingForStream(s):i.isStream(s)?t[a]=e._getBindingForStream(s):t[a]=s:i.isStream(s)?t[a+"Binding"]=e._getBindingForStream(s):t[a]=s}}function u(e,t,r){r.id&&(t.id=t.elementId=i.read(r.id)),r.tag&&(t.tagName=i.read(r.tag));var s=[];if(r["class"]&&("string"==typeof r["class"]?t.classNames=r["class"].split(" "):s.push(r["class"]._label?r["class"]._label:r["class"])),r.classBinding&&l.apply(s,r.classBinding.split(" ")),r.classNameBindings&&l.apply(s,r.classNameBindings.split(" ")),s.length>0){t.classNameBindings=s;for(var o=0;o<s.length;o++){var u,c=s[o];u=i.isStream(c)?c:a.streamifyClassNameBinding(e,c),i.isStream(u)?s[o]=u:s[o]=new n["default"](u)}}}var l=Array.prototype.push;e["default"]=s}),e("ember-htmlbars/system/render-view",["exports","ember-metal/core","ember-metal/property_get","ember-htmlbars/env"],function(e,t,r,n){"use strict";function i(e,t,r){if(r){var n;n=r.isHTMLBars?a(e,t,r):s(e,t,r),void 0!==n&&t.push(n)}}function a(e,t,r){var i=t.innerContextualElement(),a=e._blockArguments,s={view:this,dom:e.renderer._dom,hooks:n["default"].hooks,helpers:n["default"].helpers,useFragmentCache:n["default"].useFragmentCache,data:{view:e,buffer:t}};return r.render(e,s,i,a)}function s(e,t,n){var i=r.get(e,"context"),a={data:{view:e,buffer:t}};return n(i,a)}e["default"]=i}),e("ember-htmlbars/templates/component",["exports","ember-template-compiler/system/template"],function(e,t){"use strict";e["default"]=t["default"](function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(e){var t=e.createDocumentFragment(),r=e.createComment("");return e.appendChild(t,r),t},render:function(e,t,r){var n=t.dom,i=t.hooks,a=i.content;n.detectNamespace(r);var s;t.useFragmentCache&&n.canClone?(null===this.cachedFragment&&(s=this.build(n),this.hasRendered?this.cachedFragment=s:this.hasRendered=!0),this.cachedFragment&&(s=n.cloneNode(this.cachedFragment,!0))):s=this.build(n);var o=n.createMorphAt(s,0,0,r);return n.insertBoundary(s,null),n.insertBoundary(s,0),a(t,o,e,"yield"),s}}}())}),e("ember-htmlbars/templates/empty",["exports","ember-template-compiler/system/template"],function(e,t){"use strict";e["default"]=t["default"](function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(e){var t=e.createDocumentFragment();return t},render:function(e,t,r){var n=t.dom;n.detectNamespace(r);var i;return t.useFragmentCache&&n.canClone?(null===this.cachedFragment&&(i=this.build(n),this.hasRendered?this.cachedFragment=i:this.hasRendered=!0),this.cachedFragment&&(i=n.cloneNode(this.cachedFragment,!0))):i=this.build(n),i}}}())}),e("ember-htmlbars/templates/link-to-escaped",["exports","ember-template-compiler/system/template"],function(e,t){"use strict";e["default"]=t["default"](function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(e){var t=e.createDocumentFragment(),r=e.createComment("");return e.appendChild(t,r),t},render:function(e,t,r){var n=t.dom,i=t.hooks,a=i.content;n.detectNamespace(r);var s;t.useFragmentCache&&n.canClone?(null===this.cachedFragment&&(s=this.build(n),this.hasRendered?this.cachedFragment=s:this.hasRendered=!0),this.cachedFragment&&(s=n.cloneNode(this.cachedFragment,!0))):s=this.build(n);var o=n.createMorphAt(s,0,0,r);return n.insertBoundary(s,null),n.insertBoundary(s,0),a(t,o,e,"linkTitle"),s}}}())}),e("ember-htmlbars/templates/link-to-unescaped",["exports","ember-template-compiler/system/template"],function(e,t){"use strict";e["default"]=t["default"](function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(e){var t=e.createDocumentFragment(),r=e.createComment("");return e.appendChild(t,r),t},render:function(e,t,r){var n=t.dom,i=t.hooks,a=i.content;n.detectNamespace(r);var s;t.useFragmentCache&&n.canClone?(null===this.cachedFragment&&(s=this.build(n),this.hasRendered?this.cachedFragment=s:this.hasRendered=!0),this.cachedFragment&&(s=n.cloneNode(this.cachedFragment,!0))):s=this.build(n);var o=n.createUnsafeMorphAt(s,0,0,r);return n.insertBoundary(s,null),n.insertBoundary(s,0),a(t,o,e,"linkTitle"),s}}}())}),e("ember-htmlbars/templates/select-option",["exports","ember-template-compiler/system/template"],function(e,t){"use strict";e["default"]=t["default"](function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(e){var t=e.createDocumentFragment(),r=e.createComment("");return e.appendChild(t,r),t},render:function(e,t,r){var n=t.dom,i=t.hooks,a=i.content;n.detectNamespace(r);var s;t.useFragmentCache&&n.canClone?(null===this.cachedFragment&&(s=this.build(n),this.hasRendered?this.cachedFragment=s:this.hasRendered=!0),this.cachedFragment&&(s=n.cloneNode(this.cachedFragment,!0))):s=this.build(n);var o=n.createMorphAt(s,0,0,r);return n.insertBoundary(s,null),n.insertBoundary(s,0),a(t,o,e,"view.label"),s}}}())}),e("ember-htmlbars/templates/select",["exports","ember-template-compiler/system/template"],function(e,t){"use strict";e["default"]=t["default"](function(){var e=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(e){var t=e.createDocumentFragment(),r=e.createElement("option");e.setAttribute(r,"value","");var n=e.createComment("");return e.appendChild(r,n),e.appendChild(t,r),t},render:function(e,t,r){var n=t.dom,i=t.hooks,a=i.content;n.detectNamespace(r);var s;t.useFragmentCache&&n.canClone?(null===this.cachedFragment&&(s=this.build(n),this.hasRendered?this.cachedFragment=s:this.hasRendered=!0),this.cachedFragment&&(s=n.cloneNode(this.cachedFragment,!0))):s=this.build(n);var o=n.createMorphAt(n.childAt(s,[0]),0,0);return a(t,o,e,"view.prompt"),s}}}(),t=function(){var e=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(e){var t=e.createDocumentFragment(),r=e.createComment("");return e.appendChild(t,r),t},render:function(e,t,r){var n=t.dom,i=t.hooks,a=i.get,s=i.inline;n.detectNamespace(r);var o;t.useFragmentCache&&n.canClone?(null===this.cachedFragment&&(o=this.build(n),this.hasRendered?this.cachedFragment=o:this.hasRendered=!0),this.cachedFragment&&(o=n.cloneNode(this.cachedFragment,!0))):o=this.build(n);var u=n.createMorphAt(o,0,0,r);return n.insertBoundary(o,null),n.insertBoundary(o,0),s(t,u,e,"view",[a(t,e,"view.groupView")],{content:a(t,e,"group.content"),label:a(t,e,"group.label")}),o}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(e){var t=e.createDocumentFragment(),r=e.createComment("");return e.appendChild(t,r),t},render:function(t,r,n){var i=r.dom,a=r.hooks,s=a.get,o=a.block;i.detectNamespace(n);var u;r.useFragmentCache&&i.canClone?(null===this.cachedFragment&&(u=this.build(i),this.hasRendered?this.cachedFragment=u:this.hasRendered=!0),this.cachedFragment&&(u=i.cloneNode(this.cachedFragment,!0))):u=this.build(i);var l=i.createMorphAt(u,0,0,n);return i.insertBoundary(u,null),i.insertBoundary(u,0),o(r,l,t,"each",[s(r,t,"view.groupedContent")],{keyword:"group"},e,null),u}}}(),r=function(){var e=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(e){var t=e.createDocumentFragment(),r=e.createComment("");return e.appendChild(t,r),t},render:function(e,t,r){var n=t.dom,i=t.hooks,a=i.get,s=i.inline;n.detectNamespace(r);var o;t.useFragmentCache&&n.canClone?(null===this.cachedFragment&&(o=this.build(n),this.hasRendered?this.cachedFragment=o:this.hasRendered=!0),this.cachedFragment&&(o=n.cloneNode(this.cachedFragment,!0))):o=this.build(n);var u=n.createMorphAt(o,0,0,r);return n.insertBoundary(o,null),n.insertBoundary(o,0),s(t,u,e,"view",[a(t,e,"view.optionView")],{content:a(t,e,"item")}),o}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(e){var t=e.createDocumentFragment(),r=e.createComment("");return e.appendChild(t,r),t},render:function(t,r,n){var i=r.dom,a=r.hooks,s=a.get,o=a.block;i.detectNamespace(n);var u;r.useFragmentCache&&i.canClone?(null===this.cachedFragment&&(u=this.build(i),this.hasRendered?this.cachedFragment=u:this.hasRendered=!0),this.cachedFragment&&(u=i.cloneNode(this.cachedFragment,!0))):u=this.build(i);var l=i.createMorphAt(u,0,0,n);return i.insertBoundary(u,null),i.insertBoundary(u,0),o(r,l,t,"each",[s(r,t,"view.content")],{keyword:"item"},e,null),u}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(e){var t=e.createDocumentFragment(),r=e.createComment("");e.appendChild(t,r);var r=e.createComment("");e.appendChild(t,r);var r=e.createTextNode("\n");return e.appendChild(t,r),t},render:function(n,i,a){var s=i.dom,o=i.hooks,u=o.get,l=o.block;s.detectNamespace(a);var c;i.useFragmentCache&&s.canClone?(null===this.cachedFragment&&(c=this.build(s),this.hasRendered?this.cachedFragment=c:this.hasRendered=!0),this.cachedFragment&&(c=s.cloneNode(this.cachedFragment,!0))):c=this.build(s);var h=s.createMorphAt(c,0,0,a),m=s.createMorphAt(c,1,1,a);return s.insertBoundary(c,0),l(i,h,n,"if",[u(i,n,"view.prompt")],{},e,null),l(i,m,n,"if",[u(i,n,"view.optionGroupPath")],{},t,r),c}}}())}),e("ember-htmlbars/utils/string",["exports","htmlbars-util","ember-runtime/system/string"],function(e,t,r){"use strict";function n(e){return null===e||void 0===e?"":("string"!=typeof e&&(e=""+e),new t.SafeString(e))}e.htmlSafe=n,r["default"].htmlSafe=n,(i.EXTEND_PROTOTYPES===!0||i.EXTEND_PROTOTYPES.String)&&(String.prototype.htmlSafe=function(){return n(this)}),e.SafeString=t.SafeString,e.escapeExpression=t.escapeExpression}),e("ember-metal-views",["exports","ember-metal-views/renderer"],function(e,t){"use strict";e.Renderer=t["default"]}),e("ember-metal-views/renderer",["exports","dom-helper","ember-metal/environment"],function(e,t,r){"use strict";function n(e,t){this._uuid=0,this._views=new Array(2e3),this._queue=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this._parents=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this._elements=new Array(17),this._inserts={},this._dom=e||l,this._destinedForDOM=void 0===t?!0:t}function i(e,t,r){var n=this._views;n[0]=e;var i=0,a=1,s=t?t._level+1:0,o=null==t?e:t._root,u=!!o._morph,l=this._queue;l[0]=0;for(var c,h,m,d=1,f=-1,p=this._parents,v=t||null,g=this._elements,b=null,y=null,_=0,w=e;d;){if(g[_]=b,w._morph||(w._morph=null),w._root=o,this.uuid(w),w._level=s+_,w._elementCreated&&this.remove(w,!1,!0),this.willCreateElement(w),y=w._morph&&w._morph.contextualElement,!y&&v&&v._childViewsMorph&&(y=v._childViewsMorph.contextualElement),!y&&w._didCreateElementWithoutMorph&&(y="undefined"!=typeof document?document.body:null),b=this.createElement(w,y),p[_++]=f,f=i,v=w,l[d++]=i,c=this.childViews(w))for(h=c.length-1;h>=0;h--)m=c[h],i=a++,n[i]=m,l[d++]=i,w=m;for(i=l[--d],w=n[i];f===i;){if(_--,w._elementCreated=!0,this.didCreateElement(w),u&&this.willInsertElement(w),0===_){d--;break}f=p[_],v=-1===f?t:n[f],this.insertElement(w,v,b,null),i=l[--d],w=n[i],b=g[_],g[_]=null}}for(this.insertElement(w,t,b,r),h=a-1;h>=0;h--)u&&(n[h]._elementInserted=!0,this.didInsertElement(n[h])),n[h]=null;return b}function a(e,t,r){var n=this.uuid(e);if(this._inserts[n]&&(this.cancelRender(this._inserts[n]),this._inserts[n]=void 0),e._elementCreated){var i,a,s,o,u,l,c,h=[],m=[],d=e._morph;for(h.push(e),i=0;i<h.length;i++)if(s=h[i],o=!t&&s._childViewsMorph?h:m,this.beforeRemove(h[i]),u=this.childViews(s))for(l=0,c=u.length;c>l;l++)o.push(u[l]);for(i=0;i<m.length;i++)if(s=m[i],this.beforeRemove(m[i]),u=this.childViews(s))for(l=0,c=u.length;c>l;l++)m.push(u[l]);for(d&&!r&&d.destroy(),i=0,a=h.length;a>i;i++)this.afterRemove(h[i],!1);for(i=0,a=m.length;a>i;i++)this.afterRemove(m[i],!0);r&&(e._morph=d)}}function s(e,t,r,n){null!==r&&void 0!==r&&(e._morph?e._morph.setContent(r):t&&(e._morph=t._childViewsMorph.insertContentBeforeMorph(r,n)))}function o(e){e._elementCreated&&this.willDestroyElement(e),e._elementInserted&&this.willRemoveElement(e)}function u(e,t){e._elementInserted=!1,e._morph=null,e._childViewsMorph=null,e._elementCreated&&(e._elementCreated=!1,this.didDestroyElement(e)),t&&this.destroyView(e)}var l=r["default"].hasDOM?new t["default"]:null;n.prototype.uuid=function(e){return void 0===e._uuid&&(e._uuid=++this._uuid,e._renderer=this),e._uuid},n.prototype.scheduleInsert=function(e,t){if(e._morph||e._elementCreated)throw new Error("You cannot insert a View that has already been rendered");e._morph=t;var r=this.uuid(e);this._inserts[r]=this.scheduleRender(this,function(){this._inserts[r]=null,this.renderTree(e)})},n.prototype.appendTo=function(e,t){var r=this._dom.appendMorph(t);this.scheduleInsert(e,r)},n.prototype.appendAttrTo=function(e,t,r){var n=this._dom.createAttrMorph(t,r);this.scheduleInsert(e,n)},n.prototype.replaceIn=function(e,t){var r;r=t.firstNode?this._dom.createMorph(t,t.firstNode,t.lastNode):this._dom.appendMorph(t),this.scheduleInsert(e,r)},n.prototype.remove=a,n.prototype.removeAndDestroy=function(e){this.remove(e,!0)},n.prototype.renderTree=i,n.prototype.insertElement=s,n.prototype.beforeRemove=o,n.prototype.afterRemove=u;var c=function(){};n.prototype.willCreateElement=c,n.prototype.createElement=c,n.prototype.didCreateElement=c,n.prototype.willInsertElement=c,n.prototype.didInsertElement=c,n.prototype.willRemoveElement=c,n.prototype.willDestroyElement=c,n.prototype.didDestroyElement=c,n.prototype.destroyView=c,n.prototype.childViews=c,e["default"]=n}),e("ember-metal",["exports","ember-metal/core","ember-metal/merge","ember-metal/instrumentation","ember-metal/utils","ember-metal/error","ember-metal/enumerable_utils","ember-metal/cache","ember-metal/platform/define_property","ember-metal/platform/create","ember-metal/array","ember-metal/logger","ember-metal/property_get","ember-metal/events","ember-metal/observer_set","ember-metal/property_events","ember-metal/properties","ember-metal/property_set","ember-metal/map","ember-metal/get_properties","ember-metal/set_properties","ember-metal/watch_key","ember-metal/chains","ember-metal/watch_path","ember-metal/watching","ember-metal/expand_properties","ember-metal/computed","ember-metal/alias","ember-metal/computed_macros","ember-metal/observer","ember-metal/mixin","ember-metal/binding","ember-metal/run_loop","ember-metal/libraries","ember-metal/is_none","ember-metal/is_empty","ember-metal/is_blank","ember-metal/is_present","ember-metal/keys","backburner","ember-metal/streams/utils","ember-metal/streams/stream"],function(e,r,n,i,a,s,o,u,l,c,h,m,d,f,p,v,g,b,y,_,w,x,C,E,O,P,S,A,N,T,k,M,I,V,j,R,D,F,L,B,H,z){"use strict";S.computed.empty=N.empty,S.computed.notEmpty=N.notEmpty,S.computed.none=N.none,S.computed.not=N.not,S.computed.bool=N.bool,S.computed.match=N.match,S.computed.equal=N.equal,S.computed.gt=N.gt,S.computed.gte=N.gte,S.computed.lt=N.lt,S.computed.lte=N.lte,S.computed.alias=A["default"],S.computed.oneWay=N.oneWay,S.computed.reads=N.oneWay,S.computed.readOnly=N.readOnly,S.computed.defaultTo=N.defaultTo,S.computed.deprecatingAlias=N.deprecatingAlias,S.computed.and=N.and,S.computed.or=N.or,S.computed.any=N.any,S.computed.collect=N.collect;var q=r["default"].Instrumentation={};q.instrument=i.instrument,q.subscribe=i.subscribe,q.unsubscribe=i.unsubscribe,q.reset=i.reset,r["default"].instrument=i.instrument,r["default"].subscribe=i.subscribe,r["default"]._Cache=u["default"],r["default"].generateGuid=a.generateGuid,r["default"].GUID_KEY=a.GUID_KEY,r["default"].create=c["default"],r["default"].keys=L["default"],r["default"].platform={defineProperty:g.defineProperty,hasPropertyAccessors:l.hasPropertyAccessors};var U=r["default"].ArrayPolyfills={};U.map=h.map,U.forEach=h.forEach,U.filter=h.filter,U.indexOf=h.indexOf,r["default"].Error=s["default"],r["default"].guidFor=a.guidFor,r["default"].META_DESC=a.META_DESC,r["default"].EMPTY_META=a.EMPTY_META,r["default"].meta=a.meta,r["default"].getMeta=a.getMeta,r["default"].setMeta=a.setMeta,r["default"].metaPath=a.metaPath,r["default"].inspect=a.inspect,r["default"].typeOf=a.typeOf,r["default"].tryCatchFinally=a.tryCatchFinally,r["default"].isArray=a.isArray,r["default"].makeArray=a.makeArray,r["default"].canInvoke=a.canInvoke,r["default"].tryInvoke=a.tryInvoke,r["default"].tryFinally=a.tryFinally,r["default"].wrap=a.wrap,r["default"].apply=a.apply,r["default"].applyStr=a.applyStr,r["default"].uuid=a.uuid,r["default"].Logger=m["default"],r["default"].get=d.get,r["default"].getWithDefault=d.getWithDefault,r["default"].normalizeTuple=d.normalizeTuple,r["default"]._getPath=d._getPath,r["default"].EnumerableUtils=o["default"],r["default"].on=f.on,r["default"].addListener=f.addListener,r["default"].removeListener=f.removeListener,r["default"]._suspendListener=f.suspendListener,r["default"]._suspendListeners=f.suspendListeners,r["default"].sendEvent=f.sendEvent,r["default"].hasListeners=f.hasListeners,r["default"].watchedEvents=f.watchedEvents,r["default"].listenersFor=f.listenersFor,r["default"].accumulateListeners=f.accumulateListeners,r["default"]._ObserverSet=p["default"],r["default"].propertyWillChange=v.propertyWillChange,r["default"].propertyDidChange=v.propertyDidChange,r["default"].overrideChains=v.overrideChains,r["default"].beginPropertyChanges=v.beginPropertyChanges,r["default"].endPropertyChanges=v.endPropertyChanges,r["default"].changeProperties=v.changeProperties,r["default"].Descriptor=g.Descriptor,r["default"].defineProperty=g.defineProperty,r["default"].set=b.set,r["default"].trySet=b.trySet,r["default"].OrderedSet=y.OrderedSet,r["default"].Map=y.Map,r["default"].MapWithDefault=y.MapWithDefault,r["default"].getProperties=_["default"],r["default"].setProperties=w["default"],r["default"].watchKey=x.watchKey,r["default"].unwatchKey=x.unwatchKey,r["default"].flushPendingChains=C.flushPendingChains,r["default"].removeChainWatcher=C.removeChainWatcher,r["default"]._ChainNode=C.ChainNode,r["default"].finishChains=C.finishChains,r["default"].watchPath=E.watchPath,r["default"].unwatchPath=E.unwatchPath,r["default"].watch=O.watch,r["default"].isWatching=O.isWatching,r["default"].unwatch=O.unwatch,r["default"].rewatch=O.rewatch,r["default"].destroy=O.destroy,r["default"].expandProperties=P["default"],r["default"].ComputedProperty=S.ComputedProperty,r["default"].computed=S.computed,r["default"].cacheFor=S.cacheFor,r["default"].addObserver=T.addObserver,r["default"].observersFor=T.observersFor,r["default"].removeObserver=T.removeObserver,r["default"].addBeforeObserver=T.addBeforeObserver,r["default"]._suspendBeforeObserver=T._suspendBeforeObserver,r["default"]._suspendBeforeObservers=T._suspendBeforeObservers,r["default"]._suspendObserver=T._suspendObserver,r["default"]._suspendObservers=T._suspendObservers,r["default"].beforeObserversFor=T.beforeObserversFor,r["default"].removeBeforeObserver=T.removeBeforeObserver,r["default"].IS_BINDING=k.IS_BINDING,r["default"].required=k.required,r["default"].aliasMethod=k.aliasMethod,r["default"].observer=k.observer,r["default"].immediateObserver=k.immediateObserver,r["default"].beforeObserver=k.beforeObserver,r["default"].mixin=k.mixin,r["default"].Mixin=k.Mixin,r["default"].oneWay=M.oneWay,r["default"].bind=M.bind,r["default"].Binding=M.Binding,r["default"].isGlobalPath=M.isGlobalPath,r["default"].run=I["default"],r["default"].Backburner=B["default"],r["default"].libraries=new V["default"],r["default"].libraries.registerCoreLibrary("Ember",r["default"].VERSION),r["default"].isNone=j["default"],r["default"].isEmpty=R["default"],r["default"].isBlank=D["default"],r["default"].isPresent=F["default"],r["default"].merge=n["default"],r["default"].onerror=null,r["default"].__loader.registry["ember-debug"]&&t("ember-debug"),e["default"]=r["default"]}),e("ember-metal/alias",["exports","ember-metal/property_get","ember-metal/property_set","ember-metal/core","ember-metal/error","ember-metal/properties","ember-metal/computed","ember-metal/platform/create","ember-metal/utils","ember-metal/dependent_keys"],function(e,t,r,n,i,a,s,o,u,l){"use strict";function c(e){return new h(e)}function h(e){this.isDescriptor=!0,this.altKey=e,this._dependentKeys=[e]}function m(e,t,r){throw new i["default"]('Cannot set read-only property "'+t+'" on object: '+u.inspect(e))}function d(e,t,n){return a.defineProperty(e,t,null),r.set(e,t,n)}e.AliasedProperty=h,e["default"]=c,h.prototype=o["default"](a.Descriptor.prototype),h.prototype.get=function(e,r){return t.get(e,this.altKey)},h.prototype.set=function(e,t,n){return r.set(e,this.altKey,n)},h.prototype.willWatch=function(e,t){l.addDependentKeys(this,e,t,u.meta(e))},h.prototype.didUnwatch=function(e,t){l.removeDependentKeys(this,e,t,u.meta(e))},h.prototype.setup=function(e,t){var r=u.meta(e);r.watching[t]&&l.addDependentKeys(this,e,t,r)},h.prototype.teardown=function(e,t){var r=u.meta(e);r.watching[t]&&l.removeDependentKeys(this,e,t,r)},h.prototype.readOnly=function(){return this.set=m,this},h.prototype.oneWay=function(){return this.set=d,this},h.prototype._meta=void 0,h.prototype.meta=s.ComputedProperty.prototype.meta}),e("ember-metal/array",["exports"],function(e){"use strict";var t=Array.prototype,r=function(e){return e&&Function.prototype.toString.call(e).indexOf("[native code]")>-1},n=function(e,t){return r(e)?e:t},a=n(t.map,function(e){if(void 0===this||null===this||"function"!=typeof e)throw new TypeError;for(var t=Object(this),r=t.length>>>0,n=new Array(r),i=arguments[1],a=0;r>a;a++)a in t&&(n[a]=e.call(i,t[a],a,t));return n}),s=n(t.forEach,function(e){if(void 0===this||null===this||"function"!=typeof e)throw new TypeError;for(var t=Object(this),r=t.length>>>0,n=arguments[1],i=0;r>i;i++)i in t&&e.call(n,t[i],i,t)}),o=n(t.indexOf,function(e,t){null===t||void 0===t?t=0:0>t&&(t=Math.max(0,this.length+t));for(var r=t,n=this.length;n>r;r++)if(this[r]===e)return r;return-1}),u=n(t.lastIndexOf,function(e,t){var r,n=this.length;for(t=void 0===t?n-1:0>t?Math.ceil(t):Math.floor(t),0>t&&(t+=n),r=t;r>=0;r--)if(this[r]===e)return r;return-1}),l=n(t.filter,function(e,t){var r,n,i=[],a=this.length;for(r=0;a>r;r++)this.hasOwnProperty(r)&&(n=this[r],e.call(t,n,r,this)&&i.push(n));return i});i.SHIM_ES5&&(t.map=t.map||a,t.forEach=t.forEach||s,t.filter=t.filter||l,t.indexOf=t.indexOf||o,t.lastIndexOf=t.lastIndexOf||u),e.map=a,e.forEach=s,e.filter=l,e.indexOf=o,e.lastIndexOf=u}),e("ember-metal/binding",["exports","ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/utils","ember-metal/observer","ember-metal/run_loop","ember-metal/path_cache"],function(e,t,r,n,i,a,s,o){"use strict";function u(e,n){return r.get(o.isGlobal(n)?t["default"].lookup:e,n)}function l(e,t){this._direction=void 0,this._from=t,this._to=e,this._readyToSync=void 0,this._oneWay=void 0}function c(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}function h(e,t,r){return new l(t,r).connect(e)}function m(e,t,r){return new l(t,r).oneWay().connect(e)}e.bind=h,e.oneWay=m,e.Binding=l,t["default"].LOG_BINDINGS=!1||!!t["default"].ENV.LOG_BINDINGS,l.prototype={copy:function(){var e=new l(this._to,this._from);return this._oneWay&&(e._oneWay=!0),e},from:function(e){return this._from=e,this},to:function(e){return this._to=e,this},oneWay:function(){return this._oneWay=!0,this},toString:function(){var e=this._oneWay?"[oneWay]":"";return"Ember.Binding<"+i.guidFor(this)+">("+this._from+" -> "+this._to+")"+e},connect:function(e){var t=this._from,r=this._to;return n.trySet(e,r,u(e,t)),a.addObserver(e,t,this,this.fromDidChange),this._oneWay||a.addObserver(e,r,this,this.toDidChange),this._readyToSync=!0,this},disconnect:function(e){var t=!this._oneWay;return a.removeObserver(e,this._from,this,this.fromDidChange),t&&a.removeObserver(e,this._to,this,this.toDidChange),this._readyToSync=!1,this},fromDidChange:function(e){this._scheduleSync(e,"fwd")},toDidChange:function(e){this._scheduleSync(e,"back")},_scheduleSync:function(e,t){var r=this._direction;void 0===r&&(s["default"].schedule("sync",this,this._sync,e),this._direction=t),"back"===r&&"fwd"===t&&(this._direction="fwd")},_sync:function(e){var i=t["default"].LOG_BINDINGS;if(!e.isDestroyed&&this._readyToSync){var s=this._direction,l=this._from,c=this._to;if(this._direction=void 0,"fwd"===s){var h=u(e,this._from);i&&t["default"].Logger.log(" ",this.toString(),"->",h,e),this._oneWay?n.trySet(e,c,h):a._suspendObserver(e,c,this,this.toDidChange,function(){n.trySet(e,c,h)})}else if("back"===s){var m=r.get(e,this._to);i&&t["default"].Logger.log(" ",this.toString(),"<-",m,e),a._suspendObserver(e,l,this,this.fromDidChange,function(){n.trySet(o.isGlobal(l)?t["default"].lookup:e,l,m)})}}}},c(l,{from:function(e){var t=this;return new t(void 0,e)},to:function(e){var t=this;return new t(e,void 0)},oneWay:function(e,t){var r=this;return new r(void 0,e).oneWay(t)}}),e.isGlobalPath=o.isGlobal}),e("ember-metal/cache",["exports","ember-metal/dictionary"],function(e,t){"use strict";function r(e,r){this.store=t["default"](null),this.size=0,this.misses=0,this.hits=0,this.limit=e,this.func=r}e["default"]=r;var n=function(){};r.prototype={set:function(e,t){return this.limit>this.size&&(this.size++,void 0===t?this.store[e]=n:this.store[e]=t),t},get:function(e){var t=this.store[e];return void 0===t?(this.misses++,t=this.set(e,this.func(e))):t===n?(this.hits++,t=void 0):this.hits++,t},purge:function(){this.store=t["default"](null),this.size=0,this.hits=0,this.misses=0}}}),e("ember-metal/chains",["exports","ember-metal/core","ember-metal/property_get","ember-metal/utils","ember-metal/array","ember-metal/watch_key"],function(e,t,r,n,i,a){"use strict";function s(e){return e.match(f)[0]}function o(){if(0!==p.length){var e=p;p=[],i.forEach.call(e,function(e){e[0].add(e[1])}),d("Watching an undefined global, Ember expects watched globals to be setup by the time the run loop is flushed, check for typos",0===p.length)}}function u(e,t,r){if(e&&"object"==typeof e){var i=n.meta(e),s=i.chainWatchers;i.hasOwnProperty("chainWatchers")||(s=i.chainWatchers={}),s[t]||(s[t]=[]),s[t].push(r),a.watchKey(e,t,i)}}function l(e,t,r){if(e&&"object"==typeof e){var n=e.__ember_meta__;if(!n||n.hasOwnProperty("chainWatchers")){
var i=n&&n.chainWatchers;if(i&&i[t]){i=i[t];for(var s=0,o=i.length;o>s;s++)if(i[s]===r){i.splice(s,1);break}}a.unwatchKey(e,t,n)}}}function c(e,t,r){this._parent=e,this._key=t,this._watching=void 0===r,this._value=r,this._paths={},this._watching&&(this._object=e.value(),this._object&&u(this._object,this._key,this)),this._parent&&"@each"===this._parent._key&&this.value()}function h(e,t){if(!e)return void 0;var n=e.__ember_meta__;if(n&&n.proto===e)return void 0;if("@each"===t)return r.get(e,t);var i=e[t],a=null!==i&&"object"==typeof i&&i.isDescriptor?i:void 0;return a&&a._cacheable?n.cache&&t in n.cache?n.cache[t]:void 0:r.get(e,t)}function m(e){var t,r,i,a=e.__ember_meta__;if(a){if(r=a.chainWatchers)for(var s in r)if(r.hasOwnProperty(s)&&(i=r[s]))for(var o=0,u=i.length;u>o;o++)i[o].didChange(null);t=a.chains,t&&t.value()!==e&&(n.meta(e).chains=t=t.copy(e))}}e.flushPendingChains=o,e.finishChains=m,e.removeChainWatcher=l,e.ChainNode=c;var d=t["default"].warn,f=/^([^\.]+)/,p=[],v=c.prototype;v.value=function(){if(void 0===this._value&&this._watching){var e=this._parent.value();this._value=h(e,this._key)}return this._value},v.destroy=function(){if(this._watching){var e=this._object;e&&l(e,this._key,this),this._watching=!1}},v.copy=function(e){var t,r=new c(null,null,e),n=this._paths;for(t in n)n[t]<=0||r.add(t);return r},v.add=function(e){var t,n,i,a,o;if(o=this._paths,o[e]=(o[e]||0)+1,t=this.value(),n=r.normalizeTuple(t,e),n[0]&&n[0]===t)e=n[1],i=s(e),e=e.slice(i.length+1);else{if(!n[0])return p.push([this,e]),void(n.length=0);a=n[0],i=e.slice(0,0-(n[1].length+1)),e=n[1]}n.length=0,this.chain(i,e,a)},v.remove=function(e){var t,n,i,a,o;o=this._paths,o[e]>0&&o[e]--,t=this.value(),n=r.normalizeTuple(t,e),n[0]===t?(e=n[1],i=s(e),e=e.slice(i.length+1)):(a=n[0],i=e.slice(0,0-(n[1].length+1)),e=n[1]),n.length=0,this.unchain(i,e)},v.count=0,v.chain=function(e,t,r){var n,i=this._chains;i||(i=this._chains={}),n=i[e],n||(n=i[e]=new c(this,e,r)),n.count++,t&&(e=s(t),t=t.slice(e.length+1),n.chain(e,t))},v.unchain=function(e,t){var r=this._chains,n=r[e];if(t&&t.length>1){var i=s(t),a=t.slice(i.length+1);n.unchain(i,a)}n.count--,n.count<=0&&(delete r[n._key],n.destroy())},v.willChange=function(e){var t=this._chains;if(t)for(var r in t)t.hasOwnProperty(r)&&t[r].willChange(e);this._parent&&this._parent.chainWillChange(this,this._key,1,e)},v.chainWillChange=function(e,t,r,n){this._key&&(t=this._key+"."+t),this._parent?this._parent.chainWillChange(this,t,r+1,n):(r>1&&n.push(this.value(),t),t="this."+t,this._paths[t]>0&&n.push(this.value(),t))},v.chainDidChange=function(e,t,r,n){this._key&&(t=this._key+"."+t),this._parent?this._parent.chainDidChange(this,t,r+1,n):(r>1&&n.push(this.value(),t),t="this."+t,this._paths[t]>0&&n.push(this.value(),t))},v.didChange=function(e){if(this._watching){var t=this._parent.value();t!==this._object&&(l(this._object,this._key,this),this._object=t,u(t,this._key,this)),this._value=void 0,this._parent&&"@each"===this._parent._key&&this.value()}var r=this._chains;if(r)for(var n in r)r.hasOwnProperty(n)&&r[n].didChange(e);null!==e&&this._parent&&this._parent.chainDidChange(this,this._key,1,e)}}),e("ember-metal/computed",["exports","ember-metal/property_set","ember-metal/utils","ember-metal/expand_properties","ember-metal/error","ember-metal/properties","ember-metal/property_events","ember-metal/dependent_keys"],function(e,t,r,n,i,a,s,o){"use strict";function u(){}function l(e,t){this.isDescriptor=!0,e.__ember_arity=e.length,this._getter=e,e.__ember_arity>1&&(this._setter=e),this._dependentKeys=void 0,this._suspended=void 0,this._meta=void 0,this._cacheable=t&&void 0!==t.cacheable?t.cacheable:!0,this._dependentKeys=t&&t.dependentKeys,this._readOnly=t&&(void 0!==t.readOnly||!!t.readOnly)||!1}function c(e){for(var t=0,r=e.length;r>t;t++)e[t].didChange(null)}function h(e){var t;arguments.length>1&&(t=f.call(arguments),e=t.pop());var r=new l(e);if("function"!=typeof e)throw new i["default"]("Computed Property declared without a property function");return t&&r.property.apply(r,t),r}function m(e,t){var r=e.__ember_meta__,n=r&&r.cache,i=n&&n[t];return i===u?void 0:i}e.ComputedProperty=l,e.computed=h,e.cacheFor=m;var d=r.meta,f=[].slice;l.prototype=new a.Descriptor;var p=l.prototype;p.cacheable=function(e){return this._cacheable=e!==!1,this},p["volatile"]=function(){return this._cacheable=!1,this},p.readOnly=function(e){return this._readOnly=void 0===e||!!e,this},p.property=function(){var e,t=function(t){e.push(t)};e=[];for(var r=0,i=arguments.length;i>r;r++)n["default"](arguments[r],t);return this._dependentKeys=e,this},p.meta=function(e){return 0===arguments.length?this._meta||{}:(this._meta=e,this)},p.didChange=function(e,t){if(this._cacheable&&this._suspended!==e){var r=d(e);r.cache&&void 0!==r.cache[t]&&(r.cache[t]=void 0,o.removeDependentKeys(this,e,t,r))}},p.get=function(e,t){var r,n,i,a;if(this._cacheable){i=d(e),n=i.cache;var s=n&&n[t];if(s===u)return void 0;if(void 0!==s)return s;r=this._getter.call(e,t),n=i.cache,n||(n=i.cache={}),void 0===r?n[t]=u:n[t]=r,a=i.chainWatchers&&i.chainWatchers[t],a&&c(a),o.addDependentKeys(this,e,t,i)}else r=this._getter.call(e,t);return r},p.set=function(e,t,r){var n=this._suspended;this._suspended=e;try{this._set(e,t,r)}finally{this._suspended=n}},p._set=function(e,n,l){var c,h,m=this._cacheable,f=this._setter,p=d(e,m),v=p.cache,g=!1;if(this._readOnly)throw new i["default"]('Cannot set read-only property "'+n+'" on object: '+r.inspect(e));if(m&&v&&void 0!==v[n]&&(v[n]!==u&&(c=v[n]),g=!0),!f)return a.defineProperty(e,n,null,c),void t.set(e,n,l);if(h=2===f.__ember_arity?f.call(e,n,l):f.call(e,n,l,c),!g||c!==h){var b=p.watching[n];return b&&s.propertyWillChange(e,n),g&&(v[n]=void 0),m&&(g||o.addDependentKeys(this,e,n,p),v||(v=p.cache={}),void 0===h?v[n]=u:v[n]=h),b&&s.propertyDidChange(e,n),h}},p.teardown=function(e,t){var r=d(e);return r.cache&&(t in r.cache&&o.removeDependentKeys(this,e,t,r),this._cacheable&&delete r.cache[t]),null},m.set=function(e,t,r){void 0===r?e[t]=u:e[t]=r},m.get=function(e,t){var r=e[t];return r===u?void 0:r},m.remove=function(e,t){e[t]=void 0}}),e("ember-metal/computed_macros",["exports","ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/computed","ember-metal/is_empty","ember-metal/is_none","ember-metal/alias"],function(e,t,r,n,i,a,s,o){"use strict";function u(e,t){for(var n={},i=0;i<t.length;i++)n[t[i]]=r.get(e,t[i]);return n}function l(e){return function(){var t=O.call(arguments),r=i.computed(function(){return e.apply(this,[u(this,t)])});return r.property.apply(r,t)}}function c(e){return i.computed(e+".length",function(){return a["default"](r.get(this,e))})}function h(e){return i.computed(e+".length",function(){return!a["default"](r.get(this,e))})}function m(e){return i.computed(e,function(){return s["default"](r.get(this,e))})}function d(e){return i.computed(e,function(){return!r.get(this,e)})}function f(e){return i.computed(e,function(){return!!r.get(this,e)})}function p(e,t){return i.computed(e,function(){var n=r.get(this,e);return"string"==typeof n?t.test(n):!1})}function v(e,t){return i.computed(e,function(){return r.get(this,e)===t})}function g(e,t){return i.computed(e,function(){return r.get(this,e)>t})}function b(e,t){return i.computed(e,function(){return r.get(this,e)>=t})}function y(e,t){return i.computed(e,function(){return r.get(this,e)<t})}function _(e,t){return i.computed(e,function(){return r.get(this,e)<=t})}function w(e){return o["default"](e).oneWay()}function x(e){return o["default"](e).readOnly()}function C(e){return i.computed(function(t,n,i){return 1===arguments.length?r.get(this,e):null!=n?n:r.get(this,e)})}function E(e){return i.computed(e,function(t,i){return arguments.length>1?(n.set(this,e,i),i):r.get(this,e)})}e.empty=c,e.notEmpty=h,e.none=m,e.not=d,e.bool=f,e.match=p,e.equal=v,e.gt=g,e.gte=b,e.lt=y,e.lte=_,e.oneWay=w,e.readOnly=x,e.defaultTo=C,e.deprecatingAlias=E;var O=[].slice,P=l(function(e){var t;for(var r in e)if(t=e[r],e.hasOwnProperty(r)&&!t)return!1;return t}),S=l(function(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return e[t];return!1}),A=l(function(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return e[t];return null}),N=l(function(e){var r=t["default"].A();for(var n in e)e.hasOwnProperty(n)&&r.push(s["default"](e[n])?null:e[n]);return r});e.and=P,e.or=S,e.any=A,e.collect=N}),e("ember-metal/core",["exports"],function(e){"use strict";function t(){return this}e.K=t,"undefined"==typeof i&&(i={});var r=a||{};i.imports=i.imports||r,i.lookup=i.lookup||r;var n=i.exports=i.exports||r;n.Em=n.Ember=i,i.isNamespace=!0,i.toString=function(){return"Ember"},i.VERSION="1.11.3",i.ENV||("undefined"!=typeof EmberENV?i.ENV=EmberENV:"undefined"!=typeof ENV?i.ENV=ENV:i.ENV={}),i.config=i.config||{},"undefined"==typeof i.ENV.DISABLE_RANGE_API&&(i.ENV.DISABLE_RANGE_API=!0),i.FEATURES=i.ENV.FEATURES,i.FEATURES||(i.FEATURES={"features-stripped-test":!1,"ember-routing-named-substates":!0,"mandatory-setter":!1,"ember-htmlbars-component-generation":!1,"ember-htmlbars-component-helper":!0,"ember-htmlbars-inline-if-helper":!0,"ember-htmlbars-attribute-syntax":!0,"ember-routing-transitioning-classes":!0,"new-computed-syntax":!1,"ember-testing-checkbox-helpers":!1,"ember-metal-stream":!1,"ember-htmlbars-each-with-index":!0,"ember-application-instance-initializers":!1,"ember-application-initializer-context":!1,"ember-router-willtransition":!0,"ember-application-visit":!1}),i.FEATURES.isEnabled=function(e){var t=i.FEATURES[e];return i.ENV.ENABLE_ALL_FEATURES?!0:t===!0||t===!1||void 0===t?t:i.ENV.ENABLE_OPTIONAL_FEATURES?!0:!1},i.EXTEND_PROTOTYPES=i.ENV.EXTEND_PROTOTYPES,"undefined"==typeof i.EXTEND_PROTOTYPES&&(i.EXTEND_PROTOTYPES=!0),i.LOG_STACKTRACE_ON_DEPRECATION=i.ENV.LOG_STACKTRACE_ON_DEPRECATION!==!1,i.SHIM_ES5=i.ENV.SHIM_ES5===!1?!1:i.EXTEND_PROTOTYPES,i.LOG_VERSION=i.ENV.LOG_VERSION===!1?!1:!0,i.K=t,"undefined"==typeof i.assert&&(i.assert=t),"undefined"==typeof i.warn&&(i.warn=t),"undefined"==typeof i.debug&&(i.debug=t),"undefined"==typeof i.runInDebug&&(i.runInDebug=t),"undefined"==typeof i.deprecate&&(i.deprecate=t),"undefined"==typeof i.deprecateFunc&&(i.deprecateFunc=function(e,t){return t}),e["default"]=i}),e("ember-metal/dependent_keys",["exports","ember-metal/platform/create","ember-metal/watching"],function(e,t,r){function n(e,r){var n=e[r];return n?e.hasOwnProperty(r)||(n=e[r]=t["default"](n)):n=e[r]={},n}function i(e){return n(e,"deps")}function a(e,t,a,s){var o,u,l,c,h,m=e._dependentKeys;if(m)for(o=i(s),u=0,l=m.length;l>u;u++)c=m[u],h=n(o,c),h[a]=(h[a]||0)+1,r.watch(t,c,s)}function s(e,t,a,s){var o,u,l,c,h,m=e._dependentKeys;if(m)for(o=i(s),u=0,l=m.length;l>u;u++)c=m[u],h=n(o,c),h[a]=(h[a]||0)-1,r.unwatch(t,c,s)}e.addDependentKeys=a,e.removeDependentKeys=s}),e("ember-metal/deprecate_property",["exports","ember-metal/core","ember-metal/platform/define_property","ember-metal/properties","ember-metal/property_get","ember-metal/property_set"],function(e,t,r,n,i,a){"use strict";function s(e,t,s){function o(){}r.hasPropertyAccessors&&n.defineProperty(e,t,{configurable:!0,enumerable:!1,set:function(e){o(),a.set(this,s,e)},get:function(){return o(),i.get(this,s)}})}e.deprecateProperty=s}),e("ember-metal/dictionary",["exports","ember-metal/platform/create"],function(e,t){"use strict";function r(e){var r=t["default"](e);return r._dict=null,delete r._dict,r}e["default"]=r}),e("ember-metal/enumerable_utils",["exports","ember-metal/array"],function(e,t){"use strict";function r(e,r,n){return e.map?e.map(r,n):t.map.call(e,r,n)}function n(e,r,n){return e.forEach?e.forEach(r,n):t.forEach.call(e,r,n)}function i(e,r,n){return e.filter?e.filter(r,n):t.filter.call(e,r,n)}function a(e,r,n){return e.indexOf?e.indexOf(r,n):t.indexOf.call(e,r,n)}function s(e,t){return void 0===t?[]:r(t,function(t){return a(e,t)})}function o(e,t){var r=a(e,t);-1===r&&e.push(t)}function u(e,t){var r=a(e,t);-1!==r&&e.splice(r,1)}function l(e,t,r,n){for(var i,a,s=[].concat(n),o=[],u=6e4,l=t,c=r;s.length;)i=c>u?u:c,0>=i&&(i=0),a=s.splice(0,u),a=[l,i].concat(a),l+=u,c-=i,o=o.concat(m.apply(e,a));return o}function c(e,t,r,n){return e.replace?e.replace(t,r,n):l(e,t,r,n)}function h(e,t){var r=[];return n(e,function(e){a(t,e)>=0&&r.push(e)}),r}e.map=r,e.forEach=n,e.filter=i,e.indexOf=a,e.indexesOf=s,e.addObject=o,e.removeObject=u,e._replace=l,e.replace=c,e.intersection=h;var m=Array.prototype.splice;e["default"]={_replace:l,addObject:o,filter:i,forEach:n,indexOf:a,indexesOf:s,intersection:h,map:r,removeObject:u,replace:c}}),e("ember-metal/environment",["exports","ember-metal/core"],function(e,t){"use strict";var r,n="undefined"!=typeof window&&"undefined"!=typeof document&&"undefined"!=typeof document.createElement&&!t["default"].ENV.disableBrowserEnvironment;r=n?{hasDOM:!0,isChrome:!!window.chrome&&!window.opera,location:window.location,history:window.history,userAgent:window.navigator.userAgent}:{hasDOM:!1,isChrome:!1,location:null,history:null,userAgent:"Lynx (textmode)"},e["default"]=r}),e("ember-metal/error",["exports","ember-metal/platform/create"],function(e,t){"use strict";function r(){var e=Error.apply(this,arguments);Error.captureStackTrace&&Error.captureStackTrace(this,i.Error);for(var t=0;t<n.length;t++)this[n[t]]=e[n[t]]}var n=["description","fileName","lineNumber","message","name","number","stack"];r.prototype=t["default"](Error.prototype),e["default"]=r}),e("ember-metal/events",["exports","ember-metal/core","ember-metal/utils","ember-metal/platform/create"],function(e,t,r,n){function i(e,t,r){for(var n=-1,i=e.length-3;i>=0;i-=3)if(t===e[i]&&r===e[i+1]){n=i;break}return n}function a(e,t){var i,a=r.meta(e,!0),s=a.listeners;return s?s.__source__!==e&&(s=a.listeners=n["default"](s),s.__source__=e):(s=a.listeners=n["default"](null),s.__source__=e),i=s[t],i&&i.__source__!==e?(i=s[t]=s[t].slice(),i.__source__=e):i||(i=s[t]=[],i.__source__=e),i}function s(e,t,r){var n=e.__ember_meta__,a=n&&n.listeners&&n.listeners[t];if(a){for(var s=[],o=a.length-3;o>=0;o-=3){var u=a[o],l=a[o+1],c=a[o+2],h=i(r,u,l);-1===h&&(r.push(u,l,c),s.push(u,l,c))}return s}}function o(e,t,r,n,s){n||"function"!=typeof r||(n=r,r=null);var o=a(e,t),u=i(o,r,n),l=0;s&&(l|=g),-1===u&&(o.push(r,n,l),"function"==typeof e.didAddListener&&e.didAddListener(t,r,n))}function u(e,t,r,n){function s(r,n){var s=a(e,t),o=i(s,r,n);-1!==o&&(s.splice(o,3),"function"==typeof e.didRemoveListener&&e.didRemoveListener(t,r,n))}if(n||"function"!=typeof r||(n=r,r=null),n)s(r,n);else{var o=e.__ember_meta__,u=o&&o.listeners&&o.listeners[t];if(!u)return;for(var l=u.length-3;l>=0;l-=3)s(u[l],u[l+1])}}function l(e,t,n,s,o){function u(){return o.call(n)}function l(){-1!==h&&(c[h+2]&=~b)}s||"function"!=typeof n||(s=n,n=null);var c=a(e,t),h=i(c,n,s);return-1!==h&&(c[h+2]|=b),r.tryFinally(u,l)}function c(e,t,n,s,o){function u(){return o.call(n)}function l(){for(var e=0,t=f.length;t>e;e++){var r=f[e];p[e][r+2]&=~b}}s||"function"!=typeof n||(s=n,n=null);var c,h,m,d,f=[],p=[];for(m=0,d=t.length;d>m;m++){c=t[m],h=a(e,c);var v=i(h,n,s);-1!==v&&(h[v+2]|=b,f.push(v),p.push(h))}return r.tryFinally(u,l)}function h(e){var t=e.__ember_meta__.listeners,r=[];if(t)for(var n in t)"__source__"!==n&&t[n]&&r.push(n);return r}function m(e,n,i,a){if(e!==t["default"]&&"function"==typeof e.sendEvent&&e.sendEvent(n,i),!a){var s=e.__ember_meta__;a=s&&s.listeners&&s.listeners[n]}if(a){for(var o=a.length-3;o>=0;o-=3){var l=a[o],c=a[o+1],h=a[o+2];c&&(h&b||(h&g&&u(e,n,l,c),l||(l=e),"string"==typeof c?i?r.applyStr(l,c,i):l[c]():i?r.apply(l,c,i):c.call(l)))}return!0}}function d(e,t){var r=e.__ember_meta__,n=r&&r.listeners&&r.listeners[t];return!(!n||!n.length)}function f(e,t){var r=[],n=e.__ember_meta__,i=n&&n.listeners&&n.listeners[t];if(!i)return r;for(var a=0,s=i.length;s>a;a+=3){var o=i[a],u=i[a+1];r.push([o,u])}return r}function p(){var e=v.call(arguments,-1)[0],t=v.call(arguments,0,-1);return e.__ember_listens__=t,e}e.accumulateListeners=s,e.addListener=o,e.suspendListener=l,e.suspendListeners=c,e.watchedEvents=h,e.sendEvent=m,e.hasListeners=d,e.listenersFor=f,e.on=p,e.removeListener=u;var v=[].slice,g=1,b=2}),e("ember-metal/expand_properties",["exports","ember-metal/error","ember-metal/enumerable_utils","ember-metal/utils"],function(e,t,r,n){"use strict";function i(e,i){if(e.indexOf(" ")>-1)throw new t["default"]("Brace expanded properties cannot contain spaces, e.g. `user.{firstName, lastName}` should be `user.{firstName,lastName}`");if("string"===n.typeOf(e)){var o=e.split(s),u=[o];r.forEach(o,function(e,t){e.indexOf(",")>=0&&(u=a(u,e.split(","),t))}),r.forEach(u,function(e){i(e.join(""))})}else i(e)}function a(e,t,n){var i=[];return r.forEach(e,function(e){r.forEach(t,function(t){var r=e.slice(0);r[n]=t,i.push(r)})}),i}var s=/\{|\}/;e["default"]=i}),e("ember-metal/get_properties",["exports","ember-metal/property_get","ember-metal/utils"],function(e,t,r){"use strict";function n(e){var n={},i=arguments,a=1;2===arguments.length&&"array"===r.typeOf(arguments[1])&&(a=0,i=arguments[1]);for(var s=i.length;s>a;a++)n[i[a]]=t.get(e,i[a]);return n}e["default"]=n}),e("ember-metal/injected_property",["exports","ember-metal/core","ember-metal/computed","ember-metal/alias","ember-metal/properties","ember-metal/platform/create"],function(e,t,r,n,i,a){"use strict";function s(e,t){this.type=e,this.name=t,this._super$Constructor(o),c.oneWay.call(this)}function o(e){var t=this[e],r=null!==t&&"object"==typeof t&&t.isDescriptor?t:void 0;return this.container.lookup(r.type+":"+(r.name||e))}s.prototype=a["default"](i.Descriptor.prototype);var u=s.prototype,l=r.ComputedProperty.prototype,c=n.AliasedProperty.prototype;u._super$Constructor=r.ComputedProperty,u.get=l.get,u.readOnly=l.readOnly,u.teardown=l.teardown,e["default"]=s}),e("ember-metal/instrumentation",["exports","ember-metal/core","ember-metal/utils"],function(e,t,r){"use strict";function n(e,t,n,a){if(arguments.length<=3&&"function"==typeof t&&(a=n,n=t,t=void 0),0===u.length)return n.call(a);var s=t||{},o=i(e,function(){return s});if(o){var l=function(){return n.call(a)},c=function(e){s.exception=e};return r.tryCatchFinally(l,c,o)}return n.call(a)}function i(e,r){var n=l[e];if(n||(n=c(e)),0!==n.length){var i,a=r(),s=t["default"].STRUCTURED_PROFILE;s&&(i=e+": "+a.object,console.time(i));var o,u,m=n.length,d=new Array(m),f=h();for(o=0;m>o;o++)u=n[o],d[o]=u.before(e,f,a);return function(){var t,r,o,u=h();for(t=0,r=n.length;r>t;t++)o=n[t],o.after(e,u,a,d[t]);s&&console.timeEnd(i)}}}function a(e,t){for(var r,n=e.split("."),i=[],a=0,s=n.length;s>a;a++)r=n[a],i.push("*"===r?"[^\\.]*":r);i=i.join("\\."),i+="(\\..*)?";var o={pattern:e,regex:new RegExp("^"+i+"$"),object:t};return u.push(o),l={},o}function s(e){for(var t,r=0,n=u.length;n>r;r++)u[r]===e&&(t=r);u.splice(t,1),l={}}function o(){u.length=0,l={}}e.instrument=n,e._instrumentStart=i,e.subscribe=a,e.unsubscribe=s,e.reset=o;var u=[],l={},c=function(e){for(var t,r=[],n=0,i=u.length;i>n;n++)t=u[n],t.regex.test(e)&&r.push(t.object);return l[e]=r,r},h=function(){var e="undefined"!=typeof window?window.performance||{}:{},t=e.now||e.mozNow||e.webkitNow||e.msNow||e.oNow;return t?t.bind(e):function(){return+new Date}}();e.subscribers=u}),e("ember-metal/is_blank",["exports","ember-metal/is_empty"],function(e,t){"use strict";function r(e){return t["default"](e)||"string"==typeof e&&null===e.match(/\S/)}e["default"]=r}),e("ember-metal/is_empty",["exports","ember-metal/property_get","ember-metal/is_none"],function(e,t,r){"use strict";function n(e){var n=r["default"](e);if(n)return n;if("number"==typeof e.size)return!e.size;var i=typeof e;if("object"===i){var a=t.get(e,"size");if("number"==typeof a)return!a}if("number"==typeof e.length&&"function"!==i)return!e.length;if("object"===i){var s=t.get(e,"length");if("number"==typeof s)return!s}return!1}e["default"]=n}),e("ember-metal/is_none",["exports"],function(e){"use strict";function t(e){return null===e||void 0===e}e["default"]=t}),e("ember-metal/is_present",["exports","ember-metal/is_blank"],function(e,t){"use strict";function r(e){return!t["default"](e)}e["default"]=r}),e("ember-metal/keys",["exports","ember-metal/platform/define_property"],function(e,t){"use strict";var r=Object.keys;r&&t.canDefineNonEnumerableProperties||(r=function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),r=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],n=r.length;return function(i){if("object"!=typeof i&&("function"!=typeof i||null===i))throw new TypeError("Object.keys called on non-object");var a,s,o=[];for(a in i)"_super"!==a&&0!==a.lastIndexOf("__",0)&&e.call(i,a)&&o.push(a);if(t)for(s=0;n>s;s++)e.call(i,r[s])&&o.push(r[s]);return o}}()),e["default"]=r}),e("ember-metal/libraries",["exports","ember-metal/core","ember-metal/enumerable_utils"],function(e,t,r){"use strict";function n(){this._registry=[],this._coreLibIndex=0}n.prototype={constructor:n,_getLibraryByName:function(e){for(var t=this._registry,r=t.length,n=0;r>n;n++)if(t[n].name===e)return t[n]},register:function(e,t,r){var n=this._registry.length;this._getLibraryByName(e)||(r&&(n=this._coreLibIndex++),this._registry.splice(n,0,{name:e,version:t}))},registerCoreLibrary:function(e,t){this.register(e,t,!0)},deRegister:function(e){var t,n=this._getLibraryByName(e);n&&(t=r.indexOf(this._registry,n),this._registry.splice(t,1))},each:function(e){r.forEach(this._registry,function(t){e(t.name,t.version)})}},e["default"]=n}),e("ember-metal/logger",["exports","ember-metal/core","ember-metal/error"],function(e,t,r){"use strict";function n(){return this}function i(e){var r,n;t["default"].imports.console?r=t["default"].imports.console:"undefined"!=typeof console&&(r=console);var i="object"==typeof r?r[e]:null;return i?"function"==typeof i.bind?(n=i.bind(r),n.displayName="console."+e,n):"function"==typeof i.apply?(n=function(){i.apply(r,arguments)},n.displayName="console."+e,n):function(){var e=Array.prototype.join.call(arguments,", ");i(e)}:void 0}function a(e,t){if(!e)try{throw new r["default"]("assertion failed: "+t)}catch(n){setTimeout(function(){throw n},0)}}e["default"]={log:i("log")||n,warn:i("warn")||n,error:i("error")||n,info:i("info")||n,debug:i("debug")||i("info")||n,assert:i("assert")||a}}),e("ember-metal/map",["exports","ember-metal/utils","ember-metal/array","ember-metal/platform/create","ember-metal/deprecate_property"],function(e,t,r,n,a){"use strict";function s(e){throw new TypeError(""+Object.prototype.toString.call(e)+" is not a function")}function o(e){throw new TypeError("Constructor "+e+"requires 'new'")}function u(e){var t=n["default"](null);for(var r in e)t[r]=e[r];return t}function l(e,t){var r=e._keys.copy(),n=u(e._values);return t._keys=r,t._values=n,t.size=e.size,t}function c(){this instanceof c?(this.clear(),this._silenceRemoveDeprecation=!1):o("OrderedSet")}function h(){this instanceof this.constructor?(this._keys=c.create(),this._keys._silenceRemoveDeprecation=!0,this._values=n["default"](null),this.size=0):o("OrderedSet")}function m(e){this._super$constructor(),this.defaultValue=e.defaultValue}e.OrderedSet=c,e.Map=h,e.MapWithDefault=m,c.create=function(){var e=this;return new e},c.prototype={constructor:c,clear:function(){this.presenceSet=n["default"](null),this.list=[],this.size=0},add:function(e,r){var n=r||t.guidFor(e),i=this.presenceSet,a=this.list;return i[n]!==!0&&(i[n]=!0,this.size=a.push(e)),this},remove:function(e,t){return this["delete"](e,t)},"delete":function(e,n){var i=n||t.guidFor(e),a=this.presenceSet,s=this.list;if(a[i]===!0){delete a[i];var o=r.indexOf.call(s,e);return o>-1&&s.splice(o,1),this.size=s.length,!0}return!1},isEmpty:function(){return 0===this.size},has:function(e){if(0===this.size)return!1;var r=t.guidFor(e),n=this.presenceSet;return n[r]===!0},forEach:function(e){if("function"!=typeof e&&s(e),0!==this.size){var t,r=this.list,n=arguments.length;if(2===n)for(t=0;t<r.length;t++)e.call(arguments[1],r[t]);else for(t=0;t<r.length;t++)e(r[t])}},toArray:function(){return this.list.slice()},copy:function(){var e=this.constructor,t=new e;return t._silenceRemoveDeprecation=this._silenceRemoveDeprecation,t.presenceSet=u(this.presenceSet),t.list=this.toArray(),t.size=this.size,t}},a.deprecateProperty(c.prototype,"length","size"),i.Map=h,h.create=function(){var e=this;return new e},h.prototype={constructor:h,size:0,get:function(e){if(0!==this.size){var r=this._values,n=t.guidFor(e);return r[n]}},set:function(e,r){var n=this._keys,i=this._values,a=t.guidFor(e),s=e===-0?0:e;return n.add(s,a),i[a]=r,this.size=n.size,this},remove:function(e){return this["delete"](e)},"delete":function(e){if(0===this.size)return!1;var r=this._keys,n=this._values,i=t.guidFor(e);return r["delete"](e,i)?(delete n[i],this.size=r.size,!0):!1},has:function(e){return this._keys.has(e)},forEach:function(e){if("function"!=typeof e&&s(e),0!==this.size){var t,r,n=arguments.length,i=this;2===n?(r=arguments[1],t=function(t){e.call(r,i.get(t),t,i)}):t=function(t){e(i.get(t),t,i)},this._keys.forEach(t)}},clear:function(){this._keys.clear(),this._values=n["default"](null),this.size=0},copy:function(){return l(this,new h)}},a.deprecateProperty(h.prototype,"length","size"),m.create=function(e){return e?new m(e):new h},m.prototype=n["default"](h.prototype),m.prototype.constructor=m,m.prototype._super$constructor=h,m.prototype._super$get=h.prototype.get,m.prototype.get=function(e){var t=this.has(e);if(t)return this._super$get(e);var r=this.defaultValue(e);return this.set(e,r),r},m.prototype.copy=function(){var e=this.constructor;return l(this,new e({defaultValue:this.defaultValue}))},e["default"]=h}),e("ember-metal/merge",["exports","ember-metal/keys"],function(e,t){"use strict";function r(e,r){if(!r||"object"!=typeof r)return e;for(var n,i=t["default"](r),a=i.length,s=0;a>s;s++)n=i[s],e[n]=r[n];return e}e["default"]=r}),e("ember-metal/mixin",["exports","ember-metal/core","ember-metal/merge","ember-metal/array","ember-metal/platform/create","ember-metal/property_get","ember-metal/property_set","ember-metal/utils","ember-metal/expand_properties","ember-metal/properties","ember-metal/computed","ember-metal/binding","ember-metal/observer","ember-metal/events","ember-metal/streams/utils"],function(e,t,r,n,i,a,s,o,u,l,c,h,m,d,f){function p(){var e,t=this.__nextSuper;if(t){var r=arguments.length;return this.__nextSuper=null,e=0===r?t.call(this):1===r?t.call(this,arguments[0]):2===r?t.call(this,arguments[0],arguments[1]):t.apply(this,arguments),this.__nextSuper=t,e}}function v(e){var t=o.meta(e,!0),r=t.mixins;return r?t.hasOwnProperty("mixins")||(r=t.mixins=i["default"](r)):r=t.mixins={},r}function g(e){return"function"==typeof e&&e.isMethod!==!1&&e!==Boolean&&e!==Object&&e!==Number&&e!==Array&&e!==Date&&e!==String}function b(e,t){var r;return t instanceof j?(r=o.guidFor(t),e[r]?G:(e[r]=t,t.properties)):t}function y(e,t,r,n){var i;return i=r[e]||n[e],t[e]&&(i=i?i.concat(t[e]):t[e]),i}function _(e,t,r,n,a,s){var u;if(void 0===n[t]&&(u=a[t]),!u){var l=s[t],h=null!==l&&"object"==typeof l&&l.isDescriptor?l:void 0;u=h}return void 0!==u&&u instanceof c.ComputedProperty?(r=i["default"](r),r._getter=o.wrap(r._getter,u._getter),u._setter&&(r._setter?r._setter=o.wrap(r._setter,u._setter):r._setter=u._setter),r):r}function w(e,t,r,n,i){var a;if(void 0===i[t]&&(a=n[t]),a=a||e[t],void 0===a||"function"!=typeof a)return r;var s;return Q&&(s=r.__hasSuper,void 0===s&&(s=r.toString().indexOf("_super")>-1,r.__hasSuper=s)),Q===!1||s?o.wrap(r,a):r}function x(e,t,r,n){var i=n[t]||e[t];return i?"function"==typeof i.concat?null===r||void 0===r?i:i.concat(r):o.makeArray(i).concat(r):o.makeArray(r)}function C(e,t,n,i){var a=i[t]||e[t];if(!a)return n;var s=r["default"]({},a),o=!1;for(var u in n)if(n.hasOwnProperty(u)){var l=n[u];g(l)?(o=!0,s[u]=w(e,u,l,a,{})):s[u]=l}return o&&(s._super=p),s}function E(e,t,r,i,a,s,o,u){if(r instanceof l.Descriptor){if(r===U&&a[t])return G;r._getter&&(r=_(i,t,r,s,a,e)),a[t]=r,s[t]=void 0}else o&&n.indexOf.call(o,t)>=0||"concatenatedProperties"===t||"mergedProperties"===t?r=x(e,t,r,s):u&&n.indexOf.call(u,t)>=0?r=C(e,t,r,s):g(r)&&(r=w(e,t,r,s,a)),a[t]=void 0,s[t]=r}function O(e,t,r,i,a,s){function u(e){delete r[e],delete i[e]}for(var l,c,h,m,d,f,p=0,v=e.length;v>p;p++)if(l=e[p],c=b(t,l),c!==G)if(c){f=o.meta(a),a.willMergeMixin&&a.willMergeMixin(c),m=y("concatenatedProperties",c,i,a),d=y("mergedProperties",c,i,a);for(h in c)c.hasOwnProperty(h)&&(s.push(h),E(a,h,c[h],f,r,i,m,d));c.hasOwnProperty("toString")&&(a.toString=c.toString)}else l.mixins&&(O(l.mixins,t,r,i,a,s),l._without&&n.forEach.call(l._without,u))}function P(e,t,r,n){if($.test(t)){var a=n.bindings;a?n.hasOwnProperty("bindings")||(a=n.bindings=i["default"](n.bindings)):a=n.bindings={},a[t]=r}}function S(e,t,r){var n=function(r){m._suspendObserver(e,t,null,o,function(){s.trySet(e,t,r.value())})},o=function(){r.setValue(a.get(e,t),n)};s.set(e,t,r.value()),m.addObserver(e,t,null,o),r.subscribe(n),void 0===e._streamBindingSubscriptions&&(e._streamBindingSubscriptions=i["default"](null)),e._streamBindingSubscriptions[t]=n}function A(e,t){var r,n,i,a=t.bindings;if(a){for(r in a)if(n=a[r]){if(i=r.slice(0,-7),f.isStream(n)){S(e,i,n);continue}n instanceof h.Binding?(n=n.copy(),n.to(i)):n=new h.Binding(i,n),n.connect(e),e[r]=n}t.bindings={}}}function N(e,t){return A(e,t||o.meta(e)),e}function T(e,t,r,n,i){var a,s,o=t.methodName;return n[o]||i[o]?(a=i[o],t=n[o]):(s=e[o])&&null!==s&&"object"==typeof s&&s.isDescriptor?(t=s,a=void 0):(t=void 0,a=e[o]),{desc:t,value:a}}function k(e,t,r,n,i){var a=r[n];if(a)for(var s=0,o=a.length;o>s;s++)i(e,a[s],null,t)}function M(e,t,r){var n=e[t];"function"==typeof n&&(k(e,t,n,"__ember_observesBefore__",m.removeBeforeObserver),k(e,t,n,"__ember_observes__",m.removeObserver),k(e,t,n,"__ember_listens__",d.removeListener)),"function"==typeof r&&(k(e,t,r,"__ember_observesBefore__",m.addBeforeObserver),k(e,t,r,"__ember_observes__",m.addObserver),k(e,t,r,"__ember_listens__",d.addListener))}function I(e,t,r){var n,i,a,s={},u={},c=o.meta(e),h=[];e._super=p,O(t,v(e),s,u,e,h);for(var m=0,d=h.length;d>m;m++)if(n=h[m],"constructor"!==n&&u.hasOwnProperty(n)&&(a=s[n],i=u[n],a!==U)){for(;a&&a instanceof L;){var f=T(e,a,c,s,u);a=f.desc,i=f.value}(void 0!==a||void 0!==i)&&(M(e,n,i),P(e,n,i,c),l.defineProperty(e,n,a,i,c))}return r||N(e,c),e}function V(e){var t=W.call(arguments,1);return I(e,t,!1),e}function j(e,t){this.properties=t;var r=e&&e.length;if(r>0){for(var n=new Array(r),i=0;r>i;i++){var a=e[i];a instanceof j?n[i]=a:n[i]=new j(void 0,a)}this.mixins=n}else this.mixins=void 0;this.ownerConstructor=void 0}function R(e,t,r){var n=o.guidFor(e);if(r[n])return!1;if(r[n]=!0,e===t)return!0;for(var i=e.mixins,a=i?i.length:0;--a>=0;)if(R(i[a],t,r))return!0;return!1}function D(e,t,r){if(!r[o.guidFor(t)])if(r[o.guidFor(t)]=!0,t.properties){var i=t.properties;for(var a in i)i.hasOwnProperty(a)&&(e[a]=!0)}else t.mixins&&n.forEach.call(t.mixins,function(t){D(e,t,r)})}function F(){return U}function L(e){this.isDescriptor=!0,this.methodName=e}function B(e){return new L(e)}function H(){var e,r=W.call(arguments,-1)[0],n=function(t){e.push(t)},i=W.call(arguments,0,-1);"function"!=typeof r&&(r=arguments[0],i=W.call(arguments,1)),e=[];for(var a=0;a<i.length;++a)u["default"](i[a],n);if("function"!=typeof r)throw new t["default"].Error("Ember.observer called without a function");return r.__ember_observes__=e,r}function z(){for(var e=0,t=arguments.length;t>e;e++){arguments[e]}return H.apply(this,arguments)}function q(){var e,r=W.call(arguments,-1)[0],n=function(t){e.push(t)},i=W.call(arguments,0,-1);"function"!=typeof r&&(r=arguments[0],i=W.call(arguments,1)),e=[];for(var a=0;a<i.length;++a)u["default"](i[a],n);if("function"!=typeof r)throw new t["default"].Error("Ember.beforeObserver called without a function");return r.__ember_observesBefore__=e,r}e.mixin=V,e.required=F,e.aliasMethod=B,e.observer=H,e.immediateObserver=z,e.beforeObserver=q,e.Mixin=j;var U,W=[].slice,K={
__nextSuper:function(e,t,r,n){}};p.call(K),p.call(K,1),p.call(K,1,2),p.call(K,1,2,3);var G={},Q=function(){return this}.toString().indexOf("return this;")>-1,$=/^.+Binding$/;e["default"]=j,j._apply=I,j.applyPartial=function(e){var t=W.call(arguments,1);return I(e,t,!0)},j.finishPartial=N,t["default"].anyUnprocessedMixins=!1,j.create=function(){t["default"].anyUnprocessedMixins=!0;for(var e=this,r=arguments.length,n=new Array(r),i=0;r>i;i++)n[i]=arguments[i];return new e(n,void 0)};var Y=j.prototype;Y.reopen=function(){var e;this.properties?(e=new j(void 0,this.properties),this.properties=void 0,this.mixins=[e]):this.mixins||(this.mixins=[]);var t,r=arguments.length,n=this.mixins;for(t=0;r>t;t++)e=arguments[t],n.push(e instanceof j?e:new j(void 0,e));return this},Y.apply=function(e){return I(e,[this],!1)},Y.applyPartial=function(e){return I(e,[this],!0)},Y.detect=function(e){if(!e)return!1;if(e instanceof j)return R(e,this,{});var t=e.__ember_meta__,r=t&&t.mixins;return r?!!r[o.guidFor(this)]:!1},Y.without=function(){var e=new j([this]);return e._without=W.call(arguments),e},Y.keys=function(){var e={},t={},r=[];D(e,this,t);for(var n in e)e.hasOwnProperty(n)&&r.push(n);return r},j.mixins=function(e){var t=e.__ember_meta__,r=t&&t.mixins,n=[];if(!r)return n;for(var i in r){var a=r[i];a.properties||n.push(a)}return n},U=new l.Descriptor,U.toString=function(){return"(Required Property)"},L.prototype=new l.Descriptor,e.IS_BINDING=$}),e("ember-metal/observer",["exports","ember-metal/watching","ember-metal/array","ember-metal/events"],function(e,t,r,n){"use strict";function i(e){return e+v}function a(e){return e+g}function s(e,r,a,s){return n.addListener(e,i(r),a,s),t.watch(e,r),this}function o(e,t){return n.listenersFor(e,i(t))}function u(e,r,a,s){return t.unwatch(e,r),n.removeListener(e,i(r),a,s),this}function l(e,r,i,s){return n.addListener(e,a(r),i,s),t.watch(e,r),this}function c(e,t,r,i,s){return n.suspendListener(e,a(t),r,i,s)}function h(e,t,r,a,s){return n.suspendListener(e,i(t),r,a,s)}function m(e,t,i,s,o){var u=r.map.call(t,a);return n.suspendListeners(e,u,i,s,o)}function d(e,t,a,s,o){var u=r.map.call(t,i);return n.suspendListeners(e,u,a,s,o)}function f(e,t){return n.listenersFor(e,a(t))}function p(e,r,i,s){return t.unwatch(e,r),n.removeListener(e,a(r),i,s),this}e.addObserver=s,e.observersFor=o,e.removeObserver=u,e.addBeforeObserver=l,e._suspendBeforeObserver=c,e._suspendObserver=h,e._suspendBeforeObservers=m,e._suspendObservers=d,e.beforeObserversFor=f,e.removeBeforeObserver=p;var v=":change",g=":before"}),e("ember-metal/observer_set",["exports","ember-metal/utils","ember-metal/events"],function(e,t,r){"use strict";function n(){this.clear()}e["default"]=n,n.prototype.add=function(e,r,n){var i,a=this.observerSet,s=this.observers,o=t.guidFor(e),u=a[o];return u||(a[o]=u={}),i=u[r],void 0===i&&(i=s.push({sender:e,keyName:r,eventName:n,listeners:[]})-1,u[r]=i),s[i].listeners},n.prototype.flush=function(){var e,t,n,i,a=this.observers;for(this.clear(),e=0,t=a.length;t>e;++e)n=a[e],i=n.sender,i.isDestroying||i.isDestroyed||r.sendEvent(i,n.eventName,[i,n.keyName],n.listeners)},n.prototype.clear=function(){this.observerSet={},this.observers=[]}}),e("ember-metal/path_cache",["exports","ember-metal/cache"],function(e,t){"use strict";function r(e){return h.get(e)}function n(e){return m.get(e)}function i(e){return d.get(e)}function a(e){return-1!==f.get(e)}function s(e){return p.get(e)}function o(e){return v.get(e)}e.isGlobal=r,e.isGlobalPath=n,e.hasThis=i,e.isPath=a,e.getFirstKey=s,e.getTailPath=o;var u=/^([A-Z$]|([0-9][A-Z$]))/,l=/^([A-Z$]|([0-9][A-Z$])).*[\.]/,c="this.",h=new t["default"](1e3,function(e){return u.test(e)}),m=new t["default"](1e3,function(e){return l.test(e)}),d=new t["default"](1e3,function(e){return 0===e.lastIndexOf(c,0)}),f=new t["default"](1e3,function(e){return e.indexOf(".")}),p=new t["default"](1e3,function(e){var t=f.get(e);return-1===t?e:e.slice(0,t)}),v=new t["default"](1e3,function(e){var t=f.get(e);return-1!==t?e.slice(t+1):void 0}),g={isGlobalCache:h,isGlobalPathCache:m,hasThisCache:d,firstDotIndexCache:f,firstKeyCache:p,tailPathCache:v};e.caches=g}),e("ember-metal/platform/create",["exports","ember-metal/platform/define_properties"],function(e,t){"REMOVE_USE_STRICT: true";var r;if(!Object.create||Object.create(null).hasOwnProperty){var n,i=!({__proto__:null}instanceof Object);n=i||"undefined"==typeof document?function(){return{__proto__:null}}:function(){function e(){}var t=document.createElement("iframe"),r=document.body||document.documentElement;t.style.display="none",r.appendChild(t),t.src="javascript:";var i=t.contentWindow.Object.prototype;return r.removeChild(t),t=null,delete i.constructor,delete i.hasOwnProperty,delete i.propertyIsEnumerable,delete i.isPrototypeOf,delete i.toLocaleString,delete i.toString,delete i.valueOf,e.prototype=i,n=function(){return new e},new e},r=Object.create=function(e,r){function i(){}var a;if(null===e)a=n();else{if("object"!=typeof e&&"function"!=typeof e)throw new TypeError("Object prototype may only be an Object or null");i.prototype=e,a=new i}return void 0!==r&&t["default"](a,r),a}}else r=Object.create;e["default"]=r}),e("ember-metal/platform/define_properties",["exports","ember-metal/platform/define_property"],function(e,t){"use strict";var r=Object.defineProperties;r||(r=function(e,r){for(var n in r)r.hasOwnProperty(n)&&"__proto__"!==n&&t.defineProperty(e,n,r[n]);return e},Object.defineProperties=r),e["default"]=r}),e("ember-metal/platform/define_property",["exports"],function(e){"use strict";var t=function(e){if(e)try{var t=5,r={};if(e(r,"a",{configurable:!0,enumerable:!0,get:function(){return t},set:function(e){t=e}}),5!==r.a)return;if(r.a=10,10!==t)return;e(r,"a",{configurable:!0,enumerable:!1,writable:!0,value:!0});for(var n in r)if("a"===n)return;if(r.a!==!0)return;if(e(r,"a",{enumerable:!1}),r.a!==!0)return;return e}catch(i){return}}(Object.defineProperty),r=!!t;if(r&&"undefined"!=typeof document){var n=function(){try{return t(document.createElement("div"),"definePropertyOnDOM",{}),!0}catch(e){}return!1}();n||(t=function(e,t,r){var n;return n="object"==typeof Node?e instanceof Node:"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName,n?e[t]=r.value:Object.defineProperty(e,t,r)})}r||(t=function(e,t,r){r.get||(e[t]=r.value)});var i=r,a=r;e.hasES5CompliantDefineProperty=r,e.defineProperty=t,e.hasPropertyAccessors=i,e.canDefineNonEnumerableProperties=a}),e("ember-metal/properties",["exports","ember-metal/core","ember-metal/utils","ember-metal/platform/define_property","ember-metal/property_events"],function(e,t,r,n,i){"use strict";function a(){this.isDescriptor=!0}function s(e){return function(e){}}function o(e){return function(){var t=this.__ember_meta__;return t&&t.values[e]}}function u(e,t,s,o,u){var l,c,h,m;u||(u=r.meta(e));var d=u.watching[t];return l=e[t],c=null!==l&&"object"==typeof l&&l.isDescriptor?l:void 0,h=void 0!==d&&d>0,c&&c.teardown(e,t),s instanceof a?(m=s,e[t]=m,s.setup&&s.setup(e,t)):null==s?(m=o,e[t]=o):(m=s,n.defineProperty(e,t,s)),h&&i.overrideChains(e,t,u),e.didDefineProperty&&e.didDefineProperty(e,t,m),this}e.Descriptor=a,e.MANDATORY_SETTER_FUNCTION=s,e.DEFAULT_GETTER_FUNCTION=o,e.defineProperty=u}),e("ember-metal/property_events",["exports","ember-metal/utils","ember-metal/events","ember-metal/observer_set"],function(e,t,r,n){"use strict";function i(e,t){var r=e.__ember_meta__,n=r&&r.watching[t]>0||"length"===t,i=r&&r.proto,a=e[t],o=null!==a&&"object"==typeof a&&a.isDescriptor?a:void 0;n&&i!==e&&(o&&o.willChange&&o.willChange(e,t),s(e,t,r),c(e,t,r),v(e,t))}function a(e,t){var r=e.__ember_meta__,n=r&&r.watching[t]>0||"length"===t,i=r&&r.proto,a=e[t],s=null!==a&&"object"==typeof a&&a.isDescriptor?a:void 0;i!==e&&(s&&s.didChange&&s.didChange(e,t),(n||"length"===t)&&(r&&r.deps&&r.deps[t]&&o(e,t,r),h(e,t,r,!1),g(e,t)))}function s(e,t,r){if(!e.isDestroying){var n;if(r&&r.deps&&(n=r.deps[t])){var a=b,s=!a;s&&(a=b={}),l(i,e,n,t,a,r),s&&(b=null)}}}function o(e,t,r){if(!e.isDestroying){var n;if(r&&r.deps&&(n=r.deps[t])){var i=y,s=!i;s&&(i=y={}),l(a,e,n,t,i,r),s&&(y=null)}}}function u(e){var t=[];for(var r in e)t.push(r);return t}function l(e,r,n,i,a,s){var o,l,c,h,m,d=t.guidFor(r),f=a[d];if(f||(f=a[d]={}),!f[i]&&(f[i]=!0,n))for(o=u(n),c=0;c<o.length;c++)l=o[c],h=r[l],m=null!==h&&"object"==typeof h&&h.isDescriptor?h:void 0,m&&m._suspended===r||e(r,l)}function c(e,t,r){if(r.hasOwnProperty("chainWatchers")&&r.chainWatchers[t]){var n,a,s=r.chainWatchers[t],o=[];for(n=0,a=s.length;a>n;n++)s[n].willChange(o);for(n=0,a=o.length;a>n;n+=2)i(o[n],o[n+1])}}function h(e,t,r,n){if(r&&r.hasOwnProperty("chainWatchers")&&r.chainWatchers[t]){var i,s,o=r.chainWatchers[t],u=n?null:[];for(i=0,s=o.length;s>i;i++)o[i].didChange(u);if(!n)for(i=0,s=u.length;s>i;i+=2)a(u[i],u[i+1])}}function m(e,t,r){h(e,t,r,!0)}function d(){x++}function f(){x--,0>=x&&(_.clear(),w.flush())}function p(e,r){d(),t.tryFinally(e,f,r)}function v(e,t){if(!e.isDestroying){var n,i,a=t+":before";x?(n=_.add(e,t,a),i=r.accumulateListeners(e,a,n),r.sendEvent(e,a,[e,t],i)):r.sendEvent(e,a,[e,t])}}function g(e,t){if(!e.isDestroying){var n,i=t+":change";x?(n=w.add(e,t,i),r.accumulateListeners(e,i,n)):r.sendEvent(e,i,[e,t])}}e.propertyWillChange=i,e.propertyDidChange=a,e.overrideChains=m,e.beginPropertyChanges=d,e.endPropertyChanges=f,e.changeProperties=p;var b,y,_=new n["default"],w=new n["default"],x=0}),e("ember-metal/property_get",["exports","ember-metal/core","ember-metal/error","ember-metal/path_cache","ember-metal/platform/define_property"],function(e,t,r,n,i){"use strict";function a(e,t){if(""===t)return e;if(t||"string"!=typeof e||(t=e,e=null),null===e){var r=o(e,t);return r}var i,a=(e.__ember_meta__,e[t]),s=null!==a&&"object"==typeof a&&a.isDescriptor?a:void 0;return void 0===s&&n.isPath(t)?o(e,t):s?s.get(e,t):(i=e[t],void 0!==i||"object"!=typeof e||t in e||"function"!=typeof e.unknownProperty?i:e.unknownProperty(t))}function s(e,i){var s,o=n.hasThis(i),u=!o&&n.isGlobalPath(i);if((!e||u)&&(e=t["default"].lookup),o&&(i=i.slice(5)),e===t["default"].lookup&&(s=i.match(l)[0],e=a(e,s),i=i.slice(s.length+1)),!i||0===i.length)throw new r["default"]("Path cannot be empty");return[e,i]}function o(e,r){var i,o,u,l,c;if(null===e&&!n.isPath(r))return a(t["default"].lookup,r);for(i=n.hasThis(r),(!e||i)&&(u=s(e,r),e=u[0],r=u[1],u.length=0),o=r.split("."),c=o.length,l=0;null!=e&&c>l;l++)if(e=a(e,o[l],!0),e&&e.isDestroyed)return void 0;return e}function u(e,t,r){var n=a(e,t);return void 0===n?r:n}e.get=a,e.normalizeTuple=s,e._getPath=o,e.getWithDefault=u;var l=/^([^\.]+)/;e["default"]=a}),e("ember-metal/property_set",["exports","ember-metal/core","ember-metal/property_get","ember-metal/property_events","ember-metal/properties","ember-metal/error","ember-metal/path_cache","ember-metal/platform/define_property"],function(e,t,r,n,i,a,s,o){"use strict";function u(e,t,r,i){if("string"==typeof e&&(r=t,t=e,e=null),!e)return l(e,t,r,i);var a,o,u=e.__ember_meta__,c=e[t],h=null!==c&&"object"==typeof c&&c.isDescriptor?c:void 0;if(void 0===h&&s.isPath(t))return l(e,t,r,i);if(h)h.set(e,t,r);else{if("object"==typeof e&&null!==e&&void 0!==r&&e[t]===r)return r;a="object"==typeof e&&!(t in e),a&&"function"==typeof e.setUnknownProperty?e.setUnknownProperty(t,r):u&&u.watching[t]>0?(u.proto!==e&&(o=e[t]),r!==o&&(n.propertyWillChange(e,t),e[t]=r,n.propertyDidChange(e,t))):e[t]=r}return r}function l(e,t,n,i){var s;if(s=t.slice(t.lastIndexOf(".")+1),t=t===s?s:t.slice(0,t.length-(s.length+1)),"this"!==t&&(e=r._getPath(e,t)),!s||0===s.length)throw new a["default"]("Property set failed: You passed an empty path");if(!e){if(i)return;throw new a["default"]('Property set failed: object in path "'+t+'" could not be found or was destroyed.')}return u(e,s,n)}function c(e,t,r){return u(e,t,r,!0)}e.set=u,e.trySet=c}),e("ember-metal/run_loop",["exports","ember-metal/core","ember-metal/utils","ember-metal/array","ember-metal/property_events","backburner"],function(e,t,r,n,i,a){"use strict";function s(e){u.currentRunLoop=e}function o(e,t){u.currentRunLoop=t}function u(){return c.run.apply(c,arguments)}function l(){!u.currentRunLoop}var c=new a["default"](["sync","actions","destroy"],{GUID_KEY:r.GUID_KEY,sync:{before:i.beginPropertyChanges,after:i.endPropertyChanges},defaultQueue:"actions",onBegin:s,onEnd:o,onErrorTarget:t["default"],onErrorMethod:"onerror"}),h=[].slice;e["default"]=u,u.join=function(){return c.join.apply(c,arguments)},u.bind=function(e,t){var r=h.call(arguments);return function(){return u.join.apply(u,r.concat(h.call(arguments)))}},u.backburner=c,u.currentRunLoop=null,u.queues=c.queueNames,u.begin=function(){c.begin()},u.end=function(){c.end()},u.schedule=function(e,t,r){l(),c.schedule.apply(c,arguments)},u.hasScheduledTimers=function(){return c.hasTimers()},u.cancelTimers=function(){c.cancelTimers()},u.sync=function(){c.currentInstance&&c.currentInstance.queues.sync.flush()},u.later=function(){return c.later.apply(c,arguments)},u.once=function(){l();var e=arguments.length,t=new Array(e);t[0]="actions";for(var n=0;e>n;n++)t[n+1]=arguments[n];return r.apply(c,c.scheduleOnce,t)},u.scheduleOnce=function(){return l(),c.scheduleOnce.apply(c,arguments)},u.next=function(){var e=h.call(arguments);return e.push(1),r.apply(c,c.later,e)},u.cancel=function(e){return c.cancel(e)},u.debounce=function(){return c.debounce.apply(c,arguments)},u.throttle=function(){return c.throttle.apply(c,arguments)},u._addQueue=function(e,t){-1===n.indexOf.call(u.queues,e)&&u.queues.splice(n.indexOf.call(u.queues,t)+1,0,e)}}),e("ember-metal/set_properties",["exports","ember-metal/property_events","ember-metal/property_set","ember-metal/keys"],function(e,t,r,n){"use strict";function i(e,i){return i&&"object"==typeof i?(t.changeProperties(function(){for(var t,a=n["default"](i),s=0,o=a.length;o>s;s++)t=a[s],r.set(e,t,i[t])}),e):e}e["default"]=i}),e("ember-metal/streams/conditional",["exports","ember-metal/streams/stream","ember-metal/streams/utils","ember-metal/platform/create"],function(e,t,r,n){"use strict";function i(e,t,n){return r.isStream(e)?new a(e,t,n):e?t:n}function a(e,t,r){this.init(),this.oldTestResult=void 0,this.test=e,this.consequent=t,this.alternate=r}e["default"]=i,a.prototype=n["default"](t["default"].prototype),a.prototype.valueFn=function(){var e=this.oldTestResult,t=!!r.read(this.test);if(t!==e){switch(e){case!0:r.unsubscribe(this.consequent,this.notify,this);break;case!1:r.unsubscribe(this.alternate,this.notify,this);break;case void 0:r.subscribe(this.test,this.notify,this)}switch(t){case!0:r.subscribe(this.consequent,this.notify,this);break;case!1:r.subscribe(this.alternate,this.notify,this)}this.oldTestResult=t}return r.read(t?this.consequent:this.alternate)}}),e("ember-metal/streams/simple",["exports","ember-metal/merge","ember-metal/streams/stream","ember-metal/platform/create","ember-metal/streams/utils"],function(e,t,r,n,i){"use strict";function a(e){this.init(),this.source=e,i.isStream(e)&&e.subscribe(this._didChange,this)}a.prototype=n["default"](r["default"].prototype),t["default"](a.prototype,{valueFn:function(){return i.read(this.source)},setValue:function(e){var t=this.source;i.isStream(t)&&t.setValue(e)},setSource:function(e){var t=this.source;e!==t&&(i.isStream(t)&&t.unsubscribe(this._didChange,this),i.isStream(e)&&e.subscribe(this._didChange,this),this.source=e,this.notify())},_didChange:function(){this.notify()},_super$destroy:r["default"].prototype.destroy,destroy:function(){return this._super$destroy()?(i.isStream(this.source)&&this.source.unsubscribe(this._didChange,this),this.source=void 0,!0):void 0}}),e["default"]=a}),e("ember-metal/streams/stream",["exports","ember-metal/platform/create","ember-metal/path_cache"],function(e,t,r){"use strict";function n(e){this.init(),this.valueFn=e}n.prototype={isStream:!0,init:function(){this.state="dirty",this.cache=void 0,this.subscribers=void 0,this.children=void 0,this._label=void 0},get:function(e){var n=r.getFirstKey(e),i=r.getTailPath(e);void 0===this.children&&(this.children=t["default"](null));var a=this.children[n];return void 0===a&&(a=this._makeChildStream(n,e),this.children[n]=a),void 0===i?a:a.get(i)},value:function(){return"clean"===this.state?this.cache:"dirty"===this.state?(this.state="clean",this.cache=this.valueFn()):void 0},valueFn:function(){throw new Error("Stream error: valueFn not implemented")},setValue:function(){throw new Error("Stream error: setValue not implemented")},notify:function(){this.notifyExcept()},notifyExcept:function(e,t){"clean"===this.state&&(this.state="dirty",this._notifySubscribers(e,t))},subscribe:function(e,t){void 0===this.subscribers?this.subscribers=[e,t]:this.subscribers.push(e,t)},unsubscribe:function(e,t){var r=this.subscribers;if(void 0!==r)for(var n=0,i=r.length;i>n;n+=2)if(r[n]===e&&r[n+1]===t)return void r.splice(n,2)},_notifySubscribers:function(e,t){var r=this.subscribers;if(void 0!==r)for(var n=0,i=r.length;i>n;n+=2){var a=r[n],s=r[n+1];(a!==e||s!==t)&&(void 0===s?a(this):a.call(s,this))}},destroy:function(){if("destroyed"!==this.state){this.state="destroyed";var e=this.children;for(var t in e)e[t].destroy();return!0}},isGlobal:function(){for(var e=this;void 0!==e;){if(e._isRoot)return e._isGlobal;e=e.source}}},e["default"]=n}),e("ember-metal/streams/stream_binding",["exports","ember-metal/platform/create","ember-metal/merge","ember-metal/run_loop","ember-metal/streams/stream"],function(e,t,r,n,i){"use strict";function a(e){this.init(),this.stream=e,this.senderCallback=void 0,this.senderContext=void 0,this.senderValue=void 0,e.subscribe(this._onNotify,this)}a.prototype=t["default"](i["default"].prototype),r["default"](a.prototype,{valueFn:function(){return this.stream.value()},_onNotify:function(){this._scheduleSync(void 0,void 0,this)},setValue:function(e,t,r){this._scheduleSync(e,t,r)},_scheduleSync:function(e,t,r){void 0===this.senderCallback&&void 0===this.senderContext?(this.senderCallback=t,this.senderContext=r,this.senderValue=e,n["default"].schedule("sync",this,this._sync)):this.senderContext!==this&&(this.senderCallback=t,this.senderContext=r,this.senderValue=e)},_sync:function(){if("destroyed"!==this.state){this.senderContext!==this&&this.stream.setValue(this.senderValue);var e=this.senderCallback,t=this.senderContext;this.senderCallback=void 0,this.senderContext=void 0,this.senderValue=void 0,this.state="clean",this.notifyExcept(e,t)}},_super$destroy:i["default"].prototype.destroy,destroy:function(){return this._super$destroy()?(this.stream.unsubscribe(this._onNotify,this),!0):void 0}}),e["default"]=a}),e("ember-metal/streams/utils",["exports","./stream"],function(e,t){"use strict";function r(e){return e&&e.isStream}function n(e,t,r){e&&e.isStream&&e.subscribe(t,r)}function i(e,t,r){e&&e.isStream&&e.unsubscribe(t,r)}function a(e){return e&&e.isStream?e.value():e}function s(e){for(var t=e.length,r=new Array(t),n=0;t>n;n++)r[n]=a(e[n]);return r}function o(e){var t={};for(var r in e)t[r]=a(e[r]);return t}function u(e){for(var t=e.length,n=!1,i=0;t>i;i++)if(r(e[i])){n=!0;break}return n}function l(e){var t=!1;for(var n in e)if(r(e[n])){t=!0;break}return t}function c(e,r){var i=u(e);if(i){var a,o,l=new t["default"](function(){return s(e).join(r)});for(a=0,o=e.length;o>a;a++)n(e[a],l.notify,l);return l}return e.join(r)}function h(e,i){if(r(e)){var a=new t["default"](i);return n(e,a.notify,a),a}return i()}e.isStream=r,e.subscribe=n,e.unsubscribe=i,e.read=a,e.readArray=s,e.readHash=o,e.scanArray=u,e.scanHash=l,e.concat=c,e.chain=h}),e("ember-metal/utils",["exports","ember-metal/core","ember-metal/platform/create","ember-metal/platform/define_property","ember-metal/array"],function(e,t,r,n,i){function a(){return++C}function s(e){var t={};t[e]=1;for(var r in t)if(r===e)return r;return e}function o(e,t){t||(t=E);var r=t+a();return e&&(null===e[S]?e[S]=r:(A.value=r,e.__defineNonEnumerable?e.__defineNonEnumerable(I):n.defineProperty(e,S,A))),r}function u(e){if(void 0===e)return"(undefined)";if(null===e)return"(null)";var t,r=typeof e;switch(r){case"number":return t=O[e],t||(t=O[e]="nu"+e),t;case"string":return t=P[e],t||(t=P[e]="st"+a()),t;case"boolean":return e?"(true)":"(false)";default:return e[S]?e[S]:e===Object?"(Object)":e===Array?"(Array)":(t=E+a(),null===e[S]?e[S]=t:(A.value=t,e.__defineNonEnumerable?e.__defineNonEnumerable(I):n.defineProperty(e,S,A)),t)}}function l(e){this.watching={},this.cache=void 0,this.cacheMeta=void 0,this.source=e,this.deps=void 0,this.listeners=void 0,this.mixins=void 0,this.bindings=void 0,this.chains=void 0,this.values=void 0,this.proto=void 0}function c(e,t){var i=e.__ember_meta__;return t===!1?i||D:(i?i.source!==e&&(e.__defineNonEnumerable?e.__defineNonEnumerable(M):n.defineProperty(e,"__ember_meta__",k),i=r["default"](i),i.watching=r["default"](i.watching),i.cache=void 0,i.cacheMeta=void 0,i.source=e,e.__ember_meta__=i):(n.canDefineNonEnumerableProperties&&(e.__defineNonEnumerable?e.__defineNonEnumerable(M):n.defineProperty(e,"__ember_meta__",k)),i=new l(e),e.__ember_meta__=i),i)}function h(e,t){var r=c(e,!1);return r[t]}function m(e,t,r){var n=c(e,!0);return n[t]=r,r}function d(e,t,n){for(var i,a,s=c(e,n),o=0,u=t.length;u>o;o++){if(i=t[o],a=s[i]){if(a.__ember_source__!==e){if(!n)return void 0;a=s[i]=r["default"](a),a.__ember_source__=e}}else{if(!n)return void 0;a=s[i]={__ember_source__:e}}s=a}return a}function f(e,t){function r(){var r,n=this&&this.__nextSuper,i=arguments.length;if(this&&(this.__nextSuper=t),0===i)r=e.call(this);else if(1===i)r=e.call(this,arguments[0]);else if(2===i)r=e.call(this,arguments[0],arguments[1]);else{for(var a=new Array(i),s=0;i>s;s++)a[s]=arguments[s];r=w(this,e,a)}return this&&(this.__nextSuper=n),r}return r.wrappedFunction=e,r.__ember_observes__=e.__ember_observes__,r.__ember_observesBefore__=e.__ember_observesBefore__,r.__ember_listens__=e.__ember_listens__,r}function p(e){var r,n;return"undefined"==typeof j&&(r="ember-runtime/mixins/array",t["default"].__loader.registry[r]&&(j=t["default"].__loader.require(r)["default"])),!e||e.setInterval?!1:Array.isArray&&Array.isArray(e)?!0:j&&j.detect(e)?!0:(n=y(e),"array"===n?!0:void 0!==e.length&&"object"===n?!0:!1)}function v(e){return null===e||void 0===e?[]:p(e)?e:[e]}function g(e,t){return!(!e||"function"!=typeof e[t])}function b(e,t,r){return g(e,t)?r?x(e,t,r):x(e,t):void 0}function y(e){var r,n;return"undefined"==typeof z&&(n="ember-runtime/system/object",t["default"].__loader.registry[n]&&(z=t["default"].__loader.require(n)["default"])),r=null===e||void 0===e?String(e):B[q.call(e)]||"object","function"===r?z&&z.detect(e)&&(r="class"):"object"===r&&(e instanceof Error?r="error":z&&e instanceof z?r="instance":e instanceof Date&&(r="date")),r}function _(e){var t=y(e);if("array"===t)return"["+e+"]";if("object"!==t)return e+"";var r,n=[];for(var i in e)if(e.hasOwnProperty(i)){if(r=e[i],"toString"===r)continue;"function"===y(r)&&(r="function() { ... }"),n.push(r&&"function"!=typeof r.toString?i+": "+q.call(r):i+": "+r)}return"{"+n.join(", ")+"}"}function w(e,t,r){var n=r&&r.length;if(!r||!n)return t.call(e);switch(n){case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2]);case 4:return t.call(e,r[0],r[1],r[2],r[3]);case 5:return t.call(e,r[0],r[1],r[2],r[3],r[4]);default:return t.apply(e,r)}}function x(e,t,r){var n=r&&r.length;if(!r||!n)return e[t]();switch(n){case 1:return e[t](r[0]);case 2:return e[t](r[0],r[1]);case 3:return e[t](r[0],r[1],r[2]);case 4:return e[t](r[0],r[1],r[2],r[3]);case 5:return e[t](r[0],r[1],r[2],r[3],r[4]);default:return e[t].apply(e,r)}}e.uuid=a,e.generateGuid=o,e.guidFor=u,e.getMeta=h,e.setMeta=m,e.metaPath=d,e.wrap=f,e.makeArray=v,e.tryInvoke=b,e.inspect=_,e.apply=w,e.applyStr=x,e.meta=c,e.typeOf=y,e.isArray=p,e.canInvoke=g;var C=0,E="ember",O=[],P={},S=s("__ember"+ +new Date),A={writable:!0,configurable:!0,enumerable:!1,value:null},N={configurable:!0,writable:!0,enumerable:!1,value:void 0},T={configurable:!0,writable:!0,enumerable:!1,value:null},k={writable:!0,configurable:!0,enumerable:!1,value:null},M={name:"__ember_meta__",descriptor:k},I={name:S,descriptor:T},V={name:"__nextSuper",descriptor:N};l.prototype={chainWatchers:null},n.canDefineNonEnumerableProperties||(l.prototype.__preventPlainObject__=!0,l.prototype.toJSON=function(){});var j,R,D=new l(null),F=function(){var e=0;try{try{}finally{throw e++,new Error("needsFinallyFixTest")}}catch(t){}return 1!==e}();R=F?function(e,t,r){var n,i,a;r=r||this;try{n=e.call(r)}finally{try{i=t.call(r)}catch(s){a=s}}if(a)throw a;return void 0===i?n:i}:function(e,t,r){var n,i;r=r||this;try{n=e.call(r)}finally{i=t.call(r)}return void 0===i?n:i};var L;L=F?function(e,t,r,n){var i,a,s;n=n||this;try{i=e.call(n)}catch(o){i=t.call(n,o)}finally{try{a=r.call(n)}catch(u){s=u}}if(s)throw s;return void 0===a?i:a}:function(e,t,r,n){var i,a;n=n||this;try{i=e.call(n)}catch(s){i=t.call(n,s)}finally{a=r.call(n)}return void 0===a?i:a};var B={},H="Boolean Number String Function Array Date RegExp Object".split(" ");i.forEach.call(H,function(e){B["[object "+e+"]"]=e.toLowerCase()});var z,q=Object.prototype.toString;e.GUID_DESC=A,e.EMBER_META_PROPERTY=M,e.GUID_KEY_PROPERTY=I,e.NEXT_SUPER_PROPERTY=V,e.GUID_KEY=S,e.META_DESC=k,e.EMPTY_META=D,e.tryCatchFinally=L,e.tryFinally=R}),e("ember-metal/watch_key",["exports","ember-metal/core","ember-metal/utils","ember-metal/platform/define_property","ember-metal/properties"],function(e,t,r,n,i){"use strict";function a(e,t,n){if("length"!==t||"array"!==r.typeOf(e)){var i=n||r.meta(e),a=i.watching;if(a[t])a[t]=(a[t]||0)+1;else{a[t]=1;var s=e[t],o=null!==s&&"object"==typeof s&&s.isDescriptor?s:void 0;o&&o.willWatch&&o.willWatch(e,t),"function"==typeof e.willWatchProperty&&e.willWatchProperty(t)}}}function s(e,t,n){var i=n||r.meta(e),a=i.watching;if(1===a[t]){a[t]=0;var s=e[t],o=null!==s&&"object"==typeof s&&s.isDescriptor?s:void 0;o&&o.didUnwatch&&o.didUnwatch(e,t),"function"==typeof e.didUnwatchProperty&&e.didUnwatchProperty(t)}else a[t]>1&&a[t]--}e.watchKey=a,e.unwatchKey=s}),e("ember-metal/watch_path",["exports","ember-metal/utils","ember-metal/chains"],function(e,t,r){"use strict";function n(e,n){var i=n||t.meta(e),a=i.chains;return a?a.value()!==e&&(a=i.chains=a.copy(e)):a=i.chains=new r.ChainNode(null,null,e),a}function i(e,r,i){if("length"!==r||"array"!==t.typeOf(e)){var a=i||t.meta(e),s=a.watching;s[r]?s[r]=(s[r]||0)+1:(s[r]=1,n(e,a).add(r))}}function a(e,r,i){var a=i||t.meta(e),s=a.watching;1===s[r]?(s[r]=0,n(e,a).remove(r)):s[r]>1&&s[r]--}e.watchPath=i,e.unwatchPath=a}),e("ember-metal/watching",["exports","ember-metal/utils","ember-metal/chains","ember-metal/watch_key","ember-metal/watch_path","ember-metal/path_cache"],function(e,t,r,n,i,a){"use strict";function s(e,r,s){("length"!==r||"array"!==t.typeOf(e))&&(a.isPath(r)?i.watchPath(e,r,s):n.watchKey(e,r,s))}function o(e,t){var r=e.__ember_meta__;return(r&&r.watching[t])>0}function u(e,r,s){("length"!==r||"array"!==t.typeOf(e))&&(a.isPath(r)?i.unwatchPath(e,r,s):n.unwatchKey(e,r,s))}function l(e){var t,n,i,a,s=e.__ember_meta__;if(s&&(e.__ember_meta__=null,t=s.chains))for(c.push(t);c.length>0;){if(t=c.pop(),n=t._chains)for(i in n)n.hasOwnProperty(i)&&c.push(n[i]);t._watching&&(a=t._object,a&&r.removeChainWatcher(a,t._key,t))}}e.watch=s,e.isWatching=o,e.unwatch=u,e.destroy=l,s.flushPending=r.flushPendingChains;var c=[]}),e("ember-routing-htmlbars",["exports","ember-metal/core","ember-htmlbars/helpers","ember-routing-htmlbars/helpers/outlet","ember-routing-htmlbars/helpers/render","ember-routing-htmlbars/helpers/link-to","ember-routing-htmlbars/helpers/action","ember-routing-htmlbars/helpers/query-params"],function(e,t,r,n,i,a,s,o){"use strict";r.registerHelper("outlet",n.outletHelper),r.registerHelper("render",i.renderHelper),r.registerHelper("link-to",a.linkToHelper),r.registerHelper("linkTo",a.deprecatedLinkToHelper),r.registerHelper("action",s.actionHelper),r.registerHelper("query-params",o.queryParamsHelper),e["default"]=t["default"]}),e("ember-routing-htmlbars/helpers/action",["exports","ember-metal/core","ember-metal/utils","ember-metal/run_loop","ember-views/streams/utils","ember-views/system/utils","ember-views/system/action_manager","ember-metal/streams/utils"],function(e,t,r,n,i,a,s,o){"use strict";function u(e,t){var r,n,a;if(void 0===t)for(r=new Array(e.length),n=0,a=e.length;a>n;n++)r[n]=i.readUnwrappedModel(e[n]);else for(r=new Array(e.length+1),r[0]=t,n=0,a=e.length;a>n;n++)r[n+1]=i.readUnwrappedModel(e[n]);return r}function l(e,t,r,n){var i,a=n.data.view;i=t.target?o.isStream(t.target)?t.target:a.getStream(t.target):a.getStream("controller");var s={eventName:t.on||"click",parameters:e.slice(1),view:a,bubbles:t.bubbles,preventDefault:t.preventDefault,target:i,withKeyCode:t.withKeyCode},u=c.registerAction(e[0],s,t.allowedKeys);n.dom.setAttribute(r.element,"data-ember-action",u)}e.actionHelper=l;var c={};c.registeredActions=s["default"].registeredActions;var h=["alt","shift","meta","ctrl"],m=/^click|mouse|touch/,d=function(e,t){if("undefined"==typeof t){if(m.test(e.type))return a.isSimpleClick(e);t=""}if(t.indexOf("any")>=0)return!0;for(var r=0,n=h.length;n>r;r++)if(e[h[r]+"Key"]&&-1===t.indexOf(h[r]))return!1;return!0};c.registerAction=function(e,t,i){var a=r.uuid(),l=t.eventName,c=t.parameters;return s["default"].registeredActions[a]={eventName:l,handler:function(r){if(!d(r,i))return!0;t.preventDefault!==!1&&r.preventDefault(),t.bubbles===!1&&r.stopPropagation();var a,s=t.target.value();a=o.isStream(e)?e.value():e,n["default"](function(){s.send?s.send.apply(s,u(c,a)):s[a].apply(s,u(c))})}},t.view.on("willClearRender",function(){delete s["default"].registeredActions[a]}),a},e.ActionHelper=c}),e("ember-routing-htmlbars/helpers/link-to",["exports","ember-metal/core","ember-routing-views/views/link","ember-metal/streams/utils","ember-runtime/mixins/controller","ember-htmlbars/templates/link-to-escaped","ember-htmlbars/templates/link-to-unescaped","ember-htmlbars"],function(e,t,r,n,i,a,s){"use strict";function o(e,t,o,u){var l,c=(u.data.view,e[e.length-1]);if(c&&c.isQueryParams&&(t.queryParamsObject=l=e.pop()),t.disabledWhen&&(t.disabled=t.disabledWhen,delete t.disabledWhen),!o.template){var h=e.shift(),m=o.morph.parseTextAsHTML;m?t.layout=s["default"]:t.layout=a["default"],t.linkTitle=h}for(var d=0;d<e.length;d++)if(n.isStream(e[d])){var f=e[d];if(!f._isController)for(;i["default"].detect(f.value());)f=f.get("model");e[d]=f}return t.params=e,o.helperName=o.helperName||"link-to",u.helpers.view.helperFunction.call(this,[r.LinkView],t,o,u)}function u(e,t,r,n){return n.helpers["link-to"].helperFunction.call(this,e,t,r,n)}e.deprecatedLinkToHelper=u,e.linkToHelper=o}),e("ember-routing-htmlbars/helpers/outlet",["exports","ember-metal/core"],function(e,t){"use strict";function r(e,t,r,n){var i,a,s,o=n.data.view,u=e[0]||"main";return i=t.view,i&&(s="view:"+i),a=i?o.container.lookupFactory(s):t.viewClass||o.container.lookupFactory("view:-outlet"),t._outletName=u,r.helperName=r.helperName||"outlet",n.helpers.view.helperFunction.call(this,[a],t,r,n)}e.outletHelper=r}),e("ember-routing-htmlbars/helpers/query-params",["exports","ember-metal/core","ember-routing/system/query_params"],function(e,t,r){"use strict";function n(e,t){return r["default"].create({values:t})}e.queryParamsHelper=n}),e("ember-routing-htmlbars/helpers/render",["exports","ember-metal/core","ember-metal/property_get","ember-metal/error","ember-runtime/system/string","ember-routing/system/generate_controller","ember-metal/streams/utils","ember-htmlbars/system/merge-view-bindings","ember-htmlbars/system/append-templated-view","ember-metal/platform/create"],function(e,t,r,n,i,a,s,o,u,l){"use strict";function c(e,t,s,l){var c,m,d,f,p,v=l.data.view,g=e[0],b=e[1];if(c=v._keywords.controller.value().container,m=c.lookup("router:main"),1===e.length);else{if(2!==e.length)throw new n["default"]("You must pass a templateName to render");p=b.value()}g=g.replace(/\//g,".");var y="template:"+g,_=s.template;f=c.lookup("view:"+g),
f||(f=c.lookup("view:default"));var w=!!r.get(f,"template");w||(_=_||c.lookup(y));var x,C;t.controller?(x=t.controller,C="controller:"+x,delete t.controller):(x=g,C="controller:"+x);var E=v._keywords.controller.value();if(e.length>1){var O=c.lookupFactory(C)||a.generateControllerFactory(c,x,p);d=O.create({modelBinding:b,parentController:E,target:E}),f.one("willDestroyElement",function(){d.destroy()})}else d=c.lookup(C)||a["default"](c,x),d.setProperties({target:E,parentController:E});t.viewName=i.camelize(g),m&&!p&&m._connectActiveView(g,f);var P={template:_,controller:d,helperName:'render "'+g+'"'};h(v,f,g),o["default"](v,P,t),u["default"](v,s.morph,f,P)}function h(e,r,n){r._childOutlets=t["default"].A(),r._isOutlet=!0,r._outletName="__ember_orphans__",r._matchOutletName=n,r._parentOutlet=function(){for(var e=this._parentView;e&&!e._isOutlet;)e=e._parentView;return e},r.setOutletState=function(e){var t;e&&(t=e.outlets[this._matchOutletName])?(this._outletState={render:{name:"render helper stub"},outlets:l["default"](null)},this._outletState.outlets[t.render.outlet]=t,t.wasUsed=!0):this._outletState=null;for(var r=0;r<this._childOutlets.length;r++){var n=this._childOutlets[r];n.setOutletState(this._outletState&&this._outletState.outlets[n._outletName])}};for(var i,a=e;a&&!a._isOutlet;)a=a._parentView;for(;a&&(i=a._parentOutlet());)a=i;a&&(a._childOutlets.push(r),a._outletState&&r.setOutletState(a._outletState.outlets[r._outletName]))}e.renderHelper=c}),e("ember-routing-views",["exports","ember-metal/core","ember-routing-views/views/link","ember-routing-views/views/outlet"],function(e,t,r,n){"use strict";t["default"].LinkView=r.LinkView,t["default"].OutletView=n.OutletView,e["default"]=t["default"]}),e("ember-routing-views/views/link",["exports","ember-metal/core","ember-metal/property_get","ember-metal/merge","ember-metal/run_loop","ember-metal/computed","ember-runtime/system/string","ember-metal/keys","ember-views/system/utils","ember-views/views/component","ember-routing/utils","ember-metal/streams/utils"],function(e,t,r,n,i,a,s,o,u,l,c,h){"use strict";function m(e,t){var r=e.queryParamsObject,n={};if(!r)return n;var i=r.values;for(var a in i)i.hasOwnProperty(a)&&(n[a]=h.read(i[a]));return n}function d(e){for(var t=0,r=e.length;r>t;++t){var n=e[t];if(null===n||"undefined"==typeof n)return!1}return!0}function f(e,t){if(r.get(e,"loading"))return!1;var n=e["current-when"]||e.currentWhen,i=!!n;n=n||r.get(e,"loadedParams").targetRouteName,n=n.split(" ");for(var a=0,s=n.length;s>a;a++)if(p(e,n[a],i,t))return r.get(e,"activeClass");return!1}function p(e,t,n,i){var a=r.get(e,"router"),s=r.get(e,"loadedParams"),o=s.models,u=a.router.recognizer.handlersFor(t),l=u[u.length-1].handler,c=v(t,u);return o.length>c&&(t=l),i.isActiveIntent(t,o,s.queryParams,!n)}var v=function(e,t){for(var r=0,n=0,i=t.length;i>n&&(r+=t[n].names.length,t[n].handler!==e);n++);return r},g=["active","loading","disabled"];g=["active","loading","disabled","transitioningIn","transitioningOut"];var b=l["default"].extend({tagName:"a",currentWhen:null,"current-when":null,title:null,rel:null,tabindex:null,target:null,activeClass:"active",loadingClass:"loading",disabledClass:"disabled",_isDisabled:!1,replace:!1,attributeBindings:["href","title","rel","tabindex","target"],classNameBindings:g,eventName:"click",init:function(){this._super.apply(this,arguments);var e=r.get(this,"eventName");this.on(e,this,this._invoke)},_paramsChanged:function(){this.notifyPropertyChange("resolvedParams")},_setupPathObservers:function(){for(var e=this.params,t=this._wrapAsScheduled(this._paramsChanged),r=0;r<e.length;r++)h.subscribe(e[r],t,this);var n=this.queryParamsObject;if(n){var i=n.values;for(var a in i)i.hasOwnProperty(a)&&h.subscribe(i[a],t,this)}},afterRender:function(){this._super.apply(this,arguments),this._setupPathObservers()},disabled:a.computed(function(e,t){return void 0!==t&&this.set("_isDisabled",t),t?r.get(this,"disabledClass"):!1}),active:a.computed("loadedParams",function(){var e=r.get(this,"router");if(e)return f(this,e.currentState)}),willBeActive:a.computed("router.targetState",function(){var e=r.get(this,"router");if(e){var t=e.targetState;if(e.currentState!==t)return!!f(this,t)}}),transitioningIn:a.computed("active","willBeActive",function(){var e=r.get(this,"willBeActive");return"undefined"==typeof e?!1:!r.get(this,"active")&&e&&"ember-transitioning-in"}),transitioningOut:a.computed("active","willBeActive",function(){var e=r.get(this,"willBeActive");return"undefined"==typeof e?!1:r.get(this,"active")&&!e&&"ember-transitioning-out"}),loading:a.computed("loadedParams",function(){return r.get(this,"loadedParams")?void 0:r.get(this,"loadingClass")}),router:a.computed(function(){var e=r.get(this,"controller");return e&&e.container?e.container.lookup("router:main"):void 0}),_invoke:function(e){if(!u.isSimpleClick(e))return!0;if(this.preventDefault!==!1){var n=r.get(this,"target");n&&"_self"!==n||e.preventDefault()}if(this.bubbles===!1&&e.stopPropagation(),r.get(this,"_isDisabled"))return!1;if(r.get(this,"loading"))return t["default"].Logger.warn("This link-to is in an inactive loading state because at least one of its parameters presently has a null/undefined value, or the provided route name is invalid."),!1;var i=r.get(this,"target");if(i&&"_self"!==i)return!1;var a=r.get(this,"router"),s=r.get(this,"loadedParams"),o=a._doTransition(s.targetRouteName,s.models,s.queryParams);return void(r.get(this,"replace")&&o.method("replace"))},_eagerUpdateUrl:function(e,t){if(e.isActive&&e.urlMethod){0===t.indexOf("#")&&(t=t.slice(1));var n=r.get(this,"router.router");"update"===e.urlMethod?n.updateURL(t):"replace"===e.urlMethod&&n.replaceURL(t),e.method(null)}},resolvedParams:a.computed("router.url",function(){var e,t=this.params,n=[],i=0===t.length;if(i){var a=this.container.lookup("controller:application");e=r.get(a,"currentRouteName")}else{e=h.read(t[0]);for(var s=1;s<t.length;s++)n.push(h.read(t[s]))}var o=m(this,e);return{targetRouteName:e,models:n,queryParams:o}}),loadedParams:a.computed("resolvedParams",function(){var e=r.get(this,"router");if(e){var t=r.get(this,"resolvedParams"),n=t.targetRouteName;if(n&&d(t.models))return t}}),queryParamsObject:null,href:a.computed("loadedParams",function(){if("a"===r.get(this,"tagName")){var e=r.get(this,"router"),t=r.get(this,"loadedParams");if(!t)return r.get(this,"loadingHref");var i={};n["default"](i,t.queryParams),e._prepareQueryParams(t.targetRouteName,t.models,i);var a=c.routeArgs(t.targetRouteName,t.models,i),s=e.generate.apply(e,a);return s}}),loadingHref:"#"});b.toString=function(){return"LinkView"},e.LinkView=b}),e("ember-routing-views/views/outlet",["exports","ember-views/views/container_view","ember-views/views/metamorph_view","ember-metal/property_get"],function(e,t,r,n){"use strict";function a(e){return!e.render.ViewClass&&!e.render.template}function s(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;e=e.render,t=t.render;for(var r in e)if(e.hasOwnProperty(r)&&e[r]!==t[r]&&"name"!==r)return!1;return!0}var o=t["default"].extend({init:function(){this._super(),this._childOutlets=i.A(),this._outletState=null},_isOutlet:!0,_parentOutlet:function(){for(var e=this._parentView;e&&!e._isOutlet;)e=e._parentView;return e},_linkParent:i.on("init","parentViewDidChange",function(){var e=this._parentOutlet();e&&(e._childOutlets.push(this),e._outletState&&this.setOutletState(e._outletState.outlets[this._outletName]))}),willDestroy:function(){var e=this._parentOutlet();e&&e._childOutlets.removeObject(this),this._super()},_diffState:function(e){for(;e&&a(e);)e=e.outlets.main;var t=!s(this._outletState,e);return this._outletState=e,t},setOutletState:function(e){if(this._diffState(e)){var t=this._buildView(this._outletState),r=n.get(this,"length");t?this.replace(0,r,[t]):this.replace(0,r,[])}else for(var i=this._childOutlets,a=0;a<i.length;a++){var s=i[a];s.setOutletState(this._outletState&&this._outletState.outlets[s._outletName])}},_buildView:function(e){if(e){var t,r=(n.get(this,"namespace.LOG_VIEW_LOOKUPS"),e.render),i=r.ViewClass,a=!1;return i||(a=!0,i=this.container.lookupFactory(this._isTopLevel?"view:toplevel":"view:default")),t=i.create({_debugTemplateName:r.name,renderedName:r.name,controller:r.controller}),n.get(t,"template")||t.set("template",r.template),t}}}),u=o.extend(r._Metamorph);e.CoreOutletView=o,e.OutletView=u}),e("ember-routing",["exports","ember-metal/core","ember-routing/ext/run_loop","ember-routing/ext/controller","ember-routing/location/api","ember-routing/location/none_location","ember-routing/location/hash_location","ember-routing/location/history_location","ember-routing/location/auto_location","ember-routing/system/generate_controller","ember-routing/system/controller_for","ember-routing/system/dsl","ember-routing/system/router","ember-routing/system/route"],function(e,t,r,n,i,a,s,o,u,l,c,h,m,d){"use strict";t["default"].Location=i["default"],t["default"].AutoLocation=u["default"],t["default"].HashLocation=s["default"],t["default"].HistoryLocation=o["default"],t["default"].NoneLocation=a["default"],t["default"].controllerFor=c["default"],t["default"].generateControllerFactory=l.generateControllerFactory,t["default"].generateController=l["default"],t["default"].RouterDSL=h["default"],t["default"].Router=m["default"],t["default"].Route=d["default"],e["default"]=t["default"]}),e("ember-routing/ext/controller",["exports","ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/computed","ember-metal/utils","ember-metal/merge","ember-runtime/mixins/controller"],function(e,t,r,n,i,a,s,o){"use strict";function u(e,t){var r,n=e;"string"===a.typeOf(n)&&(r={},r[n]={as:null},n=r);for(var i in n){if(!n.hasOwnProperty(i))return;var o=n[i];"string"===a.typeOf(o)&&(o={as:o}),r=t[i]||{as:null,scope:"model"},s["default"](r,o),t[i]=r}}function l(e){var t=r.get(e,"_normalizedQueryParams");for(var n in t)t.hasOwnProperty(n)&&e.addObserver(n+".[]",e,e._qpChanged)}o["default"].reopen({concatenatedProperties:["queryParams","_pCacheMeta"],init:function(){this._super.apply(this,arguments),l(this)},queryParams:null,_qpDelegate:null,_normalizedQueryParams:i.computed(function(){var e=a.meta(this);if(e.proto!==this)return r.get(e.proto,"_normalizedQueryParams");var t=r.get(this,"queryParams");if(t._qpMap)return t._qpMap;for(var n=t._qpMap={},i=0,s=t.length;s>i;++i)u(t[i],n);return n}),_cacheMeta:i.computed(function(){var e=a.meta(this);if(e.proto!==this)return r.get(e.proto,"_cacheMeta");var t={},n=r.get(this,"_normalizedQueryParams");for(var i in n)if(n.hasOwnProperty(i)){var s,o=n[i],u=o.scope;"controller"===u&&(s=[]),t[i]={parts:s,values:null,scope:u,prefix:"",def:r.get(this,i)}}return t}),_updateCacheParams:function(e){var t=r.get(this,"_cacheMeta");for(var i in t)if(t.hasOwnProperty(i)){var a=t[i];a.values=e;var s=this._calculateCacheKey(a.prefix,a.parts,a.values),o=this._bucketCache;if(o){var u=o.lookup(s,i,a.def);n.set(this,i,u)}}},_qpChanged:function(e,t){var n=t.substr(0,t.length-3),i=r.get(e,"_cacheMeta"),a=i[n],s=e._calculateCacheKey(a.prefix||"",a.parts,a.values),o=r.get(e,n),u=this._bucketCache;u&&e._bucketCache.stash(s,n,o);var l=e._qpDelegate;l&&l(e,n)},_calculateCacheKey:function(e,t,n){for(var i=t||[],a="",s=0,o=i.length;o>s;++s){var u=i[s],l=r.get(n,u);a+="::"+u+":"+l}return e+a.replace(c,"-")},transitionToRoute:function(){var e=r.get(this,"target"),t=e.transitionToRoute||e.transitionTo;return t.apply(e,arguments)},transitionTo:function(){return this.transitionToRoute.apply(this,arguments)},replaceRoute:function(){var e=r.get(this,"target"),t=e.replaceRoute||e.replaceWith;return t.apply(e,arguments)},replaceWith:function(){return this.replaceRoute.apply(this,arguments)}});var c=/\./g;e["default"]=o["default"]}),e("ember-routing/ext/run_loop",["ember-metal/run_loop"],function(e){"use strict";e["default"]._addQueue("routerTransitions","actions")}),e("ember-routing/location/api",["exports","ember-metal/core","ember-metal/environment"],function(e,t,r){"use strict";e["default"]={create:function(e){var t=e&&e.implementation,r=this.implementations[t];return r.create.apply(r,arguments)},registerImplementation:function(e,t){this.implementations[e]=t},implementations:{},_location:r["default"].location,_getHash:function(){var e=(this._location||this.location).href,t=e.indexOf("#");return-1===t?"":e.substr(t)}}}),e("ember-routing/location/auto_location",["exports","ember-metal/core","ember-metal/property_set","ember-routing/location/api","ember-routing/location/history_location","ember-routing/location/hash_location","ember-routing/location/none_location","ember-metal/environment","ember-routing/location/feature_detect"],function(e,t,r,n,i,a,s,o,u){"use strict";e["default"]={_location:o["default"].location,_history:o["default"].history,cancelRouterSetup:!1,rootURL:"/",_HistoryLocation:i["default"],_HashLocation:a["default"],_NoneLocation:s["default"],_getOrigin:function(){var e=this._location,t=e.origin;return t||(t=e.protocol+"//"+e.hostname,e.port&&(t+=":"+e.port)),t},_userAgent:o["default"].userAgent,_getSupportsHistory:function(){return u.supportsHistory(o["default"].userAgent,o["default"].history)},_getSupportsHashChange:function(){return u.supportsHashChange(document.documentMode,window)},_replacePath:function(e){this._location.replace(this._getOrigin()+e)},_getRootURL:function(){return this.rootURL},_getPath:function(){var e=this._location.pathname;return"/"!==e.charAt(0)&&(e="/"+e),e},_getHash:n["default"]._getHash,_getQuery:function(){return this._location.search},_getFullPath:function(){return this._getPath()+this._getQuery()+this._getHash()},_getHistoryPath:function(){{var e,t,r=this._getRootURL(),n=this._getPath(),i=this._getHash(),a=this._getQuery();n.indexOf(r)}return"#/"===i.substr(0,2)?(t=i.substr(1).split("#"),e=t.shift(),"/"===n.slice(-1)&&(e=e.substr(1)),n+=e,n+=a,t.length&&(n+="#"+t.join("#"))):(n+=a,n+=i),n},_getHashPath:function(){var e=this._getRootURL(),t=e,r=this._getHistoryPath(),n=r.substr(e.length);return""!==n&&("/"!==n.charAt(0)&&(n="/"+n),t+="#"+n),t},create:function(e){e&&e.rootURL&&(this.rootURL=e.rootURL);var t,n,i=!1,a=this._NoneLocation,s=this._getFullPath();this._getSupportsHistory()?(t=this._getHistoryPath(),s===t?a=this._HistoryLocation:"/#"===s.substr(0,2)?(this._history.replaceState({path:t},null,t),a=this._HistoryLocation):(i=!0,this._replacePath(t))):this._getSupportsHashChange()&&(n=this._getHashPath(),s===n||"/"===s&&"/#/"===n?a=this._HashLocation:(i=!0,this._replacePath(n)));var o=a.create.apply(a,arguments);return i&&r.set(o,"cancelRouterSetup",!0),o}}}),e("ember-routing/location/feature_detect",["exports"],function(e){"use strict";function t(e,t){return"onhashchange"in t&&(void 0===e||e>7)}function r(e,t){return-1!==e.indexOf("Android 2")&&-1!==e.indexOf("Mobile Safari")&&-1===e.indexOf("Chrome")?!1:!!(t&&"pushState"in t)}e.supportsHashChange=t,e.supportsHistory=r}),e("ember-routing/location/hash_location",["exports","ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/run_loop","ember-metal/utils","ember-runtime/system/object","ember-routing/location/api"],function(e,t,r,n,i,a,s,o){"use strict";e["default"]=s["default"].extend({implementation:"hash",init:function(){n.set(this,"location",r.get(this,"_location")||window.location)},getHash:o["default"]._getHash,getURL:function(){var e=this.getHash().substr(1),t=e;return"/"!==t.charAt(0)&&(t="/",e&&(t+="#"+e)),t},setURL:function(e){r.get(this,"location").hash=e,n.set(this,"lastSetURL",e)},replaceURL:function(e){r.get(this,"location").replace("#"+e),n.set(this,"lastSetURL",e)},onUpdateURL:function(e){var s=this,o=a.guidFor(this);t["default"].$(window).on("hashchange.ember-location-"+o,function(){i["default"](function(){var t=s.getURL();r.get(s,"lastSetURL")!==t&&(n.set(s,"lastSetURL",null),e(t))})})},formatURL:function(e){return"#"+e},willDestroy:function(){var e=a.guidFor(this);t["default"].$(window).off("hashchange.ember-location-"+e)}})}),e("ember-routing/location/history_location",["exports","ember-metal/property_get","ember-metal/property_set","ember-metal/utils","ember-runtime/system/object","ember-routing/location/api","ember-views/system/jquery"],function(e,t,r,n,i,a,s){"use strict";var o=!1;e["default"]=i["default"].extend({implementation:"history",init:function(){r.set(this,"location",t.get(this,"location")||window.location),r.set(this,"baseURL",s["default"]("base").attr("href")||"")},initState:function(){var e=t.get(this,"history")||window.history;r.set(this,"history",e),e&&"state"in e&&(this.supportsHistory=!0),this.replaceState(this.formatURL(this.getURL()))},rootURL:"/",getURL:function(){var e=t.get(this,"rootURL"),r=t.get(this,"location"),n=r.pathname,i=t.get(this,"baseURL");e=e.replace(/\/$/,""),i=i.replace(/\/$/,"");var a=n.replace(i,"").replace(e,""),s=r.search||"";return a+=s,a+=this.getHash()},setURL:function(e){var t=this.getState();e=this.formatURL(e),t&&t.path===e||this.pushState(e)},replaceURL:function(e){var t=this.getState();e=this.formatURL(e),t&&t.path===e||this.replaceState(e)},getState:function(){return this.supportsHistory?t.get(this,"history").state:this._historyState},pushState:function(e){var r={path:e};t.get(this,"history").pushState(r,null,e),this._historyState=r,this._previousURL=this.getURL()},replaceState:function(e){var r={path:e};t.get(this,"history").replaceState(r,null,e),this._historyState=r,this._previousURL=this.getURL()},onUpdateURL:function(e){var t=n.guidFor(this),r=this;s["default"](window).on("popstate.ember-location-"+t,function(t){(o||(o=!0,r.getURL()!==r._previousURL))&&e(r.getURL())})},formatURL:function(e){var r=t.get(this,"rootURL"),n=t.get(this,"baseURL");return""!==e?(r=r.replace(/\/$/,""),n=n.replace(/\/$/,"")):n.match(/^\//)&&r.match(/^\//)&&(n=n.replace(/\/$/,"")),n+r+e},willDestroy:function(){var e=n.guidFor(this);s["default"](window).off("popstate.ember-location-"+e)},getHash:a["default"]._getHash})}),e("ember-routing/location/none_location",["exports","ember-metal/property_get","ember-metal/property_set","ember-runtime/system/object"],function(e,t,r,n){"use strict";e["default"]=n["default"].extend({implementation:"none",path:"",getURL:function(){return t.get(this,"path")},setURL:function(e){r.set(this,"path",e)},onUpdateURL:function(e){this.updateCallback=e},handleURL:function(e){r.set(this,"path",e),this.updateCallback(e)},formatURL:function(e){return e}})}),e("ember-routing/system/cache",["exports","ember-runtime/system/object"],function(e,t){"use strict";e["default"]=t["default"].extend({init:function(){this.cache={}},has:function(e){return e in this.cache},stash:function(e,t,r){var n=this.cache[e];n||(n=this.cache[e]={}),n[t]=r},lookup:function(e,t,r){var n=this.cache;if(!(e in n))return r;var i=n[e];return t in i?i[t]:r},cache:null})}),e("ember-routing/system/controller_for",["exports"],function(e){"use strict";function t(e,t,r){return e.lookup("controller:"+t,r)}e["default"]=t}),e("ember-routing/system/dsl",["exports","ember-metal/core","ember-metal/array"],function(e,t,r){"use strict";function n(e,t){this.parent=e,this.enableLoadingSubstates=t&&t.enableLoadingSubstates,this.matches=[]}function i(e){return e.parent&&"application"!==e.parent}function a(e,t,r){return i(e)&&r!==!0?e.parent+"."+t:t}function s(e,t,r,n){r=r||{};var i=a(e,t,r.resetNamespace);"string"!=typeof r.path&&(r.path="/"+t),e.push(r.path,i,n)}e["default"]=n,n.prototype={route:function(e,t,r){2===arguments.length&&"function"==typeof t&&(r=t,t={}),1===arguments.length&&(t={});t.resetNamespace===!0?"resource":"route";if(this.enableLoadingSubstates&&(s(this,e+"_loading",{resetNamespace:t.resetNamespace}),s(this,e+"_error",{path:"/_unused_dummy_error_path_route_"+e+"/:error"})),r){var i=a(this,e,t.resetNamespace),o=new n(i,{enableLoadingSubstates:this.enableLoadingSubstates});s(o,"loading"),s(o,"error",{path:"/_unused_dummy_error_path_route_"+e+"/:error"}),r.call(o),s(this,e,t,o.generate())}else s(this,e,t)},push:function(e,t,r){var n=t.split(".");(""===e||"/"===e||"index"===n[n.length-1])&&(this.explicitIndex=!0),this.matches.push([e,t,r])},resource:function(e,t,r){2===arguments.length&&"function"==typeof t&&(r=t,t={}),1===arguments.length&&(t={}),t.resetNamespace=!0,this.route(e,t,r)},generate:function(){var e=this.matches;return this.explicitIndex||this.route("index",{path:"/"}),function(t){for(var r=0,n=e.length;n>r;r++){var i=e[r];t(i[0]).to(i[1],i[2])}}}},n.map=function(e){var t=new n;return e.call(t),t}}),e("ember-routing/system/generate_controller",["exports","ember-metal/core","ember-metal/property_get","ember-metal/utils"],function(e,t,r,n){"use strict";function i(e,t,r){var i,a,s,o;return o=r&&n.isArray(r)?"array":r?"object":"basic",s="controller:"+o,i=e.lookupFactory(s).extend({isGenerated:!0,toString:function(){return"(generated "+t+" controller)"}}),a="controller:"+t,e._registry.register(a,i),i}function a(e,t,n){i(e,t,n);var a="controller:"+t,s=e.lookup(a);return r.get(s,"namespace.LOG_ACTIVE_GENERATION"),s}e.generateControllerFactory=i,e["default"]=a}),e("ember-routing/system/query_params",["exports","ember-runtime/system/object"],function(e,t){"use strict";e["default"]=t["default"].extend({isQueryParams:!0,values:null})}),e("ember-routing/system/route",["exports","ember-metal/core","ember-metal/error","ember-metal/property_get","ember-metal/property_set","ember-metal/get_properties","ember-metal/enumerable_utils","ember-metal/is_none","ember-metal/computed","ember-metal/merge","ember-metal/utils","ember-metal/run_loop","ember-metal/keys","ember-runtime/copy","ember-runtime/system/string","ember-runtime/system/object","ember-runtime/mixins/evented","ember-runtime/mixins/action_handler","ember-routing/system/generate_controller","ember-routing/utils"],function(e,t,r,n,i,a,s,o,u,l,c,h,m,d,f,p,v,g,b,y){"use strict";function _(){return this}function w(e){var t=x(e,e.router.router.state.handlerInfos,-1);return t&&t.handler}function x(e,t,r){if(t)for(var n,i=r||0,a=0,s=t.length;s>a;a++)if(n=t[a].handler,n===e)return t[a+i]}function C(e,t,i,a,s){var o,u,l,c,h=s&&s.controller,m=(n.get(e.router,"namespace.LOG_VIEW_LOOKUPS"),s&&s.into&&s.into.replace(/\//g,".")),d=s&&s.outlet||"main";if(a?(a=a.replace(/\//g,"."),o=a):(a=e.routeName,o=e.templateName||a),h||(h=t?e.container.lookup("controller:"+a)||e.controllerName||e.routeName:e.controllerName||e.container.lookup("controller:"+a)),"string"==typeof h){var f=h;if(h=e.container.lookup("controller:"+f),!h)throw new r["default"]("You passed `controller: '"+f+"'` into the `render` method, but no such controller could be found.")}s&&s.model&&h.set("model",s.model),u=s&&s.view||t&&a||e.viewName||a,l=e.container.lookupFactory("view:"+u),c=e.container.lookup("template:"+o);var p;m&&(p=w(e))&&m===w(e).routeName&&(m=void 0);var v={into:m,outlet:d,name:a,controller:h,ViewClass:l,template:c};return v}function E(e,t){if(t.fullQueryParams)return t.fullQueryParams;t.fullQueryParams={},l["default"](t.fullQueryParams,t.queryParams);var r=t.handlerInfos[t.handlerInfos.length-1].name;return e._deserializeQueryParams(r,t.fullQueryParams),t.fullQueryParams}function O(e,t){t.queryParamsFor=t.queryParamsFor||{};var r=e.routeName;if(t.queryParamsFor[r])return t.queryParamsFor[r];for(var i=E(e.router,t),a=t.queryParamsFor[r]={},s=n.get(e,"_qp"),o=s.qps,u=0,l=o.length;l>u;++u){var c=o[u],h=c.prop in i;a[c.prop]=h?i[c.prop]:P(c.def)}return a}function P(e){return c.isArray(e)?t["default"].A(e.slice()):e}var S=Array.prototype.slice,A=p["default"].extend(g["default"],v["default"],{queryParams:{},_qp:u.computed(function(){var e=this.controllerName||this.routeName,r=this.container.lookupFactory("controller:"+e);if(!r)return N;var i=r.proto(),a=n.get(i,"_normalizedQueryParams"),s=n.get(i,"_cacheMeta"),o=[],u={},l=this;for(var h in a)if(a.hasOwnProperty(h)){var m=a[h],d=m.as||this.serializeQueryParamKey(h),f=n.get(i,h);c.isArray(f)&&(f=t["default"].A(f.slice()));var p=c.typeOf(f),v=this.serializeQueryParam(f,d,p),g=e+":"+h,b={def:f,sdef:v,type:p,urlKey:d,prop:h,fprop:g,ctrl:e,cProto:i,svalue:v,cacheType:m.scope,route:this,cacheMeta:s[h]};u[h]=u[d]=u[g]=b,o.push(b)}return{qps:o,map:u,states:{active:function(e,t){return l._activeQPChanged(e,u[t])},allowOverrides:function(e,t){return l._updatingQPChanged(e,u[t])},changingKeys:function(e,t){return l._updateSerializedQPValue(e,u[t])}}}}),_names:null,_stashNames:function(e,t){var r=e;if(!this._names){var i=this._names=r._names;i.length||(r=t,i=r&&r._names||[]);for(var a=n.get(this,"_qp.qps"),s=a.length,o=new Array(i.length),u=0,l=i.length;l>u;++u)o[u]=r.name+"."+i[u];for(var c=0;s>c;++c){var h=a[c],m=h.cacheMeta;"model"===m.scope&&(m.parts=o),m.prefix=h.ctrl}}},_updateSerializedQPValue:function(e,t){var r=n.get(e,t.prop);t.svalue=this.serializeQueryParam(r,t.urlKey,t.type)},_activeQPChanged:function(e,t){var r=n.get(e,t.prop);this.router._queuedQPChanges[t.fprop]=r,h["default"].once(this,this._fireQueryParamTransition)},_updatingQPChanged:function(e,t){var r=this.router;r._qpUpdates||(r._qpUpdates={}),r._qpUpdates[t.urlKey]=!0},mergedProperties:["events","queryParams"],paramsFor:function(e){var t=this.container.lookup("route:"+e);if(!t)return{};var r=this.router.router.activeTransition,n=r?r.state:this.router.router.state,i={};return l["default"](i,n.params[e]),l["default"](i,O(t,n)),i},serializeQueryParamKey:function(e){return e},serializeQueryParam:function(e,t,r){return"array"===r?JSON.stringify(e):""+e},deserializeQueryParam:function(e,r,n){return"boolean"===n?"true"===e?!0:!1:"number"===n?Number(e).valueOf():"array"===n?t["default"].A(JSON.parse(e)):e},_fireQueryParamTransition:function(){this.transitionTo({queryParams:this.router._queuedQPChanges}),this.router._queuedQPChanges={}},_optionsForQueryParam:function(e){return n.get(this,"queryParams."+e.urlKey)||n.get(this,"queryParams."+e.prop)||{}},resetController:_,exit:function(){this.deactivate(),this.trigger("deactivate"),this.teardownViews()},_reset:function(e,t){var r=this.controller;r._qpDelegate=n.get(this,"_qp.states.inactive"),this.resetController(r,e,t)},enter:function(){this.connections=[],this.activate(),this.trigger("activate")},viewName:null,templateName:null,controllerName:null,_actions:{queryParamsDidChange:function(e,t,r){for(var i=n.get(this,"_qp").map,a=m["default"](e).concat(m["default"](r)),s=0,o=a.length;o>s;++s){var u=i[a[s]];u&&n.get(this._optionsForQueryParam(u),"refreshModel")&&this.refresh()}return!0},finalizeQueryParamChange:function(e,t,r){if("application"!==this.routeName)return!0;if(r){var a,o=r.state.handlerInfos,u=this.router,l=u._queryParamsFor(o[o.length-1].name),c=u._qpUpdates;y.stashParamNames(u,o);for(var h=0,m=l.qps.length;m>h;++h){var d,f,p=l.qps[h],v=p.route,g=v.controller,b=p.urlKey in e&&p.urlKey;c&&p.urlKey in c?(d=n.get(g,p.prop),f=v.serializeQueryParam(d,p.urlKey,p.type)):b?(f=e[b],d=v.deserializeQueryParam(f,p.urlKey,p.type)):(f=p.sdef,d=P(p.def)),g._qpDelegate=n.get(this,"_qp.states.inactive");var _=f!==p.svalue;if(_){if(r.queryParamsOnly&&a!==!1){var w=v._optionsForQueryParam(p),x=n.get(w,"replace");x?a=!0:x===!1&&(a=!1)}i.set(g,p.prop,d)}p.svalue=f;var C=p.sdef===f;C||t.push({value:f,visible:!0,key:b||p.urlKey})}a&&r.method("replace"),s.forEach(l.qps,function(e){var t=n.get(e.route,"_qp"),r=e.route.controller;r._qpDelegate=n.get(t,"states.active")}),u._qpUpdates=null}}},events:null,deactivate:_,activate:_,transitionTo:function(e,t){var r=this.router;return r.transitionTo.apply(r,arguments)},intermediateTransitionTo:function(){var e=this.router;e.intermediateTransitionTo.apply(e,arguments)},refresh:function(){return this.router.router.refresh(this)},replaceWith:function(){var e=this.router;return e.replaceWith.apply(e,arguments)},send:function(){if(this.router||!t["default"].testing)this.router.send.apply(this.router,arguments);else{var e=arguments[0],r=S.call(arguments,1),n=this._actions[e];if(n)return this._actions[e].apply(this,r)}},setup:function(e,t){var r=this.controllerName||this.routeName,i=this.controllerFor(r,!0);if(i||(i=this.generateController(r,e)),this.controller=i,this.setupControllers)this.setupControllers(i,e);else{var a=n.get(this,"_qp.states");if(t&&(y.stashParamNames(this.router,t.state.handlerInfos),i._qpDelegate=a.changingKeys,i._updateCacheParams(t.params)),i._qpDelegate=a.allowOverrides,t){var s=O(this,t.state);i.setProperties(s)}this.setupController(i,e,t)}this.renderTemplates?this.renderTemplates(e):this.renderTemplate(i,e)},beforeModel:_,afterModel:_,redirect:_,contextDidChange:function(){this.currentModel=this.context},model:function(e,t){var r,i,a,s,o=n.get(this,"_qp.map");for(var u in e)"queryParams"===u||o&&u in o||((r=u.match(/^(.*)_id$/))&&(i=r[1],s=e[u]),a=!0);if(!i&&a)return d["default"](e);if(!i){if(t.resolveIndex<1)return;var l=t.state.handlerInfos[t.resolveIndex-1].context;return l}return this.findModel(i,s)},deserialize:function(e,t){return this.model(this.paramsFor(this.routeName),t)},findModel:function(){var e=n.get(this,"store");return e.find.apply(e,arguments)},store:u.computed(function(){{var e=this.container;this.routeName,n.get(this,"router.namespace")}return{find:function(t,r){var n=e.lookupFactory("model:"+t);if(n)return n.find(r)}}}),serialize:function(e,t){if(!(t.length<1)&&e){var r=t[0],i={};return 1===t.length?r in e?i[r]=n.get(e,r):/_id$/.test(r)&&(i[r]=n.get(e,"id")):i=a["default"](e,t),i}},setupController:function(e,t,r){e&&void 0!==t&&i.set(e,"model",t)},controllerFor:function(e,t){var r,n=this.container,i=n.lookup("route:"+e);return i&&i.controllerName&&(e=i.controllerName),r=n.lookup("controller:"+e)},generateController:function(e,t){var r=this.container;return t=t||this.modelFor(e),b["default"](r,e,t)},modelFor:function(e){var t=this.container.lookup("route:"+e),r=this.router?this.router.router.activeTransition:null;if(r){var n=t&&t.routeName||e;if(r.resolvedModels.hasOwnProperty(n))return r.resolvedModels[n]}return t&&t.currentModel},renderTemplate:function(e,t){this.render()},render:function(e,r){var n,i="string"==typeof e&&!!e,a=0===arguments.length||t["default"].isEmpty(arguments[0]);"object"!=typeof e||r?n=e:(n=this.routeName,r=e);var s=C(this,i,a,n,r);this.connections.push(s),h["default"].once(this.router,"_setOutlets")},disconnectOutlet:function(e){var t,r;e&&"string"!=typeof e?(t=e.outlet,r=e.parentView):t=e,r=r&&r.replace(/\//g,"."),t=t||"main",this._disconnectOutlet(t,r);for(var n=0;n<this.router.router.currentHandlerInfos.length;n++)this.router.router.currentHandlerInfos[n].handler._disconnectOutlet(t,r)},_disconnectOutlet:function(e,t){var r=w(this);r&&t===r.routeName&&(t=void 0);for(var n=0;n<this.connections.length;n++){var i=this.connections[n];i.outlet===e&&i.into===t&&(this.connections[n]={into:i.into,outlet:i.outlet,name:i.name},h["default"].once(this.router,"_setOutlets"))}},willDestroy:function(){this.teardownViews()},teardownViews:function(){this.connections&&this.connections.length>0&&(this.connections=[],h["default"].once(this.router,"_setOutlets"))}}),N={qps:[],map:{},states:{}};e["default"]=A}),e("ember-routing/system/router",["exports","ember-metal/core","ember-metal/error","ember-metal/property_get","ember-metal/property_set","ember-metal/properties","ember-metal/computed","ember-metal/merge","ember-metal/run_loop","ember-runtime/system/string","ember-runtime/system/object","ember-runtime/mixins/evented","ember-routing/system/dsl","ember-routing/location/api","ember-routing/utils","ember-metal/platform/create","./router_state","router","router/transition"],function(e,t,r,n,i,a,s,o,u,l,c,h,m,d,f,p,v,g){"use strict";function b(){return this}function y(e,t,r){for(var n,i,a=t.state.handlerInfos,s=!1,o=a.length-1;o>=0;--o)if(n=a[o],i=n.handler,s){if(r(i,a[o+1].handler)!==!0)return!1}else e===i&&(s=!0);return!0}function _(e,r){var n,i=[];n=e&&"object"==typeof e&&"object"==typeof e.errorThrown?e.errorThrown:e,r&&i.push(r),n&&(n.message&&i.push(n.message),n.stack&&i.push(n.stack),"string"==typeof n&&i.push(n)),t["default"].Logger.error.apply(this,i)}function w(e,t,r){
var n,i=e.router,a=t.routeName.split(".").pop(),s="application"===e.routeName?"":e.routeName+".";return n=s+a+"_"+r,x(i,n)?n:(n=s+r,x(i,n)?n:void 0)}function x(e,t){var r=e.container;return e.hasRoute(t)&&(r._registry.has("template:"+t)||r._registry.has("route:"+t))}function C(e,t,n){var i=n.shift();if(!e){if(t)return;throw new r["default"]("Can't trigger action '"+i+"' because your app hasn't finished transitioning into its first route. To trigger an action on destination routes during a transition, you can call `.send()` on the `Transition` object passed to the `model/beforeModel/afterModel` hooks.")}for(var a,s,o=!1,u=e.length-1;u>=0;u--)if(a=e[u],s=a.handler,s._actions&&s._actions[i]){if(s._actions[i].apply(s,n)!==!0)return;o=!0}if(j[i])return void j[i].apply(null,n);if(!o&&!t)throw new r["default"]("Nothing handled the action '"+i+"'. If you did handle the action, this error can be caused by returning true from an action handler in a controller, causing the action to bubble.")}function E(e,t,r){for(var n=e.router,i=n.applyIntent(t,r),a=i.handlerInfos,s=i.params,o=0,u=a.length;u>o;++o){var l=a[o];l.isResolved||(l=l.becomeResolved(null,l.context)),s[l.name]=l.params}return i}function O(e){var t=e.container.lookup("controller:application");if(t){var r=e.router.currentHandlerInfos,n=V._routePath(r);"currentPath"in t||a.defineProperty(t,"currentPath"),i.set(t,"currentPath",n),"currentRouteName"in t||a.defineProperty(t,"currentRouteName"),i.set(t,"currentRouteName",r[r.length-1].name)}}function P(e,t){var r=v["default"].create({emberRouter:t,routerJs:t.router,routerJsState:e.state});t.currentState||t.set("currentState",r),t.set("targetState",r),e.then(null,function(e){return e&&e.name?e:void 0},"Ember: Process errors from Router")}function S(e){return"string"==typeof e&&(""===e||"/"===e.charAt(0))}function A(e,t,r,n){var i=e._queryParamsFor(t);for(var a in r)if(r.hasOwnProperty(a)){var s=r[a],o=i.map[a];o&&n(a,s,o)}}function N(e,t){if(e)for(var r=[e];r.length>0;){var n=r.shift();if(n.render.name===t)return n;var i=n.outlets;for(var a in i)r.push(i[a])}}function T(e,t,r){var n,a={render:r,outlets:p["default"](null)};return n=r.into?N(e,r.into):t,n?i.set(n.outlets,r.outlet,a):r.into?k(e,r.into,a):e=a,{liveRoutes:e,ownState:a}}function k(e,r,n){e.outlets.__ember_orphans__||(e.outlets.__ember_orphans__={render:{name:"__ember_orphans__"},outlets:p["default"](null)}),e.outlets.__ember_orphans__.outlets[r]=n,t["default"].run.schedule("afterRender",function(){})}function M(e,t,r){var n=N(e,r.routeName);return n?n:(t.outlets.main={render:{name:r.routeName,outlet:"main"},outlets:{}},t)}var I=[].slice,V=c["default"].extend(h["default"],{location:"hash",rootURL:"/",_initRouterJs:function(e){function r(){this.resource("application",{path:"/",overrideNameAssertion:!0},function(){for(var e=0;e<a.length;e++)a[e].call(this)})}var i=this.router=new g["default"];i.triggerEvent=C,i._triggerWillChangeContext=b,i._triggerWillLeave=b;var a=this.constructor.dslCallbacks||[b],s=new m["default"](null,{enableLoadingSubstates:!!e});r.call(s),n.get(this,"namespace.LOG_TRANSITIONS_INTERNAL")&&(i.log=t["default"].Logger.debug),i.map(s.generate())},init:function(){this._activeViews={},this._setupLocation(),this._qpCache={},this._queuedQPChanges={}},url:s.computed(function(){return n.get(this,"location").getURL()}),startRouting:function(e){var t=n.get(this,"initialURL"),r=n.get(this,"location");if(this.setupRouter(e,r)){"undefined"==typeof t&&(t=n.get(this,"location").getURL());var i=this.handleURL(t);if(i&&i.error)throw i.error}},setupRouter:function(e){this._initRouterJs(e);var t=this.router,r=n.get(this,"location"),i=this;return n.get(r,"cancelRouterSetup")?!1:(this._setupRouter(t,r),r.onUpdateURL(function(e){i.handleURL(e)}),!0)},didTransition:function(e){O(this),this._cancelSlowTransitionTimer(),this.notifyPropertyChange("url"),this.set("currentState",this.targetState),u["default"].once(this,this.trigger,"didTransition"),n.get(this,"namespace").LOG_TRANSITIONS&&t["default"].Logger.log("Transitioned into '"+V._routePath(e)+"'")},_setOutlets:function(){var e,t,r=this.router.currentHandlerInfos,n=null;if(r){for(var i=0;i<r.length;i++){e=r[i].handler;for(var a,s=e.connections,o=0;o<s.length;o++){var u=T(n,t,s[o]);n=u.liveRoutes,(u.ownState.render.name===e.routeName||"main"===u.ownState.render.outlet)&&(a=u.ownState)}0===s.length&&(a=M(n,t,e)),t=a}if(!this._toplevelView){var l=this.container.lookupFactory("view:-outlet");this._toplevelView=l.create({_isTopLevel:!0});var c=this.container.lookup("-application-instance:main");c.didCreateRootView(this._toplevelView)}this._toplevelView.setOutletState(n)}},willTransition:function(e,r,i){u["default"].once(this,this.trigger,"willTransition",i),n.get(this,"namespace").LOG_TRANSITIONS&&t["default"].Logger.log("Preparing to transition from '"+V._routePath(e)+"' to '"+V._routePath(r)+"'")},handleURL:function(e){return e=e.split(/#(.+)?/)[0],this._doURLTransition("handleURL",e)},_doURLTransition:function(e,t){var r=this.router[e](t||"/");return P(r,this),r},transitionTo:function(){var e,t=I.call(arguments);if(S(t[0]))return this._doURLTransition("transitionTo",t[0]);var r=t[t.length-1];e=r&&r.hasOwnProperty("queryParams")?t.pop().queryParams:{};var n=t.shift();return this._doTransition(n,t,e)},intermediateTransitionTo:function(){this.router.intermediateTransitionTo.apply(this.router,arguments),O(this);var e=this.router.currentHandlerInfos;n.get(this,"namespace").LOG_TRANSITIONS&&t["default"].Logger.log("Intermediate-transitioned into '"+V._routePath(e)+"'")},replaceWith:function(){return this.transitionTo.apply(this,arguments).method("replace")},generate:function(){var e=this.router.generate.apply(this.router,arguments);return this.location.formatURL(e)},isActive:function(e){var t=this.router;return t.isActive.apply(t,arguments)},isActiveIntent:function(e,t,r){return this.currentState.isActiveIntent(e,t,r)},send:function(e,t){this.router.trigger.apply(this.router,arguments)},hasRoute:function(e){return this.router.hasRoute(e)},reset:function(){this.router&&this.router.reset()},willDestroy:function(){this._toplevelView&&(this._toplevelView.destroy(),this._toplevelView=null),this._super.apply(this,arguments),this.reset()},_lookupActiveView:function(e){var t=this._activeViews[e];return t&&t[0]},_connectActiveView:function(e,t){function r(){delete this._activeViews[e]}var n=this._activeViews[e];n&&n[0].off("willDestroyElement",this,n[1]),this._activeViews[e]=[t,r],t.one("willDestroyElement",this,r)},_setupLocation:function(){var e=n.get(this,"location"),t=n.get(this,"rootURL");if(t&&this.container&&!this.container._registry.has("-location-setting:root-url")&&this.container._registry.register("-location-setting:root-url",t,{instantiate:!1}),"string"==typeof e&&this.container){var r=this.container.lookup("location:"+e);if("undefined"!=typeof r)e=i.set(this,"location",r);else{var a={implementation:e};e=i.set(this,"location",d["default"].create(a))}}null!==e&&"object"==typeof e&&(t&&"string"==typeof t&&(e.rootURL=t),"function"==typeof e.initState&&e.initState())},_getHandlerFunction:function(){var e=p["default"](null),t=this.container,r=t.lookupFactory("route:basic"),i=this;return function(a){var s="route:"+a,o=t.lookup(s);return e[a]?o:(e[a]=!0,o||(t._registry.register(s,r.extend()),o=t.lookup(s),n.get(i,"namespace.LOG_ACTIVE_GENERATION")),o.routeName=a,o)}},_setupRouter:function(e,t){var r,n=this;e.getHandler=this._getHandlerFunction();var i=function(){t.setURL(r)};if(e.updateURL=function(e){r=e,u["default"].once(i)},t.replaceURL){var a=function(){t.replaceURL(r)};e.replaceURL=function(e){r=e,u["default"].once(a)}}e.didTransition=function(e){n.didTransition(e)},e.willTransition=function(e,t,r){n.willTransition(e,t,r)}},_serializeQueryParams:function(e,t){var r={};A(this,e,t,function(e,n,i){var a=i.urlKey;r[a]||(r[a]=[]),r[a].push({qp:i,value:n}),delete t[e]});for(var n in r){var i=r[n],a=i[0].qp;t[a.urlKey]=a.route.serializeQueryParam(i[0].value,a.urlKey,a.type)}},_deserializeQueryParams:function(e,t){A(this,e,t,function(e,r,n){delete t[e],t[n.prop]=n.route.deserializeQueryParam(r,n.urlKey,n.type)})},_pruneDefaultQueryParamValues:function(e,t){var r=this._queryParamsFor(e);for(var n in t){var i=r.map[n];i&&i.sdef===t[n]&&delete t[n]}},_doTransition:function(e,t,r){var n=e||f.getActiveTargetName(this.router),i={};o["default"](i,r),this._prepareQueryParams(n,t,i);var a=f.routeArgs(n,t,i),s=this.router.transitionTo.apply(this.router,a);return P(s,this),s},_prepareQueryParams:function(e,t,r){this._hydrateUnsuppliedQueryParams(e,t,r),this._serializeQueryParams(e,r),this._pruneDefaultQueryParamValues(e,r)},_queryParamsFor:function(e){if(this._qpCache[e])return this._qpCache[e];var t={},r=[];this._qpCache[e]={map:t,qps:r};for(var i=this.router,a=i.recognizer.handlersFor(e),s=0,u=a.length;u>s;++s){var l=a[s],c=i.getHandler(l.handler),h=n.get(c,"_qp");h&&(o["default"](t,h.map),r.push.apply(r,h.qps))}return{qps:r,map:t}},_hydrateUnsuppliedQueryParams:function(e,t,r){var i=E(this,e,t),a=i.handlerInfos,s=this._bucketCache;f.stashParamNames(this,a);for(var o=0,u=a.length;u>o;++o)for(var l=a[o].handler,c=n.get(l,"_qp"),h=0,m=c.qps.length;m>h;++h){var d=c.qps[h],p=d.prop in r&&d.prop||d.fprop in r&&d.fprop;if(p)p!==d.fprop&&(r[d.fprop]=r[p],delete r[p]);else{var v=d.cProto,g=n.get(v,"_cacheMeta"),b=v._calculateCacheKey(d.ctrl,g[d.prop].parts,i.params);r[d.fprop]=s.lookup(b,d.prop,d.def)}}},_scheduleLoadingEvent:function(e,t){this._cancelSlowTransitionTimer(),this._slowTransitionTimer=u["default"].scheduleOnce("routerTransitions",this,"_handleSlowTransition",e,t)},currentState:null,targetState:null,_handleSlowTransition:function(e,t){this.router.activeTransition&&(this.set("targetState",v["default"].create({emberRouter:this,routerJs:this.router,routerJsState:this.router.activeTransition.state})),e.trigger(!0,"loading",e,t))},_cancelSlowTransitionTimer:function(){this._slowTransitionTimer&&u["default"].cancel(this._slowTransitionTimer),this._slowTransitionTimer=null}}),j={willResolveModel:function(e,t){t.router._scheduleLoadingEvent(e,t)},error:function(e,t,r){var n=r.router,i=y(r,t,function(t,r){var i=w(t,r,"error");return i?void n.intermediateTransitionTo(i,e):!0});return i&&x(r.router,"application_error")?void n.intermediateTransitionTo("application_error",e):void _(e,"Error while processing route: "+t.targetName)},loading:function(e,t){var r=t.router,n=y(t,e,function(t,n){var i=w(t,n,"loading");return i?void r.intermediateTransitionTo(i):e.pivotHandler!==t?!0:void 0});return n&&x(t.router,"application_loading")?void r.intermediateTransitionTo("application_loading"):void 0}};V.reopenClass({router:null,map:function(e){return this.dslCallbacks||(this.dslCallbacks=[],this.reopenClass({dslCallbacks:this.dslCallbacks})),this.dslCallbacks.push(e),this},_routePath:function(e){function t(e,t){for(var r=0,n=e.length;n>r;++r)if(e[r]!==t[r])return!1;return!0}for(var r,n,i,a=[],s=1,o=e.length;o>s;s++){for(r=e[s].name,n=r.split("."),i=I.call(a);i.length&&!t(i,n);)i.shift();a.push.apply(a,n.slice(i.length))}return a.join(".")}}),e["default"]=V}),e("ember-routing/system/router_state",["exports","ember-metal/core","ember-runtime/system/object","ember-metal/merge"],function(e,t,r,n){"use strict";function i(e,t){var r;for(r in e)if(e.hasOwnProperty(r)&&e[r]!==t[r])return!1;for(r in t)if(t.hasOwnProperty(r)&&e[r]!==t[r])return!1;return!0}var a=r["default"].extend({emberRouter:null,routerJs:null,routerJsState:null,isActiveIntent:function(e,r,a,s){var o=this.routerJsState;if(!this.routerJs.isActiveIntent(e,r,null,o))return!1;var u=t["default"].isEmpty(t["default"].keys(a));if(s&&!u){var l={};return n["default"](l,a),this.emberRouter._prepareQueryParams(e,r,l),i(l,o.queryParams)}return!0}});e["default"]=a}),e("ember-routing/utils",["exports","ember-metal/utils"],function(e,t){"use strict";function r(e,r,n){var i=[];return"string"===t.typeOf(e)&&i.push(""+e),i.push.apply(i,r),i.push({queryParams:n}),i}function n(e){var t=e.activeTransition?e.activeTransition.state.handlerInfos:e.state.handlerInfos;return t[t.length-1].name}function i(e,t){if(!t._namesStashed){for(var r=t[t.length-1].name,n=e.router.recognizer.handlersFor(r),i=null,a=0,s=t.length;s>a;++a){var o=t[a],u=n[a].names;u.length&&(i=o),o._names=u;var l=o.handler;l._stashNames(o,i)}t._namesStashed=!0}}e.routeArgs=r,e.getActiveTargetName=n,e.stashParamNames=i}),e("ember-runtime",["exports","ember-metal","ember-runtime/core","ember-runtime/compare","ember-runtime/copy","ember-runtime/inject","ember-runtime/system/namespace","ember-runtime/system/object","ember-runtime/system/tracked_array","ember-runtime/system/subarray","ember-runtime/system/container","ember-runtime/system/array_proxy","ember-runtime/system/object_proxy","ember-runtime/system/core_object","ember-runtime/system/each_proxy","ember-runtime/system/native_array","ember-runtime/system/set","ember-runtime/system/string","ember-runtime/system/deferred","ember-runtime/system/lazy_load","ember-runtime/mixins/array","ember-runtime/mixins/comparable","ember-runtime/mixins/copyable","ember-runtime/mixins/enumerable","ember-runtime/mixins/freezable","ember-runtime/mixins/-proxy","ember-runtime/mixins/observable","ember-runtime/mixins/action_handler","ember-runtime/mixins/deferred","ember-runtime/mixins/mutable_enumerable","ember-runtime/mixins/mutable_array","ember-runtime/mixins/target_action_support","ember-runtime/mixins/evented","ember-runtime/mixins/promise_proxy","ember-runtime/mixins/sortable","ember-runtime/computed/array_computed","ember-runtime/computed/reduce_computed","ember-runtime/computed/reduce_computed_macros","ember-runtime/controllers/array_controller","ember-runtime/controllers/object_controller","ember-runtime/controllers/controller","ember-runtime/mixins/controller","ember-runtime/system/service","ember-runtime/ext/rsvp","ember-runtime/ext/string","ember-runtime/ext/function"],function(e,t,r,n,i,a,s,o,u,l,c,h,m,d,f,p,v,g,b,y,_,w,x,C,E,O,P,S,A,N,T,k,M,I,V,j,R,D,F,L,B,H,z,q){"use strict";t["default"].compare=n["default"],t["default"].copy=i["default"],t["default"].isEqual=r.isEqual,t["default"].inject=a["default"],t["default"].Array=_["default"],t["default"].Comparable=w["default"],t["default"].Copyable=x["default"],t["default"].SortableMixin=V["default"],t["default"].Freezable=E.Freezable,t["default"].FROZEN_ERROR=E.FROZEN_ERROR,t["default"].DeferredMixin=A["default"],t["default"].MutableEnumerable=N["default"],t["default"].MutableArray=T["default"],t["default"].TargetActionSupport=k["default"],t["default"].Evented=M["default"],t["default"].PromiseProxyMixin=I["default"],t["default"].Observable=P["default"],t["default"].arrayComputed=j.arrayComputed,t["default"].ArrayComputedProperty=j.ArrayComputedProperty,t["default"].reduceComputed=R.reduceComputed,t["default"].ReduceComputedProperty=R.ReduceComputedProperty;var U=t["default"].computed;U.sum=D.sum,U.min=D.min,U.max=D.max,U.map=D.map,U.sort=D.sort,U.setDiff=D.setDiff,U.mapBy=D.mapBy,U.mapProperty=D.mapProperty,U.filter=D.filter,U.filterBy=D.filterBy,U.filterProperty=D.filterProperty,U.uniq=D.uniq,U.union=D.union,U.intersect=D.intersect,t["default"].String=g["default"],t["default"].Object=o["default"],t["default"].TrackedArray=u["default"],t["default"].SubArray=l["default"],t["default"].Container=c.Container,t["default"].Registry=c.Registry,t["default"].Namespace=s["default"],t["default"].Enumerable=C["default"],t["default"].ArrayProxy=h["default"],t["default"].ObjectProxy=m["default"],t["default"].ActionHandler=S["default"],t["default"].CoreObject=d["default"],t["default"].EachArray=f.EachArray,t["default"].EachProxy=f.EachProxy,t["default"].NativeArray=p["default"],t["default"].Set=v["default"],t["default"].Deferred=b["default"],t["default"].onLoad=y.onLoad,t["default"].runLoadHooks=y.runLoadHooks,t["default"].ArrayController=F["default"],t["default"].ObjectController=L["default"],t["default"].Controller=B["default"],t["default"].ControllerMixin=H["default"],t["default"].Service=z["default"],t["default"]._ProxyMixin=O["default"],t["default"].RSVP=q["default"],e["default"]=t["default"]}),e("ember-runtime/compare",["exports","ember-metal/utils","ember-runtime/mixins/comparable"],function(e,t,r){"use strict";function n(e,t){var r=e-t;return(r>0)-(0>r)}function i(e,s){if(e===s)return 0;var o=t.typeOf(e),u=t.typeOf(s);if(r["default"]){if("instance"===o&&r["default"].detect(e)&&e.constructor.compare)return e.constructor.compare(e,s);if("instance"===u&&r["default"].detect(s)&&s.constructor.compare)return-1*s.constructor.compare(s,e)}var l=n(a[o],a[u]);if(0!==l)return l;switch(o){case"boolean":case"number":return n(e,s);case"string":return n(e.localeCompare(s),0);case"array":for(var c=e.length,h=s.length,m=Math.min(c,h),d=0;m>d;d++){var f=i(e[d],s[d]);if(0!==f)return f}return n(c,h);case"instance":return r["default"]&&r["default"].detect(e)?e.compare(e,s):0;case"date":return n(e.getTime(),s.getTime());default:return 0}}var a={undefined:0,"null":1,"boolean":2,number:3,string:4,array:5,object:6,instance:7,"function":8,"class":9,date:10};e["default"]=i}),e("ember-runtime/computed/array_computed",["exports","ember-metal/core","ember-runtime/computed/reduce_computed","ember-metal/enumerable_utils","ember-metal/platform/create","ember-metal/observer","ember-metal/error"],function(e,t,r,n,i,a,s){"use strict";function o(){var e=this;return r.ReduceComputedProperty.apply(this,arguments),this._getter=function(t){return function(r){return e._hasInstanceMeta(this,r)||n.forEach(e._dependentKeys,function(t){a.addObserver(this,t,function(){e.recomputeOnce.call(this,r)})},this),t.apply(this,arguments)}}(this._getter),this}function u(e){var t;if(arguments.length>1&&(t=l.call(arguments,0,-1),e=l.call(arguments,-1)[0]),"object"!=typeof e)throw new s["default"]("Array Computed Property declared without an options hash");var r=new o(e);return t&&r.property.apply(r,t),r}e.arrayComputed=u,e.ArrayComputedProperty=o;var l=[].slice;o.prototype=i["default"](r.ReduceComputedProperty.prototype),o.prototype.initialValue=function(){return t["default"].A()},o.prototype.resetValue=function(e){return e.clear(),e},o.prototype.didChange=function(e,t){}}),e("ember-runtime/computed/reduce_computed",["exports","ember-metal/core","ember-metal/property_get","ember-metal/utils","ember-metal/error","ember-metal/property_events","ember-metal/expand_properties","ember-metal/observer","ember-metal/computed","ember-metal/platform/create","ember-metal/enumerable_utils","ember-runtime/system/tracked_array","ember-runtime/mixins/array","ember-metal/run_loop"],function(e,t,r,n,i,a,s,o,u,l,c,h,m,d){"use strict";function f(e,t){return"@this"===t?e:r.get(e,t)}function p(e,t,r,n,i,a){this.callbacks=e,this.cp=t,this.instanceMeta=r,this.dependentKeysByGuid={},this.trackedArraysByGuid={},this.suspended=!1,this.changedItems={},this.changedItemCount=0}function v(e,t,r){this.dependentArray=e,this.index=t,this.item=e.objectAt(t),this.trackedArray=r,this.beforeObserver=null,this.observer=null,this.destroyed=!1}function g(e,t,r){return 0>e?Math.max(0,t+e):t>e?e:Math.min(t-r,e)}function b(e,t,r){return Math.min(r,t-e)}function y(e,t,r,n,i,a,s){this.arrayChanged=e,this.index=r,this.item=t,this.propertyName=n,this.property=i,this.changedCount=a,s&&(this.previousValues=s)}function _(e,t,r,n,i){c.forEach(e,function(a,s){i.setValue(t.addedItem.call(this,i.getValue(),a,new y(e,a,s,n,r,e.length),i.sugarMeta))},this),t.flushedChanges.call(this,i.getValue(),i.sugarMeta)}function w(e,t){var r=e._hasInstanceMeta(this,t),n=e._instanceMeta(this,t);r&&n.setValue(e.resetValue(n.getValue())),e.options.initialize&&e.options.initialize.call(this,n.getValue(),{property:e,propertyName:t},n.sugarMeta)}function x(e,t){if(I.test(t))return!1;var r=f(e,t);return m["default"].detect(r)}function C(e,t,r){this.context=e,this.propertyName=t;var i=n.meta(e),a=i.cache;a||(a=i.cache={}),this.cache=a,this.dependentArrays={},this.sugarMeta={},this.initialValue=r}function E(e){var t=this;this.options=e,this._dependentKeys=null,this._cacheable=!0,this._itemPropertyKeys={},this._previousItemPropertyKeys={},this.readOnly(),this.recomputeOnce=function(e){d["default"].once(this,r,e)};var r=function(e){var r=t._instanceMeta(this,e),n=t._callbacks();w.call(this,t,e),r.dependentArraysObserver.suspendArrayObservers(function(){c.forEach(t._dependentKeys,function(e){if(x(this,e)){var n=f(this,e),i=r.dependentArrays[e];n===i?t._previousItemPropertyKeys[e]&&(delete t._previousItemPropertyKeys[e],r.dependentArraysObserver.setupPropertyObservers(e,t._itemPropertyKeys[e])):(r.dependentArrays[e]=n,i&&r.dependentArraysObserver.teardownObservers(i,e),n&&r.dependentArraysObserver.setupObservers(n,e))}},this)},this),c.forEach(t._dependentKeys,function(i){if(x(this,i)){var a=f(this,i);a&&_.call(this,a,n,t,e,r)}},this)};this._getter=function(e){return r.call(this,e),t._instanceMeta(this,e).getValue()}}function O(e){return e}function P(e){var t;if(arguments.length>1&&(t=T.call(arguments,0,-1),e=T.call(arguments,-1)[0]),"object"!=typeof e)throw new i["default"]("Reduce Computed Property declared without an options hash");if(!("initialValue"in e))throw new i["default"]("Reduce Computed Property declared without an initial value");var r=new E(e);return t&&r.property.apply(r,t),r}e.ReduceComputedProperty=E,e.reduceComputed=P;var S=u.cacheFor.set,A=u.cacheFor.get,N=u.cacheFor.remove,T=[].slice,k=/^(.*)\.@each\.(.*)/,M=/(.*\.@each){2,}/,I=/\.\[\]$/;p.prototype={setValue:function(e){this.instanceMeta.setValue(e,!0)},getValue:function(){return this.instanceMeta.getValue()},setupObservers:function(e,t){this.dependentKeysByGuid[n.guidFor(e)]=t,e.addArrayObserver(this,{willChange:"dependentArrayWillChange",didChange:"dependentArrayDidChange"}),this.cp._itemPropertyKeys[t]&&this.setupPropertyObservers(t,this.cp._itemPropertyKeys[t])},teardownObservers:function(e,t){var r=this.cp._itemPropertyKeys[t]||[];delete this.dependentKeysByGuid[n.guidFor(e)],this.teardownPropertyObservers(t,r),e.removeArrayObserver(this,{willChange:"dependentArrayWillChange",didChange:"dependentArrayDidChange"})},suspendArrayObservers:function(e,t){var r=this.suspended;this.suspended=!0,e.call(t),this.suspended=r},setupPropertyObservers:function(e,t){var r=f(this.instanceMeta.context,e),n=f(r,"length"),i=new Array(n);this.resetTransformations(e,i),c.forEach(r,function(n,a){var s=this.createPropertyObserverContext(r,a,this.trackedArraysByGuid[e]);i[a]=s,c.forEach(t,function(e){o.addBeforeObserver(n,e,this,s.beforeObserver),o.addObserver(n,e,this,s.observer)},this)},this)},teardownPropertyObservers:function(e,t){var r,n,i,a=this,s=this.trackedArraysByGuid[e];s&&s.apply(function(e,s,u){u!==h["default"].DELETE&&c.forEach(e,function(e){e.destroyed=!0,r=e.beforeObserver,n=e.observer,i=e.item,c.forEach(t,function(e){o.removeBeforeObserver(i,e,a,r),o.removeObserver(i,e,a,n)})})})},createPropertyObserverContext:function(e,t,r){var n=new v(e,t,r);return this.createPropertyObserver(n),n},createPropertyObserver:function(e){var t=this;e.beforeObserver=function(r,n){return t.itemPropertyWillChange(r,n,e.dependentArray,e)},e.observer=function(r,n){return t.itemPropertyDidChange(r,n,e.dependentArray,e)}},resetTransformations:function(e,t){this.trackedArraysByGuid[e]=new h["default"](t)},trackAdd:function(e,t,r){var n=this.trackedArraysByGuid[e];n&&n.addItems(t,r)},trackRemove:function(e,t,r){var n=this.trackedArraysByGuid[e];return n?n.removeItems(t,r):[]},updateIndexes:function(e,t){var r=f(t,"length");e.apply(function(e,t,n,i){n!==h["default"].DELETE&&(0!==i||n!==h["default"].RETAIN||e.length!==r||0!==t)&&c.forEach(e,function(e,r){e.index=r+t})})},dependentArrayWillChange:function(e,t,r,i){function a(e){m[h].destroyed=!0,o.removeBeforeObserver(u,e,this,m[h].beforeObserver),o.removeObserver(u,e,this,m[h].observer)}if(!this.suspended){var s,u,l,h,m,d=this.callbacks.removedItem,p=n.guidFor(e),v=this.dependentKeysByGuid[p],_=this.cp._itemPropertyKeys[v]||[],w=f(e,"length"),x=g(t,w,0),C=b(x,w,r);for(m=this.trackRemove(v,x,C),h=C-1;h>=0&&(l=x+h,!(l>=w));--h)u=e.objectAt(l),c.forEach(_,a,this),s=new y(e,u,l,this.instanceMeta.propertyName,this.cp,C),this.setValue(d.call(this.instanceMeta.context,this.getValue(),u,s,this.instanceMeta.sugarMeta));this.callbacks.flushedChanges.call(this.instanceMeta.context,this.getValue(),this.instanceMeta.sugarMeta)}},dependentArrayDidChange:function(e,t,r,i){if(!this.suspended){var a,s,u=this.callbacks.addedItem,l=n.guidFor(e),h=this.dependentKeysByGuid[l],m=new Array(i),d=this.cp._itemPropertyKeys[h],p=f(e,"length"),v=g(t,p,i),b=v+i;c.forEach(e.slice(v,b),function(t,r){d&&(s=this.createPropertyObserverContext(e,v+r,this.trackedArraysByGuid[h]),m[r]=s,c.forEach(d,function(e){o.addBeforeObserver(t,e,this,s.beforeObserver),o.addObserver(t,e,this,s.observer)},this)),a=new y(e,t,v+r,this.instanceMeta.propertyName,this.cp,i),this.setValue(u.call(this.instanceMeta.context,this.getValue(),t,a,this.instanceMeta.sugarMeta))},this),this.callbacks.flushedChanges.call(this.instanceMeta.context,this.getValue(),this.instanceMeta.sugarMeta),this.trackAdd(h,v,m)}},itemPropertyWillChange:function(e,t,r,i){var a=n.guidFor(e);this.changedItems[a]||(this.changedItems[a]={array:r,observerContext:i,obj:e,previousValues:{}}),++this.changedItemCount,this.changedItems[a].previousValues[t]=f(e,t)},itemPropertyDidChange:function(e,t,r,n){0===--this.changedItemCount&&this.flushChanges()},flushChanges:function(){var e,t,r,n=this.changedItems;for(e in n)t=n[e],t.observerContext.destroyed||(this.updateIndexes(t.observerContext.trackedArray,t.observerContext.dependentArray),r=new y(t.array,t.obj,t.observerContext.index,this.instanceMeta.propertyName,this.cp,n.length,t.previousValues),this.setValue(this.callbacks.removedItem.call(this.instanceMeta.context,this.getValue(),t.obj,r,this.instanceMeta.sugarMeta)),this.setValue(this.callbacks.addedItem.call(this.instanceMeta.context,this.getValue(),t.obj,r,this.instanceMeta.sugarMeta)));this.changedItems={},this.callbacks.flushedChanges.call(this.instanceMeta.context,this.getValue(),this.instanceMeta.sugarMeta)}},C.prototype={getValue:function(){var e=A(this.cache,this.propertyName);return void 0!==e?e:this.initialValue},setValue:function(e,t){e!==A(this.cache,this.propertyName)&&(t&&a.propertyWillChange(this.context,this.propertyName),void 0===e?N(this.cache,this.propertyName):S(this.cache,this.propertyName,e),t&&a.propertyDidChange(this.context,this.propertyName))}},E.prototype=l["default"](u.ComputedProperty.prototype),E.prototype._callbacks=function(){if(!this.callbacks){var e=this.options;this.callbacks={removedItem:e.removedItem||O,addedItem:e.addedItem||O,flushedChanges:e.flushedChanges||O}}return this.callbacks},E.prototype._hasInstanceMeta=function(e,t){var r=e.__ember_meta__,n=r&&r.cacheMeta;return!(!n||!n[t])},E.prototype._instanceMeta=function(e,t){var r=e.__ember_meta__,n=r.cacheMeta,i=n&&n[t];return n||(n=r.cacheMeta={}),i||(i=n[t]=new C(e,t,this.initialValue()),i.dependentArraysObserver=new p(this._callbacks(),this,i,e,t,i.sugarMeta)),i},E.prototype.initialValue=function(){return"function"==typeof this.options.initialValue?this.options.initialValue():this.options.initialValue},E.prototype.resetValue=function(e){return this.initialValue()},E.prototype.itemPropertyKey=function(e,t){this._itemPropertyKeys[e]=this._itemPropertyKeys[e]||[],this._itemPropertyKeys[e].push(t)},E.prototype.clearItemPropertyKeys=function(e){this._itemPropertyKeys[e]&&(this._previousItemPropertyKeys[e]=this._itemPropertyKeys[e],this._itemPropertyKeys[e]=[])},E.prototype.property=function(){var e,t,r=this,a=T.call(arguments),o={};c.forEach(a,function(a){if(M.test(a))throw new i["default"]("Nested @each properties not supported: "+a);if(e=k.exec(a)){t=e[1];var u=e[2],l=function(e){r.itemPropertyKey(t,e)};s["default"](u,l),o[n.guidFor(t)]=t}else o[n.guidFor(a)]=a});var l=[];for(var h in o)l.push(o[h]);return u.ComputedProperty.prototype.property.apply(this,l)}}),e("ember-runtime/computed/reduce_computed_macros",["exports","ember-metal/core","ember-metal/property_get","ember-metal/utils","ember-metal/error","ember-metal/enumerable_utils","ember-metal/run_loop","ember-metal/observer","ember-runtime/computed/array_computed","ember-runtime/computed/reduce_computed","ember-runtime/system/subarray","ember-metal/keys","ember-runtime/compare"],function(e,t,r,n,i,a,s,o,u,l,c,h,m){"use strict";function d(e){return l.reduceComputed(e,{initialValue:0,addedItem:function(e,t,r,n){return e+t},removedItem:function(e,t,r,n){return e-t}})}function f(e){return l.reduceComputed(e,{initialValue:-(1/0),addedItem:function(e,t,r,n){return Math.max(e,t)},removedItem:function(e,t,r,n){return e>t?e:void 0}})}function p(e){return l.reduceComputed(e,{initialValue:1/0,addedItem:function(e,t,r,n){return Math.min(e,t)},removedItem:function(e,t,r,n){return t>e?e:void 0}})}function v(e,t){var r={addedItem:function(e,r,n,i){var a=t.call(this,r,n.index);return e.insertAt(n.index,a),e},removedItem:function(e,t,r,n){return e.removeAt(r.index,1),e}};return u.arrayComputed(e,r)}function g(e,t){var n=function(e){return r.get(e,t)};return v(e+".@each."+t,n)}function b(e,t){var r={initialize:function(e,t,r){r.filteredArrayIndexes=new c["default"]},addedItem:function(e,r,n,i){var a=!!t.call(this,r,n.index,n.arrayChanged),s=i.filteredArrayIndexes.addItem(n.index,a);return a&&e.insertAt(s,r),e},removedItem:function(e,t,r,n){var i=n.filteredArrayIndexes.removeItem(r.index);return i>-1&&e.removeAt(i),e}};return u.arrayComputed(e,r)}function y(e,t,n){var i;return i=2===arguments.length?function(e){return r.get(e,t)}:function(e){return r.get(e,t)===n},b(e+".@each."+t,i)}function _(){var e=A.call(arguments);return e.push({initialize:function(e,t,r){r.itemCounts={}},addedItem:function(e,t,r,i){var a=n.guidFor(t);return i.itemCounts[a]?++i.itemCounts[a]:(i.itemCounts[a]=1,e.pushObject(t)),e},removedItem:function(e,t,r,i){var a=n.guidFor(t),s=i.itemCounts;return 0===--s[a]&&e.removeObject(t),e}}),u.arrayComputed.apply(null,e)}function w(){var e=A.call(arguments);return e.push({initialize:function(e,t,r){r.itemCounts={}},addedItem:function(e,t,r,i){var a=n.guidFor(t),s=n.guidFor(r.arrayChanged),o=r.property._dependentKeys.length,u=i.itemCounts;return u[a]||(u[a]={}),void 0===u[a][s]&&(u[a][s]=0),1===++u[a][s]&&o===h["default"](u[a]).length&&e.addObject(t),e},removedItem:function(e,t,r,i){var a,s=n.guidFor(t),o=n.guidFor(r.arrayChanged),u=i.itemCounts;return void 0===u[s][o]&&(u[s][o]=0),0===--u[s][o]&&(delete u[s][o],a=h["default"](u[s]).length,0===a&&delete u[s],e.removeObject(t)),e}}),u.arrayComputed.apply(null,e)}function x(e,t){if(2!==arguments.length)throw new i["default"]("setDiff requires exactly two dependent arrays.");return u.arrayComputed(e,t,{addedItem:function(n,i,a,s){var o=r.get(this,e),u=r.get(this,t);return a.arrayChanged===o?u.contains(i)||n.addObject(i):n.removeObject(i),n},removedItem:function(n,i,a,s){var o=r.get(this,e),u=r.get(this,t);return a.arrayChanged===u?o.contains(i)&&n.addObject(i):n.removeObject(i),n}})}function C(e,t,i,a){var s,o,u,l,c;return arguments.length<4&&(a=r.get(e,"length")),arguments.length<3&&(i=0),i===a?i:(s=i+Math.floor((a-i)/2),o=e.objectAt(s),l=n.guidFor(o),c=n.guidFor(t),l===c?s:(u=this.order(o,t),0===u&&(u=c>l?-1:1),0>u?this.binarySearch(e,t,s+1,a):u>0?this.binarySearch(e,t,i,s):s))}function E(e,t){return"function"==typeof t?O(e,t):P(e,t)}function O(e,t){return u.arrayComputed(e,{initialize:function(e,r,n){n.order=t,n.binarySearch=C,n.waitingInsertions=[],n.insertWaiting=function(){var t,r,i=n.waitingInsertions;n.waitingInsertions=[];for(var a=0;a<i.length;a++)r=i[a],t=n.binarySearch(e,r),e.insertAt(t,r)},n.insertLater=function(e){this.waitingInsertions.push(e)}},addedItem:function(e,t,r,n){return n.insertLater(t),e},removedItem:function(e,t,r,n){return e.removeObject(t),e},flushedChanges:function(e,t){t.insertWaiting()}})}function P(e,t){return u.arrayComputed(e,{initialize:function(n,i,u){function l(){
var n,s,o,l=r.get(this,t),h=u.sortProperties=[],m=u.sortPropertyAscending={};i.property.clearItemPropertyKeys(e),a.forEach(l,function(t){-1!==(s=t.indexOf(":"))?(n=t.substring(0,s),o="desc"!==t.substring(s+1).toLowerCase()):(n=t,o=!0),h.push(n),m[n]=o,i.property.itemPropertyKey(e,n)}),l.addObserver("@each",this,c)}function c(){s["default"].once(this,h,i.propertyName)}function h(e){l.call(this),i.property.recomputeOnce.call(this,e)}o.addObserver(this,t,c),l.call(this),u.order=function(e,t){for(var r,n,i,a=this.keyFor(e),s=this.keyFor(t),o=0;o<this.sortProperties.length;++o)if(r=this.sortProperties[o],n=m["default"](a[r],s[r]),0!==n)return i=this.sortPropertyAscending[r],i?n:-1*n;return 0},u.binarySearch=C,S(u)},addedItem:function(e,t,r,n){var i=n.binarySearch(e,t);return e.insertAt(i,t),e},removedItem:function(e,t,r,n){var i=n.binarySearch(e,t);return e.removeAt(i),n.dropKeyFor(t),e}})}function S(e){e.keyFor=function(e){var t=n.guidFor(e);if(this.keyCache[t])return this.keyCache[t];for(var i,a={},s=0;s<this.sortProperties.length;++s)i=this.sortProperties[s],a[i]=r.get(e,i);return this.keyCache[t]=a},e.dropKeyFor=function(e){var t=n.guidFor(e);this.keyCache[t]=null},e.keyCache={}}e.sum=d,e.max=f,e.min=p,e.map=v,e.mapBy=g,e.filter=b,e.filterBy=y,e.uniq=_,e.intersect=w,e.setDiff=x,e.sort=E;var A=[].slice,N=g,T=y,k=_;e.mapProperty=N,e.filterProperty=T,e.union=k}),e("ember-runtime/controllers/array_controller",["exports","ember-metal/core","ember-metal/property_get","ember-metal/enumerable_utils","ember-runtime/system/array_proxy","ember-runtime/mixins/sortable","ember-runtime/mixins/controller","ember-metal/computed","ember-metal/error","ember-runtime/mixins/array"],function(e,t,r,n,i,a,s,o,u,l){"use strict";e["default"]=i["default"].extend(s["default"],a["default"],{itemController:null,lookupItemController:function(e){return r.get(this,"itemController")},objectAtContent:function(e){var t,n=r.get(this,"length"),i=r.get(this,"arrangedContent"),a=i&&i.objectAt(e);return e>=0&&n>e&&(t=this.lookupItemController(a))?this.controllerAt(e,a,t):a},arrangedContentDidChange:function(){this._super.apply(this,arguments),this._resetSubControllers()},arrayContentDidChange:function(e,t,r){var i=this._subControllers;if(i.length){var a=i.slice(e,e+t);n.forEach(a,function(e){e&&e.destroy()}),n.replace(i,e,t,new Array(r))}this._super(e,t,r)},init:function(){this._super.apply(this,arguments),this._subControllers=[]},model:o.computed(function(e,r){return arguments.length>1?r:t["default"].A()}),_isVirtual:!1,controllerAt:function(e,t,n){var i,a,s,o=r.get(this,"container"),l=this._subControllers;if(l.length>e&&(a=l[e]))return a;if(s=this._isVirtual?r.get(this,"parentController"):this,i="controller:"+n,!o._registry.has(i))throw new u["default"]('Could not resolve itemController: "'+n+'"');return a=o.lookupFactory(i).create({target:s,parentController:s,model:t}),l[e]=a,a},_subControllers:null,_resetSubControllers:function(){var e,t=this._subControllers;if(t.length){for(var r=0,n=t.length;n>r;r++)e=t[r],e&&e.destroy();t.length=0}},willDestroy:function(){this._resetSubControllers(),this._super.apply(this,arguments)}})}),e("ember-runtime/controllers/controller",["exports","ember-metal/core","ember-runtime/system/object","ember-runtime/mixins/controller","ember-runtime/inject"],function(e,t,r,n,i){"use strict";function a(e){}var s=r["default"].extend(n["default"]);i.createInjectionHelper("controller",a),e["default"]=s}),e("ember-runtime/controllers/object_controller",["exports","ember-metal/core","ember-runtime/mixins/controller","ember-runtime/system/object_proxy"],function(e,t,r,n){"use strict";var i="Ember.ObjectController is deprecated, please use Ember.Controller and use `model.propertyName`.";e["default"]=n["default"].extend(r["default"],{init:function(){this._super()}}),e.objectControllerDeprecation=i}),e("ember-runtime/copy",["exports","ember-metal/enumerable_utils","ember-metal/utils","ember-runtime/system/object","ember-runtime/mixins/copyable"],function(e,t,r,n,i){"use strict";function a(e,n,s,o){var u,l,c;if("object"!=typeof e||null===e)return e;if(n&&(l=t.indexOf(s,e))>=0)return o[l];if("array"===r.typeOf(e)){if(u=e.slice(),n)for(l=u.length;--l>=0;)u[l]=a(u[l],n,s,o)}else if(i["default"]&&i["default"].detect(e))u=e.copy(n,s,o);else if(e instanceof Date)u=new Date(e.getTime());else{u={};for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&"__"!==c.substring(0,2)&&(u[c]=n?a(e[c],n,s,o):e[c])}return n&&(s.push(e),o.push(u)),u}function s(e,t){return"object"!=typeof e||null===e?e:i["default"]&&i["default"].detect(e)?e.copy(t):a(e,t,t?[]:null,t?[]:null)}e["default"]=s}),e("ember-runtime/core",["exports"],function(e){"use strict";function t(e,t){return e&&"function"==typeof e.isEqual?e.isEqual(t):e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():e===t}e.isEqual=t}),e("ember-runtime/ext/function",["ember-metal/core","ember-metal/expand_properties","ember-metal/computed","ember-metal/mixin"],function(e,t,r,n){"use strict";var i=Array.prototype.slice,a=Function.prototype;(e["default"].EXTEND_PROTOTYPES===!0||e["default"].EXTEND_PROTOTYPES.Function)&&(a.property=function(){var e=r.computed(this);return e.property.apply(e,arguments)},a.observes=function(){for(var e=arguments.length,t=new Array(e),r=0;e>r;r++)t[r]=arguments[r];return n.observer.apply(this,t.concat(this))},a.observesImmediately=function(){return this.observes.apply(this,arguments)},a.observesBefore=function(){for(var e=[],r=function(t){e.push(t)},n=0,i=arguments.length;i>n;++n)t["default"](arguments[n],r);return this.__ember_observesBefore__=e,this},a.on=function(){var e=i.call(arguments);return this.__ember_listens__=e,this})}),e("ember-runtime/ext/rsvp",["exports","ember-metal/core","ember-metal/logger","ember-metal/run_loop","rsvp"],function(e,r,n,i,a){"use strict";function s(e){var i;if(e&&e.errorThrown?(i=e.errorThrown,"string"==typeof i&&(i=new Error(i)),i.__reason_with_error_thrown__=e):i=e,i&&"TransitionAborted"!==i.name)if(r["default"].testing){if(!o&&r["default"].__loader.registry[u]&&(o=t(u)["default"]),!o||!o.adapter)throw i;o.adapter.exception(i),n["default"].error(i.stack)}else r["default"].onerror?r["default"].onerror(i):n["default"].error(i.stack)}e.onerrorDefault=s;var o,u="ember-testing/test",l=function(){r["default"].Test&&r["default"].Test.adapter&&r["default"].Test.adapter.asyncStart()},c=function(){r["default"].Test&&r["default"].Test.adapter&&r["default"].Test.adapter.asyncEnd()};a.configure("async",function(e,t){var n=!i["default"].currentRunLoop;r["default"].testing&&n&&l(),i["default"].backburner.schedule("actions",function(){r["default"].testing&&n&&c(),e(t)})}),a.Promise.prototype.fail=function(e,t){return this["catch"](e,t)},a.on("error",s),e["default"]=a}),e("ember-runtime/ext/string",["ember-metal/core","ember-runtime/system/string"],function(e,t){"use strict";var r=String.prototype;(e["default"].EXTEND_PROTOTYPES===!0||e["default"].EXTEND_PROTOTYPES.String)&&(r.fmt=function(){return t.fmt(this,arguments)},r.w=function(){return t.w(this)},r.loc=function(){return t.loc(this,arguments)},r.camelize=function(){return t.camelize(this)},r.decamelize=function(){return t.decamelize(this)},r.dasherize=function(){return t.dasherize(this)},r.underscore=function(){return t.underscore(this)},r.classify=function(){return t.classify(this)},r.capitalize=function(){return t.capitalize(this)})}),e("ember-runtime/inject",["exports","ember-metal/core","ember-metal/enumerable_utils","ember-metal/injected_property","ember-metal/keys"],function(e,t,r,n,i){"use strict";function a(){}function s(e,t){u[e]=t,a[e]=function(t){return new n["default"](e,t)}}function o(e){var t,i,a,s,o,l=e.proto(),c=[];for(t in l)i=l[t],i instanceof n["default"]&&-1===r.indexOf(c,i.type)&&c.push(i.type);if(c.length)for(s=0,o=c.length;o>s;s++)a=u[c[s]],"function"==typeof a&&a(e);return!0}e.createInjectionHelper=s,e.validatePropertyInjections=o;var u={};e["default"]=a}),e("ember-runtime/mixins/-proxy",["exports","ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/utils","ember-metal/observer","ember-metal/property_events","ember-metal/computed","ember-metal/properties","ember-metal/mixin","ember-runtime/system/string"],function(e,t,r,n,i,a,s,o,u,l,c){"use strict";function h(e,t){var r=t.slice(8);r in this||s.propertyWillChange(this,r)}function m(e,t){var r=t.slice(8);r in this||s.propertyDidChange(this,r)}e["default"]=l.Mixin.create({content:null,_contentDidChange:l.observer("content",function(){}),isTruthy:o.computed.bool("content"),_debugContainerKey:null,willWatchProperty:function(e){var t="content."+e;a.addBeforeObserver(this,t,null,h),a.addObserver(this,t,null,m)},didUnwatchProperty:function(e){var t="content."+e;a.removeBeforeObserver(this,t,null,h),a.removeObserver(this,t,null,m)},unknownProperty:function(e){var t=r.get(this,"content");return t?r.get(t,e):void 0},setUnknownProperty:function(e,t){var a=i.meta(this);if(a.proto===this)return u.defineProperty(this,e,null,t),t;var s=r.get(this,"content");return n.set(s,e,t)}})}),e("ember-runtime/mixins/action_handler",["exports","ember-metal/merge","ember-metal/mixin","ember-metal/property_get","ember-metal/utils"],function(e,t,r,n,i){"use strict";var a=r.Mixin.create({mergedProperties:["_actions"],willMergeMixin:function(e){var r;e._actions||("object"===i.typeOf(e.actions)?r="actions":"object"===i.typeOf(e.events)&&(r="events"),r&&(e._actions=t["default"](e._actions||{},e[r])),delete e[r])},send:function(e){var t,r=[].slice.call(arguments,1);if(this._actions&&this._actions[e]){var i=this._actions[e].apply(this,r)===!0;if(!i)return}(t=n.get(this,"target"))&&t.send.apply(t,arguments)}});e["default"]=a}),e("ember-runtime/mixins/array",["exports","ember-metal/core","ember-metal/property_get","ember-metal/computed","ember-metal/is_none","ember-runtime/mixins/enumerable","ember-metal/enumerable_utils","ember-metal/mixin","ember-metal/property_events","ember-metal/events","ember-metal/watching"],function(e,r,n,i,a,s,o,u,l,c,h){"use strict";function m(e,t,r,i,a){var s=r&&r.willChange||"arrayWillChange",o=r&&r.didChange||"arrayDidChange",u=n.get(e,"hasArrayObservers");return u===a&&l.propertyWillChange(e,"hasArrayObservers"),i(e,"@array:before",t,s),i(e,"@array:change",t,o),u===a&&l.propertyDidChange(e,"hasArrayObservers"),e}e["default"]=u.Mixin.create(s["default"],{length:u.required(),objectAt:function(e){return 0>e||e>=n.get(this,"length")?void 0:n.get(this,e)},objectsAt:function(e){var t=this;return o.map(e,function(e){return t.objectAt(e)})},nextObject:function(e){return this.objectAt(e)},"[]":i.computed(function(e,t){return void 0!==t&&this.replace(0,n.get(this,"length"),t),this}),firstObject:i.computed(function(){return this.objectAt(0)}),lastObject:i.computed(function(){return this.objectAt(n.get(this,"length")-1)}),contains:function(e){return this.indexOf(e)>=0},slice:function(e,t){var i=r["default"].A(),s=n.get(this,"length");for(a["default"](e)&&(e=0),(a["default"](t)||t>s)&&(t=s),0>e&&(e=s+e),0>t&&(t=s+t);t>e;)i[i.length]=this.objectAt(e++);return i},indexOf:function(e,t){var r,i=n.get(this,"length");for(void 0===t&&(t=0),0>t&&(t+=i),r=t;i>r;r++)if(this.objectAt(r)===e)return r;return-1},lastIndexOf:function(e,t){var r,i=n.get(this,"length");for((void 0===t||t>=i)&&(t=i-1),0>t&&(t+=i),r=t;r>=0;r--)if(this.objectAt(r)===e)return r;return-1},addArrayObserver:function(e,t){return m(this,e,t,c.addListener,!1)},removeArrayObserver:function(e,t){return m(this,e,t,c.removeListener,!0)},hasArrayObservers:i.computed(function(){return c.hasListeners(this,"@array:change")||c.hasListeners(this,"@array:before")}),arrayContentWillChange:function(e,t,r){var i,a;if(void 0===e?(e=0,t=r=-1):(void 0===t&&(t=-1),void 0===r&&(r=-1)),h.isWatching(this,"@each")&&n.get(this,"@each"),c.sendEvent(this,"@array:before",[this,e,t,r]),e>=0&&t>=0&&n.get(this,"hasEnumerableObservers")){i=[],a=e+t;for(var s=e;a>s;s++)i.push(this.objectAt(s))}else i=t;return this.enumerableContentWillChange(i,r),this},arrayContentDidChange:function(e,t,r){var a,s;if(void 0===e?(e=0,t=r=-1):(void 0===t&&(t=-1),void 0===r&&(r=-1)),e>=0&&r>=0&&n.get(this,"hasEnumerableObservers")){a=[],s=e+r;for(var o=e;s>o;o++)a.push(this.objectAt(o))}else a=r;this.enumerableContentDidChange(t,a),c.sendEvent(this,"@array:change",[this,e,t,r]);var u=n.get(this,"length"),h=i.cacheFor(this,"firstObject"),m=i.cacheFor(this,"lastObject");return this.objectAt(0)!==h&&(l.propertyWillChange(this,"firstObject"),l.propertyDidChange(this,"firstObject")),this.objectAt(u-1)!==m&&(l.propertyWillChange(this,"lastObject"),l.propertyDidChange(this,"lastObject")),this},"@each":i.computed(function(){if(!this.__each){var e=t("ember-runtime/system/each_proxy").EachProxy;this.__each=new e(this)}return this.__each})})}),e("ember-runtime/mixins/comparable",["exports","ember-metal/mixin"],function(e,t){"use strict";e["default"]=t.Mixin.create({compare:t.required(Function)})}),e("ember-runtime/mixins/controller",["exports","ember-metal/mixin","ember-metal/alias","ember-runtime/mixins/action_handler","ember-runtime/mixins/controller_content_model_alias_deprecation"],function(e,t,r,n,i){"use strict";e["default"]=t.Mixin.create(n["default"],i["default"],{isController:!0,target:null,container:null,parentController:null,store:null,model:null,content:r["default"]("model")})}),e("ember-runtime/mixins/controller_content_model_alias_deprecation",["exports","ember-metal/core","ember-metal/mixin"],function(e,t,r){"use strict";e["default"]=r.Mixin.create({willMergeMixin:function(e){this._super.apply(this,arguments);var t=!!e.model;e.content&&!t&&(e.model=e.content,delete e.content)}})}),e("ember-runtime/mixins/copyable",["exports","ember-metal/property_get","ember-metal/mixin","ember-runtime/mixins/freezable","ember-runtime/system/string","ember-metal/error"],function(e,t,r,n,i,a){"use strict";e["default"]=r.Mixin.create({copy:r.required(Function),frozenCopy:function(){if(n.Freezable&&n.Freezable.detect(this))return t.get(this,"isFrozen")?this:this.copy().freeze();throw new a["default"](i.fmt("%@ does not support freezing",[this]))}})}),e("ember-runtime/mixins/deferred",["exports","ember-metal/core","ember-metal/property_get","ember-metal/mixin","ember-metal/computed","ember-runtime/ext/rsvp"],function(e,t,r,n,i,a){"use strict";e["default"]=n.Mixin.create({then:function(e,t,n){function i(t){return e(t===s?o:t)}var a,s,o;return o=this,a=r.get(this,"_deferred"),s=a.promise,s.then(e&&i,t,n)},resolve:function(e){var t,n;t=r.get(this,"_deferred"),n=t.promise,t.resolve(e===this?n:e)},reject:function(e){r.get(this,"_deferred").reject(e)},_deferred:i.computed(function(){return a["default"].defer("Ember: DeferredMixin - "+this)})})}),e("ember-runtime/mixins/enumerable",["exports","ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/utils","ember-metal/mixin","ember-metal/enumerable_utils","ember-metal/computed","ember-metal/property_events","ember-metal/events","ember-runtime/compare"],function(e,t,r,n,i,a,s,o,u,l,c){"use strict";function h(){return 0===p.length?{}:p.pop()}function m(e){return p.push(e),null}function d(e,t){function n(n){var a=r.get(n,e);return i?t===a:!!a}var i=2===arguments.length;return n}var f=Array.prototype.slice,p=[];e["default"]=a.Mixin.create({nextObject:a.required(Function),firstObject:o.computed("[]",function(){if(0===r.get(this,"length"))return void 0;var e=h(),t=this.nextObject(0,null,e);return m(e),t}),lastObject:o.computed("[]",function(){var e=r.get(this,"length");if(0===e)return void 0;var t,n=h(),i=0,a=null;do a=t,t=this.nextObject(i++,a,n);while(void 0!==t);return m(n),a}),contains:function(e){var t=this.find(function(t){return t===e});return void 0!==t},forEach:function(e,t){if("function"!=typeof e)throw new TypeError;var n=h(),i=r.get(this,"length"),a=null;void 0===t&&(t=null);for(var s=0;i>s;s++){var o=this.nextObject(s,a,n);e.call(t,o,s,this),a=o}return a=null,n=m(n),this},getEach:a.aliasMethod("mapBy"),setEach:function(e,t){return this.forEach(function(r){n.set(r,e,t)})},map:function(e,r){var n=t["default"].A();return this.forEach(function(t,i,a){n[i]=e.call(r,t,i,a)}),n},mapBy:function(e){return this.map(function(t){return r.get(t,e)})},mapProperty:a.aliasMethod("mapBy"),filter:function(e,r){var n=t["default"].A();return this.forEach(function(t,i,a){e.call(r,t,i,a)&&n.push(t)}),n},reject:function(e,t){return this.filter(function(){return!i.apply(t,e,arguments)})},filterBy:function(e,t){return this.filter(i.apply(this,d,arguments))},filterProperty:a.aliasMethod("filterBy"),rejectBy:function(e,t){var n=function(n){return r.get(n,e)===t},i=function(t){return!!r.get(t,e)},a=2===arguments.length?n:i;return this.reject(a)},rejectProperty:a.aliasMethod("rejectBy"),find:function(e,t){var n=r.get(this,"length");void 0===t&&(t=null);for(var i,a,s=h(),o=!1,u=null,l=0;n>l&&!o;l++)i=this.nextObject(l,u,s),(o=e.call(t,i,l,this))&&(a=i),u=i;return i=u=null,s=m(s),a},findBy:function(e,t){return this.find(i.apply(this,d,arguments))},findProperty:a.aliasMethod("findBy"),every:function(e,t){return!this.find(function(r,n,i){return!e.call(t,r,n,i)})},everyBy:a.aliasMethod("isEvery"),everyProperty:a.aliasMethod("isEvery"),isEvery:function(e,t){return this.every(i.apply(this,d,arguments))},any:function(e,t){var n,i,a=r.get(this,"length"),s=h(),o=!1,u=null;for(void 0===t&&(t=null),i=0;a>i&&!o;i++)n=this.nextObject(i,u,s),o=e.call(t,n,i,this),u=n;return n=u=null,s=m(s),o},some:a.aliasMethod("any"),isAny:function(e,t){return this.any(i.apply(this,d,arguments))},anyBy:a.aliasMethod("isAny"),someProperty:a.aliasMethod("isAny"),reduce:function(e,t,r){if("function"!=typeof e)throw new TypeError;var n=t;return this.forEach(function(t,i){n=e(n,t,i,this,r)},this),n},invoke:function(e){var r,n=t["default"].A();return arguments.length>1&&(r=f.call(arguments,1)),this.forEach(function(t,a){var s=t&&t[e];"function"==typeof s&&(n[a]=r?i.apply(t,s,r):t[e]())},this),n},toArray:function(){var e=t["default"].A();return this.forEach(function(t,r){e[r]=t}),e},compact:function(){return this.filter(function(e){return null!=e})},without:function(e){if(!this.contains(e))return this;var r=t["default"].A();return this.forEach(function(t){t!==e&&(r[r.length]=t)}),r},uniq:function(){var e=t["default"].A();return this.forEach(function(t){s.indexOf(e,t)<0&&e.push(t)}),e},"[]":o.computed(function(e,t){return this}),addEnumerableObserver:function(e,t){var n=t&&t.willChange||"enumerableWillChange",i=t&&t.didChange||"enumerableDidChange",a=r.get(this,"hasEnumerableObservers");return a||u.propertyWillChange(this,"hasEnumerableObservers"),l.addListener(this,"@enumerable:before",e,n),l.addListener(this,"@enumerable:change",e,i),a||u.propertyDidChange(this,"hasEnumerableObservers"),this},removeEnumerableObserver:function(e,t){var n=t&&t.willChange||"enumerableWillChange",i=t&&t.didChange||"enumerableDidChange",a=r.get(this,"hasEnumerableObservers");return a&&u.propertyWillChange(this,"hasEnumerableObservers"),l.removeListener(this,"@enumerable:before",e,n),l.removeListener(this,"@enumerable:change",e,i),a&&u.propertyDidChange(this,"hasEnumerableObservers"),this},hasEnumerableObservers:o.computed(function(){return l.hasListeners(this,"@enumerable:change")||l.hasListeners(this,"@enumerable:before")}),enumerableContentWillChange:function(e,t){var n,i,a;return n="number"==typeof e?e:e?r.get(e,"length"):e=-1,i="number"==typeof t?t:t?r.get(t,"length"):t=-1,a=0>i||0>n||i-n!==0,-1===e&&(e=null),-1===t&&(t=null),u.propertyWillChange(this,"[]"),a&&u.propertyWillChange(this,"length"),l.sendEvent(this,"@enumerable:before",[this,e,t]),this},enumerableContentDidChange:function(e,t){var n,i,a;return n="number"==typeof e?e:e?r.get(e,"length"):e=-1,i="number"==typeof t?t:t?r.get(t,"length"):t=-1,a=0>i||0>n||i-n!==0,-1===e&&(e=null),-1===t&&(t=null),l.sendEvent(this,"@enumerable:change",[this,e,t]),a&&u.propertyDidChange(this,"length"),u.propertyDidChange(this,"[]"),this},sortBy:function(){var e=arguments;return this.toArray().sort(function(t,n){for(var i=0;i<e.length;i++){var a=e[i],s=r.get(t,a),o=r.get(n,a),u=c["default"](s,o);if(u)return u}return 0})}})}),e("ember-runtime/mixins/evented",["exports","ember-metal/mixin","ember-metal/events"],function(e,t,r){"use strict";e["default"]=t.Mixin.create({on:function(e,t,n){return r.addListener(this,e,t,n),this},one:function(e,t,n){return n||(n=t,t=null),r.addListener(this,e,t,n,!0),this},trigger:function(e){for(var t=arguments.length,n=new Array(t-1),i=1;t>i;i++)n[i-1]=arguments[i];r.sendEvent(this,e,n)},off:function(e,t,n){return r.removeListener(this,e,t,n),this},has:function(e){return r.hasListeners(this,e)}})}),e("ember-runtime/mixins/freezable",["exports","ember-metal/mixin","ember-metal/property_get","ember-metal/property_set"],function(e,t,r,n){"use strict";var i=t.Mixin.create({isFrozen:!1,freeze:function(){return r.get(this,"isFrozen")?this:(n.set(this,"isFrozen",!0),this)}}),a="Frozen object cannot be modified.";e.Freezable=i,e.FROZEN_ERROR=a}),e("ember-runtime/mixins/mutable_array",["exports","ember-metal/property_get","ember-metal/utils","ember-metal/error","ember-metal/mixin","ember-runtime/mixins/array","ember-runtime/mixins/mutable_enumerable","ember-runtime/mixins/enumerable"],function(e,t,r,n,i,a,s,o){"use strict";var u="Index out of range",l=[];e["default"]=i.Mixin.create(a["default"],s["default"],{replace:i.required(),clear:function(){var e=t.get(this,"length");return 0===e?this:(this.replace(0,e,l),this)},insertAt:function(e,r){if(e>t.get(this,"length"))throw new n["default"](u);return this.replace(e,0,[r]),this},removeAt:function(e,r){if("number"==typeof e){if(0>e||e>=t.get(this,"length"))throw new n["default"](u);void 0===r&&(r=1),this.replace(e,r,l)}return this},pushObject:function(e){return this.insertAt(t.get(this,"length"),e),e},pushObjects:function(e){if(!o["default"].detect(e)&&!r.isArray(e))throw new TypeError("Must pass Ember.Enumerable to Ember.MutableArray#pushObjects");return this.replace(t.get(this,"length"),0,e),this},popObject:function(){var e=t.get(this,"length");if(0===e)return null;var r=this.objectAt(e-1);return this.removeAt(e-1,1),r},shiftObject:function(){if(0===t.get(this,"length"))return null;var e=this.objectAt(0);return this.removeAt(0),e},unshiftObject:function(e){return this.insertAt(0,e),e},unshiftObjects:function(e){return this.replace(0,0,e),this},reverseObjects:function(){var e=t.get(this,"length");if(0===e)return this;var r=this.toArray().reverse();return this.replace(0,e,r),this},setObjects:function(e){if(0===e.length)return this.clear();var r=t.get(this,"length");return this.replace(0,r,e),this},removeObject:function(e){for(var r=t.get(this,"length")||0;--r>=0;){var n=this.objectAt(r);n===e&&this.removeAt(r)}return this},addObject:function(e){return this.contains(e)||this.pushObject(e),this}})}),e("ember-runtime/mixins/mutable_enumerable",["exports","ember-metal/enumerable_utils","ember-runtime/mixins/enumerable","ember-metal/mixin","ember-metal/property_events"],function(e,t,r,n,i){"use strict";e["default"]=n.Mixin.create(r["default"],{addObject:n.required(Function),addObjects:function(e){return i.beginPropertyChanges(this),t.forEach(e,function(e){this.addObject(e)},this),i.endPropertyChanges(this),this},removeObject:n.required(Function),removeObjects:function(e){i.beginPropertyChanges(this);for(var t=e.length-1;t>=0;t--)this.removeObject(e[t]);return i.endPropertyChanges(this),this}})}),e("ember-runtime/mixins/observable",["exports","ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/utils","ember-metal/get_properties","ember-metal/set_properties","ember-metal/mixin","ember-metal/events","ember-metal/property_events","ember-metal/observer","ember-metal/computed","ember-metal/is_none"],function(e,t,r,n,i,a,s,o,u,l,c,h,m){"use strict";var d=Array.prototype.slice;e["default"]=o.Mixin.create({get:function(e){return r.get(this,e)},getProperties:function(){return i.apply(null,a["default"],[this].concat(d.call(arguments)))},set:function(e,t){return n.set(this,e,t),this},setProperties:function(e){return s["default"](this,e)},beginPropertyChanges:function(){return l.beginPropertyChanges(),this},endPropertyChanges:function(){return l.endPropertyChanges(),this},propertyWillChange:function(e){return l.propertyWillChange(this,e),this},propertyDidChange:function(e){return l.propertyDidChange(this,e),this},notifyPropertyChange:function(e){return this.propertyWillChange(e),this.propertyDidChange(e),this},addBeforeObserver:function(e,t,r){c.addBeforeObserver(this,e,t,r)},addObserver:function(e,t,r){c.addObserver(this,e,t,r)},removeObserver:function(e,t,r){c.removeObserver(this,e,t,r)},hasObserverFor:function(e){return u.hasListeners(this,e+":change")},getWithDefault:function(e,t){return r.getWithDefault(this,e,t)},incrementProperty:function(e,t){return m["default"](t)&&(t=1),n.set(this,e,(parseFloat(r.get(this,e))||0)+t),r.get(this,e)},decrementProperty:function(e,t){return m["default"](t)&&(t=1),n.set(this,e,(r.get(this,e)||0)-t),r.get(this,e)},toggleProperty:function(e){return n.set(this,e,!r.get(this,e)),r.get(this,e)},cacheFor:function(e){return h.cacheFor(this,e)},observersForKey:function(e){return c.observersFor(this,e)}})}),e("ember-runtime/mixins/promise_proxy",["exports","ember-metal/property_get","ember-metal/set_properties","ember-metal/computed","ember-metal/mixin","ember-metal/error"],function(e,t,r,n,i,a){"use strict";function s(e,t){return r["default"](e,{isFulfilled:!1,isRejected:!1}),t.then(function(t){return r["default"](e,{content:t,isFulfilled:!0}),t},function(t){throw r["default"](e,{reason:t,isRejected:!0}),t},"Ember: PromiseProxy")}function o(e){return function(){var r=t.get(this,"promise");return r[e].apply(r,arguments)}}var u=n.computed.not,l=n.computed.or;e["default"]=i.Mixin.create({reason:null,isPending:u("isSettled").readOnly(),isSettled:l("isRejected","isFulfilled").readOnly(),isRejected:!1,isFulfilled:!1,promise:n.computed(function(e,t){if(2===arguments.length)return s(this,t);throw new a["default"]("PromiseProxy's promise must be set")}),then:o("then"),"catch":o("catch"),"finally":o("finally")})}),e("ember-runtime/mixins/sortable",["exports","ember-metal/core","ember-metal/property_get","ember-metal/enumerable_utils","ember-runtime/mixins/mutable_enumerable","ember-runtime/compare","ember-metal/observer","ember-metal/computed","ember-metal/computed_macros","ember-metal/mixin"],function(e,t,r,n,i,a,s,o,u,l){"use strict";e["default"]=l.Mixin.create(i["default"],{sortProperties:null,sortAscending:!0,sortFunction:a["default"],orderBy:function(e,t){var i=0,a=r.get(this,"sortProperties"),s=r.get(this,"sortAscending"),o=r.get(this,"sortFunction");return n.forEach(a,function(n){0===i&&(i=o.call(this,r.get(e,n),r.get(t,n)),0===i||s||(i=-1*i))},this),i},destroy:function(){var e=r.get(this,"content"),t=r.get(this,"sortProperties");return e&&t&&n.forEach(e,function(e){n.forEach(t,function(t){s.removeObserver(e,t,this,"contentItemSortPropertyDidChange")},this)},this),this._super.apply(this,arguments)},isSorted:u.notEmpty("sortProperties"),arrangedContent:o.computed("content","sortProperties.@each",function(e,i){var a=r.get(this,"content"),o=r.get(this,"isSorted"),u=r.get(this,"sortProperties"),l=this;return a&&o?(a=a.slice(),a.sort(function(e,t){return l.orderBy(e,t)}),n.forEach(a,function(e){n.forEach(u,function(t){s.addObserver(e,t,this,"contentItemSortPropertyDidChange")},this)},this),t["default"].A(a)):a}),_contentWillChange:l.beforeObserver("content",function(){var e=r.get(this,"content"),t=r.get(this,"sortProperties");e&&t&&n.forEach(e,function(e){n.forEach(t,function(t){s.removeObserver(e,t,this,"contentItemSortPropertyDidChange")},this)},this),this._super.apply(this,arguments)}),sortPropertiesWillChange:l.beforeObserver("sortProperties",function(){this._lastSortAscending=void 0}),sortPropertiesDidChange:l.observer("sortProperties",function(){this._lastSortAscending=void 0}),sortAscendingWillChange:l.beforeObserver("sortAscending",function(){this._lastSortAscending=r.get(this,"sortAscending")}),sortAscendingDidChange:l.observer("sortAscending",function(){if(void 0!==this._lastSortAscending&&r.get(this,"sortAscending")!==this._lastSortAscending){var e=r.get(this,"arrangedContent");e.reverseObjects()}}),contentArrayWillChange:function(e,t,i,a){var o=r.get(this,"isSorted");if(o){var u=r.get(this,"arrangedContent"),l=e.slice(t,t+i),c=r.get(this,"sortProperties");n.forEach(l,function(e){u.removeObject(e),n.forEach(c,function(t){s.removeObserver(e,t,this,"contentItemSortPropertyDidChange")},this)},this)}return this._super(e,t,i,a)},contentArrayDidChange:function(e,t,i,a){var o=r.get(this,"isSorted"),u=r.get(this,"sortProperties");if(o){var l=e.slice(t,t+a);n.forEach(l,function(e){this.insertItemSorted(e),n.forEach(u,function(t){s.addObserver(e,t,this,"contentItemSortPropertyDidChange")},this)},this)}return this._super(e,t,i,a)},insertItemSorted:function(e){var t=r.get(this,"arrangedContent"),n=r.get(t,"length"),i=this._binarySearch(e,0,n);t.insertAt(i,e)},contentItemSortPropertyDidChange:function(e){var t=r.get(this,"arrangedContent"),n=t.indexOf(e),i=t.objectAt(n-1),a=t.objectAt(n+1),s=i&&this.orderBy(e,i),o=a&&this.orderBy(e,a);(0>s||o>0)&&(t.removeObject(e),this.insertItemSorted(e))},_binarySearch:function(e,t,n){var i,a,s,o;return t===n?t:(o=r.get(this,"arrangedContent"),i=t+Math.floor((n-t)/2),a=o.objectAt(i),s=this.orderBy(a,e),0>s?this._binarySearch(e,i+1,n):s>0?this._binarySearch(e,t,i):i)}})}),e("ember-runtime/mixins/target_action_support",["exports","ember-metal/core","ember-metal/property_get","ember-metal/utils","ember-metal/mixin","ember-metal/computed"],function(e,t,r,n,i,a){"use strict";var s=i.Mixin.create({target:null,action:null,actionContext:null,targetObject:a.computed(function(){var e=r.get(this,"target");if("string"===n.typeOf(e)){var i=r.get(this,e);return void 0===i&&(i=r.get(t["default"].lookup,e)),i}return e}).property("target"),actionContextObject:a.computed(function(){var e=r.get(this,"actionContext");if("string"===n.typeOf(e)){var i=r.get(this,e);return void 0===i&&(i=r.get(t["default"].lookup,e)),i}return e}).property("actionContext"),triggerAction:function(e){function t(e,t){var r=[];return t&&r.push(t),r.concat(e)}e=e||{};var n=e.action||r.get(this,"action"),i=e.target||r.get(this,"targetObject"),a=e.actionContext;if("undefined"==typeof a&&(a=r.get(this,"actionContextObject")||this),i&&n){var s;return s=i.send?i.send.apply(i,t(a,n)):i[n].apply(i,t(a)),s!==!1&&(s=!0),s}return!1}});e["default"]=s}),e("ember-runtime/system/application",["exports","ember-runtime/system/namespace"],function(e,t){"use strict";e["default"]=t["default"].extend()}),e("ember-runtime/system/array_proxy",["exports","ember-metal/core","ember-metal/property_get","ember-metal/utils","ember-metal/computed","ember-metal/mixin","ember-metal/property_events","ember-metal/error","ember-runtime/system/object","ember-runtime/mixins/mutable_array","ember-runtime/mixins/enumerable","ember-runtime/system/string","ember-metal/alias"],function(e,t,r,n,i,a,s,o,u,l,c,h,m){"use strict";function d(){return this}var f="Index out of range",p=[],v=u["default"].extend(l["default"],{content:null,arrangedContent:m["default"]("content"),objectAtContent:function(e){return r.get(this,"arrangedContent").objectAt(e)},replaceContent:function(e,t,n){r.get(this,"content").replace(e,t,n)},_contentWillChange:a.beforeObserver("content",function(){this._teardownContent()}),_teardownContent:function(){var e=r.get(this,"content");e&&e.removeArrayObserver(this,{willChange:"contentArrayWillChange",didChange:"contentArrayDidChange"})},contentArrayWillChange:d,contentArrayDidChange:d,_contentDidChange:a.observer("content",function(){r.get(this,"content");this._setupContent()}),_setupContent:function(){var e=r.get(this,"content");e&&e.addArrayObserver(this,{willChange:"contentArrayWillChange",didChange:"contentArrayDidChange"})},_arrangedContentWillChange:a.beforeObserver("arrangedContent",function(){
var e=r.get(this,"arrangedContent"),t=e?r.get(e,"length"):0;this.arrangedContentArrayWillChange(this,0,t,void 0),this.arrangedContentWillChange(this),this._teardownArrangedContent(e)}),_arrangedContentDidChange:a.observer("arrangedContent",function(){var e=r.get(this,"arrangedContent"),t=e?r.get(e,"length"):0;this._setupArrangedContent(),this.arrangedContentDidChange(this),this.arrangedContentArrayDidChange(this,0,void 0,t)}),_setupArrangedContent:function(){var e=r.get(this,"arrangedContent");e&&e.addArrayObserver(this,{willChange:"arrangedContentArrayWillChange",didChange:"arrangedContentArrayDidChange"})},_teardownArrangedContent:function(){var e=r.get(this,"arrangedContent");e&&e.removeArrayObserver(this,{willChange:"arrangedContentArrayWillChange",didChange:"arrangedContentArrayDidChange"})},arrangedContentWillChange:d,arrangedContentDidChange:d,objectAt:function(e){return r.get(this,"content")&&this.objectAtContent(e)},length:i.computed(function(){var e=r.get(this,"arrangedContent");return e?r.get(e,"length"):0}),_replace:function(e,t,n){var i=r.get(this,"content");return i&&this.replaceContent(e,t,n),this},replace:function(){if(r.get(this,"arrangedContent")!==r.get(this,"content"))throw new o["default"]("Using replace on an arranged ArrayProxy is not allowed.");n.apply(this,this._replace,arguments)},_insertAt:function(e,t){if(e>r.get(this,"content.length"))throw new o["default"](f);return this._replace(e,0,[t]),this},insertAt:function(e,t){if(r.get(this,"arrangedContent")===r.get(this,"content"))return this._insertAt(e,t);throw new o["default"]("Using insertAt on an arranged ArrayProxy is not allowed.")},removeAt:function(e,t){if("number"==typeof e){var n,i=r.get(this,"content"),a=r.get(this,"arrangedContent"),u=[];if(0>e||e>=r.get(this,"length"))throw new o["default"](f);for(void 0===t&&(t=1),n=e;e+t>n;n++)u.push(i.indexOf(a.objectAt(n)));for(u.sort(function(e,t){return t-e}),s.beginPropertyChanges(),n=0;n<u.length;n++)this._replace(u[n],1,p);s.endPropertyChanges()}return this},pushObject:function(e){return this._insertAt(r.get(this,"content.length"),e),e},pushObjects:function(e){if(!c["default"].detect(e)&&!n.isArray(e))throw new TypeError("Must pass Ember.Enumerable to Ember.MutableArray#pushObjects");return this._replace(r.get(this,"length"),0,e),this},setObjects:function(e){if(0===e.length)return this.clear();var t=r.get(this,"length");return this._replace(0,t,e),this},unshiftObject:function(e){return this._insertAt(0,e),e},unshiftObjects:function(e){return this._replace(0,0,e),this},slice:function(){var e=this.toArray();return e.slice.apply(e,arguments)},arrangedContentArrayWillChange:function(e,t,r,n){this.arrayContentWillChange(t,r,n)},arrangedContentArrayDidChange:function(e,t,r,n){this.arrayContentDidChange(t,r,n)},init:function(){this._super.apply(this,arguments),this._setupContent(),this._setupArrangedContent()},willDestroy:function(){this._teardownArrangedContent(),this._teardownContent()}});e["default"]=v}),e("ember-runtime/system/container",["exports","ember-metal/property_set","container/registry","container/container"],function(e,t,r,n){"use strict";r["default"].set=t.set,n["default"].set=t.set,e.Registry=r["default"],e.Container=n["default"]}),e("ember-runtime/system/core_object",["exports","ember-metal","ember-metal/merge","ember-metal/property_get","ember-metal/utils","ember-metal/platform/create","ember-metal/chains","ember-metal/events","ember-metal/mixin","ember-metal/enumerable_utils","ember-metal/error","ember-metal/platform/define_property","ember-metal/keys","ember-runtime/mixins/action_handler","ember-metal/properties","ember-metal/binding","ember-metal/computed","ember-metal/injected_property","ember-metal/run_loop","ember-metal/watching","ember-metal/core","ember-runtime/inject"],function(e,t,r,n,i,a,s,o,u,l,c,h,m,d,f,p,v,g,b,y,_,w){"REMOVE_USE_STRICT: true";function x(){var e,t,n=!1,h=function(){n||h.proto(),this.__defineNonEnumerable(i.GUID_KEY_PROPERTY),this.__defineNonEnumerable(i.NEXT_SUPER_PROPERTY);var d=i.meta(this),f=d.proto;if(d.proto=this,e){var p=e;e=null,i.apply(this,this.reopen,p)}if(t){var v=t;t=null;for(var g=this.concatenatedProperties,b=this.mergedProperties,y=0,_=v.length;_>y;y++){var w=v[y];if("object"!=typeof w&&void 0!==w)throw new c["default"]("Ember.Object.create only accepts objects.");if(w)for(var x=m["default"](w),C=0,E=x.length;E>C;C++){var O=x[C],S=w[O];if(u.IS_BINDING.test(O)){var A=d.bindings;A?d.hasOwnProperty("bindings")||(A=d.bindings=a["default"](d.bindings)):A=d.bindings={},A[O]=S}var N=this[O],T=null!==N&&"object"==typeof N&&N.isDescriptor?N:void 0;if(g&&g.length>0&&l.indexOf(g,O)>=0){var k=this[O];S=k?"function"==typeof k.concat?k.concat(S):i.makeArray(k).concat(S):i.makeArray(S)}if(b&&b.length&&l.indexOf(b,O)>=0){var M=this[O];S=r["default"](M,S)}T?T.set(this,O,S):"function"!=typeof this.setUnknownProperty||O in this?this[O]=S:this.setUnknownProperty(O,S)}}}P(this,d);var I=arguments.length;if(0===I)this.init();else if(1===I)this.init(arguments[0]);else{for(var V=new Array(I),j=0;I>j;j++)V[j]=arguments[j];this.init.apply(this,V)}d.proto=f,s.finishChains(this),o.sendEvent(this,"init")};return h.toString=u.Mixin.prototype.toString,h.willReopen=function(){n&&(h.PrototypeMixin=u.Mixin.create(h.PrototypeMixin)),n=!1},h._initMixins=function(t){e=t},h._initProperties=function(e){t=e},h.proto=function(){var e=h.superclass;return e&&e.proto(),n||(n=!0,h.PrototypeMixin.applyPartial(h.prototype)),this.prototype},h}function C(e){return function(){return e}}var E=b["default"].schedule,O=u.Mixin._apply,P=u.Mixin.finishPartial,S=u.Mixin.prototype.reopen,A=!1,N=x();N.toString=function(){return"Ember.CoreObject"},N.PrototypeMixin=u.Mixin.create({reopen:function(){for(var e=arguments.length,t=new Array(e),r=0;e>r;r++)t[r]=arguments[r];return O(this,t,!0),this},init:function(){},__defineNonEnumerable:function(e){h.defineProperty(this,e.name,e.descriptor)},concatenatedProperties:null,isDestroyed:!1,isDestroying:!1,destroy:function(){return this.isDestroying?void 0:(this.isDestroying=!0,E("actions",this,this.willDestroy),E("destroy",this,this._scheduledDestroy),this)},willDestroy:_.K,_scheduledDestroy:function(){this.isDestroyed||(y.destroy(this),this.isDestroyed=!0)},bind:function(e,t){return t instanceof p.Binding||(t=p.Binding.from(t)),t.to(e).connect(this),t},toString:function(){var e="function"==typeof this.toStringExtension,t=e?":"+this.toStringExtension():"",r="<"+this.constructor.toString()+":"+i.guidFor(this)+t+">";return this.toString=C(r),r}}),N.PrototypeMixin.ownerConstructor=N,N.__super__=null;var T={ClassMixin:u.required(),PrototypeMixin:u.required(),isClass:!0,isMethod:!1,extend:function(){var e,t=x();return t.ClassMixin=u.Mixin.create(this.ClassMixin),t.PrototypeMixin=u.Mixin.create(this.PrototypeMixin),t.ClassMixin.ownerConstructor=t,t.PrototypeMixin.ownerConstructor=t,S.apply(t.PrototypeMixin,arguments),t.superclass=this,t.__super__=this.prototype,e=t.prototype=a["default"](this.prototype),e.constructor=t,i.generateGuid(e),i.meta(e).proto=e,t.ClassMixin.apply(t),t},createWithMixins:function(){var e=this,t=arguments.length;if(t>0){for(var r=new Array(t),n=0;t>n;n++)r[n]=arguments[n];this._initMixins(r)}return new e},create:function(){var e=this,t=arguments.length;if(t>0){for(var r=new Array(t),n=0;t>n;n++)r[n]=arguments[n];this._initProperties(r)}return new e},reopen:function(){this.willReopen();var e=arguments.length,t=new Array(e);if(e>0)for(var r=0;e>r;r++)t[r]=arguments[r];return i.apply(this.PrototypeMixin,S,t),this},reopenClass:function(){var e=arguments.length,t=new Array(e);if(e>0)for(var r=0;e>r;r++)t[r]=arguments[r];return i.apply(this.ClassMixin,S,t),O(this,arguments,!1),this},detect:function(e){if("function"!=typeof e)return!1;for(;e;){if(e===this)return!0;e=e.superclass}return!1},detectInstance:function(e){return e instanceof this},metaForProperty:function(e){var t=this.proto(),r=t[e],n=null!==r&&"object"==typeof r&&r.isDescriptor?r:void 0;return n._meta||{}},_computedProperties:v.computed(function(){A=!0;var e,t=this.proto(),r=[];for(var n in t)e=t[n],e instanceof v.ComputedProperty&&r.push({name:n,meta:e._meta});return r}).readOnly(),eachComputedProperty:function(e,t){for(var r,i,a={},s=n.get(this,"_computedProperties"),o=0,u=s.length;u>o;o++)r=s[o],i=r.name,e.call(t||this,r.name,r.meta||a)}};T._lazyInjections=function(){var e,t,r={},n=this.proto();for(e in n)t=n[e],t instanceof g["default"]&&(r[e]=t.type+":"+(t.name||e));return r};var k=u.Mixin.create(T);k.ownerConstructor=N,N.ClassMixin=k,k.apply(N),N.reopen({didDefineProperty:function(e,r,n){if(A!==!1&&n instanceof t["default"].ComputedProperty){var i=t["default"].meta(this.constructor).cache;i&&void 0!==i._computedProperties&&(i._computedProperties=void 0)}}}),e["default"]=N}),e("ember-runtime/system/deferred",["exports","ember-metal/core","ember-runtime/mixins/deferred","ember-runtime/system/object"],function(e,t,r,n){"use strict";var i=n["default"].extend(r["default"],{init:function(){this._super.apply(this,arguments)}});i.reopenClass({promise:function(e,t){var r=i.create();return e.call(t,r),r}}),e["default"]=i}),e("ember-runtime/system/each_proxy",["exports","ember-metal/core","ember-metal/property_get","ember-metal/utils","ember-metal/enumerable_utils","ember-metal/array","ember-runtime/mixins/array","ember-runtime/system/object","ember-metal/computed","ember-metal/observer","ember-metal/events","ember-metal/properties","ember-metal/property_events"],function(e,t,r,n,i,a,s,o,u,l,c,h,m){"use strict";function d(e,t,r,i,a){var s,o=r._objects;for(o||(o=r._objects={});--a>=i;){var u=e.objectAt(a);u&&(l.addBeforeObserver(u,t,r,"contentKeyWillChange"),l.addObserver(u,t,r,"contentKeyDidChange"),s=n.guidFor(u),o[s]||(o[s]=[]),o[s].push(a))}}function f(e,t,r,i,s){var o=r._objects;o||(o=r._objects={});for(var u,c;--s>=i;){var h=e.objectAt(s);h&&(l.removeBeforeObserver(h,t,r,"contentKeyWillChange"),l.removeObserver(h,t,r,"contentKeyDidChange"),c=n.guidFor(h),u=o[c],u[a.indexOf.call(u,s)]=null)}}var p=o["default"].extend(s["default"],{init:function(e,t,r){this._super.apply(this,arguments),this._keyName=t,this._owner=r,this._content=e},objectAt:function(e){var t=this._content.objectAt(e);return t&&r.get(t,this._keyName)},length:u.computed(function(){var e=this._content;return e?r.get(e,"length"):0})}),v=/^.+:(before|change)$/,g=o["default"].extend({init:function(e){this._super.apply(this,arguments),this._content=e,e.addArrayObserver(this),i.forEach(c.watchedEvents(this),function(e){this.didAddListener(e)},this)},unknownProperty:function(e,t){var r;return r=new p(this._content,e,this),h.defineProperty(this,e,null,r),this.beginObservingContentKey(e),r},arrayWillChange:function(e,t,r,n){var i,a,s=this._keys;a=r>0?t+r:-1,m.beginPropertyChanges(this);for(i in s)s.hasOwnProperty(i)&&(a>0&&f(e,i,this,t,a),m.propertyWillChange(this,i));m.propertyWillChange(this._content,"@each"),m.endPropertyChanges(this)},arrayDidChange:function(e,t,r,n){var i,a=this._keys;i=n>0?t+n:-1,m.changeProperties(function(){for(var r in a)a.hasOwnProperty(r)&&(i>0&&d(e,r,this,t,i),m.propertyDidChange(this,r));m.propertyDidChange(this._content,"@each")},this)},didAddListener:function(e){v.test(e)&&this.beginObservingContentKey(e.slice(0,-7))},didRemoveListener:function(e){v.test(e)&&this.stopObservingContentKey(e.slice(0,-7))},beginObservingContentKey:function(e){var t=this._keys;if(t||(t=this._keys={}),t[e])t[e]++;else{t[e]=1;var n=this._content,i=r.get(n,"length");d(n,e,this,0,i)}},stopObservingContentKey:function(e){var t=this._keys;if(t&&t[e]>0&&--t[e]<=0){var n=this._content,i=r.get(n,"length");f(n,e,this,0,i)}},contentKeyWillChange:function(e,t){m.propertyWillChange(this,t)},contentKeyDidChange:function(e,t){m.propertyDidChange(this,t)}});e.EachArray=p,e.EachProxy=g}),e("ember-runtime/system/lazy_load",["exports","ember-metal/core","ember-metal/array","ember-runtime/system/native_array"],function(e,t,r){"use strict";function n(e,r){var n;a[e]=a[e]||t["default"].A(),a[e].pushObject(r),(n=s[e])&&r(n)}function i(e,t){if(s[e]=t,"object"==typeof window&&"function"==typeof window.dispatchEvent&&"function"==typeof CustomEvent){var n=new CustomEvent(e,{detail:t,name:e});window.dispatchEvent(n)}a[e]&&r.forEach.call(a[e],function(e){e(t)})}e.onLoad=n,e.runLoadHooks=i;var a=t["default"].ENV.EMBER_LOAD_HOOKS||{},s={}}),e("ember-runtime/system/namespace",["exports","ember-metal/core","ember-metal/property_get","ember-metal/array","ember-metal/utils","ember-metal/mixin","ember-runtime/system/object"],function(e,t,r,n,i,a,s){"use strict";function o(e,t,r){var n=e.length;p[e.join(".")]=t;for(var a in t)if(v.call(t,a)){var s=t[a];if(e[n]=a,s&&s.toString===h)s.toString=d(e.join(".")),s[b]=e.join(".");else if(s&&s.isNamespace){if(r[i.guidFor(s)])continue;r[i.guidFor(s)]=!0,o(e,s,r)}}e.length=n}function u(e,t){try{var r=e[t];return r&&r.isNamespace&&r}catch(n){}}function l(){var e,r=t["default"].lookup;if(!f.PROCESSED)for(var n in r)g.test(n)&&(!r.hasOwnProperty||r.hasOwnProperty(n))&&(e=u(r,n),e&&(e[b]=n))}function c(e){var t=e.superclass;return t?t[b]?t[b]:c(t):void 0}function h(){t["default"].BOOTED||this[b]||m();var e;if(this[b])e=this[b];else if(this._toString)e=this._toString;else{var r=c(this);e=r?"(subclass of "+r+")":"(unknown mixin)",this.toString=d(e)}return e}function m(){var e=!f.PROCESSED,r=t["default"].anyUnprocessedMixins;if(e&&(l(),f.PROCESSED=!0),e||r){for(var n,i=f.NAMESPACES,a=0,s=i.length;s>a;a++)n=i[a],o([n.toString()],n,{});t["default"].anyUnprocessedMixins=!1}}function d(e){return function(){return e}}var f=s["default"].extend({isNamespace:!0,init:function(){f.NAMESPACES.push(this),f.PROCESSED=!1},toString:function(){var e=r.get(this,"name")||r.get(this,"modulePrefix");return e?e:(l(),this[b])},nameClasses:function(){o([this.toString()],this,{})},destroy:function(){var e=f.NAMESPACES,r=this.toString();r&&(t["default"].lookup[r]=void 0,delete f.NAMESPACES_BY_ID[r]),e.splice(n.indexOf.call(e,this),1),this._super.apply(this,arguments)}});f.reopenClass({NAMESPACES:[t["default"]],NAMESPACES_BY_ID:{},PROCESSED:!1,processAll:m,byName:function(e){return t["default"].BOOTED||m(),p[e]}});var p=f.NAMESPACES_BY_ID,v={}.hasOwnProperty,g=/^[A-Z]/,b=t["default"].NAME_KEY=i.GUID_KEY+"_name";a.Mixin.prototype.toString=h,e["default"]=f}),e("ember-runtime/system/native_array",["exports","ember-metal/core","ember-metal/property_get","ember-metal/enumerable_utils","ember-metal/mixin","ember-metal/array","ember-runtime/mixins/array","ember-runtime/mixins/mutable_array","ember-runtime/mixins/observable","ember-runtime/mixins/copyable","ember-runtime/mixins/freezable","ember-runtime/copy"],function(e,t,r,n,i,a,s,o,u,l,c,h){"use strict";var m=i.Mixin.create(o["default"],u["default"],l["default"],{get:function(e){return"length"===e?this.length:"number"==typeof e?this[e]:this._super(e)},objectAt:function(e){return this[e]},replace:function(e,t,i){if(this.isFrozen)throw c.FROZEN_ERROR;var a=i?r.get(i,"length"):0;return this.arrayContentWillChange(e,t,a),0===a?this.splice(e,t):n._replace(this,e,t,i),this.arrayContentDidChange(e,t,a),this},unknownProperty:function(e,t){var r;return void 0!==t&&void 0===r&&(r=this[e]=t),r},indexOf:a.indexOf,lastIndexOf:a.lastIndexOf,copy:function(e){return e?this.map(function(e){return h["default"](e,!0)}):this.slice()}}),d=["length"];n.forEach(m.keys(),function(e){Array.prototype[e]&&d.push(e)}),m=m.without.apply(m,d);var f=function(e){return void 0===e&&(e=[]),s["default"].detect(e)?e:m.apply(e)};m.activate=function(){m.apply(Array.prototype),f=function(e){return e||[]}},(t["default"].EXTEND_PROTOTYPES===!0||t["default"].EXTEND_PROTOTYPES.Array)&&m.activate(),t["default"].A=f,e["default"]=m,e.A=f,e.NativeArray=m}),e("ember-runtime/system/object",["exports","ember-runtime/system/core_object","ember-runtime/mixins/observable"],function(e,t,r){"use strict";var n=t["default"].extend(r["default"]);n.toString=function(){return"Ember.Object"},e["default"]=n}),e("ember-runtime/system/object_proxy",["exports","ember-runtime/system/object","ember-runtime/mixins/-proxy"],function(e,t,r){"use strict";e["default"]=t["default"].extend(r["default"])}),e("ember-runtime/system/service",["exports","ember-runtime/system/object","ember-runtime/inject"],function(e,t,r){"use strict";r.createInjectionHelper("service"),e["default"]=t["default"].extend()}),e("ember-runtime/system/set",["exports","ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/utils","ember-metal/is_none","ember-runtime/system/string","ember-runtime/system/core_object","ember-runtime/mixins/mutable_enumerable","ember-runtime/mixins/enumerable","ember-runtime/mixins/copyable","ember-runtime/mixins/freezable","ember-metal/error","ember-metal/property_events","ember-metal/mixin","ember-metal/computed"],function(e,t,r,n,i,a,s,o,u,l,c,h,m,d,f,p){"use strict";e["default"]=o["default"].extend(u["default"],c["default"],h.Freezable,{length:0,clear:function(){if(this.isFrozen)throw new m["default"](h.FROZEN_ERROR);var e=r.get(this,"length");if(0===e)return this;var t;this.enumerableContentWillChange(e,0),d.propertyWillChange(this,"firstObject"),d.propertyWillChange(this,"lastObject");for(var a=0;e>a;a++)t=i.guidFor(this[a]),delete this[t],delete this[a];return n.set(this,"length",0),d.propertyDidChange(this,"firstObject"),d.propertyDidChange(this,"lastObject"),this.enumerableContentDidChange(e,0),this},isEqual:function(e){if(!l["default"].detect(e))return!1;var t=r.get(this,"length");if(r.get(e,"length")!==t)return!1;for(;--t>=0;)if(!e.contains(this[t]))return!1;return!0},add:f.aliasMethod("addObject"),remove:f.aliasMethod("removeObject"),pop:function(){if(r.get(this,"isFrozen"))throw new m["default"](h.FROZEN_ERROR);var e=this.length>0?this[this.length-1]:null;return this.remove(e),e},push:f.aliasMethod("addObject"),shift:f.aliasMethod("pop"),unshift:f.aliasMethod("push"),addEach:f.aliasMethod("addObjects"),removeEach:f.aliasMethod("removeObjects"),init:function(e){this._super.apply(this,arguments),e&&this.addObjects(e)},nextObject:function(e){return this[e]},firstObject:p.computed(function(){return this.length>0?this[0]:void 0}),lastObject:p.computed(function(){return this.length>0?this[this.length-1]:void 0}),addObject:function(e){if(r.get(this,"isFrozen"))throw new m["default"](h.FROZEN_ERROR);if(a["default"](e))return this;var t,s=i.guidFor(e),o=this[s],u=r.get(this,"length");return o>=0&&u>o&&this[o]===e?this:(t=[e],this.enumerableContentWillChange(null,t),d.propertyWillChange(this,"lastObject"),u=r.get(this,"length"),this[s]=u,this[u]=e,n.set(this,"length",u+1),d.propertyDidChange(this,"lastObject"),this.enumerableContentDidChange(null,t),this)},removeObject:function(e){if(r.get(this,"isFrozen"))throw new m["default"](h.FROZEN_ERROR);if(a["default"](e))return this;var t,s,o=i.guidFor(e),u=this[o],l=r.get(this,"length"),c=0===u,f=u===l-1;return u>=0&&l>u&&this[u]===e&&(s=[e],this.enumerableContentWillChange(s,null),c&&d.propertyWillChange(this,"firstObject"),f&&d.propertyWillChange(this,"lastObject"),l-1>u&&(t=this[l-1],this[u]=t,this[i.guidFor(t)]=u),delete this[o],delete this[l-1],n.set(this,"length",l-1),c&&d.propertyDidChange(this,"firstObject"),f&&d.propertyDidChange(this,"lastObject"),this.enumerableContentDidChange(s,null)),this},contains:function(e){return this[i.guidFor(e)]>=0},copy:function(){var e=this.constructor,t=new e,a=r.get(this,"length");for(n.set(t,"length",a);--a>=0;)t[a]=this[a],t[i.guidFor(this[a])]=a;return t},toString:function(){var e,t=this.length,r=[];for(e=0;t>e;e++)r[e]=this[e];return s.fmt("Ember.Set<%@>",[r.join(",")])}})}),e("ember-runtime/system/string",["exports","ember-metal/core","ember-metal/utils","ember-metal/cache"],function(e,t,r,n){"use strict";function i(e,t){var n=t;if(!r.isArray(n)||arguments.length>2){n=new Array(arguments.length-1);for(var i=1,a=arguments.length;a>i;i++)n[i-1]=arguments[i]}var s=0;return e.replace(/%@([0-9]+)?/g,function(e,t){return t=t?parseInt(t,10)-1:s++,e=n[t],null===e?"(null)":void 0===e?"":r.inspect(e)})}function a(e,n){return(!r.isArray(n)||arguments.length>2)&&(n=Array.prototype.slice.call(arguments,1)),e=t["default"].STRINGS[e]||e,i(e,n)}function s(e){return e.split(/\s+/)}function o(e){return y.get(e)}function u(e){return f.get(e)}function l(e){return p.get(e)}function c(e){return v.get(e)}function h(e){return g.get(e)}function m(e){return b.get(e)}e.fmt=i,e.loc=a,e.w=s,e.decamelize=o,e.dasherize=u,e.camelize=l,e.classify=c,e.underscore=h,e.capitalize=m;var d=/[ _]/g,f=new n["default"](1e3,function(e){return o(e).replace(d,"-")}),p=new n["default"](1e3,function(e){return e.replace(w,function(e,t,r){return r?r.toUpperCase():""}).replace(/^([A-Z])/,function(e,t,r){return e.toLowerCase()})}),v=new n["default"](1e3,function(e){for(var t=e.split("."),r=[],n=0,i=t.length;i>n;n++){var a=l(t[n]);r.push(a.charAt(0).toUpperCase()+a.substr(1))}return r.join(".")}),g=new n["default"](1e3,function(e){return e.replace(x,"$1_$2").replace(C,"_").toLowerCase()}),b=new n["default"](1e3,function(e){return e.charAt(0).toUpperCase()+e.substr(1)}),y=new n["default"](1e3,function(e){return e.replace(_,"$1_$2").toLowerCase()}),_=/([a-z\d])([A-Z])/g,w=/(\-|_|\.|\s)+(.)?/g,x=/([a-z\d])([A-Z]+)/g,C=/\-|\s+/g;t["default"].STRINGS={},e["default"]={fmt:i,loc:a,w:s,decamelize:o,dasherize:u,camelize:l,classify:c,underscore:h,capitalize:m}}),e("ember-runtime/system/subarray",["exports","ember-metal/error","ember-metal/enumerable_utils"],function(e,t,r){"use strict";function n(e,t){this.type=e,this.count=t}function i(e){arguments.length<1&&(e=0),e>0?this._operations=[new n(a,e)]:this._operations=[]}var a="r",s="f";e["default"]=i,i.prototype={addItem:function(e,t){var r=-1,i=t?a:s,o=this;return this._findOperation(e,function(s,u,l,c,h){var m,d;i===s.type?++s.count:e===l?o._operations.splice(u,0,new n(i,1)):(m=new n(i,1),d=new n(s.type,c-e+1),s.count=e-l,o._operations.splice(u+1,0,m,d)),t&&(r=s.type===a?h+(e-l):h),o._composeAt(u)},function(e){o._operations.push(new n(i,1)),t&&(r=e),o._composeAt(o._operations.length-1)}),r},removeItem:function(e){var r=-1,n=this;return this._findOperation(e,function(t,i,s,o,u){t.type===a&&(r=u+(e-s)),t.count>1?--t.count:(n._operations.splice(i,1),n._composeAt(i))},function(){throw new t["default"]("Can't remove an item that has never been added.")}),r},_findOperation:function(e,t,r){var n,i,s,o,u,l=0;for(n=o=0,i=this._operations.length;i>n;o=u+1,++n){if(s=this._operations[n],u=o+s.count-1,e>=o&&u>=e)return void t(s,n,o,u,l);s.type===a&&(l+=s.count)}r(l)},_composeAt:function(e){var t,r=this._operations[e];r&&(e>0&&(t=this._operations[e-1],t.type===r.type&&(r.count+=t.count,this._operations.splice(e-1,1),--e)),e<this._operations.length-1&&(t=this._operations[e+1],t.type===r.type&&(r.count+=t.count,this._operations.splice(e+1,1))))},toString:function(){var e="";return r["default"].forEach(this._operations,function(t){e+=" "+t.type+":"+t.count}),e.substring(1)}}}),e("ember-runtime/system/tracked_array",["exports","ember-metal/property_get","ember-metal/enumerable_utils"],function(e,t,r){"use strict";function n(e){arguments.length<1&&(e=[]);var r=t.get(e,"length");r?this._operations=[new i(s,r,e)]:this._operations=[]}function i(e,t,r){this.type=e,this.count=t,this.items=r}function a(e,t,r,n){this.operation=e,this.index=t,this.split=r,this.rangeStart=n}var s="r",o="i",u="d";e["default"]=n,n.RETAIN=s,n.INSERT=o,n.DELETE=u,n.prototype={addItems:function(e,r){var n=t.get(r,"length");if(!(1>n)){var a,s,u=this._findArrayOperation(e),l=u.operation,c=u.index,h=u.rangeStart;s=new i(o,n,r),l?u.split?(this._split(c,e-h,s),a=c+1):(this._operations.splice(c,0,s),a=c):(this._operations.push(s),a=c),this._composeInsert(a)}},removeItems:function(e,t){if(!(1>t)){var r,n,a=this._findArrayOperation(e),s=a.index,o=a.rangeStart;return r=new i(u,t),a.split?(this._split(s,e-o,r),n=s+1):(this._operations.splice(s,0,r),n=s),this._composeDelete(n)}},apply:function(e){var t=[],n=0;r.forEach(this._operations,function(r,i){e(r.items,n,r.type,i),r.type!==u&&(n+=r.count,t=t.concat(r.items))}),this._operations=[new i(s,t.length,t)]},_findArrayOperation:function(e){var t,r,n,i,s,o=!1;for(t=n=0,s=this._operations.length;s>t;++t)if(r=this._operations[t],r.type!==u){if(i=n+r.count-1,e===n)break;if(e>n&&i>=e){o=!0;break}n=i+1}return new a(r,t,o,n)},_split:function(e,t,r){var n=this._operations[e],a=n.items.slice(t),s=new i(n.type,a.length,a);n.count=t,n.items=n.items.slice(0,t),this._operations.splice(e+1,0,r,s)},_composeInsert:function(e){var t=this._operations[e],r=this._operations[e-1],n=this._operations[e+1],i=r&&r.type,a=n&&n.type;i===o?(r.count+=t.count,r.items=r.items.concat(t.items),a===o?(r.count+=n.count,r.items=r.items.concat(n.items),this._operations.splice(e,2)):this._operations.splice(e,1)):a===o&&(t.count+=n.count,t.items=t.items.concat(n.items),this._operations.splice(e+1,1))},_composeDelete:function(e){var t,r,n,i=this._operations[e],a=i.count,s=this._operations[e-1],l=s&&s.type,c=!1,h=[];l===u&&(i=s,e-=1);for(var m=e+1;a>0;++m)t=this._operations[m],r=t.type,n=t.count,r!==u?(n>a?(h=h.concat(t.items.splice(0,a)),t.count-=a,m-=1,n=a,a=0):(n===a&&(c=!0),h=h.concat(t.items),a-=n),r===o&&(i.count-=n)):i.count+=n;return i.count>0?this._operations.splice(e+1,m-1-e):this._operations.splice(e,c?2:1),h},toString:function(){var e="";return r.forEach(this._operations,function(t){e+=" "+t.type+":"+t.count}),e.substring(1)}}}),e("ember-template-compiler",["exports","ember-metal/core","ember-template-compiler/system/precompile","ember-template-compiler/system/compile","ember-template-compiler/system/template","ember-template-compiler/plugins","ember-template-compiler/plugins/transform-each-in-to-hash","ember-template-compiler/plugins/transform-with-as-to-hash","ember-template-compiler/compat"],function(e,t,r,n,i,a,s,o){"use strict";a.registerPlugin("ast",o["default"]),a.registerPlugin("ast",s["default"]),e._Ember=t["default"],e.precompile=r["default"],e.compile=n["default"],e.template=i["default"],e.registerPlugin=a.registerPlugin}),e("ember-template-compiler/compat",["ember-metal/core","ember-template-compiler/compat/precompile","ember-template-compiler/system/compile","ember-template-compiler/system/template"],function(e,t,r,n){"use strict";var i=e["default"].Handlebars=e["default"].Handlebars||{};i.precompile=t["default"],i.compile=r["default"],i.template=n["default"]}),e("ember-template-compiler/compat/precompile",["exports","ember-template-compiler/system/compile_options"],function(e,r){"use strict";var n,a;e["default"]=function(e){if((!n||!a)&&i.__loader.registry["htmlbars-compiler/compiler"]){var s=t("htmlbars-compiler/compiler");n=s.compile,a=s.compileSpec}if(!n||!a)throw new Error("Cannot call `precompile` without the template compiler loaded. Please load `ember-template-compiler.js` prior to calling `precompile`.");var o=void 0===arguments[1]?!0:arguments[1],u=o?n:a;return u(e,r["default"]())}}),e("ember-template-compiler/plugins",["exports"],function(e){"use strict";function t(e,t){if(!r[e])throw new Error('Attempting to register "'+t+'" as "'+e+'" which is not a valid HTMLBars plugin type.');r[e].push(t)}e.registerPlugin=t;var r={ast:[]};e["default"]=r}),e("ember-template-compiler/plugins/transform-each-in-to-hash",["exports"],function(e){"use strict";function t(){this.syntax=null}t.prototype.transform=function(e){var t=this,r=new t.syntax.Walker,n=t.syntax.builders;return r.visit(e,function(e){if(t.validate(e)){if(e.program&&e.program.blockParams.length)throw new Error("You cannot use keyword (`{{each foo in bar}}`) and block params (`{{each bar as |foo|}}`) at the same time.");var r=e.sexpr.params.splice(0,2),i=r[0].original;e.sexpr.hash||(e.sexpr.hash=n.hash()),e.sexpr.hash.pairs.push(n.pair("keyword",n.string(i)))}}),e},t.prototype.validate=function(e){return("BlockStatement"===e.type||"MustacheStatement"===e.type)&&"each"===e.sexpr.path.original&&3===e.sexpr.params.length&&"PathExpression"===e.sexpr.params[1].type&&"in"===e.sexpr.params[1].original},e["default"]=t}),e("ember-template-compiler/plugins/transform-with-as-to-hash",["exports"],function(e){"use strict";function t(){this.syntax=null}t.prototype.transform=function(e){var t=this,r=new t.syntax.Walker;return r.visit(e,function(e){if(t.validate(e)){if(e.program&&e.program.blockParams.length)throw new Error("You cannot use keyword (`{{with foo as bar}}`) and block params (`{{with foo as |bar|}}`) at the same time.");var r=e.sexpr.params.splice(1,2),n=r[1].original;e.program.blockParams=[n]}}),e},t.prototype.validate=function(e){return"BlockStatement"===e.type&&"with"===e.sexpr.path.original&&3===e.sexpr.params.length&&"PathExpression"===e.sexpr.params[1].type&&"as"===e.sexpr.params[1].original},e["default"]=t}),e("ember-template-compiler/system/compile",["exports","ember-template-compiler/system/compile_options","ember-template-compiler/system/template"],function(e,r,n){"use strict";var a;e["default"]=function(e){if(!a&&i.__loader.registry["htmlbars-compiler/compiler"]&&(a=t("htmlbars-compiler/compiler").compile),!a)throw new Error("Cannot call `compile` without the template compiler loaded. Please load `ember-template-compiler.js` prior to calling `compile`.");var s=a(e,r["default"]());return n["default"](s)}}),e("ember-template-compiler/system/compile_options",["exports","ember-metal/core","ember-template-compiler/plugins"],function(e,t,r){"use strict";e["default"]=function(){var e=!0;return{revision:"Ember@1.11.3",disableComponentGeneration:e,plugins:r["default"]}}}),e("ember-template-compiler/system/precompile",["exports","ember-template-compiler/system/compile_options"],function(e,r){"use strict";var n;e["default"]=function(e){if(!n&&i.__loader.registry["htmlbars-compiler/compiler"]&&(n=t("htmlbars-compiler/compiler").compileSpec),!n)throw new Error("Cannot call `compileSpec` without the template compiler loaded. Please load `ember-template-compiler.js` prior to calling `compileSpec`.");return n(e,r["default"]())}}),e("ember-template-compiler/system/template",["exports"],function(e){"use strict";e["default"]=function(e){return e.isTop=!0,e.isMethod=!1,e}}),e("ember-views",["exports","ember-runtime","ember-views/system/jquery","ember-views/system/utils","ember-views/system/render_buffer","ember-views/system/renderer","dom-helper","ember-views/system/ext","ember-views/views/states","ember-views/views/core_view","ember-views/views/view","ember-views/views/container_view","ember-views/views/collection_view","ember-views/views/component","ember-views/system/event_dispatcher","ember-views/mixins/view_target_action_support","ember-views/component_lookup","ember-views/views/checkbox","ember-views/mixins/text_support","ember-views/views/text_field","ember-views/views/text_area","ember-views/views/simple_bound_view","ember-views/views/metamorph_view","ember-views/views/select"],function(e,t,r,n,i,a,s,o,u,l,c,h,m,d,f,p,v,g,b,y,_,w,x,C){"use strict";t["default"].$=r["default"],t["default"].ViewTargetActionSupport=p["default"],t["default"].RenderBuffer=i["default"];var E=t["default"].ViewUtils={};E.isSimpleClick=n.isSimpleClick,E.getViewClientRects=n.getViewClientRects,E.getViewBoundingClientRect=n.getViewBoundingClientRect,t["default"].CoreView=l["default"],t["default"].View=c["default"],t["default"].View.states=u.states,t["default"].View.cloneStates=u.cloneStates,t["default"].View.DOMHelper=s["default"],t["default"].View._Renderer=a["default"],t["default"].Checkbox=g["default"],t["default"].TextField=y["default"],t["default"].TextArea=_["default"],t["default"]._SimpleBoundView=w["default"],t["default"]._MetamorphView=x["default"],t["default"]._Metamorph=x._Metamorph,t["default"].Select=C.Select,t["default"].SelectOption=C.SelectOption,t["default"].SelectOptgroup=C.SelectOptgroup,t["default"].TextSupport=b["default"],t["default"].ComponentLookup=v["default"],t["default"].ContainerView=h["default"],t["default"].CollectionView=m["default"],t["default"].Component=d["default"],t["default"].EventDispatcher=f["default"],
e["default"]=t["default"]}),e("ember-views/attr_nodes/attr_node",["exports","ember-metal/core","ember-metal/streams/utils","ember-metal/run_loop"],function(e,t,r,n){"use strict";function i(e,t){this.init(e,t)}var a="Binding style attributes may introduce cross-site scripting vulnerabilities; please ensure that values being bound are properly escaped. For more information, including how to disable this warning, see http://emberjs.com/deprecations/v1.x/#toc_warning-when-binding-style-attributes.";i.prototype.init=function(e,t){this.isAttrNode=!0,this.isView=!0,this.tagName="",this.isVirtual=!0,this.attrName=e,this.attrValue=t,this.isDirty=!0,this.isDestroying=!1,this.lastValue=null,this.hasRenderedInitially=!1,r.subscribe(this.attrValue,this.rerender,this)},i.prototype.renderIfDirty=function(){if(this.isDirty&&!this.isDestroying){var e=r.read(this.attrValue);e!==this.lastValue?this._renderer.renderTree(this,this._parentView):this.isDirty=!1}},i.prototype.render=function(e){if(this.isDirty=!1,!this.isDestroying){var t=r.read(this.attrValue);return"value"!==this.attrName||null!==t&&void 0!==t||(t=""),void 0===t&&(t=null),this.hasRenderedInitially&&"value"===this.attrName&&this._morph.element.value===t?void(this.lastValue=t):void((null!==this.lastValue||null!==t)&&(this._deprecateEscapedStyle(t),this._morph.setContent(t),this.lastValue=t,this.hasRenderedInitially=!0))}},i.prototype._deprecateEscapedStyle=function(e){},i.prototype.rerender=function(){this.isDirty=!0,n["default"].schedule("render",this,this.renderIfDirty)},i.prototype.destroy=function(){this.isDestroying=!0,this.isDirty=!1,r.unsubscribe(this.attrValue,this.rerender,this),!this.removedFromDOM&&this._renderer&&this._renderer.remove(this,!0)},i.prototype.propertyDidChange=function(){},i.prototype._notifyBecameHidden=function(){},i.prototype._notifyBecameVisible=function(){},e["default"]=i,e.styleWarning=a}),e("ember-views/attr_nodes/legacy_bind",["exports","./attr_node","ember-runtime/system/string","ember-metal/utils","ember-metal/streams/utils","ember-metal/platform/create"],function(e,t,r,n,i,a){"use strict";function s(e,t){this.init(e,t)}s.prototype=a["default"](t["default"].prototype),s.prototype.render=function(e){if(this.isDirty=!1,!this.isDestroying){var t=i.read(this.attrValue);void 0===t&&(t=null),"value"!==this.attrName&&"src"!==this.attrName||null!==t||(t=""),(null!==this.lastValue||null!==t)&&(this._deprecateEscapedStyle(t),this._morph.setContent(t),this.lastValue=t)}},e["default"]=s}),e("ember-views/component_lookup",["exports","ember-runtime/system/object"],function(e,t){"use strict";e["default"]=t["default"].extend({lookupFactory:function(e,t){t=t||this.container;var r="component:"+e,n="template:components/"+e,a=t&&t._registry.has(n);a&&t._registry.injection(r,"layout",n);var s=t.lookupFactory(r);return a||s?(s||(t._registry.register(r,i.Component),s=t.lookupFactory(r)),s):void 0}})}),e("ember-views/mixins/attribute_bindings_support",["exports","ember-metal/mixin","ember-views/attr_nodes/attr_node","ember-metal/properties","ember-views/system/platform","ember-metal/streams/utils","ember-metal/property_set"],function(e,t,r,n,i,a,s){"use strict";var o=[],u=t.Mixin.create({concatenatedProperties:["attributeBindings"],attributeBindings:o,_attrNodes:o,_unspecifiedAttributeBindings:null,_applyAttributeBindings:function(e){var t=this.attributeBindings;if(t&&t.length){var n,s,o,u,l,c,h,m,d=this._unspecifiedAttributeBindings=this._unspecifiedAttributeBindings||{};for(h=0,m=t.length;m>h;h++)n=t[h],s=n.indexOf(":"),-1===s?(o=n,u=n):(o=n.substring(0,s),u=n.substring(s+1)),o in this?(c=this.getStream("view."+o),l=new r["default"](u,c),this.appendAttr(l),i.canSetNameOnInputs||"name"!==u||e.attr("name",a.read(c))):d[o]=u;this.setUnknownProperty=this._setUnknownProperty}},setUnknownProperty:null,_setUnknownProperty:function(e,t){var i=this._unspecifiedAttributeBindings&&this._unspecifiedAttributeBindings[e];if(n.defineProperty(this,e),i){var a=this.getStream("view."+e),o=new r["default"](i,a);this.appendAttr(o)}return s.set(this,e,t)}});e["default"]=u}),e("ember-views/mixins/class_names_support",["exports","ember-metal/core","ember-metal/mixin","ember-runtime/system/native_array","ember-metal/enumerable_utils","ember-metal/streams/utils","ember-views/streams/class_name_binding","ember-metal/utils"],function(e,t,r,n,i,a,s,o){"use strict";var u=[],l=r.Mixin.create({concatenatedProperties:["classNames","classNameBindings"],init:function(){this._super.apply(this,arguments),this.classNameBindings=n.A(this.classNameBindings.slice()),this.classNames=n.A(this.classNames.slice())},classNames:["ember-view"],classNameBindings:u,_applyClassNameBindings:function(){var e=this.classNameBindings;if(e&&e.length){var t,r,n,o=this.classNames;i.forEach(e,function(e){var u;u=a.isStream(e)?e:s.streamifyClassNameBinding(this,e,"_view.");var l,c=this._wrapAsScheduled(function(){t=this.$(),r=a.read(u),l&&(t.removeClass(l),o.removeObject(l)),r?(t.addClass(r),l=r):l=null});n=a.read(u),n&&(i.addObject(o,n),l=n),a.subscribe(u,c,this),this.one("willClearRender",function(){l&&(o.removeObject(l),l=null)})},this)}}});e["default"]=l}),e("ember-views/mixins/component_template_deprecation",["exports","ember-metal/core","ember-metal/property_get","ember-metal/mixin"],function(e,t,r,n){"use strict";e["default"]=n.Mixin.create({willMergeMixin:function(e){this._super.apply(this,arguments);var t,n,i=e.layoutName||e.layout||r.get(this,"layoutName");e.templateName&&!i&&(t="templateName",n="layoutName",e.layoutName=e.templateName,delete e.templateName),e.template&&!i&&(t="template",n="layout",e.layout=e.template,delete e.template)}})}),e("ember-views/mixins/instrumentation_support",["exports","ember-metal/mixin","ember-metal/computed","ember-metal/property_get"],function(e,t,r,n){"use strict";var i=t.Mixin.create({instrumentDisplay:r.computed(function(){return this.helperName?"{{"+this.helperName+"}}":void 0}),instrumentName:"view",instrumentDetails:function(e){e.template=n.get(this,"templateName"),this._super(e)}});e["default"]=i}),e("ember-views/mixins/legacy_view_support",["exports","ember-metal/core","ember-metal/mixin","ember-metal/property_get"],function(e,t,r,n){"use strict";var i=r.Mixin.create({beforeRender:function(e){},afterRender:function(e){},mutateChildViews:function(e){for(var t,r=this._childViews,n=r.length;--n>=0;)t=r[n],e(this,t,n);return this},removeAllChildren:function(){return this.mutateChildViews(function(e,t){e.removeChild(t)})},destroyAllChildren:function(){return this.mutateChildViews(function(e,t){t.destroy()})},nearestChildOf:function(e){for(var t=n.get(this,"parentView");t;){if(n.get(t,"parentView")instanceof e)return t;t=n.get(t,"parentView")}},nearestInstanceOf:function(e){for(var t=n.get(this,"parentView");t;){if(t instanceof e)return t;t=n.get(t,"parentView")}}});e["default"]=i}),e("ember-views/mixins/normalized_rerender_if_needed",["exports","ember-metal/property_get","ember-metal/mixin","ember-metal/merge","ember-views/views/states"],function(e,t,r,n,i){"use strict";var a=i.cloneStates(i.states);n["default"](a._default,{rerenderIfNeeded:function(){return this}}),n["default"](a.inDOM,{rerenderIfNeeded:function(e){e.normalizedValue()!==e._lastNormalizedValue&&e.rerender()}}),e["default"]=r.Mixin.create({_states:a,normalizedValue:function(){var e=this.lazyValue.value(),r=t.get(this,"valueNormalizerFunc");return r?r(e):e},rerenderIfNeeded:function(){this.currentState.rerenderIfNeeded(this)}})}),e("ember-views/mixins/template_rendering_support",["exports","ember-metal/mixin","ember-metal/property_get"],function(e,t,n){"use strict";function i(e,t,n){void 0===a&&(a=r("ember-htmlbars/system/render-view")["default"]),a(e,t,n)}var a,s=t.Mixin.create({render:function(e){var t=n.get(this,"layout")||n.get(this,"template");i(this,e,t)}});e["default"]=s}),e("ember-views/mixins/text_support",["exports","ember-metal/property_get","ember-metal/property_set","ember-metal/mixin","ember-runtime/mixins/target_action_support"],function(e,t,r,n,i){"use strict";function a(e,r,n){var i=t.get(r,e),a=t.get(r,"onEvent"),s=t.get(r,"value");(a===e||"keyPress"===a&&"key-press"===e)&&r.sendAction("action",s),r.sendAction(e,s),(i||a===e)&&(t.get(r,"bubbles")||n.stopPropagation())}var s=n.Mixin.create(i["default"],{value:"",attributeBindings:["autocapitalize","autocorrect","autofocus","disabled","form","maxlength","placeholder","readonly","required","selectionDirection","spellcheck","tabindex","title"],placeholder:null,disabled:!1,maxlength:null,init:function(){this._super.apply(this,arguments),this.on("paste",this,this._elementValueDidChange),this.on("cut",this,this._elementValueDidChange),this.on("input",this,this._elementValueDidChange)},action:null,onEvent:"enter",bubbles:!1,interpretKeyEvents:function(e){var t=s.KEY_EVENTS,r=t[e.keyCode];return this._elementValueDidChange(),r?this[r](e):void 0},_elementValueDidChange:function(){r.set(this,"value",this.$().val())},change:function(e){this._elementValueDidChange(e)},insertNewline:function(e){a("enter",this,e),a("insert-newline",this,e)},cancel:function(e){a("escape-press",this,e)},focusIn:function(e){a("focus-in",this,e)},focusOut:function(e){this._elementValueDidChange(e),a("focus-out",this,e)},keyPress:function(e){a("key-press",this,e)},keyUp:function(e){this.interpretKeyEvents(e),this.sendAction("key-up",t.get(this,"value"),e)},keyDown:function(e){this.sendAction("key-down",t.get(this,"value"),e)}});s.KEY_EVENTS={13:"insertNewline",27:"cancel"},e["default"]=s}),e("ember-views/mixins/view_child_views_support",["exports","ember-metal/core","ember-metal/mixin","ember-metal/computed","ember-metal/property_get","ember-metal/property_set","ember-metal/set_properties","ember-metal/error","ember-metal/enumerable_utils","ember-runtime/system/native_array"],function(e,t,r,n,i,a,s,o,u,l){"use strict";var c=n.computed(function(){var e=this._childViews,t=l.A();return u.forEach(e,function(e){var r;e.isVirtual?(r=i.get(e,"childViews"))&&t.pushObjects(r):t.push(e)}),t.replace=function(e,t,r){throw new o["default"]("childViews is immutable")},t}),h=[],m=r.Mixin.create({childViews:c,_childViews:h,init:function(){this._childViews=this._childViews.slice(),this._super.apply(this,arguments)},appendChild:function(e,t){return this.currentState.appendChild(this,e,t)},removeChild:function(e){if(!this.isDestroying){a.set(e,"_parentView",null);var t=this._childViews;return u.removeObject(t,e),this.propertyDidChange("childViews"),this}},createChildView:function(e,t){if(!e)throw new TypeError("createChildViews first argument must exist");if(e.isView&&e._parentView===this&&e.container===this.container)return e;var r,n=t||{};if(n._parentView=this,n.renderer=this.renderer,e.isViewClass)n.container=this.container,r=e.create(n),r.viewName&&a.set(i.get(this,"concreteView"),r.viewName,r);else if("string"==typeof e){var o="view:"+e,u=this.container.lookupFactory(o);r=u.create(n)}else r=e,n.container=this.container,s["default"](r,n);return r}});e["default"]=m,e.childViewsProperty=c}),e("ember-views/mixins/view_context_support",["exports","ember-metal/mixin","ember-metal/computed","ember-metal/property_get","ember-metal/property_set"],function(e,t,r,n,i){"use strict";var a=t.Mixin.create({context:r.computed(function(e,t){return 2===arguments.length?(i.set(this,"_context",t),t):n.get(this,"_context")})["volatile"](),_context:r.computed(function(e,t){if(2===arguments.length)return t;var r,i;return(i=n.get(this,"controller"))?i:(r=this._parentView,r?n.get(r,"_context"):null)}),_controller:null,controller:r.computed(function(e,t){if(2===arguments.length)return this._controller=t,t;if(this._controller)return this._controller;var r=this._parentView;return r?n.get(r,"controller"):null})});e["default"]=a}),e("ember-views/mixins/view_keyword_support",["exports","ember-metal/mixin","ember-metal/platform/create","ember-views/streams/key_stream"],function(e,t,r,n){"use strict";var i=t.Mixin.create({init:function(){this._super.apply(this,arguments),this._keywords||(this._keywords=r["default"](null)),this._keywords._view=this,this._keywords.view=void 0,this._keywords.controller=new n["default"](this,"controller"),this._setupKeywords()},_setupKeywords:function(){var e=this._keywords,t=this._contextView||this._parentView;if(t){var r=t._keywords;e.view=this.isVirtual?r.view:this;for(var n in r)e[n]||(e[n]=r[n])}else e.view=this.isVirtual?null:this}});e["default"]=i}),e("ember-views/mixins/view_state_support",["exports","ember-metal/core","ember-metal/mixin"],function(e,t,r){"use strict";var n=r.Mixin.create({transitionTo:function(e,t){this._transitionTo(e,t)},_transitionTo:function(e,t){var r=this.currentState,n=this.currentState=this._states[e];this._state=e,r&&r.exit&&r.exit(this),n.enter&&n.enter(this)}});e["default"]=n}),e("ember-views/mixins/view_stream_support",["exports","ember-metal/mixin","ember-metal/streams/stream_binding","ember-views/streams/key_stream","ember-views/streams/context_stream","ember-metal/platform/create","ember-metal/streams/utils"],function(e,t,r,n,i,a,s){"use strict";var o=t.Mixin.create({init:function(){this._baseContext=void 0,this._contextStream=void 0,this._streamBindings=void 0,this._super.apply(this,arguments)},getStream:function(e){var t=this._getContextStream().get(e);return t._label=e,t},_willDestroyElement:function(){this._streamBindings&&this._destroyStreamBindings(),this._contextStream&&this._destroyContextStream()},_getBindingForStream:function(e){void 0===this._streamBindings&&(this._streamBindings=a["default"](null));var t=e;if(s.isStream(e)&&(t=e._label,!t))return e;if(void 0!==this._streamBindings[t])return this._streamBindings[t];var n=this._getContextStream().get(t),i=new r["default"](n);return i._label=t,this._streamBindings[t]=i},_destroyStreamBindings:function(){var e=this._streamBindings;for(var t in e)e[t].destroy();this._streamBindings=void 0},_getContextStream:function(){return void 0===this._contextStream&&(this._baseContext=new n["default"](this,"context"),this._contextStream=new i["default"](this)),this._contextStream},_destroyContextStream:function(){this._baseContext.destroy(),this._baseContext=void 0,this._contextStream.destroy(),this._contextStream=void 0},_unsubscribeFromStreamBindings:function(){for(var e in this._streamBindingSubscriptions){var t=this[e+"Binding"],r=this._streamBindingSubscriptions[e];t.unsubscribe(r)}}});e["default"]=o}),e("ember-views/mixins/view_target_action_support",["exports","ember-metal/mixin","ember-runtime/mixins/target_action_support","ember-metal/alias"],function(e,t,r,n){"use strict";e["default"]=t.Mixin.create(r["default"],{target:n["default"]("controller"),actionContext:n["default"]("context")})}),e("ember-views/mixins/visibility_support",["exports","ember-metal/mixin","ember-metal/property_get","ember-metal/run_loop"],function(e,t,r,n){"use strict";function i(){return this}var a=t.Mixin.create({isVisible:!0,becameVisible:i,becameHidden:i,_isVisibleDidChange:t.observer("isVisible",function(){this._isVisible!==r.get(this,"isVisible")&&n["default"].scheduleOnce("render",this,this._toggleVisibility)}),_toggleVisibility:function(){var e=this.$(),t=r.get(this,"isVisible");this._isVisible!==t&&(this._isVisible=t,e&&(e.toggle(t),this._isAncestorHidden()||(t?this._notifyBecameVisible():this._notifyBecameHidden())))},_notifyBecameVisible:function(){this.trigger("becameVisible"),this.forEachChildView(function(e){var t=r.get(e,"isVisible");(t||null===t)&&e._notifyBecameVisible()})},_notifyBecameHidden:function(){this.trigger("becameHidden"),this.forEachChildView(function(e){var t=r.get(e,"isVisible");(t||null===t)&&e._notifyBecameHidden()})},_isAncestorHidden:function(){for(var e=r.get(this,"parentView");e;){if(r.get(e,"isVisible")===!1)return!0;e=r.get(e,"parentView")}return!1}});e["default"]=a}),e("ember-views/streams/class_name_binding",["exports","ember-metal/streams/utils","ember-metal/property_get","ember-runtime/system/string","ember-metal/utils"],function(e,t,r,n,i){"use strict";function a(e){var t,r,n=e.split(":"),i=n[0],a="";return n.length>1&&(t=n[1],3===n.length&&(r=n[2]),a=":"+t,r&&(a+=":"+r)),{path:i,classNames:a,className:""===t?void 0:t,falsyClassName:r}}function s(e,t,a,s){if(i.isArray(t)&&(t=0!==r.get(t,"length")),a||s)return a&&t?a:s&&!t?s:null;if(t===!0){var o=e.split(".");return n.dasherize(o[o.length-1])}return t!==!1&&null!=t?t:null}function o(e,r,n){n=n||"";var i=a(r);if(""===i.path)return s(i.path,!0,i.className,i.falsyClassName);var o=e.getStream(n+i.path);return t.chain(o,function(){return s(i.path,t.read(o),i.className,i.falsyClassName)})}e.parsePropertyPath=a,e.classStringForValue=s,e.streamifyClassNameBinding=o}),e("ember-views/streams/context_stream",["exports","ember-metal/core","ember-metal/merge","ember-metal/platform/create","ember-metal/path_cache","ember-metal/streams/stream","ember-metal/streams/simple"],function(e,t,r,n,i,a,s){"use strict";function o(e){this.init(),this.view=e}o.prototype=n["default"](a["default"].prototype),r["default"](o.prototype,{value:function(){},_makeChildStream:function(e,r){var n;return""===e||"this"===e?n=this.view._baseContext:i.isGlobal(e)&&t["default"].lookup[e]?(n=new s["default"](t["default"].lookup[e]),n._isGlobal=!0):n=new s["default"](e in this.view._keywords?this.view._keywords[e]:this.view._baseContext.get(e)),n._isRoot=!0,"controller"===e&&(n._isController=!0),n}}),e["default"]=o}),e("ember-views/streams/key_stream",["exports","ember-metal/core","ember-metal/merge","ember-metal/platform/create","ember-metal/property_get","ember-metal/property_set","ember-metal/observer","ember-metal/streams/stream","ember-metal/streams/utils"],function(e,t,r,n,i,a,s,o,u){"use strict";function l(e,t){this.init(),this.source=e,this.obj=void 0,this.key=t,u.isStream(e)&&e.subscribe(this._didChange,this)}l.prototype=n["default"](o["default"].prototype),r["default"](l.prototype,{valueFn:function(){var e=this.obj,t=u.read(this.source);return t!==e&&(e&&"object"==typeof e&&s.removeObserver(e,this.key,this,this._didChange),t&&"object"==typeof t&&s.addObserver(t,this.key,this,this._didChange),this.obj=t),t?i.get(t,this.key):void 0},setValue:function(e){this.obj&&a.set(this.obj,this.key,e)},setSource:function(e){var t=this.source;e!==t&&(u.isStream(t)&&t.unsubscribe(this._didChange,this),u.isStream(e)&&e.subscribe(this._didChange,this),this.source=e,this.notify())},_didChange:function(){this.notify()},_super$destroy:o["default"].prototype.destroy,destroy:function(){return this._super$destroy()?(u.isStream(this.source)&&this.source.unsubscribe(this._didChange,this),this.obj&&"object"==typeof this.obj&&s.removeObserver(this.obj,this.key,this,this._didChange),this.source=void 0,this.obj=void 0,!0):void 0}}),e["default"]=l,o["default"].prototype._makeChildStream=function(e){return new l(this,e)}}),e("ember-views/streams/should_display",["exports","ember-metal/streams/stream","ember-metal/streams/utils","ember-metal/platform/create","ember-metal/property_get","ember-metal/utils"],function(e,t,r,n,i,a){"use strict";function s(e){if(r.isStream(e))return new o(e);var t=e&&i.get(e,"isTruthy");return"boolean"==typeof t?t:a.isArray(e)?0!==i.get(e,"length"):!!e}function o(e){this.init(),this.oldPredicate=void 0,this.predicateStream=e,this.isTruthyStream=e.get("isTruthy"),this.lengthStream=void 0,r.subscribe(this.predicateStream,this.notify,this),r.subscribe(this.isTruthyStream,this.notify,this)}e["default"]=s,o.prototype=n["default"](t["default"].prototype),o.prototype.valueFn=function(){var e=this.oldPredicate,t=r.read(this.predicateStream),n=a.isArray(t);t!==e&&(this.lengthStream&&!n&&(r.unsubscribe(this.lengthStream,this.notify,this),this.lengthStream=void 0),!this.lengthStream&&n&&(this.lengthStream=this.predicateStream.get("length"),r.subscribe(this.lengthStream,this.notify,this)),this.oldPredicate=t);var i=r.read(this.isTruthyStream);if("boolean"==typeof i)return i;if(this.lengthStream){var s=r.read(this.lengthStream);return 0!==s}return!!t}}),e("ember-views/streams/utils",["exports","ember-metal/core","ember-metal/property_get","ember-metal/path_cache","ember-runtime/system/string","ember-metal/streams/utils","ember-views/views/view","ember-runtime/mixins/controller"],function(e,t,r,n,i,a,s,o){"use strict";function u(e,t){var i,s=a.read(e);return i="string"==typeof s?n.isGlobal(s)?r.get(null,s):t.lookupFactory("view:"+s):s}function l(e,t){var r=a.read(e),n=t.lookup("component-lookup:main");return n.lookupFactory(r,t)}function c(e){if(a.isStream(e)){var t=e.value();if(!e._isController)for(;o["default"].detect(t);)t=r.get(t,"model");return t}return e}e.readViewFactory=u,e.readComponentFactory=l,e.readUnwrappedModel=c}),e("ember-views/system/action_manager",["exports"],function(e){"use strict";function t(){}t.registeredActions={},e["default"]=t}),e("ember-views/system/event_dispatcher",["exports","ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/is_none","ember-metal/run_loop","ember-metal/utils","ember-runtime/system/string","ember-runtime/system/object","ember-views/system/jquery","ember-views/system/action_manager","ember-views/views/view","ember-metal/merge"],function(e,t,r,n,i,a,s,o,u,l,c,h,m){"use strict";e["default"]=u["default"].extend({events:{touchstart:"touchStart",touchmove:"touchMove",touchend:"touchEnd",touchcancel:"touchCancel",keydown:"keyDown",keyup:"keyUp",keypress:"keyPress",mousedown:"mouseDown",mouseup:"mouseUp",contextmenu:"contextMenu",click:"click",dblclick:"doubleClick",mousemove:"mouseMove",focusin:"focusIn",focusout:"focusOut",mouseenter:"mouseEnter",mouseleave:"mouseLeave",submit:"submit",input:"input",change:"change",dragstart:"dragStart",drag:"drag",dragenter:"dragEnter",dragleave:"dragLeave",dragover:"dragOver",drop:"drop",dragend:"dragEnd"},rootElement:"body",canDispatchToEventManager:!0,setup:function(e,t){var a,s=r.get(this,"events");m["default"](s,e||{}),i["default"](t)||n.set(this,"rootElement",t),t=l["default"](r.get(this,"rootElement")),t.addClass("ember-application");for(a in s)s.hasOwnProperty(a)&&this.setupHandler(t,a,s[a])},setupHandler:function(e,t,r){var n=this;e.on(t+".ember",".ember-view",function(e,t){var i=h["default"].views[this.id],a=!0,s=n.canDispatchToEventManager?n._findNearestEventManager(i,r):null;return s&&s!==t?a=n._dispatchEvent(s,e,r,i):i&&(a=n._bubbleEvent(i,e,r)),a}),e.on(t+".ember","[data-ember-action]",function(e){var t=l["default"](e.currentTarget).attr("data-ember-action"),n=c["default"].registeredActions[t];return n&&n.eventName===r?n.handler(e):void 0})},_findNearestEventManager:function(e,t){for(var n=null;e&&(n=r.get(e,"eventManager"),!n||!n[t]);)e=r.get(e,"parentView");return n},_dispatchEvent:function(e,t,r,n){var i=!0,o=e[r];return"function"===s.typeOf(o)?(i=a["default"](e,o,t,n),t.stopPropagation()):i=this._bubbleEvent(n,t,r),i},_bubbleEvent:function(e,t,r){return a["default"].join(e,e.handleEvent,r,t)},destroy:function(){var e=r.get(this,"rootElement");return l["default"](e).off(".ember","**").removeClass("ember-application"),this._super.apply(this,arguments)},toString:function(){return"(EventDispatcher)"}})}),e("ember-views/system/ext",["ember-metal/run_loop"],function(e){"use strict";e["default"]._addQueue("render","actions"),e["default"]._addQueue("afterRender","render")}),e("ember-views/system/jquery",["exports","ember-metal/core","ember-metal/enumerable_utils","ember-metal/environment"],function(e,t,n,i){"use strict";var s;if(i["default"].hasDOM&&(s=t["default"].imports&&t["default"].imports.jQuery||a&&a.jQuery,s||"function"!=typeof r||(s=r("jquery")),s)){var o=["dragstart","drag","dragenter","dragleave","dragover","drop","dragend"];n.forEach(o,function(e){s.event.fixHooks[e]={props:["dataTransfer"]}})}e["default"]=s}),e("ember-views/system/lookup_partial",["exports","ember-metal/core"],function(e,t){"use strict";function r(e,t){var r=t.split("/"),n=r[r.length-1];r[r.length-1]="_"+n;var i=r.join("/"),a=e.templateForName(i);return a||(a=e.templateForName(t)),a}e["default"]=r}),e("ember-views/system/platform",["exports","ember-metal/environment"],function(e,t){"use strict";var r=t["default"].hasDOM&&function(){var e=document.createElement("div"),t=document.createElement("input");return t.setAttribute("name","foo"),e.appendChild(t),!!e.innerHTML.match("foo")}();e.canSetNameOnInputs=r}),e("ember-views/system/render_buffer",["exports","ember-views/system/jquery","ember-metal/core","ember-metal/platform/create","dom-helper/prop","ember-views/system/platform"],function(e,t,r,n,i,a){"use strict";function s(e,t,r){if(c=c||{tr:e.createElement("tbody"),col:e.createElement("colgroup")},"TABLE"===r.tagName){var n=h.exec(t);if(n)return c[n[1].toLowerCase()]}}function o(){this.seen=n["default"](null),this.list=[]}function u(e){return e&&m.test(e)?e.replace(d,""):e}function l(e){var t={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},r=function(e){return t[e]||"&amp;"},n=e.toString();return p.test(n)?n.replace(f,r):n}var c,h=/(?:<script)*.*?<([\w:]+)/i;o.prototype={add:function(e){this.seen[e]!==!0&&(this.seen[e]=!0,this.list.push(e))}};var m=/[^a-zA-Z0-9\-]/,d=/[^a-zA-Z0-9\-]/g,f=/&(?!\w+;)|[<>"'`]/g,p=/[&<>"'`]/,v=function(e){this.buffer=null,this.childViews=[],this.attrNodes=[],this.dom=e};v.prototype={reset:function(e,t){this.tagName=e,this.buffer=null,this._element=null,this._outerContextualElement=t,this.elementClasses=null,this.elementId=null,this.elementAttributes=null,this.elementProperties=null,this.elementTag=null,this.elementStyle=null,this.childViews.length=0,this.attrNodes.length=0},_element:null,_outerContextualElement:null,elementClasses:null,classes:null,elementId:null,elementAttributes:null,elementProperties:null,elementTag:null,elementStyle:null,pushChildView:function(e){var t=this.childViews.length;this.childViews[t]=e,this.push("<script id='morph-"+t+"' type='text/x-placeholder'></script>")},pushAttrNode:function(e){var t=this.attrNodes.length;this.attrNodes[t]=e},hydrateMorphs:function(e){for(var t=this.childViews,r=this._element,n=0,i=t.length;i>n;n++){var a=t[n],s=r.querySelector("#morph-"+n),o=s.parentNode;a._morph=this.dom.insertMorphBefore(o,s,1===o.nodeType?o:e),o.removeChild(s)}},push:function(e){return"string"==typeof e?(null===this.buffer&&(this.buffer=""),this.buffer+=e):this.buffer=e,this},addClass:function(e){return this.elementClasses=this.elementClasses||new o,this.elementClasses.add(e),this.classes=this.elementClasses.list,this},setClasses:function(e){this.elementClasses=null;var t,r=e.length;for(t=0;r>t;t++)this.addClass(e[t])},id:function(e){return this.elementId=e,this},attr:function(e,t){var r=this.elementAttributes=this.elementAttributes||{};return 1===arguments.length?r[e]:(r[e]=t,this)},removeAttr:function(e){var t=this.elementAttributes;return t&&delete t[e],this},prop:function(e,t){var r=this.elementProperties=this.elementProperties||{};return 1===arguments.length?r[e]:(r[e]=t,this)},removeProp:function(e){var t=this.elementProperties;return t&&delete t[e],this},style:function(e,t){return this.elementStyle=this.elementStyle||{},this.elementStyle[e]=t,this},generateElement:function(){var e,t,r,n=this.tagName,s=this.elementId,o=this.classes,c=this.elementAttributes,h=this.elementProperties,m=this.elementStyle,d="";r=!a.canSetNameOnInputs&&c&&c.name?"<"+u(n)+' name="'+l(c.name)+'">':n;var f=this.dom.createElement(r,this.outerContextualElement());if(s&&(this.dom.setAttribute(f,"id",s),this.elementId=null),o&&(this.dom.setAttribute(f,"class",o.join(" ")),this.classes=null,this.elementClasses=null),m){for(t in m)d+=t+":"+m[t]+";";this.dom.setAttribute(f,"style",d),this.elementStyle=null}if(c){for(e in c)this.dom.setAttribute(f,e,c[e]);this.elementAttributes=null}if(h){for(t in h){var p=i.normalizeProperty(f,t.toLowerCase())||t;this.dom.setPropertyStrict(f,p,h[t])}this.elementProperties=null}this._element=f},element:function(){if(this._element&&this.attrNodes.length>0){var e,t,r,n;for(e=0,t=this.attrNodes.length;t>e;e++)n=this.attrNodes[e],r=this.dom.createAttrMorph(this._element,n.attrName),n._morph=r}var i=this.innerContent();if(null===i)return this._element;var a=this.innerContextualElement(i);if(this.dom.detectNamespace(a),this._element||(this._element=this.dom.createDocumentFragment()),i.nodeType)this._element.appendChild(i);else{var s=this.dom.parseHTML(i,a);this._element.appendChild(s)}return this.childViews.length>0&&this.hydrateMorphs(a),this._element},string:function(){if(this._element){var e=this.element(),r=e.outerHTML;return"undefined"==typeof r?t["default"]("<div/>").append(e).html():r}return this.innerString()},outerContextualElement:function(){return void 0===this._outerContextualElement&&(this.outerContextualElement=document.body),this._outerContextualElement},innerContextualElement:function(e){var t;t=this._element&&1===this._element.nodeType?this._element:this.outerContextualElement();var r;return e&&(r=s(this.dom,e,t)),r||t},innerString:function(){var e=this.innerContent();return e&&!e.nodeType?e:void 0},innerContent:function(){return this.buffer}},e["default"]=v}),e("ember-views/system/renderer",["exports","ember-metal/core","ember-metal-views/renderer","ember-metal/platform/create","ember-views/system/render_buffer","ember-metal/run_loop","ember-metal/property_get","ember-metal/instrumentation"],function(e,t,r,n,i,a,s,o){"use strict";function u(e,t){this._super$constructor(e,t),this.buffer=new i["default"](e)}u.prototype=n["default"](r["default"].prototype),u.prototype.constructor=u,u.prototype._super$constructor=r["default"],u.prototype.scheduleRender=function(e,t){return a["default"].scheduleOnce("render",e,t)},u.prototype.cancelRender=function(e){a["default"].cancel(e)},u.prototype.createElement=function(e,t){var r=e.tagName;null!==r&&"object"==typeof r&&r.isDescriptor&&(r=s.get(e,"tagName"));{var n=e.classNameBindings;""===r&&n&&n.length>0}(null===r||void 0===r)&&(r="div");var i=e.buffer=this.buffer;i.reset(r,t),e.beforeRender&&e.beforeRender(i),""!==r&&(e.applyAttributesToBuffer&&e.applyAttributesToBuffer(i),i.generateElement()),e.render&&e.render(i),e.afterRender&&e.afterRender(i);var a=i.element();return e.buffer=null,a&&1===a.nodeType&&(e.element=a),a},u.prototype.destroyView=function(e){e.removedFromDOM=!0,e.destroy()},u.prototype.childViews=function(e){return e._attrNodes&&e._childViews?e._attrNodes.concat(e._childViews):e._attrNodes||e._childViews},r["default"].prototype.willCreateElement=function(e){o.subscribers.length&&e.instrumentDetails&&(e._instrumentEnd=o._instrumentStart("render."+e.instrumentName,function(){var t={};return e.instrumentDetails(t),t})),e._transitionTo&&e._transitionTo("inBuffer")},r["default"].prototype.didCreateElement=function(e){e._transitionTo&&e._transitionTo("hasElement"),e._instrumentEnd&&e._instrumentEnd()},r["default"].prototype.willInsertElement=function(e){this._destinedForDOM&&e.trigger&&e.trigger("willInsertElement")},r["default"].prototype.didInsertElement=function(e){e._transitionTo&&e._transitionTo("inDOM"),this._destinedForDOM&&e.trigger&&e.trigger("didInsertElement")},r["default"].prototype.willRemoveElement=function(e){},r["default"].prototype.willDestroyElement=function(e){this._destinedForDOM&&(e._willDestroyElement&&e._willDestroyElement(),e.trigger&&(e.trigger("willDestroyElement"),e.trigger("willClearRender")))},r["default"].prototype.didDestroyElement=function(e){e.element=null,e._transitionTo&&e._transitionTo("preRender")},e["default"]=u}),e("ember-views/system/utils",["exports"],function(e){"use strict";function t(e){var t=e.shiftKey||e.metaKey||e.altKey||e.ctrlKey,r=e.which>1;return!t&&!r}function r(e){var t=document.createRange();return t.setStartBefore(e._morph.firstNode),t.setEndAfter(e._morph.lastNode),t}function n(e){var t=r(e);return t.getClientRects()}function i(e){var t=r(e);return t.getBoundingClientRect()}e.isSimpleClick=t,e.getViewClientRects=n,e.getViewBoundingClientRect=i}),e("ember-views/views/bound_component_view",["exports","ember-views/views/metamorph_view","ember-metal/streams/utils","ember-views/streams/utils","ember-htmlbars/system/merge-view-bindings","ember-metal/error","ember-views/views/container_view"],function(e,t,r,n,i,a,s){
"use strict";e["default"]=s["default"].extend(t._Metamorph,{init:function(){this._super.apply(this,arguments);var e=this._boundComponentOptions.componentNameStream,t=this.container;this.componentClassStream=r.chain(e,function(){return n.readComponentFactory(e,t)}),r.subscribe(this.componentClassStream,this._updateBoundChildComponent,this),this._updateBoundChildComponent()},willDestroy:function(){r.unsubscribe(this.componentClassStream,this._updateBoundChildComponent,this),this._super.apply(this,arguments)},_updateBoundChildComponent:function(){this.replace(0,1,[this._createNewComponent()])},_createNewComponent:function(){var e=r.read(this.componentClassStream);if(!e)throw new a["default"]('HTMLBars error: Could not find component named "'+r.read(this._boundComponentOptions.componentNameStream)+'".');var t,n=this._boundComponentOptions,s={};for(t in n)"_boundComponentOptions"!==t&&"componentClassStream"!==t&&(s[t]=n[t]);var o={};return i["default"](this,o,s),this.createChildView(e,o)}})}),e("ember-views/views/bound_if_view",["exports","ember-metal/run_loop","ember-views/views/metamorph_view","ember-views/mixins/normalized_rerender_if_needed","ember-htmlbars/system/render-view"],function(e,t,r,n,i){"use strict";e["default"]=r["default"].extend(n["default"],{init:function(){this._super.apply(this,arguments);var e=this;this.conditionStream.subscribe(this._wrapAsScheduled(function(){t["default"].scheduleOnce("render",e,"rerenderIfNeeded")}))},normalizedValue:function(){return this.conditionStream.value()},render:function(e){var t=this.conditionStream.value();this._lastNormalizedValue=t;var r=t?this.truthyTemplate:this.falsyTemplate;i["default"](this,e,r)}})}),e("ember-views/views/bound_partial_view",["exports","ember-views/views/metamorph_view","ember-views/mixins/normalized_rerender_if_needed","ember-views/system/lookup_partial","ember-metal/run_loop","ember-htmlbars/system/render-view","ember-htmlbars/templates/empty"],function(e,t,r,n,i,a,s){"use strict";e["default"]=t["default"].extend(r["default"],{init:function(){this._super.apply(this,arguments);var e=this;this.templateNameStream.subscribe(this._wrapAsScheduled(function(){i["default"].scheduleOnce("render",e,"rerenderIfNeeded")}))},normalizedValue:function(){return this.templateNameStream.value()},render:function(e){var t=this.normalizedValue();this._lastNormalizedValue=t;var r;t&&(r=n["default"](this,t)),a["default"](this,e,r||s["default"])}})}),e("ember-views/views/checkbox",["exports","ember-metal/property_get","ember-metal/property_set","ember-views/views/view"],function(e,t,r,n){"use strict";e["default"]=n["default"].extend({instrumentDisplay:'{{input type="checkbox"}}',classNames:["ember-checkbox"],tagName:"input",attributeBindings:["type","checked","indeterminate","disabled","tabindex","name","autofocus","required","form"],type:"checkbox",checked:!1,disabled:!1,indeterminate:!1,init:function(){this._super.apply(this,arguments),this.on("change",this,this._updateElementValue)},didInsertElement:function(){this._super.apply(this,arguments),t.get(this,"element").indeterminate=!!t.get(this,"indeterminate")},_updateElementValue:function(){r.set(this,"checked",this.$().prop("checked"))}})}),e("ember-views/views/collection_view",["exports","ember-metal/core","ember-metal/binding","ember-metal/property_get","ember-metal/property_set","ember-runtime/system/string","ember-views/views/container_view","ember-views/views/core_view","ember-views/views/view","ember-metal/mixin","ember-views/streams/utils","ember-runtime/mixins/array"],function(e,t,r,n,i,a,s,o,u,l,c,h){"use strict";var m=s["default"].extend({content:null,emptyViewClass:u["default"],emptyView:null,itemViewClass:u["default"],init:function(){var e=this._super.apply(this,arguments);return this._contentDidChange(),e},_contentWillChange:l.beforeObserver("content",function(){var e=this.get("content");e&&e.removeArrayObserver(this);var t=e?n.get(e,"length"):0;this.arrayWillChange(e,0,t)}),_contentDidChange:l.observer("content",function(){var e=n.get(this,"content");e&&(this._assertArrayLike(e),e.addArrayObserver(this));var t=e?n.get(e,"length"):0;this.arrayDidChange(e,0,null,t)}),_assertArrayLike:function(e){},destroy:function(){if(this._super.apply(this,arguments)){var e=n.get(this,"content");return e&&e.removeArrayObserver(this),this._createdEmptyView&&this._createdEmptyView.destroy(),this}},arrayWillChange:function(e,t,r){var i=n.get(this,"emptyView");i&&i instanceof u["default"]&&i.removeFromParent();var a,s,o=this._childViews;for(s=t+r-1;s>=t;s--)a=o[s],a.destroy()},arrayDidChange:function(e,t,a,s){var u,l,h,m,d,f,p,v=[];if(m=e?n.get(e,"length"):0){for(p=this._itemViewProps||{},d=n.get(this,"itemViewClass"),d=c.readViewFactory(d,this.container),h=t;t+s>h;h++)l=e.objectAt(h),p._context=this.keyword?this.get("context"):l,p.content=l,p.contentIndex=h,u=this.createChildView(d,p),this.blockParams>1?u._blockArguments=[l,u.getStream("_view.contentIndex")]:1===this.blockParams&&(u._blockArguments=[l]),v.push(u);if(this.replace(t,0,v),this.blockParams>1){var g=this._childViews;for(h=t+s;m>h;h++)u=g[h],i.set(u,"contentIndex",h)}}else{if(f=n.get(this,"emptyView"),!f)return;"string"==typeof f&&r.isGlobalPath(f)&&(f=n.get(f)||f),f=this.createChildView(f),v.push(f),i.set(this,"emptyView",f),o["default"].detect(f)&&(this._createdEmptyView=f),this.replace(t,0,v)}},createChildView:function(e,t){var r=this._super(e,t),a=n.get(r,"tagName");return(null===a||void 0===a)&&(a=m.CONTAINER_MAP[n.get(this,"tagName")],i.set(r,"tagName",a)),r}});m.CONTAINER_MAP={ul:"li",ol:"li",table:"tr",thead:"tr",tbody:"tr",tfoot:"tr",tr:"td",select:"option"},e["default"]=m}),e("ember-views/views/component",["exports","ember-metal/core","ember-views/mixins/component_template_deprecation","ember-runtime/mixins/target_action_support","ember-views/views/view","ember-metal/property_get","ember-metal/property_set","ember-metal/is_none","ember-metal/computed","ember-htmlbars/templates/component"],function(e,t,r,n,i,a,s,o,u,l){"use strict";var c=Array.prototype.slice,h=i["default"].extend(n["default"],r["default"],{controller:null,context:null,instrumentName:"component",instrumentDisplay:u.computed(function(){return this._debugContainerKey?"{{"+this._debugContainerKey.split(":")[1]+"}}":void 0}),init:function(){this._super.apply(this,arguments),this._keywords.view=this,s.set(this,"context",this),s.set(this,"controller",this)},defaultLayout:l["default"],template:u.computed(function(e,t){if(void 0!==t)return t;var r=a.get(this,"templateName"),n=this.templateForName(r,"template");return n||a.get(this,"defaultTemplate")}).property("templateName"),templateName:null,_setupKeywords:function(){},_yield:function(e,t,r,n){var s=t.data.view,o=this._parentView,u=a.get(this,"template");u&&s.appendChild(i["default"],{isVirtual:!0,tagName:"",template:u,_blockArguments:n,_contextView:o,_morph:r,context:a.get(o,"context"),controller:a.get(o,"controller")})},targetObject:u.computed(function(e){var t=this._parentView;return t?a.get(t,"controller"):null}).property("_parentView"),sendAction:function(e){var t,r=c.call(arguments,1);t=void 0===e?a.get(this,"action"):a.get(this,e),void 0!==t&&this.triggerAction({action:t,actionContext:r})},send:function(e){var r,n=[].slice.call(arguments,1),i=this._actions&&this._actions[e];if(i){var s=this._actions[e].apply(this,n)===!0;if(!s)return}if(r=a.get(this,"target"))r.send.apply(r,arguments);else if(!i)throw new Error(t["default"].inspect(this)+" had no action handler for: "+e)}});e["default"]=h}),e("ember-views/views/container_view",["exports","ember-metal/core","ember-metal/merge","ember-runtime/mixins/mutable_array","ember-metal/property_get","ember-metal/property_set","ember-views/views/view","ember-views/views/states","ember-metal/error","ember-metal/enumerable_utils","ember-metal/computed","ember-metal/run_loop","ember-metal/properties","ember-metal/mixin","ember-runtime/system/native_array"],function(e,t,r,n,i,a,s,o,u,l,c,h,m,d,f){"use strict";function p(){return this}var v=o.cloneStates(o.states),g=s["default"].extend(n["default"],{_states:v,willWatchProperty:function(e){},init:function(){this._super.apply(this,arguments);var e=i.get(this,"childViews");m.defineProperty(this,"childViews",s["default"].childViewsProperty);var t=this._childViews;l.forEach(e,function(e,r){var n;"string"==typeof e?(n=i.get(this,e),n=this.createChildView(n),a.set(this,e,n)):n=this.createChildView(e),t[r]=n},this);var r=i.get(this,"currentView");r&&(t.length||(t=this._childViews=this._childViews.slice()),t.push(this.createChildView(r)))},replace:function(e,t,r){var n=r?i.get(r,"length"):0;if(this.arrayContentWillChange(e,t,n),this.childViewsWillChange(this._childViews,e,t),0===n)this._childViews.splice(e,t);else{var a=[e,t].concat(r);r.length&&!this._childViews.length&&(this._childViews=this._childViews.slice()),this._childViews.splice.apply(this._childViews,a)}return this.arrayContentDidChange(e,t,n),this.childViewsDidChange(this._childViews,e,t,n),this},objectAt:function(e){return this._childViews[e]},length:c.computed(function(){return this._childViews.length})["volatile"](),render:function(e){var t=e.element(),r=e.dom;return""===this.tagName?(t=r.createDocumentFragment(),e._element=t,this._childViewsMorph=r.appendMorph(t,this._morph.contextualElement)):this._childViewsMorph=r.appendMorph(t),t},instrumentName:"container",childViewsWillChange:function(e,t,r){if(this.propertyWillChange("childViews"),r>0){var n=e.slice(t,t+r);this.currentState.childViewsWillChange(this,e,t,r),this.initializeViews(n,null,null)}},removeChild:function(e){return this.removeObject(e),this},childViewsDidChange:function(e,t,r,n){if(n>0){var i=e.slice(t,t+n);this.initializeViews(i,this),this.currentState.childViewsDidChange(this,e,t,n)}this.propertyDidChange("childViews")},initializeViews:function(e,t){l.forEach(e,function(e){a.set(e,"_parentView",t),!e.container&&t&&a.set(e,"container",t.container)})},currentView:null,_currentViewWillChange:d.beforeObserver("currentView",function(){var e=i.get(this,"currentView");e&&e.destroy()}),_currentViewDidChange:d.observer("currentView",function(){var e=i.get(this,"currentView");e&&this.pushObject(e)}),_ensureChildrenAreInDOM:function(){this.currentState.ensureChildrenAreInDOM(this)}});r["default"](v._default,{childViewsWillChange:p,childViewsDidChange:p,ensureChildrenAreInDOM:p}),r["default"](v.inBuffer,{childViewsDidChange:function(e,t,r,n){throw new u["default"]("You cannot modify child views while in the inBuffer state")}}),r["default"](v.hasElement,{childViewsWillChange:function(e,t,r,n){for(var i=r;r+n>i;i++){var a=t[i];a._unsubscribeFromStreamBindings(),a.remove()}},childViewsDidChange:function(e,t,r,n){h["default"].scheduleOnce("render",e,"_ensureChildrenAreInDOM")},ensureChildrenAreInDOM:function(e){for(var t=e._childViews,r=e._renderer,n=null,i=t.length-1;i>=0;i--){var a=t[i];a._elementCreated||r.renderTree(a,e,n),n=a._morph}}}),e["default"]=g}),e("ember-views/views/core_view",["exports","ember-views/system/renderer","dom-helper","ember-views/views/states","ember-runtime/system/object","ember-runtime/mixins/evented","ember-runtime/mixins/action_handler","ember-metal/property_get","ember-metal/computed","ember-metal/utils"],function(e,t,r,n,i,a,s,o,u,l){"use strict";function c(){return this}var h,m=i["default"].extend(a["default"],s["default"],{isView:!0,isVirtual:!1,_states:n.cloneStates(n.states),init:function(){this._super.apply(this,arguments),this._state="preRender",this.currentState=this._states.preRender,this._isVisible=o.get(this,"isVisible"),this.renderer||(h=h||new t["default"](new r["default"]),this.renderer=h)},parentView:u.computed("_parentView",function(){var e=this._parentView;return e&&e.isVirtual?o.get(e,"parentView"):e}),_state:null,_parentView:null,concreteView:u.computed("parentView",function(){return this.isVirtual?o.get(this,"parentView.concreteView"):this}),instrumentName:"core_view",instrumentDetails:function(e){e.object=this.toString(),e.containerKey=this._debugContainerKey,e.view=this},trigger:function(){this._super.apply(this,arguments);var e=arguments[0],t=this[e];if(t){for(var r=arguments.length,n=new Array(r-1),i=1;r>i;i++)n[i-1]=arguments[i];return t.apply(this,n)}},has:function(e){return"function"===l.typeOf(this[e])||this._super(e)},destroy:function(){var e=this._parentView;if(this._super.apply(this,arguments))return!this.removedFromDOM&&this._renderer&&this._renderer.remove(this,!0),e&&e.removeChild(this),this._transitionTo("destroying",!1),this},clearRenderedChildren:c,_transitionTo:c,destroyElement:c});m.reopenClass({isViewClass:!0}),e["default"]=m}),e("ember-views/views/each",["exports","ember-metal/core","ember-runtime/system/string","ember-metal/property_get","ember-metal/property_set","ember-views/views/collection_view","ember-metal/binding","ember-runtime/mixins/controller","ember-runtime/controllers/array_controller","ember-runtime/mixins/array","ember-metal/observer","ember-views/views/metamorph_view"],function(e,t,r,n,i,a,s,o,u,l,c,h){"use strict";e["default"]=a["default"].extend(h._Metamorph,{init:function(){var e,t=n.get(this,"itemController");if(t){var r=n.get(this,"controller.container").lookupFactory("controller:array").create({_isVirtual:!0,parentController:n.get(this,"controller"),itemController:t,target:n.get(this,"controller"),_eachView:this});this.disableContentObservers(function(){i.set(this,"content",r),e=new s.Binding("content","_eachView.dataSource").oneWay(),e.connect(r)}),this._arrayController=r}else this.disableContentObservers(function(){e=new s.Binding("content","dataSource").oneWay(),e.connect(this)});return this._super.apply(this,arguments)},_assertArrayLike:function(e){},disableContentObservers:function(e){c.removeBeforeObserver(this,"content",null,"_contentWillChange"),c.removeObserver(this,"content",null,"_contentDidChange"),e.call(this),c.addBeforeObserver(this,"content",null,"_contentWillChange"),c.addObserver(this,"content",null,"_contentDidChange")},itemViewClass:h["default"],emptyViewClass:h["default"],createChildView:function(e,t){var r=this._super(e,t),a=n.get(r,"content"),s=n.get(this,"keyword");return s&&(r._keywords[s]=a),a&&a.isController&&i.set(r,"controller",a),r},destroy:function(){return this._super.apply(this,arguments)?(this._arrayController&&this._arrayController.destroy(),this):void 0}})}),e("ember-views/views/metamorph_view",["exports","ember-metal/core","ember-views/views/view","ember-metal/mixin"],function(e,t,r,n){"use strict";var i=n.Mixin.create({isVirtual:!0,tagName:"",instrumentName:"metamorph",init:function(){this._super.apply(this,arguments)}});e["default"]=r["default"].extend(i),e._Metamorph=i}),e("ember-views/views/select",["exports","ember-metal/enumerable_utils","ember-metal/property_get","ember-metal/property_set","ember-views/views/view","ember-views/views/collection_view","ember-metal/utils","ember-metal/is_none","ember-metal/computed","ember-runtime/system/native_array","ember-metal/mixin","ember-metal/properties","ember-htmlbars/templates/select","ember-htmlbars/templates/select-option"],function(e,t,r,n,i,a,s,o,u,l,c,h,m,d){"use strict";var f=m["default"],p=i["default"].extend({instrumentDisplay:"Ember.SelectOption",tagName:"option",attributeBindings:["value","selected"],defaultTemplate:d["default"],init:function(){this.labelPathDidChange(),this.valuePathDidChange(),this._super.apply(this,arguments)},selected:u.computed(function(){var e=r.get(this,"value"),n=r.get(this,"parentView.selection");return r.get(this,"parentView.multiple")?n&&t.indexOf(n,e)>-1:e===r.get(this,"parentView.value")}).property("content","parentView.selection"),labelPathDidChange:c.observer("parentView.optionLabelPath",function(){var e=r.get(this,"parentView.optionLabelPath");h.defineProperty(this,"label",u.computed.alias(e))}),valuePathDidChange:c.observer("parentView.optionValuePath",function(){var e=r.get(this,"parentView.optionValuePath");h.defineProperty(this,"value",u.computed.alias(e))})}),v=a["default"].extend({instrumentDisplay:"Ember.SelectOptgroup",tagName:"optgroup",attributeBindings:["label"],selectionBinding:"parentView.selection",multipleBinding:"parentView.multiple",optionLabelPathBinding:"parentView.optionLabelPath",optionValuePathBinding:"parentView.optionValuePath",itemViewClassBinding:"parentView.optionView"}),g=i["default"].extend({instrumentDisplay:"Ember.Select",tagName:"select",classNames:["ember-select"],defaultTemplate:f,attributeBindings:["multiple","disabled","tabindex","name","required","autofocus","form","size"],multiple:!1,disabled:!1,required:!1,content:null,selection:null,value:u.computed("_valuePath","selection",function(e,t){if(2===arguments.length)return t;var n=r.get(this,"_valuePath");return n?r.get(this,"selection."+n):r.get(this,"selection")}),prompt:null,optionLabelPath:"content",optionValuePath:"content",optionGroupPath:null,groupView:v,groupedContent:u.computed(function(){var e=r.get(this,"optionGroupPath"),n=l.A(),i=r.get(this,"content")||[];return t.forEach(i,function(t){var i=r.get(t,e);r.get(n,"lastObject.label")!==i&&n.pushObject({label:i,content:l.A()}),r.get(n,"lastObject.content").push(t)}),n}).property("optionGroupPath","content.@each"),optionView:p,_change:function(){r.get(this,"multiple")?this._changeMultiple():this._changeSingle()},selectionDidChange:c.observer("selection.@each",function(){var e=r.get(this,"selection");if(r.get(this,"multiple")){if(!s.isArray(e))return void n.set(this,"selection",l.A([e]));this._selectionDidChangeMultiple()}else this._selectionDidChangeSingle()}),valueDidChange:c.observer("value",function(){var e,t=r.get(this,"content"),n=r.get(this,"value"),i=r.get(this,"optionValuePath").replace(/^content\.?/,""),a=i?r.get(this,"selection."+i):r.get(this,"selection");n!==a&&(e=t?t.find(function(e){return n===(i?r.get(e,i):e)}):null,this.set("selection",e))}),_setDefaults:function(){var e=r.get(this,"selection"),t=r.get(this,"value");o["default"](e)||this.selectionDidChange(),o["default"](t)||this.valueDidChange(),o["default"](e)&&this._change()},_changeSingle:function(){var e=this.$()[0].selectedIndex,t=r.get(this,"content"),i=r.get(this,"prompt");if(t&&r.get(t,"length")){if(i&&0===e)return void n.set(this,"selection",null);i&&(e-=1),n.set(this,"selection",t.objectAt(e))}},_changeMultiple:function(){var e=this.$("option:selected"),i=r.get(this,"prompt"),a=i?1:0,o=r.get(this,"content"),u=r.get(this,"selection");if(o&&e){var l=e.map(function(){return this.index-a}).toArray(),c=o.objectsAt(l);s.isArray(u)?t.replace(u,0,r.get(u,"length"),c):n.set(this,"selection",c)}},_selectionDidChangeSingle:function(){var e=r.get(this,"value"),t=this;e&&e.then?e.then(function(n){r.get(t,"value")===e&&t._setSelectedIndex(n)}):this._setSelectedIndex(e)},_setSelectedIndex:function(e){var n=r.get(this,"element"),i=r.get(this,"contentValues");if(n){var a=t.indexOf(i,e),s=r.get(this,"prompt");s&&(a+=1),n&&(n.selectedIndex=a)}},_valuePath:u.computed("optionValuePath",function(){var e=r.get(this,"optionValuePath");return e.replace(/^content\.?/,"")}),contentValues:u.computed("content.[]","_valuePath",function(){var e=r.get(this,"_valuePath"),n=r.get(this,"content")||[];return e?t.map(n,function(t){return r.get(t,e)}):t.map(n,function(e){return e})}),_selectionDidChangeMultiple:function(){var e,n=r.get(this,"content"),i=r.get(this,"selection"),a=n?t.indexesOf(n,i):[-1],s=r.get(this,"prompt"),o=s?1:0,u=this.$("option");u&&u.each(function(){e=this.index>-1?this.index-o:-1,this.selected=t.indexOf(a,e)>-1})},init:function(){this._super.apply(this,arguments),this.on("didInsertElement",this,this._setDefaults),this.on("change",this,this._change)}});e["default"]=g,e.Select=g,e.SelectOption=p,e.SelectOptgroup=v}),e("ember-views/views/simple_bound_view",["exports","ember-metal/error","ember-metal/run_loop","ember-metal/utils"],function(e,t,r,n){"use strict";function i(){return this}function a(e,t,r,i){this.stream=i,this[n.GUID_KEY]=n.uuid(),this._lastNormalizedValue=void 0,this.state="preRender",this.updateId=null,this._parentView=e,this.buffer=null,this._morph=r,this.renderer=t}function s(e,t,n){var i=e.appendChild(a,{_morph:t,stream:n});n.subscribe(e._wrapAsScheduled(function(){r["default"].scheduleOnce("render",i,"rerender")}))}e.appendSimpleBoundView=s,a.prototype={isVirtual:!0,isView:!0,tagName:"",destroy:function(){this.updateId&&(r["default"].cancel(this.updateId),this.updateId=null),this._parentView&&this._parentView.removeChild(this),this.morph=null,this.state="destroyed"},propertyWillChange:i,propertyDidChange:i,normalizedValue:function(){var e=this.stream.value();return null===e||void 0===e?"":e},render:function(e){var t=this.normalizedValue();this._lastNormalizedValue=t,e._element=t},rerender:function(){switch(this.state){case"preRender":case"destroyed":break;case"inBuffer":throw new t["default"]("Something you did tried to replace an {{expression}} before it was inserted into the DOM.");case"hasElement":case"inDOM":this.updateId=r["default"].scheduleOnce("render",this,"update")}return this},update:function(){this.updateId=null;var e=this.normalizedValue();e!==this._lastNormalizedValue&&(this._lastNormalizedValue=e,this._morph.setContent(e))},_transitionTo:function(e){this.state=e}},a.create=function(e){return new a(e._parentView,e.renderer,e._morph,e.stream)},a.isViewClass=!0,e["default"]=a}),e("ember-views/views/states",["exports","ember-metal/platform/create","ember-metal/merge","ember-views/views/states/default","ember-views/views/states/pre_render","ember-views/views/states/in_buffer","ember-views/views/states/has_element","ember-views/views/states/in_dom","ember-views/views/states/destroying"],function(e,t,r,n,i,a,s,o,u){"use strict";function l(e){var n={};n._default={},n.preRender=t["default"](n._default),n.destroying=t["default"](n._default),n.inBuffer=t["default"](n._default),n.hasElement=t["default"](n._default),n.inDOM=t["default"](n.hasElement);for(var i in e)e.hasOwnProperty(i)&&r["default"](n[i],e[i]);return n}e.cloneStates=l;var c={_default:n["default"],preRender:i["default"],inDOM:o["default"],inBuffer:a["default"],hasElement:s["default"],destroying:u["default"]};e.states=c}),e("ember-views/views/states/default",["exports","ember-metal/error"],function(e,t){"use strict";function r(){return this}e["default"]={appendChild:function(){throw new t["default"]("You can't use appendChild outside of the rendering process")},$:function(){return void 0},getElement:function(){return null},handleEvent:function(){return!0},destroyElement:function(e){return e._renderer&&e._renderer.remove(e,!1),e},rerender:r,invokeObserver:r}}),e("ember-views/views/states/destroying",["exports","ember-metal/merge","ember-metal/platform/create","ember-runtime/system/string","ember-views/views/states/default","ember-metal/error"],function(e,t,r,n,i,a){"use strict";var s="You can't call %@ on a view being destroyed",o=r["default"](i["default"]);t["default"](o,{appendChild:function(){throw new a["default"](n.fmt(s,["appendChild"]))},rerender:function(){throw new a["default"](n.fmt(s,["rerender"]))},destroyElement:function(){throw new a["default"](n.fmt(s,["destroyElement"]))}}),e["default"]=o}),e("ember-views/views/states/has_element",["exports","ember-views/views/states/default","ember-metal/run_loop","ember-metal/merge","ember-metal/platform/create","ember-views/system/jquery","ember-metal/error","ember-metal/property_get"],function(e,t,r,n,i,a,s,o){"use strict";var u=i["default"](t["default"]);n["default"](u,{$:function(e,t){var r=e.get("concreteView").element;return t?a["default"](t,r):a["default"](r)},getElement:function(e){var t=o.get(e,"parentView");return t&&(t=o.get(t,"element")),t?e.findElementInParentElement(t):a["default"]("#"+o.get(e,"elementId"))[0]},rerender:function(e){if(e._root._morph&&!e._elementInserted)throw new s["default"]("Something you did caused a view to re-render after it rendered but before it was inserted into the DOM.");r["default"].scheduleOnce("render",function(){e.isDestroying||e._renderer.renderTree(e,e._parentView)})},destroyElement:function(e){return e._renderer.remove(e,!1),e},handleEvent:function(e,t,r){return e.has(t)?e.trigger(t,r):!0},invokeObserver:function(e,t){t.call(e)}}),e["default"]=u}),e("ember-views/views/states/in_buffer",["exports","ember-views/views/states/default","ember-metal/error","ember-views/system/jquery","ember-metal/platform/create","ember-metal/merge"],function(e,t,r,n,i,a){"use strict";var s=i["default"](t["default"]);a["default"](s,{$:function(e,t){return e.rerender(),n["default"]()},rerender:function(e){throw new r["default"]("Something you did caused a view to re-render after it rendered but before it was inserted into the DOM.")},appendChild:function(e,t,r){var n=e.buffer,i=e._childViews;return t=e.createChildView(t,r),i.length||(i=e._childViews=i.slice()),i.push(t),t._morph||n.pushChildView(t),e.propertyDidChange("childViews"),t},appendAttr:function(e,t){var r=e.buffer,n=e._attrNodes;return n.length||(n=e._attrNodes=n.slice()),n.push(t),t._morph||r.pushAttrNode(t),e.propertyDidChange("childViews"),t},invokeObserver:function(e,t){t.call(e)}}),e["default"]=s}),e("ember-views/views/states/in_dom",["exports","ember-metal/core","ember-metal/platform/create","ember-metal/merge","ember-metal/error","ember-metal/observer","ember-views/views/states/has_element"],function(e,r,n,i,a,s,o){"use strict";var u,l=n["default"](o["default"]);i["default"](l,{enter:function(e){u||(u=t("ember-views/views/view")["default"]),e.isVirtual||(u.views[e.elementId]=e)},exit:function(e){u||(u=t("ember-views/views/view")["default"]),this.isVirtual||delete u.views[e.elementId]},appendAttr:function(e,t){var r=e._attrNodes;return r.length||(r=e._attrNodes=r.slice()),r.push(t),t._parentView=e,e.renderer.appendAttrTo(t,e.element,t.attrName),e.propertyDidChange("childViews"),t}}),e["default"]=l}),e("ember-views/views/states/pre_render",["exports","ember-views/views/states/default","ember-metal/platform/create"],function(e,t,r){"use strict";var n=r["default"](t["default"]);e["default"]=n}),e("ember-views/views/text_area",["exports","ember-metal/property_get","ember-views/views/component","ember-views/mixins/text_support","ember-metal/mixin"],function(e,t,r,n,i){"use strict";e["default"]=r["default"].extend(n["default"],{instrumentDisplay:"{{textarea}}",classNames:["ember-text-area"],tagName:"textarea",attributeBindings:["rows","cols","name","selectionEnd","selectionStart","wrap","lang","dir"],rows:null,cols:null,_updateElementValue:i.observer("value",function(){var e=t.get(this,"value"),r=this.$();r&&e!==r.val()&&r.val(e)}),init:function(){this._super.apply(this,arguments),this.on("didInsertElement",this,this._updateElementValue)}})}),e("ember-views/views/text_field",["exports","ember-views/views/component","ember-views/mixins/text_support"],function(e,t,r){"use strict";e["default"]=t["default"].extend(r["default"],{instrumentDisplay:'{{input type="text"}}',classNames:["ember-text-field"],tagName:"input",attributeBindings:["accept","autocomplete","autosave","dir","formaction","formenctype","formmethod","formnovalidate","formtarget","height","inputmode","lang","list","max","min","multiple","name","pattern","size","step","type","value","width"],defaultLayout:null,value:"",type:"text",size:null,pattern:null,min:null,max:null})}),e("ember-views/views/view",["exports","ember-metal/core","ember-runtime/mixins/evented","ember-runtime/system/object","ember-metal/error","ember-metal/property_get","ember-metal/run_loop","ember-metal/observer","ember-metal/utils","ember-metal/computed","ember-metal/mixin","ember-metal/deprecate_property","ember-metal/property_events","ember-views/system/jquery","ember-views/system/ext","ember-views/views/core_view","ember-views/mixins/view_stream_support","ember-views/mixins/view_keyword_support","ember-views/mixins/view_context_support","ember-views/mixins/view_child_views_support","ember-views/mixins/view_state_support","ember-views/mixins/template_rendering_support","ember-views/mixins/class_names_support","ember-views/mixins/attribute_bindings_support","ember-views/mixins/legacy_view_support","ember-views/mixins/instrumentation_support","ember-views/mixins/visibility_support"],function(e,t,r,n,i,a,s,o,u,l,c,h,m,d,f,p,v,g,b,y,_,w,x,C,E,O,P){"use strict";function S(){return this}t["default"].TEMPLATES={};var A=[],N=p["default"].extend(v["default"],g["default"],b["default"],y["default"],_["default"],w["default"],x["default"],C["default"],E["default"],O["default"],P["default"],{isView:!0,templateName:null,layoutName:null,template:l.computed("templateName",function(e,t){if(void 0!==t)return t;var r=a.get(this,"templateName"),n=this.templateForName(r,"template");return n||a.get(this,"defaultTemplate")}),layout:l.computed(function(e){var t=a.get(this,"layoutName"),r=this.templateForName(t,"layout");return r||a.get(this,"defaultLayout")}).property("layoutName"),_yield:function(e,t,r){var n=a.get(this,"template");return n?n.isHTMLBars?n.render(e,t,r.contextualElement):n(e,t):void 0},_blockArguments:A,templateForName:function(e,t){if(e){if(!this.container)throw new i["default"]("Container was not found when looking up a views template. This is most likely due to manually instantiating an Ember.View. See: http://git.io/EKPpnA");return this.container.lookup("template:"+e)}},_contextDidChange:c.observer("context",function(){this.rerender()}),_childViewsWillChange:c.beforeObserver("childViews",function(){if(this.isVirtual){var e=a.get(this,"parentView");e&&m.propertyWillChange(e,"childViews")}}),_childViewsDidChange:c.observer("childViews",function(){if(this.isVirtual){var e=a.get(this,"parentView");e&&m.propertyDidChange(e,"childViews")}}),nearestOfType:function(e){for(var t=a.get(this,"parentView"),r=e instanceof c.Mixin?function(t){return e.detect(t)}:function(t){return e.detect(t.constructor)};t;){if(r(t))return t;t=a.get(t,"parentView")}},nearestWithProperty:function(e){for(var t=a.get(this,"parentView");t;){if(e in t)return t;t=a.get(t,"parentView")}},_parentViewDidChange:c.observer("_parentView",function(){this.isDestroying||(this._setupKeywords(),this.trigger("parentViewDidChange"),a.get(this,"parentView.controller")&&!a.get(this,"controller")&&this.notifyPropertyChange("controller"))}),_controllerDidChange:c.observer("controller",function(){this.isDestroying||(this.rerender(),this.forEachChildView(function(e){e.propertyDidChange("controller")}))}),rerender:function(){return this.currentState.rerender(this)},_classStringForProperty:function(e){return N._classStringForValue(e.path,e.stream.value(),e.className,e.falsyClassName)},element:null,$:function(e){return this.currentState.$(this,e)},forEachChildView:function(e){var t=this._childViews;if(!t)return this;var r,n,i=t.length;for(n=0;i>n;n++)r=t[n],e(r);return this},appendTo:function(e){var t=d["default"](e);return this.renderer.appendTo(this,t[0]),this},replaceIn:function(e){var t=d["default"](e);return this.renderer.replaceIn(this,t[0]),this},append:function(){return this.appendTo(document.body)},remove:function(){this.removedFromDOM||this.destroyElement()},elementId:null,findElementInParentElement:function(e){var t="#"+this.elementId;return d["default"](t)[0]||d["default"](t,e)[0]},createElement:function(){return this.element?this:(this._didCreateElementWithoutMorph=!0,this.renderer.renderTree(this),this)},willInsertElement:S,didInsertElement:S,willClearRender:S,destroyElement:function(){return this.currentState.destroyElement(this)},willDestroyElement:S,parentViewDidChange:S,applyAttributesToBuffer:function(e){this._applyClassNameBindings(),this._applyAttributeBindings(e),e.setClasses(this.classNames),e.id(this.elementId);var t=a.get(this,"ariaRole");t&&e.attr("role",t),a.get(this,"isVisible")===!1&&e.style("display","none")},tagName:null,ariaRole:null,init:function(){this.isVirtual||this.elementId||(this.elementId=u.guidFor(this)),this._super.apply(this,arguments)},__defineNonEnumerable:function(e){this[e.name]=e.descriptor.value},appendAttr:function(e){return this.currentState.appendAttr(this,e);

},removeFromParent:function(){var e=this._parentView;return this.remove(),e&&e.removeChild(this),this},destroy:function(){var e=a.get(this,"parentView"),t=this.viewName;return this._super.apply(this,arguments)?(t&&e&&e.set(t,null),this):void 0},handleEvent:function(e,t){return this.currentState.handleEvent(this,e,t)},registerObserver:function(e,t,r,n){if(n||"function"!=typeof r||(n=r,r=null),e&&"object"==typeof e){var i=this._wrapAsScheduled(n);n.addObserver(e,t,r,i),this.one("willClearRender",function(){n.removeObserver(e,t,r,i)})}},_wrapAsScheduled:function(e){var t=this,r=function(){t.currentState.invokeObserver(this,e)},n=function(){s["default"].scheduleOnce("render",this,r)};return n}});h.deprecateProperty(N.prototype,"state","_state"),h.deprecateProperty(N.prototype,"states","_states");var T=n["default"].extend(r["default"]).create();N.addMutationListener=function(e){T.on("change",e)},N.removeMutationListener=function(e){T.off("change",e)},N.notifyMutationListeners=function(){T.trigger("change")},N.views={},N.childViewsProperty=y.childViewsProperty,e["default"]=N,e.ViewKeywordSupport=g["default"],e.ViewStreamSupport=v["default"],e.ViewContextSupport=b["default"],e.ViewChildViewsSupport=y["default"],e.ViewStateSupport=_["default"],e.TemplateRenderingSupport=w["default"],e.ClassNamesSupport=x["default"],e.AttributeBindingsSupport=C["default"]}),e("ember-views/views/with_view",["exports","ember-metal/property_set","ember-views/views/metamorph_view","ember-views/mixins/normalized_rerender_if_needed","ember-metal/run_loop","ember-htmlbars/system/render-view"],function(e,t,r,n,i,a){"use strict";e["default"]=r["default"].extend(n["default"],{init:function(){this._super.apply(this,arguments);var e=this;this.withValue.subscribe(this._wrapAsScheduled(function(){i["default"].scheduleOnce("render",e,"rerenderIfNeeded")}));var r=this.controllerName;if(r){var n=this.container.lookupFactory("controller:"+r),a=n.create({parentController:this.previousContext,target:this.previousContext});this._generatedController=a,this.preserveContext?(this._blockArguments=[a],this.withValue.subscribe(function(e){t.set(a,"model",e.value())})):t.set(this,"controller",a),t.set(a,"model",this.withValue.value())}else this.preserveContext&&(this._blockArguments=[this.withValue])},normalizedValue:function(){return this.withValue.value()},render:function(e){var r=this.normalizedValue();this._lastNormalizedValue=r,this.preserveContext||this.controllerName||t.set(this,"_context",r);var n=r?this.mainTemplate:this.inverseTemplate;a["default"](this,e,n)},willDestroy:function(){this._super.apply(this,arguments),this._generatedController&&this._generatedController.destroy()}})}),e("ember",["ember-metal","ember-runtime","ember-views","ember-routing","ember-application","ember-extension-support","ember-htmlbars","ember-routing-htmlbars","ember-routing-views","ember-metal/environment","ember-runtime/system/lazy_load"],function(e,r,n,a,s,o,u,l,c,h,m){"use strict";i.__loader.registry["ember-template-compiler"]&&t("ember-template-compiler"),i.__loader.registry["ember-testing"]&&t("ember-testing"),m.runLoadHooks("Ember")}),e("htmlbars-util",["./htmlbars-util/safe-string","./htmlbars-util/handlebars/utils","./htmlbars-util/namespaces","exports"],function(e,t,r,n){"use strict";var i=e["default"],a=t.escapeExpression,s=r.getAttrNamespace;n.SafeString=i,n.escapeExpression=a,n.getAttrNamespace=s}),e("htmlbars-util/array-utils",["exports"],function(e){"use strict";function t(e,t,r){var n,i;if(void 0===r)for(n=0,i=e.length;i>n;n++)t(e[n],n,e);else for(n=0,i=e.length;i>n;n++)t.call(r,e[n],n,e)}function r(e,t){var r,n,i=[];for(r=0,n=e.length;n>r;r++)i.push(t(e[r],r,e));return i}e.forEach=t,e.map=r;var n;n=Array.prototype.indexOf?function(e,t,r){return e.indexOf(t,r)}:function(e,t,r){void 0===r||null===r?r=0:0>r&&(r=Math.max(0,e.length+r));for(var n=r,i=e.length;i>n;n++)if(e[n]===t)return n;return-1};var i=n;e.indexOfArray=i}),e("htmlbars-util/handlebars/safe-string",["exports"],function(e){"use strict";function t(e){this.string=e}t.prototype.toString=t.prototype.toHTML=function(){return""+this.string},e["default"]=t}),e("htmlbars-util/handlebars/utils",["./safe-string","exports"],function(e,t){"use strict";function r(e){return o[e]}function n(e){for(var t=1;t<arguments.length;t++)for(var r in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],r)&&(e[r]=arguments[t][r]);return e}function i(e){return e&&e.toHTML?e.toHTML():null==e?"":e?(e=""+e,l.test(e)?e.replace(u,r):e):e+""}function a(e){return e||0===e?m(e)&&0===e.length?!0:!1:!0}function s(e,t){return(e?e+".":"")+t}var o=(e["default"],{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"}),u=/[&<>"'`]/g,l=/[&<>"'`]/;t.extend=n;var c=Object.prototype.toString;t.toString=c;var h=function(e){return"function"==typeof e};h(/x/)&&(h=function(e){return"function"==typeof e&&"[object Function]"===c.call(e)});var h;t.isFunction=h;var m=Array.isArray||function(e){return e&&"object"==typeof e?"[object Array]"===c.call(e):!1};t.isArray=m,t.escapeExpression=i,t.isEmpty=a,t.appendContextPath=s}),e("htmlbars-util/namespaces",["exports"],function(e){"use strict";function t(e){var t,n=e.indexOf(":");if(-1!==n){var i=e.slice(0,n);t=r[i]}return t||null}var r={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"};e.getAttrNamespace=t}),e("htmlbars-util/object-utils",["exports"],function(e){"use strict";function t(e,t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r]);return e}e.merge=t}),e("htmlbars-util/quoting",["exports"],function(e){"use strict";function t(e){return e=e.replace(/\\/g,"\\\\"),e=e.replace(/"/g,'\\"'),e=e.replace(/\n/g,"\\n")}function r(e){return'"'+t(e)+'"'}function n(e){return"["+e+"]"}function i(e){return"{"+e.join(", ")+"}"}function a(e,t){for(var r="";t--;)r+=e;return r}e.escapeString=t,e.string=r,e.array=n,e.hash=i,e.repeat=a}),e("htmlbars-util/safe-string",["./handlebars/safe-string","exports"],function(e,t){"use strict";var r=e["default"];t["default"]=r}),e("morph-attr",["./morph-attr/sanitize-attribute-value","./dom-helper/prop","./dom-helper/build-html-dom","./htmlbars-util","exports"],function(e,t,r,n,i){"use strict";function a(e){this.domHelper.setPropertyStrict(this.element,this.attrName,e)}function s(e){c(e)?this.domHelper.removeAttribute(this.element,this.attrName):this.domHelper.setAttribute(this.element,this.attrName,e)}function o(e){c(e)?this.domHelper.removeAttribute(this.element,this.attrName):this.domHelper.setAttributeNS(this.element,this.namespace,this.attrName,e)}function u(e,t,r,n){this.element=e,this.domHelper=r,this.namespace=void 0!==n?n:d(t),this.escaped=!0;var i=h(this.element,t);this.namespace?(this._update=o,this.attrName=t):e.namespaceURI!==m&&"style"!==t&&i?(this.attrName=i,this._update=a):(this.attrName=t,this._update=s)}var l=e.sanitizeAttributeValue,c=t.isAttrRemovalValue,h=t.normalizeProperty,m=r.svgNamespace,d=n.getAttrNamespace;u.prototype.setContent=function(e){if(this.escaped){var t=l(this.domHelper,this.element,this.attrName,e);this._update(t,this.namespace)}else this._update(e,this.namespace)},i["default"]=u,i.sanitizeAttributeValue=l}),e("morph-attr/sanitize-attribute-value",["exports"],function(e){"use strict";function t(e,t,o,u){var l;if(l=t?t.tagName.toUpperCase():null,u&&u.toHTML)return u.toHTML();if((null===l||n[l])&&a[o]){var c=e.protocolForURL(u);if(r[c]===!0)return"unsafe:"+u}return i[l]&&s[o]?"unsafe:"+u:u}var r={"javascript:":!0,"vbscript:":!0},n={A:!0,BODY:!0,LINK:!0,IMG:!0,IFRAME:!0,BASE:!0},i={EMBED:!0},a={href:!0,src:!0,background:!0};e.badAttributes=a;var s={src:!0};e.sanitizeAttributeValue=t}),e("morph-range",["./morph-range/utils","exports"],function(e,t){"use strict";function r(e,t){this.domHelper=e,this.contextualElement=t,this.parseTextAsHTML=!1,this.firstNode=null,this.lastNode=null,this.parentMorph=null,this.firstChildMorph=null,this.lastChildMorph=null,this.previousMorph=null,this.nextMorph=null}function n(e){for(var t,r=e;(t=r.parentMorph)&&r===t.firstChildMorph&&r.firstNode!==t.firstNode;)t.firstNode=r.firstNode,r=t}function i(e){for(var t,r=e;(t=r.parentMorph)&&r===t.lastChildMorph&&r.lastNode!==t.lastNode;)t.lastNode=r.lastNode,r=t}var a=e.clear,s=e.insertBefore;r.prototype.setContent=function(e){if(null===e||void 0===e)return this.clear();var t=typeof e;switch(t){case"string":return this.parseTextAsHTML?this.setHTML(e):this.setText(e);case"object":if("number"==typeof e.nodeType)return this.setNode(e);if("string"==typeof e.string)return this.setHTML(e.string);if(this.parseTextAsHTML)return this.setHTML(e.toString());case"boolean":case"number":return this.setText(e.toString());default:throw new TypeError("unsupported content")}},r.prototype.clear=function(){return this.setNode(this.domHelper.createComment(""))},r.prototype.setText=function(e){var t=this.firstNode,r=this.lastNode;return t&&r===t&&3===t.nodeType?(t.nodeValue=e,t):this.setNode(e?this.domHelper.createTextNode(e):this.domHelper.createComment(""))},r.prototype.setNode=function(e){var t,r;switch(e.nodeType){case 3:t=e,r=e;break;case 11:t=e.firstChild,r=e.lastChild,null===t&&(t=this.domHelper.createComment(""),e.appendChild(t),r=t);break;default:t=e,r=e}var o=this.firstNode;if(null!==o){var u=o.parentNode;s(u,t,r,o),a(u,o,this.lastNode)}return this.firstNode=t,this.lastNode=r,this.parentMorph&&(n(this),i(this)),e},r.prototype.reset=function(){this.firstChildMorph=null,this.lastChildMorph=null},r.prototype.destroy=function(){var e=this.parentMorph,t=this.previousMorph,r=this.nextMorph,s=this.firstNode,o=this.lastNode,u=s&&s.parentNode;if(t?r?(t.nextMorph=r,r.previousMorph=t):(t.nextMorph=null,e&&(e.lastChildMorph=t)):r?(r.previousMorph=null,e&&(e.firstChildMorph=r)):e&&(e.lastChildMorph=e.firstChildMorph=null),this.parentMorph=null,this.firstNode=null,this.lastNode=null,e){if(!e.firstChildMorph)return void e.clear();n(e.firstChildMorph),i(e.lastChildMorph)}a(u,s,o)},r.prototype.setHTML=function(e){var t=this.domHelper.parseHTML(e,this.contextualElement);return this.setNode(t)},r.prototype.appendContent=function(e){return this.insertContentBeforeMorph(e,null)},r.prototype.insertContentBeforeMorph=function(e,t){var n=new r(this.domHelper,this.contextualElement);return n.setContent(e),this.insertBeforeMorph(n,t),n},r.prototype.appendMorph=function(e){this.insertBeforeMorph(e,null)},r.prototype.insertBeforeMorph=function(e,t){if(t&&t.parentMorph!==this)throw new Error("The morph before which the new morph is to be inserted is not a child of this morph.");e.parentMorph=this;var r=this.firstNode.parentNode;s(r,e.firstNode,e.lastNode,t?t.firstNode:this.lastNode.nextSibling),this.firstChildMorph||a(r,this.firstNode,this.lastNode);var o=t?t.previousMorph:this.lastChildMorph;o?(o.nextMorph=e,e.previousMorph=o):this.firstChildMorph=e,t?(t.previousMorph=e,e.nextMorph=t):this.lastChildMorph=e,n(this.firstChildMorph),i(this.lastChildMorph)},t["default"]=r}),e("morph-range/utils",["exports"],function(e){"use strict";function t(e,t,r){if(e){var n,i=t;do{if(n=i.nextSibling,e.removeChild(i),i===r)break;i=n}while(i)}}function r(e,t,r,n){var i,a=r,s=n;do{if(i=a.previousSibling,e.insertBefore(a,s),a===t)break;s=a,a=i}while(a)}e.clear=t,e.insertBefore=r}),e("route-recognizer",["./route-recognizer/dsl","exports"],function(e,t){"use strict";function r(e){return"[object Array]"===Object.prototype.toString.call(e)}function n(e){this.string=e}function i(e){this.name=e}function a(e){this.name=e}function s(){}function o(e,t,r){"/"===e.charAt(0)&&(e=e.substr(1));for(var o=e.split("/"),u=[],l=0,c=o.length;c>l;l++){var h,m=o[l];(h=m.match(/^:([^\/]+)$/))?(u.push(new i(h[1])),t.push(h[1]),r.dynamics++):(h=m.match(/^\*([^\/]+)$/))?(u.push(new a(h[1])),t.push(h[1]),r.stars++):""===m?u.push(new s):(u.push(new n(m)),r.statics++)}return u}function u(e){this.charSpec=e,this.nextStates=[]}function l(e){return e.sort(function(e,t){if(e.types.stars!==t.types.stars)return e.types.stars-t.types.stars;if(e.types.stars){if(e.types.statics!==t.types.statics)return t.types.statics-e.types.statics;if(e.types.dynamics!==t.types.dynamics)return t.types.dynamics-e.types.dynamics}return e.types.dynamics!==t.types.dynamics?e.types.dynamics-t.types.dynamics:e.types.statics!==t.types.statics?t.types.statics-e.types.statics:0})}function c(e,t){for(var r=[],n=0,i=e.length;i>n;n++){var a=e[n];r=r.concat(a.match(t))}return r}function h(e){this.queryParams=e||{}}function m(e,t,r){for(var n=e.handlers,i=e.regex,a=t.match(i),s=1,o=new h(r),u=0,l=n.length;l>u;u++){for(var c=n[u],m=c.names,d={},f=0,p=m.length;p>f;f++)d[m[f]]=a[s++];o.push({handler:c.handler,params:d,isDynamic:!!m.length})}return o}function d(e,t){return t.eachChar(function(t){e=e.put(t)}),e}function f(e){return e=e.replace(/\+/gm,"%20"),decodeURIComponent(e)}var p=e["default"],v=["/",".","*","+","?","|","(",")","[","]","{","}","\\"],g=new RegExp("(\\"+v.join("|\\")+")","g");n.prototype={eachChar:function(e){for(var t,r=this.string,n=0,i=r.length;i>n;n++)t=r.charAt(n),e({validChars:t})},regex:function(){return this.string.replace(g,"\\$1")},generate:function(){return this.string}},i.prototype={eachChar:function(e){e({invalidChars:"/",repeat:!0})},regex:function(){return"([^/]+)"},generate:function(e){return e[this.name]}},a.prototype={eachChar:function(e){e({invalidChars:"",repeat:!0})},regex:function(){return"(.+)"},generate:function(e){return e[this.name]}},s.prototype={eachChar:function(){},regex:function(){return""},generate:function(){return""}},u.prototype={get:function(e){for(var t=this.nextStates,r=0,n=t.length;n>r;r++){var i=t[r],a=i.charSpec.validChars===e.validChars;if(a=a&&i.charSpec.invalidChars===e.invalidChars)return i}},put:function(e){var t;return(t=this.get(e))?t:(t=new u(e),this.nextStates.push(t),e.repeat&&t.nextStates.push(t),t)},match:function(e){for(var t,r,n,i=this.nextStates,a=[],s=0,o=i.length;o>s;s++)t=i[s],r=t.charSpec,"undefined"!=typeof(n=r.validChars)?-1!==n.indexOf(e)&&a.push(t):"undefined"!=typeof(n=r.invalidChars)&&-1===n.indexOf(e)&&a.push(t);return a}};var b=Object.create||function(e){function t(){}return t.prototype=e,new t};h.prototype=b({splice:Array.prototype.splice,slice:Array.prototype.slice,push:Array.prototype.push,length:0,queryParams:null});var y=function(){this.rootState=new u,this.names={}};y.prototype={add:function(e,t){for(var r,n=this.rootState,i="^",a={statics:0,dynamics:0,stars:0},u=[],l=[],c=!0,h=0,m=e.length;m>h;h++){var f=e[h],p=[],v=o(f.path,p,a);l=l.concat(v);for(var g=0,b=v.length;b>g;g++){var y=v[g];y instanceof s||(c=!1,n=n.put({validChars:"/"}),i+="/",n=d(n,y),i+=y.regex())}var _={handler:f.handler,names:p};u.push(_)}c&&(n=n.put({validChars:"/"}),i+="/"),n.handlers=u,n.regex=new RegExp(i+"$"),n.types=a,(r=t&&t.as)&&(this.names[r]={segments:l,handlers:u})},handlersFor:function(e){var t=this.names[e],r=[];if(!t)throw new Error("There is no route named "+e);for(var n=0,i=t.handlers.length;i>n;n++)r.push(t.handlers[n]);return r},hasRoute:function(e){return!!this.names[e]},generate:function(e,t){var r=this.names[e],n="";if(!r)throw new Error("There is no route named "+e);for(var i=r.segments,a=0,o=i.length;o>a;a++){var u=i[a];u instanceof s||(n+="/",n+=u.generate(t))}return"/"!==n.charAt(0)&&(n="/"+n),t&&t.queryParams&&(n+=this.generateQueryString(t.queryParams,r.handlers)),n},generateQueryString:function(e,t){var n=[],i=[];for(var a in e)e.hasOwnProperty(a)&&i.push(a);i.sort();for(var s=0,o=i.length;o>s;s++){a=i[s];var u=e[a];if(null!=u){var l=encodeURIComponent(a);if(r(u))for(var c=0,h=u.length;h>c;c++){var m=a+"[]="+encodeURIComponent(u[c]);n.push(m)}else l+="="+encodeURIComponent(u),n.push(l)}}return 0===n.length?"":"?"+n.join("&")},parseQueryString:function(e){for(var t=e.split("&"),r={},n=0;n<t.length;n++){var i,a=t[n].split("="),s=f(a[0]),o=s.length,u=!1;1===a.length?i="true":(o>2&&"[]"===s.slice(o-2)&&(u=!0,s=s.slice(0,o-2),r[s]||(r[s]=[])),i=a[1]?f(a[1]):""),u?r[s].push(i):r[s]=i}return r},recognize:function(e){var t,r,n,i,a=[this.rootState],s={},o=!1;if(i=e.indexOf("?"),-1!==i){var u=e.substr(i+1,e.length);e=e.substr(0,i),s=this.parseQueryString(u)}for(e=decodeURI(e),"/"!==e.charAt(0)&&(e="/"+e),t=e.length,t>1&&"/"===e.charAt(t-1)&&(e=e.substr(0,t-1),o=!0),r=0,n=e.length;n>r&&(a=c(a,e.charAt(r)),a.length);r++);var h=[];for(r=0,n=a.length;n>r;r++)a[r].handlers&&h.push(a[r]);a=l(h);var d=h[0];return d&&d.handlers?(o&&"(.+)$"===d.regex.source.slice(-5)&&(e+="/"),m(d,e,s)):void 0}},y.prototype.map=p,y.VERSION="0.1.5",t["default"]=y}),e("route-recognizer/dsl",["exports"],function(e){"use strict";function t(e,t,r){this.path=e,this.matcher=t,this.delegate=r}function r(e){this.routes={},this.children={},this.target=e}function n(e,r,i){return function(a,s){var o=e+a;return s?void s(n(o,r,i)):new t(e+a,r,i)}}function i(e,t,r){for(var n=0,i=0,a=e.length;a>i;i++)n+=e[i].path.length;t=t.substr(n);var s={path:t,handler:r};e.push(s)}function a(e,t,r,n){var s=t.routes;for(var o in s)if(s.hasOwnProperty(o)){var u=e.slice();i(u,o,s[o]),t.children[o]?a(u,t.children[o],r,n):r.call(n,u)}}t.prototype={to:function(e,t){var r=this.delegate;if(r&&r.willAddRoute&&(e=r.willAddRoute(this.matcher.target,e)),this.matcher.add(this.path,e),t){if(0===t.length)throw new Error("You must have an argument in the function passed to `to`");this.matcher.addChild(this.path,e,t,this.delegate)}return this}},r.prototype={add:function(e,t){this.routes[e]=t},addChild:function(e,t,i,a){var s=new r(t);this.children[e]=s;var o=n(e,s,a);a&&a.contextEntered&&a.contextEntered(t,o),i(o)}},e["default"]=function(e,t){var i=new r;e(n("",i,this.delegate)),a([],i,function(e){t?t(this,e):this.add(e)},this)}}),e("router",["./router/router","exports"],function(e,t){"use strict";var r=e["default"];t["default"]=r}),e("router/handler-info",["./utils","rsvp/promise","exports"],function(e,t,r){"use strict";function n(e){var t=e||{};s(this,t),this.initialize(t)}function i(e,t){if(!e^!t)return!1;if(!e)return!0;for(var r in e)if(e.hasOwnProperty(r)&&e[r]!==t[r])return!1;return!0}var a=e.bind,s=e.merge,o=(e.serialize,e.promiseLabel),u=e.applyHook,l=t["default"];n.prototype={name:null,handler:null,params:null,context:null,factory:null,initialize:function(){},log:function(e,t){e.log&&e.log(this.name+": "+t)},promiseLabel:function(e){return o("'"+this.name+"' "+e)},getUnresolved:function(){return this},serialize:function(){return this.params||{}},resolve:function(e,t){var r=a(this,this.checkForAbort,e),n=a(this,this.runBeforeModelHook,t),i=a(this,this.getModel,t),s=a(this,this.runAfterModelHook,t),o=a(this,this.becomeResolved,t);return l.resolve(void 0,this.promiseLabel("Start handler")).then(r,null,this.promiseLabel("Check for abort")).then(n,null,this.promiseLabel("Before model")).then(r,null,this.promiseLabel("Check if aborted during 'beforeModel' hook")).then(i,null,this.promiseLabel("Model")).then(r,null,this.promiseLabel("Check if aborted in 'model' hook")).then(s,null,this.promiseLabel("After model")).then(r,null,this.promiseLabel("Check if aborted in 'afterModel' hook")).then(o,null,this.promiseLabel("Become resolved"))},runBeforeModelHook:function(e){return e.trigger&&e.trigger(!0,"willResolveModel",e,this.handler),this.runSharedModelHook(e,"beforeModel",[])},runAfterModelHook:function(e,t){var r=this.name;return this.stashResolvedModel(e,t),this.runSharedModelHook(e,"afterModel",[t]).then(function(){return e.resolvedModels[r]},null,this.promiseLabel("Ignore fulfillment value and return model value"))},runSharedModelHook:function(e,t,r){this.log(e,"calling "+t+" hook"),this.queryParams&&r.push(this.queryParams),r.push(e);var n=u(this.handler,t,r);return n&&n.isTransition&&(n=null),l.resolve(n,this.promiseLabel("Resolve value returned from one of the model hooks"))},getModel:null,checkForAbort:function(e,t){return l.resolve(e(),this.promiseLabel("Check for abort")).then(function(){return t},null,this.promiseLabel("Ignore fulfillment value and continue"))},stashResolvedModel:function(e,t){e.resolvedModels=e.resolvedModels||{},e.resolvedModels[this.name]=t},becomeResolved:function(e,t){var r=this.serialize(t);return e&&(this.stashResolvedModel(e,t),e.params=e.params||{},e.params[this.name]=r),this.factory("resolved",{context:t,name:this.name,handler:this.handler,params:r})},shouldSupercede:function(e){if(!e)return!0;var t=e.context===this.context;return e.name!==this.name||this.hasOwnProperty("context")&&!t||this.hasOwnProperty("params")&&!i(this.params,e.params)}},r["default"]=n}),e("router/handler-info/factory",["router/handler-info/resolved-handler-info","router/handler-info/unresolved-handler-info-by-object","router/handler-info/unresolved-handler-info-by-param","exports"],function(e,t,r,n){"use strict";function i(e,t){var r=i.klasses[e],n=new r(t||{});return n.factory=i,n}var a=e["default"],s=t["default"],o=r["default"];i.klasses={resolved:a,param:o,object:s},n["default"]=i}),e("router/handler-info/resolved-handler-info",["../handler-info","router/utils","rsvp/promise","exports"],function(e,t,r,n){"use strict";var i=e["default"],a=t.subclass,s=(t.promiseLabel,r["default"]),o=a(i,{resolve:function(e,t){return t&&t.resolvedModels&&(t.resolvedModels[this.name]=this.context),s.resolve(this,this.promiseLabel("Resolve"))},getUnresolved:function(){return this.factory("param",{name:this.name,handler:this.handler,params:this.params})},isResolved:!0});n["default"]=o}),e("router/handler-info/unresolved-handler-info-by-object",["../handler-info","router/utils","rsvp/promise","exports"],function(e,t,r,n){"use strict";var i=e["default"],a=(t.merge,t.subclass),s=(t.promiseLabel,t.isParam),o=r["default"],u=a(i,{getModel:function(e){return this.log(e,this.name+": resolving provided model"),o.resolve(this.context)},initialize:function(e){this.names=e.names||[],this.context=e.context},serialize:function(e){var t=e||this.context,r=this.names,n=this.handler,i={};if(s(t))return i[r[0]]=t,i;if(n.serialize)return n.serialize(t,r);if(1===r.length){var a=r[0];return/_id$/.test(a)?i[a]=t.id:i[a]=t,i}}});n["default"]=u}),e("router/handler-info/unresolved-handler-info-by-param",["../handler-info","router/utils","exports"],function(e,t,r){"use strict";var n=e["default"],i=t.resolveHook,a=t.merge,s=t.subclass,o=(t.promiseLabel,s(n,{initialize:function(e){this.params=e.params||{}},getModel:function(e){var t=this.params;e&&e.queryParams&&(t={},a(t,this.params),t.queryParams=e.queryParams);var r=this.handler,n=i(r,"deserialize")||i(r,"model");return this.runSharedModelHook(e,n,[t])}}));r["default"]=o}),e("router/router",["route-recognizer","rsvp/promise","./utils","./transition-state","./transition","./transition-intent/named-transition-intent","./transition-intent/url-transition-intent","./handler-info","exports"],function(e,t,r,n,i,a,s,o,u){"use strict";function l(e){var t=e||{};this.getHandler=t.getHandler||this.getHandler,this.updateURL=t.updateURL||this.updateURL,this.replaceURL=t.replaceURL||this.replaceURL,this.didTransition=t.didTransition||this.didTransition,this.willTransition=t.willTransition||this.willTransition,this.delegate=t.delegate||this.delegate,this.triggerEvent=t.triggerEvent||this.triggerEvent,this.log=t.log||this.log,this.recognizer=new w,this.reset()}function c(e,t){var r,n=!!this.activeTransition,i=n?this.activeTransition.state:this.state,a=e.applyToState(i,this.recognizer,this.getHandler,t),s=N(i.queryParams,a.queryParams);return b(a.handlerInfos,i.handlerInfos)?s&&(r=this.queryParamsTransition(s,n,i,a))?r:this.activeTransition||new V(this):t?void m(this,a):(r=new V(this,e,a),this.activeTransition&&this.activeTransition.abort(),this.activeTransition=r,r.promise=r.promise.then(function(e){return v(r,e.state)},null,T("Settle transition promise when transition is finalized")),n||_(this,a,r),h(this,a,s),r)}function h(e,t,r){r&&(e._changedQueryParams=r.all,C(e,t.handlerInfos,!0,["queryParamsDidChange",r.changed,r.all,r.removed]),e._changedQueryParams=null)}function m(e,t,r){var n,i,a,s=f(e.state,t);for(n=0,i=s.exited.length;i>n;n++)a=s.exited[n].handler,delete a.context,k(a,"reset",!0,r),k(a,"exit",r);var o=e.oldState=e.state;e.state=t;var u=e.currentHandlerInfos=s.unchanged.slice();try{for(n=0,i=s.reset.length;i>n;n++)a=s.reset[n].handler,k(a,"reset",!1,r);for(n=0,i=s.updatedContext.length;i>n;n++)d(u,s.updatedContext[n],!1,r);for(n=0,i=s.entered.length;i>n;n++)d(u,s.entered[n],!0,r)}catch(l){throw e.state=o,e.currentHandlerInfos=o.handlerInfos,l}e.state.queryParams=y(e,u,t.queryParams,r)}function d(e,t,r,n){var i=t.handler,a=t.context;if(r&&k(i,"enter",n),n&&n.isAborted)throw new j;if(i.context=a,k(i,"contextDidChange"),k(i,"setup",a,n),n&&n.isAborted)throw new j;return e.push(t),!0}function f(e,t){var r,n,i,a=e.handlerInfos,s=t.handlerInfos,o={updatedContext:[],exited:[],entered:[],unchanged:[]},u=!1;for(n=0,i=s.length;i>n;n++){var l=a[n],c=s[n];l&&l.handler===c.handler||(r=!0),r?(o.entered.push(c),l&&o.exited.unshift(l)):u||l.context!==c.context?(u=!0,o.updatedContext.push(c)):o.unchanged.push(l)}for(n=s.length,i=a.length;i>n;n++)o.exited.unshift(a[n]);return o.reset=o.updatedContext.slice(),o.reset.reverse(),o}function p(e,t,r){var n=e.urlMethod;if(n){for(var i=e.router,a=t.handlerInfos,s=a[a.length-1].name,o={},u=a.length-1;u>=0;--u){var l=a[u];S(o,l.params),l.handler.inaccessibleByURL&&(n=null)}if(n){o.queryParams=e._visibleQueryParams||t.queryParams;var c=i.recognizer.generate(s,o);"replace"===n?i.replaceURL(c):i.updateURL(c)}}}function v(e,t){try{E(e.router,e.sequence,"Resolved all models on destination route; finalizing transition.");{var r=e.router,n=t.handlerInfos;e.sequence}return m(r,t,e),e.isAborted?(r.state.handlerInfos=r.currentHandlerInfos,x.reject(I(e))):(p(e,t,e.intent.url),e.isActive=!1,r.activeTransition=null,C(r,r.currentHandlerInfos,!0,["didTransition"]),r.didTransition&&r.didTransition(r.currentHandlerInfos),E(r,e.sequence,"TRANSITION COMPLETE."),n[n.length-1].handler)}catch(i){if(!(i instanceof j)){var a=e.state.handlerInfos;e.trigger(!0,"error",i,e,a[a.length-1].handler),e.abort()}throw i}}function g(e,t,r){var n=t[0]||"/",i=t[t.length-1],a={};i&&i.hasOwnProperty("queryParams")&&(a=F.call(t).queryParams);var s;if(0===t.length){E(e,"Updating query params");var o=e.state.handlerInfos;s=new R({name:o[o.length-1].name,contexts:[],queryParams:a})}else"/"===n.charAt(0)?(E(e,"Attempting URL transition to "+n),s=new D({url:n})):(E(e,"Attempting transition to "+n),s=new R({name:t[0],contexts:O.call(t,1),queryParams:a}));return e.transitionByIntent(s,r)}function b(e,t){if(e.length!==t.length)return!1;for(var r=0,n=e.length;n>r;++r)if(e[r]!==t[r])return!1;return!0}function y(e,t,r,n){for(var i in r)r.hasOwnProperty(i)&&null===r[i]&&delete r[i];var a=[];C(e,t,!0,["finalizeQueryParamChange",r,a,n]),n&&(n._visibleQueryParams={});for(var s={},o=0,u=a.length;u>o;++o){var l=a[o];s[l.key]=l.value,n&&l.visible!==!1&&(n._visibleQueryParams[l.key]=l.value)}return s}function _(e,t,r){var n,i,a,s,o,u,l=e.state.handlerInfos,c=[],h=null;for(s=l.length,a=0;s>a;a++){if(o=l[a],u=t.handlerInfos[a],!u||o.name!==u.name){h=a;break}u.isResolved||c.push(o)}null!==h&&(n=l.slice(h,s),i=function(e){for(var t=0,r=n.length;r>t;t++)if(n[t].name===e)return!0;return!1}),C(e,l,!0,["willTransition",r]),e.willTransition&&e.willTransition(l,t.handlerInfos,r)}var w=e["default"],x=t["default"],C=r.trigger,E=r.log,O=r.slice,P=r.forEach,S=r.merge,A=(r.serialize,r.extractQueryParams),N=r.getChangelist,T=r.promiseLabel,k=r.callHook,M=n["default"],I=i.logAbort,V=i.Transition,j=i.TransitionAborted,R=a["default"],D=s["default"],F=(o.ResolvedHandlerInfo,Array.prototype.pop);l.prototype={map:function(e){this.recognizer.delegate=this.delegate,this.recognizer.map(e,function(e,t){for(var r=t.length-1,n=!0;r>=0&&n;--r){var i=t[r];e.add(t,{as:i.handler}),n="/"===i.path||""===i.path||".index"===i.handler.slice(-6)}})},hasRoute:function(e){return this.recognizer.hasRoute(e)},getHandler:function(){},queryParamsTransition:function(e,t,r,n){var i=this;if(h(this,n,e),!t&&this.activeTransition)return this.activeTransition;var a=new V(this);return a.queryParamsOnly=!0,r.queryParams=y(this,n.handlerInfos,n.queryParams,a),a.promise=a.promise.then(function(e){return p(a,r,!0),i.didTransition&&i.didTransition(i.currentHandlerInfos),e},null,T("Transition complete")),a},transitionByIntent:function(e,t){try{return c.apply(this,arguments)}catch(r){return new V(this,e,null,r)}},reset:function(){this.state&&P(this.state.handlerInfos.slice().reverse(),function(e){var t=e.handler;k(t,"exit")}),this.state=new M,this.currentHandlerInfos=null},activeTransition:null,handleURL:function(e){var t=O.call(arguments);return"/"!==e.charAt(0)&&(t[0]="/"+e),g(this,t).method(null)},updateURL:function(){throw new Error("updateURL is not implemented")},replaceURL:function(e){this.updateURL(e)},transitionTo:function(e){return g(this,arguments)},intermediateTransitionTo:function(e){return g(this,arguments,!0)},refresh:function(e){for(var t=this.activeTransition?this.activeTransition.state:this.state,r=t.handlerInfos,n={},i=0,a=r.length;a>i;++i){var s=r[i];n[s.name]=s.params||{}}E(this,"Starting a refresh transition");var o=new R({name:r[r.length-1].name,pivotHandler:e||r[0].handler,contexts:[],queryParams:this._changedQueryParams||t.queryParams||{}});return this.transitionByIntent(o,!1)},replaceWith:function(e){return g(this,arguments).method("replace")},generate:function(e){for(var t=A(O.call(arguments,1)),r=t[0],n=t[1],i=new R({name:e,contexts:r}),a=i.applyToState(this.state,this.recognizer,this.getHandler),s={},o=0,u=a.handlerInfos.length;u>o;++o){var l=a.handlerInfos[o],c=l.serialize();S(s,c)}return s.queryParams=n,this.recognizer.generate(e,s)},applyIntent:function(e,t){var r=new R({name:e,contexts:t}),n=this.activeTransition&&this.activeTransition.state||this.state;return r.applyToState(n,this.recognizer,this.getHandler)},isActiveIntent:function(e,t,r,n){var i,a,s=n||this.state,o=s.handlerInfos;if(!o.length)return!1;var u=o[o.length-1].name,l=this.recognizer.handlersFor(u),c=0;for(a=l.length;a>c&&(i=o[c],i.name!==e);++c);if(c===l.length)return!1;var h=new M;h.handlerInfos=o.slice(0,c+1),l=l.slice(0,c+1);var m=new R({name:u,contexts:t}),d=m.applyToHandlers(h,l,this.getHandler,u,!0,!0),f=b(d.handlerInfos,h.handlerInfos);if(!r||!f)return f;var p={};S(p,r);var v=s.queryParams;for(var g in v)v.hasOwnProperty(g)&&p.hasOwnProperty(g)&&(p[g]=v[g]);return f&&!N(p,r)},isActive:function(e){var t=A(O.call(arguments,1));return this.isActiveIntent(e,t[0],t[1])},trigger:function(e){var t=O.call(arguments);C(this,this.currentHandlerInfos,!1,t)},log:null},u["default"]=l}),e("router/transition-intent",["./utils","exports"],function(e,t){"use strict";function r(e){this.initialize(e),this.data=this.data||{}}e.merge;r.prototype={initialize:null,applyToState:null},t["default"]=r}),e("router/transition-intent/named-transition-intent",["../transition-intent","../transition-state","../handler-info/factory","../utils","exports"],function(e,t,r,n,i){"use strict";var a=e["default"],s=t["default"],o=r["default"],u=n.isParam,l=n.extractQueryParams,c=n.merge,h=n.subclass;i["default"]=h(a,{name:null,pivotHandler:null,contexts:null,queryParams:null,initialize:function(e){this.name=e.name,this.pivotHandler=e.pivotHandler,this.contexts=e.contexts||[],this.queryParams=e.queryParams},applyToState:function(e,t,r,n){var i=l([this.name].concat(this.contexts)),a=i[0],s=(i[1],t.handlersFor(a[0])),o=s[s.length-1].handler;return this.applyToHandlers(e,s,r,o,n)},applyToHandlers:function(e,t,r,n,i,a){var o,u,l=new s,h=this.contexts.slice(0),m=t.length;if(this.pivotHandler)for(o=0,u=t.length;u>o;++o)if(r(t[o].handler)===this.pivotHandler){m=o;break}!this.pivotHandler;for(o=t.length-1;o>=0;--o){var d=t[o],f=d.handler,p=r(f),v=e.handlerInfos[o],g=null;if(g=d.names.length>0?o>=m?this.createParamHandlerInfo(f,p,d.names,h,v):this.getHandlerInfoForDynamicSegment(f,p,d.names,h,v,n,o):this.createParamHandlerInfo(f,p,d.names,h,v),
a){g=g.becomeResolved(null,g.context);var b=v&&v.context;d.names.length>0&&g.context===b&&(g.params=v&&v.params),g.context=b}var y=v;(o>=m||g.shouldSupercede(v))&&(m=Math.min(o,m),y=g),i&&!a&&(y=y.becomeResolved(null,y.context)),l.handlerInfos.unshift(y)}if(h.length>0)throw new Error("More context objects were passed than there are dynamic segments for the route: "+n);return i||this.invalidateChildren(l.handlerInfos,m),c(l.queryParams,this.queryParams||{}),l},invalidateChildren:function(e,t){for(var r=t,n=e.length;n>r;++r){{e[r]}e[r]=e[r].getUnresolved()}},getHandlerInfoForDynamicSegment:function(e,t,r,n,i,a,s){{var l;r.length}if(n.length>0){if(l=n[n.length-1],u(l))return this.createParamHandlerInfo(e,t,r,n,i);n.pop()}else{if(i&&i.name===e)return i;if(!this.preTransitionState)return i;var c=this.preTransitionState.handlerInfos[s];l=c&&c.context}return o("object",{name:e,handler:t,context:l,names:r})},createParamHandlerInfo:function(e,t,r,n,i){for(var a={},s=r.length;s--;){var l=i&&e===i.name&&i.params||{},c=n[n.length-1],h=r[s];if(u(c))a[h]=""+n.pop();else{if(!l.hasOwnProperty(h))throw new Error("You didn't provide enough string/numeric parameters to satisfy all of the dynamic segments for route "+e);a[h]=l[h]}}return o("param",{name:e,handler:t,params:a})}})}),e("router/transition-intent/url-transition-intent",["../transition-intent","../transition-state","../handler-info/factory","../utils","./../unrecognized-url-error","exports"],function(e,t,r,n,i,a){"use strict";var s=e["default"],o=t["default"],u=r["default"],l=(n.oCreate,n.merge),c=n.subclass,h=i["default"];a["default"]=c(s,{url:null,initialize:function(e){this.url=e.url},applyToState:function(e,t,r){var n,i,a=new o,s=t.recognize(this.url);if(!s)throw new h(this.url);var c=!1;for(n=0,i=s.length;i>n;++n){var m=s[n],d=m.handler,f=r(d);if(f.inaccessibleByURL)throw new h(this.url);var p=u("param",{name:d,handler:f,params:m.params}),v=e.handlerInfos[n];c||p.shouldSupercede(v)?(c=!0,a.handlerInfos[n]=p):a.handlerInfos[n]=v}return l(a.queryParams,s.queryParams),a}})}),e("router/transition-state",["./handler-info","./utils","rsvp/promise","exports"],function(e,t,r,n){"use strict";function i(e){this.handlerInfos=[],this.queryParams={},this.params={}}var a=(e.ResolvedHandlerInfo,t.forEach),s=t.promiseLabel,o=t.callHook,u=r["default"];i.prototype={handlerInfos:null,queryParams:null,params:null,promiseLabel:function(e){var t="";return a(this.handlerInfos,function(e){""!==t&&(t+="."),t+=e.name}),s("'"+t+"': "+e)},resolve:function(e,t){function r(){return u.resolve(e(),c.promiseLabel("Check if should continue"))["catch"](function(e){return h=!0,u.reject(e)},c.promiseLabel("Handle abort"))}function n(e){var r=c.handlerInfos,n=t.resolveIndex>=r.length?r.length-1:t.resolveIndex;return u.reject({error:e,handlerWithError:c.handlerInfos[n].handler,wasAborted:h,state:c})}function i(e){var n=c.handlerInfos[t.resolveIndex].isResolved;if(c.handlerInfos[t.resolveIndex++]=e,!n){var i=e.handler;o(i,"redirect",e.context,t)}return r().then(s,null,c.promiseLabel("Resolve handler"))}function s(){if(t.resolveIndex===c.handlerInfos.length)return{error:null,state:c};var e=c.handlerInfos[t.resolveIndex];return e.resolve(r,t).then(i,null,c.promiseLabel("Proceed"))}var l=this.params;a(this.handlerInfos,function(e){l[e.name]=e.params||{}}),t=t||{},t.resolveIndex=0;var c=this,h=!1;return u.resolve(null,this.promiseLabel("Start transition")).then(s,null,this.promiseLabel("Resolve handler"))["catch"](n,this.promiseLabel("Handle error"))}},n["default"]=i}),e("router/transition",["rsvp/promise","./handler-info","./utils","exports"],function(e,t,r,n){"use strict";function i(e,t,r,n){function s(){return u.isAborted?o.reject(void 0,h("Transition aborted - reject")):void 0}var u=this;if(this.state=r||e.state,this.intent=t,this.router=e,this.data=this.intent&&this.intent.data||{},this.resolvedModels={},this.queryParams={},n)return this.promise=o.reject(n),void(this.error=n);if(r){this.params=r.params,this.queryParams=r.queryParams,this.handlerInfos=r.handlerInfos;var l=r.handlerInfos.length;l&&(this.targetName=r.handlerInfos[l-1].name);for(var c=0;l>c;++c){var m=r.handlerInfos[c];if(!m.isResolved)break;this.pivotHandler=m.handler}this.sequence=i.currentSequence++,this.promise=r.resolve(s,this)["catch"](function(e){return e.wasAborted||u.isAborted?o.reject(a(u)):(u.trigger("error",e.error,u,e.handlerWithError),u.abort(),o.reject(e.error))},h("Handle Abort"))}else this.promise=o.resolve(this.state),this.params={}}function a(e){return c(e.router,e.sequence,"detected abort."),new s}function s(e){this.message=e||"TransitionAborted",this.name="TransitionAborted"}var o=e["default"],u=(t.ResolvedHandlerInfo,r.trigger),l=r.slice,c=r.log,h=r.promiseLabel;i.currentSequence=0,i.prototype={targetName:null,urlMethod:"update",intent:null,params:null,pivotHandler:null,resolveIndex:0,handlerInfos:null,resolvedModels:null,isActive:!0,state:null,queryParamsOnly:!1,isTransition:!0,isExiting:function(e){for(var t=this.handlerInfos,r=0,n=t.length;n>r;++r){var i=t[r];if(i.name===e||i.handler===e)return!1}return!0},promise:null,data:null,then:function(e,t,r){return this.promise.then(e,t,r)},"catch":function(e,t){return this.promise["catch"](e,t)},"finally":function(e,t){return this.promise["finally"](e,t)},abort:function(){return this.isAborted?this:(c(this.router,this.sequence,this.targetName+": transition was aborted"),this.intent.preTransitionState=this.router.state,this.isAborted=!0,this.isActive=!1,this.router.activeTransition=null,this)},retry:function(){return this.abort(),this.router.transitionByIntent(this.intent,!1)},method:function(e){return this.urlMethod=e,this},trigger:function(e){var t=l.call(arguments);"boolean"==typeof e?t.shift():e=!1,u(this.router,this.state.handlerInfos.slice(0,this.resolveIndex+1),e,t)},followRedirects:function(){var e=this.router;return this.promise["catch"](function(t){return e.activeTransition?e.activeTransition.followRedirects():o.reject(t)})},toString:function(){return"Transition (sequence "+this.sequence+")"},log:function(e){c(this.router,this.sequence,e)}},i.prototype.send=i.prototype.trigger,n.Transition=i,n.logAbort=a,n.TransitionAborted=s}),e("router/unrecognized-url-error",["./utils","exports"],function(e,t){"use strict";function r(e){this.message=e||"UnrecognizedURLError",this.name="UnrecognizedURLError",Error.call(this)}var n=e.oCreate;r.prototype=n(Error.prototype),t["default"]=r}),e("router/utils",["exports"],function(e){"use strict";function t(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}function r(e){var t,r,n=e&&e.length;return n&&n>0&&e[n-1]&&e[n-1].hasOwnProperty("queryParams")?(r=e[n-1].queryParams,t=v.call(e,0,n-1),[t,r]):[e,null]}function n(e){for(var t in e)if("number"==typeof e[t])e[t]=""+e[t];else if(g(e[t]))for(var r=0,n=e[t].length;n>r;r++)e[t][r]=""+e[t][r]}function i(e,t,r){e.log&&(3===arguments.length?e.log("Transition #"+t+": "+r):(r=t,e.log(r)))}function a(e,t){var r=arguments;return function(n){var i=v.call(r,2);return i.push(n),t.apply(e,i)}}function s(e){return"string"==typeof e||e instanceof String||"number"==typeof e||e instanceof Number}function o(e,t){for(var r=0,n=e.length;n>r&&!1!==t(e[r]);r++);}function u(e,t,r,n){if(e.triggerEvent)return void e.triggerEvent(t,r,n);var i=n.shift();if(!t){if(r)return;throw new Error("Could not trigger event '"+i+"'. There are no active handlers")}for(var a=!1,s=t.length-1;s>=0;s--){var o=t[s],u=o.handler;if(u.events&&u.events[i]){if(u.events[i].apply(u,n)!==!0)return;a=!0}}if(!a&&!r)throw new Error("Nothing handled the event '"+i+"'.")}function l(e,r){var i,a={all:{},changed:{},removed:{}};t(a.all,r);var s=!1;n(e),n(r);for(i in e)e.hasOwnProperty(i)&&(r.hasOwnProperty(i)||(s=!0,a.removed[i]=e[i]));for(i in r)if(r.hasOwnProperty(i))if(g(e[i])&&g(r[i]))if(e[i].length!==r[i].length)a.changed[i]=r[i],s=!0;else for(var o=0,u=e[i].length;u>o;o++)e[i][o]!==r[i][o]&&(a.changed[i]=r[i],s=!0);else e[i]!==r[i]&&(a.changed[i]=r[i],s=!0);return s&&a}function c(e){return"Router: "+e}function h(e,r){function n(t){e.call(this,t||{})}return n.prototype=b(e.prototype),t(n.prototype,r),n}function m(e,t){if(e){var r="_"+t;return e[r]&&r||e[t]&&t}}function d(e,t,r,n){var i=m(e,t);return i&&e[i].call(e,r,n)}function f(e,t,r){var n=m(e,t);return n?0===r.length?e[n].call(e):1===r.length?e[n].call(e,r[0]):2===r.length?e[n].call(e,r[0],r[1]):e[n].apply(e,r):void 0}var p,v=Array.prototype.slice;p=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var g=p;e.isArray=g;var b=Object.create||function(e){function t(){}return t.prototype=e,new t};e.oCreate=b,e.extractQueryParams=r,e.log=i,e.bind=a,e.forEach=o,e.trigger=u,e.getChangelist=l,e.promiseLabel=c,e.subclass=h,e.merge=t,e.slice=v,e.isParam=s,e.coerceQueryParamsToString=n,e.callHook=d,e.resolveHook=m,e.applyHook=f}),e("rsvp",["./rsvp/promise","./rsvp/events","./rsvp/node","./rsvp/all","./rsvp/all-settled","./rsvp/race","./rsvp/hash","./rsvp/hash-settled","./rsvp/rethrow","./rsvp/defer","./rsvp/config","./rsvp/map","./rsvp/resolve","./rsvp/reject","./rsvp/filter","./rsvp/asap","exports"],function(e,t,r,n,i,a,s,o,u,l,c,h,m,d,f,p,v){"use strict";function g(e,t){T.async(e,t)}function b(){T.on.apply(T,arguments)}function y(){T.off.apply(T,arguments)}var _=e["default"],w=t["default"],x=r["default"],C=n["default"],E=i["default"],O=a["default"],P=s["default"],S=o["default"],A=u["default"],N=l["default"],T=c.config,k=c.configure,M=h["default"],I=m["default"],V=d["default"],j=f["default"],R=p["default"];T.async=R;var D=I;if("undefined"!=typeof window&&"object"==typeof window.__PROMISE_INSTRUMENTATION__){var F=window.__PROMISE_INSTRUMENTATION__;k("instrument",!0);for(var L in F)F.hasOwnProperty(L)&&b(L,F[L])}v.cast=D,v.Promise=_,v.EventTarget=w,v.all=C,v.allSettled=E,v.race=O,v.hash=P,v.hashSettled=S,v.rethrow=A,v.defer=N,v.denodeify=x,v.configure=k,v.on=b,v.off=y,v.resolve=I,v.reject=V,v.async=g,v.map=M,v.filter=j}),e("rsvp.umd",["./rsvp"],function(t){"use strict";var r=t.Promise,n=t.allSettled,i=t.hash,a=t.hashSettled,s=t.denodeify,o=t.on,u=t.off,l=t.map,c=t.filter,h=t.resolve,m=t.reject,d=t.rethrow,f=t.all,p=t.defer,v=t.EventTarget,g=t.configure,b=t.race,y=t.async,_={race:b,Promise:r,allSettled:n,hash:i,hashSettled:a,denodeify:s,on:o,off:u,map:l,filter:c,resolve:h,reject:m,all:f,rethrow:d,defer:p,EventTarget:v,configure:g,async:y};"function"==typeof e&&e.amd?e(function(){return _}):"undefined"!=typeof module&&module.exports?module.exports=_:"undefined"!=typeof this&&(this.RSVP=_)}),e("rsvp/-internal",["./utils","./instrument","./config","exports"],function(e,t,r,n){"use strict";function i(){return new TypeError("A promises callback cannot return that same promise.")}function a(){}function s(e){try{return e.then}catch(t){return A.error=t,A}}function o(e,t,r,n){try{e.call(t,r,n)}catch(i){return i}}function u(e,t,r){E.async(function(e){var n=!1,i=o(r,t,function(r){n||(n=!0,t!==r?h(e,r):d(e,r))},function(t){n||(n=!0,f(e,t))},"Settle: "+(e._label||" unknown promise"));!n&&i&&(n=!0,f(e,i))},e)}function l(e,t){t._state===P?d(e,t._result):e._state===S?f(e,t._result):p(t,void 0,function(r){t!==r?h(e,r):d(e,r)},function(t){f(e,t)})}function c(e,t){if(t.constructor===e.constructor)l(e,t);else{var r=s(t);r===A?f(e,A.error):void 0===r?d(e,t):x(r)?u(e,t,r):d(e,t)}}function h(e,t){e===t?d(e,t):w(t)?c(e,t):d(e,t)}function m(e){e._onerror&&e._onerror(e._result),v(e)}function d(e,t){e._state===O&&(e._result=t,e._state=P,0===e._subscribers.length?E.instrument&&C("fulfilled",e):E.async(v,e))}function f(e,t){e._state===O&&(e._state=S,e._result=t,E.async(m,e))}function p(e,t,r,n){var i=e._subscribers,a=i.length;e._onerror=null,i[a]=t,i[a+P]=r,i[a+S]=n,0===a&&e._state&&E.async(v,e)}function v(e){var t=e._subscribers,r=e._state;if(E.instrument&&C(r===P?"fulfilled":"rejected",e),0!==t.length){for(var n,i,a=e._result,s=0;s<t.length;s+=3)n=t[s],i=t[s+r],n?y(r,n,i,a):i(a);e._subscribers.length=0}}function g(){this.error=null}function b(e,t){try{return e(t)}catch(r){return N.error=r,N}}function y(e,t,r,n){var a,s,o,u,l=x(r);if(l){if(a=b(r,n),a===N?(u=!0,s=a.error,a=null):o=!0,t===a)return void f(t,i())}else a=n,o=!0;t._state!==O||(l&&o?h(t,a):u?f(t,s):e===P?d(t,a):e===S&&f(t,a))}function _(e,t){try{t(function(t){h(e,t)},function(t){f(e,t)})}catch(r){f(e,r)}}var w=e.objectOrFunction,x=e.isFunction,C=t["default"],E=r.config,O=void 0,P=1,S=2,A=new g,N=new g;n.noop=a,n.resolve=h,n.reject=f,n.fulfill=d,n.subscribe=p,n.publish=v,n.publishRejection=m,n.initializePromise=_,n.invokeCallback=y,n.FULFILLED=P,n.REJECTED=S,n.PENDING=O}),e("rsvp/all-settled",["./enumerator","./promise","./utils","exports"],function(e,t,r,n){"use strict";function i(e,t,r){this._superConstructor(e,t,!1,r)}var a=e["default"],s=e.makeSettledResult,o=t["default"],u=r.o_create;i.prototype=u(a.prototype),i.prototype._superConstructor=a,i.prototype._makeResult=s,i.prototype._validationError=function(){return new Error("allSettled must be called with an array")},n["default"]=function(e,t){return new i(o,e,t).promise}}),e("rsvp/all",["./promise","exports"],function(e,t){"use strict";var r=e["default"];t["default"]=function(e,t){return r.all(e,t)}}),e("rsvp/asap",["exports"],function(e){"use strict";function t(){return function(){process.nextTick(o)}}function n(){return function(){vertxNext(o)}}function i(){var e=0,t=new d(o),r=document.createTextNode("");return t.observe(r,{characterData:!0}),function(){r.data=e=++e%2}}function a(){var e=new MessageChannel;return e.port1.onmessage=o,function(){e.port2.postMessage(0)}}function s(){return function(){setTimeout(o,1)}}function o(){for(var e=0;l>e;e+=2){var t=p[e],r=p[e+1];t(r),p[e]=void 0,p[e+1]=void 0}l=0}function u(){try{{var e=r("vertx");e.runOnLoop||e.runOnContext}return n()}catch(t){return s()}}var l=0;e["default"]=function(e,t){p[l]=e,p[l+1]=t,l+=2,2===l&&c()};var c,h="undefined"!=typeof window?window:void 0,m=h||{},d=m.MutationObserver||m.WebKitMutationObserver,f="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,p=new Array(1e3);c="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?t():d?i():f?a():void 0===h&&"function"==typeof r?u():s()}),e("rsvp/config",["./events","exports"],function(e,t){"use strict";function r(e,t){return"onerror"===e?void i.on("error",t):2!==arguments.length?i[e]:void(i[e]=t)}var n=e["default"],i={instrument:!1};n.mixin(i),t.config=i,t.configure=r}),e("rsvp/defer",["./promise","exports"],function(e,t){"use strict";var r=e["default"];t["default"]=function(e){var t={};return t.promise=new r(function(e,r){t.resolve=e,t.reject=r},e),t}}),e("rsvp/enumerator",["./utils","./-internal","exports"],function(e,t,r){"use strict";function n(e,t,r){return e===h?{state:"fulfilled",value:r}:{state:"rejected",reason:r}}function i(e,t,r,n){this._instanceConstructor=e,this.promise=new e(o,n),this._abortOnReject=r,this._validateInput(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._init(),0===this.length?l(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&l(this.promise,this._result))):u(this.promise,this._validationError())}var a=e.isArray,s=e.isMaybeThenable,o=t.noop,u=t.reject,l=t.fulfill,c=t.subscribe,h=t.FULFILLED,m=t.REJECTED,d=t.PENDING;r.makeSettledResult=n,i.prototype._validateInput=function(e){return a(e)},i.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},i.prototype._init=function(){this._result=new Array(this.length)},r["default"]=i,i.prototype._enumerate=function(){for(var e=this.length,t=this.promise,r=this._input,n=0;t._state===d&&e>n;n++)this._eachEntry(r[n],n)},i.prototype._eachEntry=function(e,t){var r=this._instanceConstructor;s(e)?e.constructor===r&&e._state!==d?(e._onerror=null,this._settledAt(e._state,t,e._result)):this._willSettleAt(r.resolve(e),t):(this._remaining--,this._result[t]=this._makeResult(h,t,e))},i.prototype._settledAt=function(e,t,r){var n=this.promise;n._state===d&&(this._remaining--,this._abortOnReject&&e===m?u(n,r):this._result[t]=this._makeResult(e,t,r)),0===this._remaining&&l(n,this._result)},i.prototype._makeResult=function(e,t,r){return r},i.prototype._willSettleAt=function(e,t){var r=this;c(e,void 0,function(e){r._settledAt(h,t,e)},function(e){r._settledAt(m,t,e)})}}),e("rsvp/events",["exports"],function(e){"use strict";function t(e,t){for(var r=0,n=e.length;n>r;r++)if(e[r]===t)return r;return-1}function r(e){var t=e._promiseCallbacks;return t||(t=e._promiseCallbacks={}),t}e["default"]={mixin:function(e){return e.on=this.on,e.off=this.off,e.trigger=this.trigger,e._promiseCallbacks=void 0,e},on:function(e,n){var i,a=r(this);i=a[e],i||(i=a[e]=[]),-1===t(i,n)&&i.push(n)},off:function(e,n){var i,a,s=r(this);return n?(i=s[e],a=t(i,n),void(-1!==a&&i.splice(a,1))):void(s[e]=[])},trigger:function(e,t){var n,i,a=r(this);if(n=a[e])for(var s=0;s<n.length;s++)(i=n[s])(t)}}}),e("rsvp/filter",["./promise","./utils","exports"],function(e,t,r){"use strict";var n=e["default"],i=t.isFunction;r["default"]=function(e,t,r){return n.all(e,r).then(function(e){if(!i(t))throw new TypeError("You must pass a function as filter's second argument.");for(var a=e.length,s=new Array(a),o=0;a>o;o++)s[o]=t(e[o]);return n.all(s,r).then(function(t){for(var r=new Array(a),n=0,i=0;a>i;i++)t[i]&&(r[n]=e[i],n++);return r.length=n,r})})}}),e("rsvp/hash-settled",["./promise","./enumerator","./promise-hash","./utils","exports"],function(e,t,r,n,i){"use strict";function a(e,t,r){this._superConstructor(e,t,!1,r)}var s=e["default"],o=t.makeSettledResult,u=r["default"],l=t["default"],c=n.o_create;a.prototype=c(u.prototype),a.prototype._superConstructor=l,a.prototype._makeResult=o,a.prototype._validationError=function(){return new Error("hashSettled must be called with an object")},i["default"]=function(e,t){return new a(s,e,t).promise}}),e("rsvp/hash",["./promise","./promise-hash","exports"],function(e,t,r){"use strict";var n=e["default"],i=t["default"];r["default"]=function(e,t){return new i(n,e,t).promise}}),e("rsvp/instrument",["./config","./utils","exports"],function(e,t,r){"use strict";function n(){setTimeout(function(){for(var e,t=0;t<s.length;t++){e=s[t];var r=e.payload;r.guid=r.key+r.id,r.childGuid=r.key+r.childId,r.error&&(r.stack=r.error.stack),i.trigger(e.name,e.payload)}s.length=0},50)}var i=e.config,a=t.now,s=[];r["default"]=function(e,t,r){1===s.push({name:e,payload:{key:t._guidKey,id:t._id,eventName:e,detail:t._result,childId:r&&r._id,label:t._label,timeStamp:a(),error:i["instrument-with-stack"]?new Error(t._label):null}})&&n()}}),e("rsvp/map",["./promise","./utils","exports"],function(e,t,r){"use strict";var n=e["default"],i=t.isFunction;r["default"]=function(e,t,r){return n.all(e,r).then(function(e){if(!i(t))throw new TypeError("You must pass a function as map's second argument.");for(var a=e.length,s=new Array(a),o=0;a>o;o++)s[o]=t(e[o]);return n.all(s,r)})}}),e("rsvp/node",["./promise","./-internal","./utils","exports"],function(e,t,r,n){"use strict";function i(){this.value=void 0}function a(e){try{return e.then}catch(t){return b.value=t,b}}function s(e,t,r){try{e.apply(t,r)}catch(n){return b.value=n,b}}function o(e,t){for(var r,n,i={},a=e.length,s=new Array(a),o=0;a>o;o++)s[o]=e[o];for(n=0;n<t.length;n++)r=t[n],i[r]=s[n+1];return i}function u(e){for(var t=e.length,r=new Array(t-1),n=1;t>n;n++)r[n-1]=e[n];return r}function l(e,t){return{then:function(r,n){return e.call(t,r,n)}}}function c(e,t,r,n){var i=s(r,n,t);return i===b&&v(e,i.value),e}function h(e,t,r,n){return d.all(t).then(function(t){var i=s(r,n,t);return i===b&&v(e,i.value),e})}function m(e){return e&&"object"==typeof e?e.constructor===d?!0:a(e):!1}var d=e["default"],f=t.noop,p=t.resolve,v=t.reject,g=r.isArray,b=new i,y=new i;n["default"]=function(e,t){var r=function(){for(var r,n=this,i=arguments.length,a=new Array(i+1),s=!1,b=0;i>b;++b){if(r=arguments[b],!s){if(s=m(r),s===y){var _=new d(f);return v(_,y.value),_}s&&s!==!0&&(r=l(s,r))}a[b]=r}var w=new d(f);return a[i]=function(e,r){e?v(w,e):void 0===t?p(w,r):t===!0?p(w,u(arguments)):g(t)?p(w,o(arguments,t)):p(w,r)},s?h(w,a,e,n):c(w,a,e,n)};return r.__proto__=e,r}}),e("rsvp/promise-hash",["./enumerator","./-internal","./utils","exports"],function(e,t,r,n){"use strict";function i(e,t,r){this._superConstructor(e,t,!0,r)}var a=e["default"],s=t.PENDING,o=r.o_create;n["default"]=i,i.prototype=o(a.prototype),i.prototype._superConstructor=a,i.prototype._init=function(){this._result={}},i.prototype._validateInput=function(e){return e&&"object"==typeof e},i.prototype._validationError=function(){return new Error("Promise.hash must be called with an object")},i.prototype._enumerate=function(){var e=this.promise,t=this._input,r=[];for(var n in t)e._state===s&&t.hasOwnProperty(n)&&r.push({position:n,entry:t[n]});var i=r.length;this._remaining=i;for(var a,o=0;e._state===s&&i>o;o++)a=r[o],this._eachEntry(a.entry,a.position)}}),e("rsvp/promise",["./config","./instrument","./utils","./-internal","./promise/all","./promise/race","./promise/resolve","./promise/reject","exports"],function(e,t,r,n,i,a,s,o,u){"use strict";function l(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function c(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function h(e,t){this._id=S++,this._label=t,this._state=void 0,this._result=void 0,this._subscribers=[],m.instrument&&d("created",this),v!==e&&(f(e)||l(),this instanceof h||c(),b(this,e))}var m=e.config,d=t["default"],f=r.isFunction,p=r.now,v=n.noop,g=n.subscribe,b=n.initializePromise,y=n.invokeCallback,_=n.FULFILLED,w=n.REJECTED,x=i["default"],C=a["default"],E=s["default"],O=o["default"],P="rsvp_"+p()+"-",S=0;u["default"]=h,h.cast=E,h.all=x,h.race=C,h.resolve=E,h.reject=O,h.prototype={constructor:h,_guidKey:P,_onerror:function(e){m.trigger("error",e)},then:function(e,t,r){var n=this,i=n._state;if(i===_&&!e||i===w&&!t)return m.instrument&&d("chained",this,this),this;n._onerror=null;var a=new this.constructor(v,r),s=n._result;if(m.instrument&&d("chained",n,a),i){var o=arguments[i-1];m.async(function(){y(i,a,o,s)})}else g(n,a,e,t);return a},"catch":function(e,t){return this.then(null,e,t)},"finally":function(e,t){var r=this.constructor;return this.then(function(t){return r.resolve(e()).then(function(){return t})},function(t){return r.resolve(e()).then(function(){throw t})},t)}}}),e("rsvp/promise/all",["../enumerator","exports"],function(e,t){"use strict";var r=e["default"];t["default"]=function(e,t){return new r(this,e,!0,t).promise}}),e("rsvp/promise/race",["../utils","../-internal","exports"],function(e,t,r){"use strict";var n=e.isArray,i=t.noop,a=t.resolve,s=t.reject,o=t.subscribe,u=t.PENDING;r["default"]=function(e,t){function r(e){a(h,e)}function l(e){s(h,e)}var c=this,h=new c(i,t);if(!n(e))return s(h,new TypeError("You must pass an array to race.")),h;for(var m=e.length,d=0;h._state===u&&m>d;d++)o(c.resolve(e[d]),void 0,r,l);return h}}),e("rsvp/promise/reject",["../-internal","exports"],function(e,t){"use strict";var r=e.noop,n=e.reject;t["default"]=function(e,t){var i=this,a=new i(r,t);return n(a,e),a}}),e("rsvp/promise/resolve",["../-internal","exports"],function(e,t){"use strict";var r=e.noop,n=e.resolve;t["default"]=function(e,t){var i=this;if(e&&"object"==typeof e&&e.constructor===i)return e;var a=new i(r,t);return n(a,e),a}}),e("rsvp/race",["./promise","exports"],function(e,t){"use strict";var r=e["default"];t["default"]=function(e,t){return r.race(e,t)}}),e("rsvp/reject",["./promise","exports"],function(e,t){"use strict";var r=e["default"];t["default"]=function(e,t){return r.reject(e,t)}}),e("rsvp/resolve",["./promise","exports"],function(e,t){"use strict";var r=e["default"];t["default"]=function(e,t){return r.resolve(e,t)}}),e("rsvp/rethrow",["exports"],function(e){"use strict";e["default"]=function(e){throw setTimeout(function(){throw e}),e}}),e("rsvp/utils",["exports"],function(e){"use strict";function t(e){return"function"==typeof e||"object"==typeof e&&null!==e}function r(e){return"function"==typeof e}function n(e){return"object"==typeof e&&null!==e}function i(){}e.objectOrFunction=t,e.isFunction=r,e.isMaybeThenable=n;var a;a=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var s=a;e.isArray=s;var o=Date.now||function(){return(new Date).getTime()};e.now=o;var u=Object.create||function(e){if(arguments.length>1)throw new Error("Second argument not supported");if("object"!=typeof e)throw new TypeError("Argument must be an object");return i.prototype=e,new i};e.o_create=u}),t("ember")}();
Ember.TEMPLATES.application=Ember.HTMLBars.template(function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createComment("");dom.appendChild(el0,el1);var el1=dom.createTextNode("\n\n");dom.appendChild(el0,el1);var el1=dom.createComment("");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,content=hooks.content;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(fragment,0,0,contextualElement),morph1=dom.createMorphAt(fragment,2,2,contextualElement);return dom.insertBoundary(fragment,null),dom.insertBoundary(fragment,0),content(env,morph0,context,"outlet"),content(env,morph1,context,"message-tray"),fragment}}}()),Ember.TEMPLATES["components/basic-message"]=Ember.HTMLBars.template(function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createElement("div");dom.setAttribute(el1,"class","basic-message__body");var el2=dom.createComment("");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"class","basic-message__dismiss");var el2=dom.createTextNode("✕");return dom.appendChild(el1,el2),dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,content=hooks.content,element=hooks.element;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var element0=dom.childAt(fragment,[2]),morph0=dom.createMorphAt(dom.childAt(fragment,[0]),0,0);return content(env,morph0,context,"message.content"),element(env,element0,context,"action",["dismiss"],{}),fragment}}}()),Ember.TEMPLATES["components/cpu-setting-node"]=Ember.HTMLBars.template(function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createElement("div");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,element=hooks.element;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var element0=dom.childAt(fragment,[0]);return element(env,element0,context,"bind-attr",[],{"class":"isEnabled willEnable willDisable"}),element(env,element0,context,"action",["enable"],{}),fragment}}}()),Ember.TEMPLATES["components/cpu-setting"]=Ember.HTMLBars.template(function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createComment("");dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");dom.appendChild(el0,el1);var el1=dom.createComment("");dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");dom.appendChild(el0,el1);var el1=dom.createComment("");dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");dom.appendChild(el0,el1);var el1=dom.createComment("");dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");dom.appendChild(el0,el1);var el1=dom.createComment("");dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");dom.appendChild(el0,el1);var el1=dom.createComment("");dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");dom.appendChild(el0,el1);var el1=dom.createComment("");dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");dom.appendChild(el0,el1);var el1=dom.createComment("");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,inline=hooks.inline;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(fragment,0,0,contextualElement),morph1=dom.createMorphAt(fragment,2,2,contextualElement),morph2=dom.createMorphAt(fragment,4,4,contextualElement),morph3=dom.createMorphAt(fragment,6,6,contextualElement),morph4=dom.createMorphAt(fragment,8,8,contextualElement),morph5=dom.createMorphAt(fragment,10,10,contextualElement),morph6=dom.createMorphAt(fragment,12,12,contextualElement),morph7=dom.createMorphAt(fragment,14,14,contextualElement);return dom.insertBoundary(fragment,null),dom.insertBoundary(fragment,0),inline(env,morph0,context,"cpu-setting-node",[],{index:0,grid:get(env,context,"this")}),inline(env,morph1,context,"cpu-setting-node",[],{index:1,grid:get(env,context,"this")}),inline(env,morph2,context,"cpu-setting-node",[],{index:2,grid:get(env,context,"this")}),inline(env,morph3,context,"cpu-setting-node",[],{index:3,grid:get(env,context,"this")}),inline(env,morph4,context,"cpu-setting-node",[],{index:4,grid:get(env,context,"this")}),inline(env,morph5,context,"cpu-setting-node",[],{index:5,grid:get(env,context,"this")}),inline(env,morph6,context,"cpu-setting-node",[],{index:6,grid:get(env,context,"this")}),inline(env,morph7,context,"cpu-setting-node",[],{index:7,grid:get(env,context,"this")}),fragment}}}()),Ember.TEMPLATES["components/demo-detail"]=Ember.HTMLBars.template(function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createElement("div");dom.setAttribute(el1,"class","demo-detail__close"),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n\n");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"class","demo-detail__desc-container");var el2=dom.createTextNode("\n    ");dom.appendChild(el1,el2);var el2=dom.createElement("div");dom.setAttribute(el2,"class","demo-detail__desc-body");var el3=dom.createTextNode("\n        ");dom.appendChild(el2,el3);var el3=dom.createComment("");dom.appendChild(el2,el3);var el3=dom.createTextNode("\n    ");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n\n");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"class","demo-detail__aside");var el2=dom.createTextNode("\n\n    ");dom.appendChild(el1,el2);var el2=dom.createElement("ul");dom.setAttribute(el2,"class","demo-detail__resources");var el3=dom.createTextNode("\n\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("li"),el4=dom.createTextNode("\n            ");dom.appendChild(el3,el4);var el4=dom.createElement("h1"),el5=dom.createTextNode("Images avaliable");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode("\n        ");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("li"),el4=dom.createTextNode("\n            ");dom.appendChild(el3,el4);var el4=dom.createElement("h1"),el5=dom.createTextNode("Features ");dom.appendChild(el4,el5);var el5=dom.createComment("");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode("\n        ");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("li"),el4=dom.createTextNode("\n            ");dom.appendChild(el3,el4);var el4=dom.createElement("h1"),el5=dom.createTextNode("Matches ");dom.appendChild(el4,el5);var el5=dom.createComment("");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode("\n        ");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("li"),el4=dom.createTextNode("\n            ");dom.appendChild(el3,el4);var el4=dom.createElement("h1"),el5=dom.createTextNode("Calibration ");dom.appendChild(el4,el5);var el5=dom.createComment("");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode("\n        ");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("li"),el4=dom.createTextNode("\n            ");dom.appendChild(el3,el4);var el4=dom.createElement("h1"),el5=dom.createTextNode("MVS ");dom.appendChild(el4,el5);var el5=dom.createComment("");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode("\n        ");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n\n    ");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n\n    ");dom.appendChild(el1,el2);var el2=dom.createElement("div");dom.setAttribute(el2,"class","demo-detail__enter");var el3=dom.createTextNode("\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("h1"),el4=dom.createTextNode("Enter");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n    ");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n\n");return dom.appendChild(el1,el2),dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,element=hooks.element,content=hooks.content,get=hooks.get,subexpr=hooks.subexpr,concat=hooks.concat,attribute=hooks.attribute,inline=hooks.inline;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var element0=dom.childAt(fragment,[0]),element1=dom.childAt(fragment,[4]),element2=dom.childAt(element1,[1]),element3=dom.childAt(element2,[3]),element4=dom.childAt(element2,[5]),element5=dom.childAt(element2,[7]),element6=dom.childAt(element2,[9]),element7=dom.childAt(element1,[3]),morph0=dom.createUnsafeMorphAt(dom.childAt(fragment,[2,1]),1,1),attrMorph0=dom.createAttrMorph(element3,"class"),morph1=dom.createMorphAt(dom.childAt(element3,[1]),1,1),attrMorph1=dom.createAttrMorph(element4,"class"),morph2=dom.createMorphAt(dom.childAt(element4,[1]),1,1),attrMorph2=dom.createAttrMorph(element5,"class"),morph3=dom.createMorphAt(dom.childAt(element5,[1]),1,1),attrMorph3=dom.createAttrMorph(element6,"class"),morph4=dom.createMorphAt(dom.childAt(element6,[1]),1,1);return element(env,element0,context,"action",["close"],{}),content(env,morph0,context,"project.desc"),attribute(env,attrMorph0,element3,"class",concat(env,[subexpr(env,context,"if",[get(env,context,"project.hasFeature"),"","not-avaliable"],{})])),inline(env,morph1,context,"if",[get(env,context,"project.hasFeature"),"avaliable","not avaliable"],{}),attribute(env,attrMorph1,element4,"class",concat(env,[subexpr(env,context,"if",[get(env,context,"project.hasMatch"),"","not-avaliable"],{})])),inline(env,morph2,context,"if",[get(env,context,"project.hasMatch"),"avaliable","not avaliable"],{}),attribute(env,attrMorph2,element5,"class",concat(env,[subexpr(env,context,"if",[get(env,context,"project.hasCalibration"),"","not-avaliable"],{})])),inline(env,morph3,context,"if",[get(env,context,"project.hasCalibration"),"avaliable","not avaliable"],{}),attribute(env,attrMorph3,element6,"class",concat(env,[subexpr(env,context,"if",[get(env,context,"project.hasMVS"),"","not-avaliable"],{})])),inline(env,morph4,context,"if",[get(env,context,"project.hasMVS"),"avaliable","not avaliable"],{}),element(env,element7,context,"action",["enter"],{}),fragment}}}()),Ember.TEMPLATES["components/demo-thumbnail"]=Ember.HTMLBars.template(function(){var child0=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("    ");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"class","demo-thumbnail__body"),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,element=hooks.element;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var element0=dom.childAt(fragment,[1]);return element(env,element0,context,"bind-attr",[],{style:get(env,context,"backgroundStyle")}),fragment}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createElement("div");dom.setAttribute(el1,"class","demo-thumbnail__header");var el2=dom.createTextNode("\n    ");dom.appendChild(el1,el2);var el2=dom.createElement("span"),el3=dom.createComment("");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n\n");dom.appendChild(el0,el1);var el1=dom.createComment("");dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,content=hooks.content,get=hooks.get,block=hooks.block;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(dom.childAt(fragment,[0,1]),0,0),morph1=dom.createMorphAt(fragment,2,2,contextualElement);return content(env,morph0,context,"project.name"),block(env,morph1,context,"link-to",["welcome.demo",get(env,context,"project")],{},child0,null),fragment}}}()),Ember.TEMPLATES["components/floating-window"]=Ember.HTMLBars.template(function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createElement("div");dom.setAttribute(el1,"class","floating-window__input-image");var el2=dom.createTextNode("\n    ");dom.appendChild(el1,el2);var el2=dom.createElement("div");dom.setAttribute(el2,"class","floating-window__header");var el3=dom.createTextNode("\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("span");dom.setAttribute(el3,"class","floating-window__header__h1");var el4=dom.createComment("");dom.appendChild(el3,el4);var el4=dom.createTextNode(" ");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("span");dom.setAttribute(el3,"class","floating-window__header__h2");var el4=dom.createComment("");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("div");dom.appendChild(el2,el3);var el3=dom.createTextNode("\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("div");dom.setAttribute(el3,"class","exit-icon"),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n    ");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n\n    ");dom.appendChild(el1,el2);var el2=dom.createElement("div");dom.setAttribute(el2,"class","floating-window__inner-container");var el3=dom.createTextNode("\n        ");dom.appendChild(el2,el3);var el3=dom.createComment("");dom.appendChild(el2,el3);var el3=dom.createTextNode("\n    ");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n\n");return dom.appendChild(el1,el2),dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,content=hooks.content,element=hooks.element;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var element0=dom.childAt(fragment,[0]),element1=dom.childAt(element0,[1]),element2=dom.childAt(element1,[5]),element3=dom.childAt(element1,[7]),morph0=dom.createMorphAt(dom.childAt(element1,[1]),0,0),morph1=dom.createMorphAt(dom.childAt(element1,[3]),0,0),morph2=dom.createMorphAt(dom.childAt(element0,[3]),1,1);return content(env,morph0,context,"mainTitle"),content(env,morph1,context,"subTitle"),element(env,element2,context,"bind-attr",[],{"class":":load-indicator isLoading"}),element(env,element3,context,"action",["close"],{}),content(env,morph2,context,"yield"),fragment}}}()),Ember.TEMPLATES["components/image-detail"]=Ember.HTMLBars.template(function(){var child0=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("    ");dom.appendChild(el0,el1);var el1=dom.createComment("");dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,inline=hooks.inline;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(fragment,1,1,contextualElement);return inline(env,morph0,context,"dynamic-image",[],{src:get(env,context,"dataurl")}),fragment}}}(),child1=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("    ");dom.appendChild(el0,el1);var el1=dom.createElement("div"),el2=dom.createTextNode("Loading...");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom;dom.detectNamespace(contextualElement);var fragment;return env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom),fragment}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createComment("");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,block=hooks.block;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(fragment,0,0,contextualElement);return dom.insertBoundary(fragment,null),dom.insertBoundary(fragment,0),block(env,morph0,context,"if",[get(env,context,"dataurl")],{},child0,child1),fragment}}}()),Ember.TEMPLATES["components/image-gallery"]=Ember.HTMLBars.template(function(){var child0=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("    ");dom.appendChild(el0,el1);var el1=dom.createElement("li");dom.setAttribute(el1,"class","image-gallery__item");var el2=dom.createTextNode("\n        ");dom.appendChild(el1,el2);var el2=dom.createComment("");dom.appendChild(el1,el2);var el2=dom.createTextNode("\n    ");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,inline=hooks.inline;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(dom.childAt(fragment,[1]),1,1);return inline(env,morph0,context,"image-importer",[],{adapter:get(env,context,"adapter"),images:get(env,context,"images")}),fragment}}}(),child1=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("    ");dom.appendChild(el0,el1);var el1=dom.createElement("li");dom.setAttribute(el1,"class","image-gallery__item");var el2=dom.createTextNode("\n        ");dom.appendChild(el1,el2);var el2=dom.createElement("div");dom.setAttribute(el2,"class","image-gallery__thumbnail");var el3=dom.createTextNode("\n            ");dom.appendChild(el2,el3);var el3=dom.createElement("span"),el4=dom.createComment("");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n        ");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n    ");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,concat=hooks.concat,attribute=hooks.attribute,element=hooks.element,content=hooks.content;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var element0=dom.childAt(fragment,[1,1]),attrMorph0=dom.createAttrMorph(element0,"style"),morph0=dom.createMorphAt(dom.childAt(element0,[1]),0,0);return attribute(env,attrMorph0,element0,"style",concat(env,["background-image: url('",get(env,context,"img.thumbnail"),"')"])),element(env,element0,context,"action",["expand",get(env,context,"img")],{}),content(env,morph0,context,"img.id"),fragment}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createComment("");dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");dom.appendChild(el0,el1);var el1=dom.createComment("");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,block=hooks.block;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(fragment,0,0,contextualElement),morph1=dom.createMorphAt(fragment,2,2,contextualElement);return dom.insertBoundary(fragment,null),dom.insertBoundary(fragment,0),block(env,morph0,context,"if",[get(env,context,"canImport")],{},child0,null),block(env,morph1,context,"each",[get(env,context,"images")],{keyword:"img"},child1,null),fragment}}}()),Ember.TEMPLATES["components/image-importer"]=Ember.HTMLBars.template(function(){var child0=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("    ");dom.appendChild(el0,el1);var el1=dom.createElement("h1"),el2=dom.createTextNode("Drop");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom;dom.detectNamespace(contextualElement);var fragment;return env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom),fragment}}}(),child1=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("    ");dom.appendChild(el0,el1);var el1=dom.createElement("h1"),el2=dom.createTextNode("Drag");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom;dom.detectNamespace(contextualElement);var fragment;return env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom),fragment}}}(),child2=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("    ");dom.appendChild(el0,el1);var el1=dom.createElement("span"),el2=dom.createTextNode("Processing ");dom.appendChild(el1,el2);var el2=dom.createComment("");dom.appendChild(el1,el2);var el2=dom.createTextNode(" images.");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,content=hooks.content;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(dom.childAt(fragment,[1]),1,1);return content(env,morph0,context,"queue.length"),fragment}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createComment("");dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");dom.appendChild(el0,el1);var el1=dom.createComment("");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,block=hooks.block;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(fragment,0,0,contextualElement),morph1=dom.createMorphAt(fragment,2,2,contextualElement);return dom.insertBoundary(fragment,null),dom.insertBoundary(fragment,0),block(env,morph0,context,"if",[get(env,context,"isActive")],{},child0,child1),block(env,morph1,context,"if",[get(env,context,"inProgress")],{},child2,null),fragment}}}()),Ember.TEMPLATES["components/match-grid"]=Ember.HTMLBars.template(function(){var child0=function(){var child0=function(){var child0=function(){var child0=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("                        ");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"class","match-grid__cell thumbnail"),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,concat=hooks.concat,attribute=hooks.attribute;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var element0=dom.childAt(fragment,[1]),attrMorph0=dom.createAttrMorph(element0,"style");return attribute(env,attrMorph0,element0,"style",concat(env,["background-image: url('",get(env,context,"node.image.thumbnail"),"')"])),fragment}}}(),child1=function(){var child0=function(){var child0=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("                            ");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"class","match-grid__cell");var el2=dom.createTextNode("\n                                ");dom.appendChild(el1,el2);var el2=dom.createComment("");dom.appendChild(el1,el2);var el2=dom.createTextNode("\n                            ");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,inline=hooks.inline;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(dom.childAt(fragment,[1]),1,1);return inline(env,morph0,context,"match-grid-node",[],{from:get(env,context,"node.from"),to:get(env,context,"node.to"),data:get(env,context,"node"),action:"enter"}),fragment}}}(),child1=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("                            ");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"class","match-grid__cell");var el2=dom.createTextNode("\n                                ");dom.appendChild(el1,el2);var el2=dom.createElement("div");dom.setAttribute(el2,"class","match-grid__node is-false"),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n                            ");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom;dom.detectNamespace(contextualElement);var fragment;return env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom),fragment
}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createComment("");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,block=hooks.block;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(fragment,0,0,contextualElement);return dom.insertBoundary(fragment,null),dom.insertBoundary(fragment,0),block(env,morph0,context,"if",[get(env,context,"node.robust")],{},child0,child1),fragment}}}(),child1=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("                        ");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"class","match-grid__cell");var el2=dom.createTextNode("\n                            ");dom.appendChild(el1,el2);var el2=dom.createElement("div");dom.setAttribute(el2,"class","match-grid__node is-connected"),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n                        ");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n                    ");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom;dom.detectNamespace(contextualElement);var fragment;return env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom),fragment}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createComment("");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,block=hooks.block;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(fragment,0,0,contextualElement);return dom.insertBoundary(fragment,null),dom.insertBoundary(fragment,0),block(env,morph0,context,"if",[get(env,context,"node.hasRaw")],{},child0,child1),fragment}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("\n");dom.appendChild(el0,el1);var el1=dom.createComment("");dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,block=hooks.block;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(fragment,1,1,contextualElement);return block(env,morph0,context,"if",[get(env,context,"node.isDiag")],{},child0,child1),fragment}}}(),child1=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("                    ");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"class","match-grid__cell");var el2=dom.createTextNode("\n                        ");dom.appendChild(el1,el2);var el2=dom.createElement("div");dom.setAttribute(el2,"class","match-grid__node"),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n                    ");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom;dom.detectNamespace(contextualElement);var fragment;return env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom),fragment}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("\n");dom.appendChild(el0,el1);var el1=dom.createComment("");dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,block=hooks.block;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(fragment,1,1,contextualElement);return block(env,morph0,context,"if",[get(env,context,"node")],{},child0,child1),fragment}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("\n        ");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"class","match-grid__row");var el2=dom.createTextNode("\n\n");dom.appendChild(el1,el2);var el2=dom.createComment("");dom.appendChild(el1,el2);var el2=dom.createTextNode("\n        ");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,block=hooks.block;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(dom.childAt(fragment,[1]),1,1);return block(env,morph0,context,"each",[get(env,context,"row")],{keyword:"node"},child0,null),fragment}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createElement("div");dom.setAttribute(el1,"class","match-grid__body");var el2=dom.createTextNode("\n\n");dom.appendChild(el1,el2);var el2=dom.createComment("");dom.appendChild(el1,el2);var el2=dom.createTextNode("\n");return dom.appendChild(el1,el2),dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,block=hooks.block;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(dom.childAt(fragment,[0]),1,1);return block(env,morph0,context,"each",[get(env,context,"matches.table")],{keyword:"row"},child0,null),fragment}}}()),Ember.TEMPLATES["components/match-mode-tab"]=Ember.HTMLBars.template(function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createComment("");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,content=hooks.content;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(fragment,0,0,contextualElement);return dom.insertBoundary(fragment,null),dom.insertBoundary(fragment,0),content(env,morph0,context,"mode"),fragment}}}()),Ember.TEMPLATES["components/message-tray"]=Ember.HTMLBars.template(function(){var child0=function(){var child0=function(){var child0=function(){var child0=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("                        ");dom.appendChild(el0,el1);var el1=dom.createComment("");dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,inline=hooks.inline;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(fragment,1,1,contextualElement);return inline(env,morph0,context,"task-message",[],{message:get(env,context,"message")}),fragment}}}(),child1=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("                        ");dom.appendChild(el0,el1);var el1=dom.createComment("");dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,inline=hooks.inline;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(fragment,1,1,contextualElement);return inline(env,morph0,context,"basic-message",[],{message:get(env,context,"message")}),fragment}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("\n");dom.appendChild(el0,el1);var el1=dom.createComment("");dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,block=hooks.block;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(fragment,1,1,contextualElement);return block(env,morph0,context,"if",[get(env,context,"message.task")],{},child0,child1),fragment}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("        ");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"class","message-tray__body");var el2=dom.createTextNode("\n            ");dom.appendChild(el1,el2);var el2=dom.createElement("div");dom.setAttribute(el2,"class","message-tray__header");var el3=dom.createTextNode("\n                ");dom.appendChild(el2,el3);var el3=dom.createElement("div");dom.setAttribute(el3,"class","message-tray__status");var el4=dom.createComment("");dom.appendChild(el3,el4);var el4=dom.createTextNode(" notifications");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n                ");dom.appendChild(el2,el3);var el3=dom.createElement("div");dom.setAttribute(el3,"class","message-tray__close");var el4=dom.createTextNode("✕");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n            ");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n            ");dom.appendChild(el1,el2);var el2=dom.createElement("ul");dom.setAttribute(el2,"class","message-tray__queue");var el3=dom.createTextNode("\n");dom.appendChild(el2,el3);var el3=dom.createComment("");dom.appendChild(el2,el3);var el3=dom.createTextNode("            ");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n        ");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,content=hooks.content,element=hooks.element,get=hooks.get,block=hooks.block;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var element1=dom.childAt(fragment,[1]),element2=dom.childAt(element1,[1]),element3=dom.childAt(element2,[3]),morph0=dom.createMorphAt(dom.childAt(element2,[1]),0,0),morph1=dom.createMorphAt(dom.childAt(element1,[3]),1,1);return content(env,morph0,context,"queue.length"),element(env,element3,context,"action",["close"],{}),block(env,morph1,context,"each",[get(env,context,"queue")],{keyword:"message"},child0,null),fragment}}}(),child1=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("        ");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"class","message-tray__icon");var el2=dom.createTextNode("\n            ");dom.appendChild(el1,el2);var el2=dom.createElement("span"),el3=dom.createTextNode("!");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n        ");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,element=hooks.element;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var element0=dom.childAt(fragment,[1]);return element(env,element0,context,"action",["expand"],{}),fragment}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createComment("");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,block=hooks.block;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(fragment,0,0,contextualElement);return dom.insertBoundary(fragment,null),dom.insertBoundary(fragment,0),block(env,morph0,context,"if",[get(env,context,"expanded")],{},child0,child1),fragment}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createComment("");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,block=hooks.block;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(fragment,0,0,contextualElement);return dom.insertBoundary(fragment,null),dom.insertBoundary(fragment,0),block(env,morph0,context,"if",[get(env,context,"queue")],{},child0,null),fragment}}}()),Ember.TEMPLATES["components/project-creator"]=Ember.HTMLBars.template(function(){var child0=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("        ");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"class","project-creator__submit");var el2=dom.createTextNode("\n            ");dom.appendChild(el1,el2);var el2=dom.createElement("h1"),el3=dom.createTextNode("Create");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n        ");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,element=hooks.element;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var element0=dom.childAt(fragment,[1]);return element(env,element0,context,"action",["createProject"],{}),fragment}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createElement("div");dom.setAttribute(el1,"class","project-creator__input");var el2=dom.createTextNode("\n\n    ");dom.appendChild(el1,el2);var el2=dom.createComment("");dom.appendChild(el1,el2);var el2=dom.createTextNode("\n\n");dom.appendChild(el1,el2);var el2=dom.createComment("");dom.appendChild(el1,el2);var el2=dom.createTextNode("\n");return dom.appendChild(el1,el2),dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,inline=hooks.inline,block=hooks.block;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var element1=dom.childAt(fragment,[0]),morph0=dom.createMorphAt(element1,1,1),morph1=dom.createMorphAt(element1,3,3);return inline(env,morph0,context,"input",[],{value:get(env,context,"newProjectName"),placeholder:"Name"}),block(env,morph1,context,"unless",[get(env,context,"isInvalid")],{},child0,null),fragment}}}()),Ember.TEMPLATES["components/project-thumbnail"]=Ember.HTMLBars.template(function(){var child0=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("        ");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"class","project-thumbnail__delete-confirm");var el2=dom.createTextNode("\n            ");dom.appendChild(el1,el2);var el2=dom.createElement("div");dom.setAttribute(el2,"class","project-thumbnail__delete-confirm__cancel");var el3=dom.createTextNode("\n                ");dom.appendChild(el2,el3);var el3=dom.createElement("h1"),el4=dom.createTextNode("Cancel");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n            ");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n            ");dom.appendChild(el1,el2);var el2=dom.createElement("div");dom.setAttribute(el2,"class","project-thumbnail__delete-confirm__delete");var el3=dom.createTextNode("\n                ");dom.appendChild(el2,el3);var el3=dom.createElement("h1"),el4=dom.createTextNode("Delete");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n            ");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n        ");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,element=hooks.element;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var element0=dom.childAt(fragment,[1]),element1=dom.childAt(element0,[1]),element2=dom.childAt(element0,[3]);return element(env,element1,context,"action",["cancelDelete"],{}),element(env,element2,context,"action",["delete"],{}),fragment}}}(),child1=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("        ");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"class","project-thumbnail__deleting");var el2=dom.createTextNode("\n            ");dom.appendChild(el1,el2);var el2=dom.createElement("h1"),el3=dom.createTextNode("Deleting");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n        ");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom;dom.detectNamespace(contextualElement);var fragment;return env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom),fragment}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createElement("div");dom.setAttribute(el1,"class","project-thumbnail__header");var el2=dom.createTextNode("\n    ");dom.appendChild(el1,el2);var el2=dom.createElement("span"),el3=dom.createComment("");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n    ");dom.appendChild(el1,el2);var el2=dom.createElement("div");dom.setAttribute(el2,"class","exit-icon"),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n\n");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"class","project-thumbnail__body");var el2=dom.createTextNode("\n\n");dom.appendChild(el1,el2);var el2=dom.createComment("");dom.appendChild(el1,el2);var el2=dom.createTextNode("\n");dom.appendChild(el1,el2);var el2=dom.createComment("");dom.appendChild(el1,el2);var el2=dom.createTextNode("\n    ");dom.appendChild(el1,el2);var el2=dom.createElement("div"),el3=dom.createTextNode("Enter");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n\n");return dom.appendChild(el1,el2),dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,content=hooks.content,element=hooks.element,get=hooks.get,block=hooks.block;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var element3=dom.childAt(fragment,[0]),element4=dom.childAt(element3,[3]),element5=dom.childAt(fragment,[2]),element6=dom.childAt(element5,[5]),morph0=dom.createMorphAt(dom.childAt(element3,[1]),0,0),morph1=dom.createMorphAt(element5,1,1),morph2=dom.createMorphAt(element5,3,3);return content(env,morph0,context,"project.name"),element(env,element4,context,"action",["confirmDelete"],{}),block(env,morph1,context,"if",[get(env,context,"isConfirmDelete")],{},child0,null),block(env,morph2,context,"if",[get(env,context,"isDeleting")],{},child1,null),element(env,element6,context,"action",["enter"],{}),fragment}}}()),Ember.TEMPLATES["components/task-message"]=Ember.HTMLBars.template(function(){var child0=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("    ");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"class","task-message__progress");var el2=dom.createComment("");dom.appendChild(el1,el2);var el2=dom.createTextNode("%");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,content=hooks.content;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(dom.childAt(fragment,[1]),0,0);return content(env,morph0,context,"progress"),fragment}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createElement("div");dom.setAttribute(el1,"class","task-message__body");var el2=dom.createComment("");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n\n");dom.appendChild(el0,el1);var el1=dom.createComment("");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,content=hooks.content,get=hooks.get,block=hooks.block;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(dom.childAt(fragment,[0]),0,0),morph1=dom.createMorphAt(fragment,2,2,contextualElement);return dom.insertBoundary(fragment,null),content(env,morph0,context,"content"),block(env,morph1,context,"if",[get(env,context,"progress")],{},child0,null),fragment}}}()),Ember.TEMPLATES["components/workspace-control-panel"]=Ember.HTMLBars.template(function(){var child0=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("        ");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"class","controll-panel__l1-body");var el2=dom.createTextNode("\n            ");dom.appendChild(el1,el2);var el2=dom.createElement("div");dom.setAttribute(el2,"id","controll-panel__images"),dom.setAttribute(el2,"class","controll-panel__l2");var el3=dom.createTextNode("\n                ");dom.appendChild(el2,el3);var el3=dom.createElement("div");dom.setAttribute(el3,"class","controll-panel__l2-tab  enter-point");var el4=dom.createTextNode("Images");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n            ");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n            ");dom.appendChild(el1,el2);var el2=dom.createElement("div");dom.setAttribute(el2,"id","controll-panel__parameters"),dom.setAttribute(el2,"class","controll-panel__l2");var el3=dom.createTextNode("\n                ");dom.appendChild(el2,el3);var el3=dom.createElement("div");dom.setAttribute(el3,"class","controll-panel__l2-tab");var el4=dom.createTextNode("\n                    ");dom.appendChild(el3,el4);var el4=dom.createElement("div"),el5=dom.createTextNode("Use ");dom.appendChild(el4,el5);var el5=dom.createComment("");dom.appendChild(el4,el5);var el5=dom.createTextNode(" CPU Cores");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode("\n                    ");dom.appendChild(el3,el4);var el4=dom.createComment("");dom.appendChild(el3,el4);var el4=dom.createTextNode("\n                ");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n            ");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n        ");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,element=hooks.element,content=hooks.content,get=hooks.get,inline=hooks.inline;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var element8=dom.childAt(fragment,[1]),element9=dom.childAt(element8,[1,1]),element10=dom.childAt(element8,[3,1]),morph0=dom.createMorphAt(dom.childAt(element10,[1]),1,1),morph1=dom.createMorphAt(element10,3,3);return element(env,element9,context,"action",["enter","workspace.images"],{}),content(env,morph0,context,"workspace.threadPoolSize"),inline(env,morph1,context,"cpu-setting",[],{workspace:get(env,context,"workspace")}),fragment}}}(),child1=function(){var child0=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("                ");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"class","controll-panel__l2-body");var el2=dom.createTextNode("\n                    ");dom.appendChild(el1,el2);var el2=dom.createElement("div");dom.setAttribute(el2,"id","controll-panel__matching"),dom.setAttribute(el2,"class","controll-panel__l3-tab  enter-point");var el3=dom.createTextNode("Feature Matching");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n                    ");dom.appendChild(el1,el2);var el2=dom.createElement("div");dom.setAttribute(el2,"id","controll-panel__recovery"),dom.setAttribute(el2,"class","controll-panel__l3-tab  enter-point");var el3=dom.createTextNode("Sparse Reconstruction");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n                ");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,element=hooks.element;dom.detectNamespace(contextualElement);var fragment;
env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var element0=dom.childAt(fragment,[1]),element1=dom.childAt(element0,[1]),element2=dom.childAt(element0,[3]);return element(env,element1,context,"action",["enter","workspace.matcher"],{}),element(env,element2,context,"action",["enter","workspace.register"],{}),fragment}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("        ");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"class","controll-panel__l1-body");var el2=dom.createTextNode("\n\n            ");dom.appendChild(el1,el2);var el2=dom.createElement("div");dom.setAttribute(el2,"id","controll-panel__extractor"),dom.setAttribute(el2,"class","controll-panel__l2");var el3=dom.createTextNode("\n                ");dom.appendChild(el2,el3);var el3=dom.createElement("div");dom.setAttribute(el3,"class","controll-panel__l2-tab  enter-point");var el4=dom.createTextNode("Feature Extraction");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n            ");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n\n            ");dom.appendChild(el1,el2);var el2=dom.createElement("div");dom.setAttribute(el2,"id","controll-panel__register"),dom.setAttribute(el2,"class","controll-panel__l2");var el3=dom.createTextNode("\n                ");dom.appendChild(el2,el3);var el3=dom.createElement("div");dom.setAttribute(el3,"class","controll-panel__l2-tab");var el4=dom.createTextNode("Camera Registration");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n");dom.appendChild(el2,el3);var el3=dom.createComment("");dom.appendChild(el2,el3);var el3=dom.createTextNode("            ");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n\n            ");dom.appendChild(el1,el2);var el2=dom.createElement("div");dom.setAttribute(el2,"id","controll-panel__stereo"),dom.setAttribute(el2,"class","controll-panel__l2");var el3=dom.createTextNode("\n                ");dom.appendChild(el2,el3);var el3=dom.createElement("div");dom.setAttribute(el3,"class","controll-panel__l2-tab  enter-point");var el4=dom.createTextNode("Stereopsis");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n            ");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n\n        ");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,element=hooks.element,get=hooks.get,block=hooks.block;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var element3=dom.childAt(fragment,[1]),element4=dom.childAt(element3,[1,1]),element5=dom.childAt(element3,[3]),element6=dom.childAt(element5,[1]),element7=dom.childAt(element3,[5,1]),morph0=dom.createMorphAt(element5,3,3);return element(env,element4,context,"action",["enter","workspace.extractor"],{}),element(env,element6,context,"action",["toggleMenu","register"],{}),block(env,morph0,context,"if",[get(env,context,"expandRegister")],{},child0,null),element(env,element7,context,"action",["enter","workspace.mvs"],{}),fragment}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createElement("div");dom.setAttribute(el1,"id","controll-panel__header"),dom.setAttribute(el1,"class","floating-window__header");var el2=dom.createTextNode("\n    ");dom.appendChild(el1,el2);var el2=dom.createElement("span"),el3=dom.createTextNode("WebSFM");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n    ");dom.appendChild(el1,el2);var el2=dom.createElement("div");dom.setAttribute(el2,"class","exit-icon"),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"id","controll-panel__body");var el2=dom.createTextNode("\n\n    ");dom.appendChild(el1,el2);var el2=dom.createElement("div");dom.setAttribute(el2,"id","controll-panel__input"),dom.setAttribute(el2,"class","controll-panel__l1");var el3=dom.createTextNode("\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("div");dom.setAttribute(el3,"class","controll-panel__l1-tab");var el4=dom.createTextNode("\n            ");dom.appendChild(el3,el4);var el4=dom.createElement("span"),el5=dom.createTextNode("INPUTS");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode("\n        ");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n");dom.appendChild(el2,el3);var el3=dom.createComment("");dom.appendChild(el2,el3);var el3=dom.createTextNode("    ");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n\n    ");dom.appendChild(el1,el2);var el2=dom.createElement("div");dom.setAttribute(el2,"id","controll-panel__progress"),dom.setAttribute(el2,"class","controll-panel__l1");var el3=dom.createTextNode("\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("div");dom.setAttribute(el3,"class","controll-panel__l1-tab");var el4=dom.createTextNode("\n            ");dom.appendChild(el3,el4);var el4=dom.createElement("span"),el5=dom.createTextNode("PROGRESS");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode("\n        ");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n");dom.appendChild(el2,el3);var el3=dom.createComment("");dom.appendChild(el2,el3);var el3=dom.createTextNode("    ");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n\n    ");dom.appendChild(el1,el2);var el2=dom.createElement("div");dom.setAttribute(el2,"id","controll-panel__output"),dom.setAttribute(el2,"class","controll-panel__l1");var el3=dom.createTextNode("\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("div");dom.setAttribute(el3,"class","controll-panel__l1-tab");var el4=dom.createTextNode("\n            ");dom.appendChild(el3,el4);var el4=dom.createElement("span"),el5=dom.createTextNode("Output");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode("\n        ");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n    ");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n\n");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n\n\n");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"id","controll-panel__footer");var el2=dom.createTextNode("\n    ");dom.appendChild(el1,el2);var el2=dom.createComment("");dom.appendChild(el1,el2);var el2=dom.createTextNode("\n");return dom.appendChild(el1,el2),dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,element=hooks.element,get=hooks.get,block=hooks.block,inline=hooks.inline;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var element11=dom.childAt(fragment,[0,3]),element12=dom.childAt(fragment,[2]),element13=dom.childAt(element12,[1]),element14=dom.childAt(element13,[1]),element15=dom.childAt(element12,[3]),element16=dom.childAt(element15,[1]),morph0=dom.createMorphAt(element13,3,3),morph1=dom.createMorphAt(element15,3,3),morph2=dom.createMorphAt(dom.childAt(fragment,[4]),1,1);return element(env,element11,context,"action",["close"],{}),element(env,element14,context,"action",["toggleMenu","input"],{}),block(env,morph0,context,"if",[get(env,context,"expandInput")],{},child0,null),element(env,element16,context,"action",["toggleMenu","progress"],{}),block(env,morph1,context,"if",[get(env,context,"expandProgress")],{},child1,null),inline(env,morph2,context,"workspace-progress-bar",[],{workspace:get(env,context,"workspace")}),fragment}}}()),Ember.TEMPLATES["components/workspace-progress-bar"]=Ember.HTMLBars.template(function(){var child0=function(){var child0=function(){var child0=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("                    is active\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom;dom.detectNamespace(contextualElement);var fragment;return env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom),fragment}}}(),child1=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("                    is not active\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom;dom.detectNamespace(contextualElement);var fragment;return env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom),fragment}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("            ");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"class","controll-panel__state-body__thread");var el2=dom.createTextNode("\n                thread\n");dom.appendChild(el1,el2);var el2=dom.createComment("");dom.appendChild(el1,el2);var el2=dom.createTextNode("            ");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,block=hooks.block;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(dom.childAt(fragment,[1]),1,1);return block(env,morph0,context,"if",[get(env,context,"worker.isActive")],{},child0,child1),fragment}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("\n");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"class","controll-panel__state-body__container");var el2=dom.createTextNode("\n    ");dom.appendChild(el1,el2);var el2=dom.createElement("div");dom.setAttribute(el2,"class","controll-panel__state-body");var el3=dom.createTextNode("\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("div"),el4=dom.createComment("");dom.appendChild(el3,el4);var el4=dom.createTextNode(" cores can be used");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n");dom.appendChild(el2,el3);var el3=dom.createComment("");dom.appendChild(el2,el3);var el3=dom.createTextNode("    ");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,content=hooks.content,get=hooks.get,block=hooks.block;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var element2=dom.childAt(fragment,[1,1]),morph0=dom.createMorphAt(dom.childAt(element2,[1]),0,0),morph1=dom.createMorphAt(element2,3,3);return content(env,morph0,context,"workspace.threadPoolSize"),block(env,morph1,context,"each",[get(env,context,"workspace.workers")],{keyword:"worker"},child0,null),fragment}}}(),child1=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("            ");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"class","is_running");var el2=dom.createTextNode("\n                ");dom.appendChild(el1,el2);var el2=dom.createElement("span");dom.setAttribute(el2,"class","icon-pause"),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n            ");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,element=hooks.element;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var element1=dom.childAt(fragment,[1]);return element(env,element1,context,"action",["stop"],{}),fragment}}}(),child2=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("            ");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"class","is_stopped");var el2=dom.createTextNode("\n                ");dom.appendChild(el1,el2);var el2=dom.createElement("span");dom.setAttribute(el2,"class","icon-play"),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n            ");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,element=hooks.element;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var element0=dom.childAt(fragment,[1]);return element(env,element0,context,"action",["run"],{}),fragment}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createComment("");dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"class","controll-panel__state-bar");var el2=dom.createTextNode("\n    ");dom.appendChild(el1,el2);var el2=dom.createElement("div");dom.setAttribute(el2,"class","controll-panel__state-bar__toggle");var el3=dom.createTextNode("\n");dom.appendChild(el2,el3);var el3=dom.createComment("");dom.appendChild(el2,el3);var el3=dom.createTextNode("    ");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n\n    ");dom.appendChild(el1,el2);var el2=dom.createElement("div");dom.setAttribute(el2,"class","controll-panel__state-bar__body");var el3=dom.createTextNode("\n        ");dom.appendChild(el2,el3);var el3=dom.createComment("");dom.appendChild(el2,el3);var el3=dom.createTextNode("\n    ");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n\n");return dom.appendChild(el1,el2),dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,block=hooks.block,element=hooks.element,content=hooks.content;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var element3=dom.childAt(fragment,[2]),element4=dom.childAt(element3,[3]),morph0=dom.createMorphAt(fragment,0,0,contextualElement),morph1=dom.createMorphAt(dom.childAt(element3,[1]),1,1),morph2=dom.createMorphAt(element4,1,1);return dom.insertBoundary(fragment,0),block(env,morph0,context,"if",[get(env,context,"expand")],{},child0,null),block(env,morph1,context,"if",[get(env,context,"isRunning")],{},child1,child2),element(env,element4,context,"action",["toggleExpand"],{}),content(env,morph2,context,"description"),fragment}}}()),Ember.TEMPLATES.welcome=Ember.HTMLBars.template(function(){var child0=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("                ");dom.appendChild(el0,el1);var el1=dom.createElement("li");dom.setAttribute(el1,"class","welcome-screen__projects__item");var el2=dom.createTextNode("\n                    ");dom.appendChild(el1,el2);var el2=dom.createComment("");dom.appendChild(el1,el2);var el2=dom.createTextNode("\n                ");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,inline=hooks.inline;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(dom.childAt(fragment,[1]),1,1);return inline(env,morph0,context,"project-thumbnail",[],{project:get(env,context,"project"),ctx:get(env,context,"ctx")}),fragment}}}(),child1=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("                ");dom.appendChild(el0,el1);var el1=dom.createElement("li");dom.setAttribute(el1,"class","welcome-screen__demos__item");var el2=dom.createTextNode("\n                    ");dom.appendChild(el1,el2);var el2=dom.createComment("");dom.appendChild(el1,el2);var el2=dom.createTextNode("\n                ");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,inline=hooks.inline;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(dom.childAt(fragment,[1]),1,1);return inline(env,morph0,context,"demo-thumbnail",[],{project:get(env,context,"demo"),ctx:get(env,context,"ctx")}),fragment}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("\n\n");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"class","welcome-screen__header");var el2=dom.createTextNode("\n    ");dom.appendChild(el1,el2);var el2=dom.createElement("div"),el3=dom.createTextNode("\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("h1"),el4=dom.createTextNode("Welcome to WebSFM");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("span"),el4=dom.createTextNode("preview");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n    ");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n\n\n\n\n");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"class","welcome-screen__projects-container");var el2=dom.createTextNode("\n\n    ");dom.appendChild(el1,el2);var el2=dom.createElement("div");dom.setAttribute(el2,"class","welcome-screen__projects");var el3=dom.createTextNode("\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("ul"),el4=dom.createTextNode("\n\n            ");dom.appendChild(el3,el4);var el4=dom.createElement("li");dom.setAttribute(el4,"class","welcome-screen__projects__item");var el5=dom.createTextNode("\n                ");dom.appendChild(el4,el5);var el5=dom.createElement("div");dom.setAttribute(el5,"class","welcome-screen__projects__header");var el6=dom.createTextNode("\n                    ");dom.appendChild(el5,el6);var el6=dom.createElement("h1"),el7=dom.createTextNode("Projects");dom.appendChild(el6,el7),dom.appendChild(el5,el6);var el6=dom.createTextNode("\n                ");dom.appendChild(el5,el6),dom.appendChild(el4,el5);var el5=dom.createTextNode("\n            ");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode("\n\n");dom.appendChild(el3,el4);var el4=dom.createComment("");dom.appendChild(el3,el4);var el4=dom.createTextNode("\n            ");dom.appendChild(el3,el4);var el4=dom.createElement("li");dom.setAttribute(el4,"class","welcome-screen__projects__item");var el5=dom.createTextNode("\n                ");dom.appendChild(el4,el5);var el5=dom.createComment("");dom.appendChild(el4,el5);var el5=dom.createTextNode("\n            ");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode("\n\n        ");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n\n    ");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n\n");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n\n\n\n\n");dom.appendChild(el0,el1);var el1=dom.createElement("div"),el2=dom.createTextNode("\n    ");dom.appendChild(el1,el2);var el2=dom.createComment("");dom.appendChild(el1,el2);var el2=dom.createTextNode("\n");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n\n\n\n\n");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"class","welcome-screen__demos-container");var el2=dom.createTextNode("\n\n    ");dom.appendChild(el1,el2);var el2=dom.createElement("div");dom.setAttribute(el2,"class","welcome-screen__demos");var el3=dom.createTextNode("\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("ul"),el4=dom.createTextNode("\n            ");dom.appendChild(el3,el4);var el4=dom.createElement("li");dom.setAttribute(el4,"class","welcome-screen__demos__item");var el5=dom.createTextNode("\n                ");dom.appendChild(el4,el5);var el5=dom.createElement("div");dom.setAttribute(el5,"class","welcome-screen__demos__header");var el6=dom.createTextNode("\n                    ");dom.appendChild(el5,el6);var el6=dom.createElement("h1"),el7=dom.createTextNode("DEMOS");dom.appendChild(el6,el7),dom.appendChild(el5,el6);var el6=dom.createTextNode("\n                ");dom.appendChild(el5,el6),dom.appendChild(el4,el5);var el5=dom.createTextNode("\n            ");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode("\n");dom.appendChild(el3,el4);var el4=dom.createComment("");dom.appendChild(el3,el4);var el4=dom.createTextNode("        ");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n    ");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n\n");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n\n\n\n");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"id","welcome-screen__sfm"),dom.setAttribute(el1,"class","welcome-screen__app-desc-row");var el2=dom.createTextNode("\n\n    ");dom.appendChild(el1,el2);var el2=dom.createElement("img");dom.setAttribute(el2,"src","/assets/images/websfm.jpeg"),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n\n    ");dom.appendChild(el1,el2);var el2=dom.createElement("div"),el3=dom.createTextNode("\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("h1"),el4=dom.createTextNode("Structure from Motion");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("section"),el4=dom.createTextNode("\n            TL;DR, ");dom.appendChild(el3,el4);var el4=dom.createElement("span");dom.setAttribute(el4,"class","name");var el5=dom.createTextNode("Structure from Motion");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode(" means turn a set of images into 3D model, ");dom.appendChild(el3,el4);var el4=dom.createElement("span");dom.setAttribute(el4,"class","name");var el5=dom.createTextNode("WebSFM");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode(" is an SFM system inside modern browser.\n            Details in the companion ");dom.appendChild(el3,el4);var el4=dom.createElement("a");dom.setAttribute(el4,"class","papaer"),dom.setAttribute(el4,"href","https://github.com/ptx-pluto/web-sfm-thesis/blob/master/thesis.pdf"),dom.setAttribute(el4,"target","_blank");var el5=dom.createTextNode("thesis");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode(".\n            You can also checkout the source code on ");dom.appendChild(el3,el4);var el4=dom.createElement("a");dom.setAttribute(el4,"href","https://github.com/ptx-pluto/web-sfm"),dom.setAttribute(el4,"target","_blank");var el5=dom.createTextNode("Github");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode("\n        ");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("section"),el4=dom.createTextNode("\n            I seperated WebSFM's pipeline into 4 modules,\n            ");dom.appendChild(el3,el4);var el4=dom.createElement("a");dom.setAttribute(el4,"href","https://github.com/ptx-pluto/web-sfm/tree/master/src/websift"),dom.setAttribute(el4,"target","_blank");var el5=dom.createTextNode("WebSIFT");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode(",\n            ");dom.appendChild(el3,el4);var el4=dom.createElement("a");dom.setAttribute(el4,"href","https://github.com/ptx-pluto/web-sfm/tree/master/src/webmatcher"),dom.setAttribute(el4,"target","_blank");var el5=dom.createTextNode("WebMatcher");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode(",\n            ");dom.appendChild(el3,el4);var el4=dom.createElement("a");dom.setAttribute(el4,"href","https://github.com/ptx-pluto/web-sfm/tree/master/src/webregister"),dom.setAttribute(el4,"target","_blank");var el5=dom.createTextNode("WebRegister");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode(" and\n            ");dom.appendChild(el3,el4);var el4=dom.createElement("a"),el5=dom.createTextNode("WebMVS");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode(", including algorithms like\n            ");dom.appendChild(el3,el4);var el4=dom.createElement("span");dom.setAttribute(el4,"class","name");var el5=dom.createTextNode("SIFT");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode(",\n            ");dom.appendChild(el3,el4);var el4=dom.createElement("span");dom.setAttribute(el4,"class","name");var el5=dom.createTextNode("balanced kd-tree");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode(",\n            ");dom.appendChild(el3,el4);var el4=dom.createElement("span");dom.setAttribute(el4,"class","name");var el5=dom.createTextNode("ANN search");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode(",\n            ");dom.appendChild(el3,el4);var el4=dom.createElement("span");dom.setAttribute(el4,"class","name");var el5=dom.createTextNode("eight-point algorithm");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode(",\n            ");dom.appendChild(el3,el4);var el4=dom.createElement("span");dom.setAttribute(el4,"class","name");var el5=dom.createTextNode("DLT");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode(",\n            ");dom.appendChild(el3,el4);var el4=dom.createElement("span");dom.setAttribute(el4,"class","name");var el5=dom.createTextNode("RANSAC");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode(",\n            ");dom.appendChild(el3,el4);var el4=dom.createElement("span");dom.setAttribute(el4,"class","name");var el5=dom.createTextNode("Levenberg-Marquardt algorithm");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode(",\n            ");dom.appendChild(el3,el4);var el4=dom.createElement("span");dom.setAttribute(el4,"class","name");var el5=dom.createTextNode("sparse bundle adjustment");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode("\n            .etc\n        ");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("section"),el4=dom.createTextNode("\n            WebSFM is still under construction, mostly WebMVS part.");dom.appendChild(el3,el4);var el4=dom.createElement("br");dom.appendChild(el3,el4);var el4=dom.createTextNode("\n        ");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n    ");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n\n");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n\n");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"id","welcome-screen__framework"),dom.setAttribute(el1,"class","welcome-screen__app-desc-row");var el2=dom.createTextNode("\n\n    ");dom.appendChild(el1,el2);var el2=dom.createElement("div"),el3=dom.createTextNode("\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("h1"),el4=dom.createTextNode("Framework");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("section"),el4=dom.createTextNode("\n            WebSFM uses Ember.js to construct its single page application (");dom.appendChild(el3,el4);var el4=dom.createElement("em"),el5=dom.createTextNode("application.js");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode(").");dom.appendChild(el3,el4);var el4=dom.createElement("br");dom.appendChild(el3,el4);var el4=dom.createTextNode("\n        ");dom.appendChild(el3,el4),dom.appendChild(el2,el3);
var el3=dom.createTextNode("\n\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("section"),el4=dom.createTextNode("\n            All SFM related mathematical routines are written/tested through node.js, then browserify into a seperate ");dom.appendChild(el3,el4);var el4=dom.createElement("em"),el5=dom.createTextNode("worker.js");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode(",\n            which can be instantiated multiple times as multiple WebWorkers.\n            Then they are encapsulated inside asynchronous task requests, can be accessed through WebWorker messaging.\n        ");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n\n    ");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n\n    ");dom.appendChild(el1,el2);var el2=dom.createElement("img");dom.setAttribute(el2,"src","/assets/images/framework.png"),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n\n");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n\n");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"id","welcome-screen__data-model"),dom.setAttribute(el1,"class","welcome-screen__app-desc-row");var el2=dom.createTextNode("\n    ");dom.appendChild(el1,el2);var el2=dom.createElement("img");dom.setAttribute(el2,"src","/assets/images/data.model.png"),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n    ");dom.appendChild(el1,el2);var el2=dom.createElement("div"),el3=dom.createTextNode("\n\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("h1"),el4=dom.createTextNode("Data Model");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("section"),el4=dom.createTextNode("\n            WebSFM needs to handle large mount of data inside the browser,\n            such as surfels and SIFT features. They can cost up to 10+ even 100+ MB in text or JSON form.");dom.appendChild(el3,el4);var el4=dom.createElement("br");dom.appendChild(el3,el4);var el4=dom.createTextNode("\n            That's why WebSFM have a very organized way to handle those large data.\n        ");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("section"),el4=dom.createTextNode("\n            WebSFM uses ArrayBuffer as the underlying payload.");dom.appendChild(el3,el4);var el4=dom.createElement("br");dom.appendChild(el3,el4);var el4=dom.createTextNode("\n              - For networking, it can be directly transfered through XMLHttpRequest as a native response type.");dom.appendChild(el3,el4);var el4=dom.createElement("br");dom.appendChild(el3,el4);var el4=dom.createTextNode("\n              - For storage, ArrayBuffer is supported in all implementations of IndexedDB.");dom.appendChild(el3,el4);var el4=dom.createElement("br");dom.appendChild(el3,el4);var el4=dom.createTextNode("\n              - For multi-threading, ArrayBuffer is a TransferableObject for WebWorkers.");dom.appendChild(el3,el4);var el4=dom.createElement("br");dom.appendChild(el3,el4);var el4=dom.createTextNode("\n            Colors(Uint8) and Cordinates(Float32) are stored in its minimum form through TypedArray. No JSON or text involved, which also means no parsing required.\n        ");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("section"),el4=dom.createTextNode("\n            ");dom.appendChild(el3,el4);var el4=dom.createElement("em"),el5=dom.createTextNode("With this approch, a point cloud of size 450,000 can be loaded and rendered instantaneously inside a browser, and only cost 6.8MB.");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode("\n        ");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n\n    ");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n\n");dom.appendChild(el0,el1);var el1=dom.createElement("div");dom.setAttribute(el1,"id","welcome-screen__ptx"),dom.setAttribute(el1,"class","welcome-screen__app-desc-row");var el2=dom.createTextNode("\n\n    ");dom.appendChild(el1,el2);var el2=dom.createElement("div"),el3=dom.createTextNode("\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("h1"),el4=dom.createTextNode("I am PTX, hire me!");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("section"),el4=dom.createTextNode("\n            I am PTX, author of WebSFM, recent college graduate, Computer Science major, Applied Mathematics minor, looking for job.\n        ");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n\n        ");dom.appendChild(el2,el3);var el3=dom.createElement("section"),el4=dom.createTextNode("\n            More information about me on my ");dom.appendChild(el3,el4);var el4=dom.createElement("a");dom.setAttribute(el4,"href","http://ptx.digital"),dom.setAttribute(el4,"target","_blank");var el5=dom.createTextNode("homepage");dom.appendChild(el4,el5),dom.appendChild(el3,el4);var el4=dom.createTextNode(".\n        ");dom.appendChild(el3,el4),dom.appendChild(el2,el3);var el3=dom.createTextNode("\n\n    ");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n\n    ");dom.appendChild(el1,el2);var el2=dom.createElement("img");dom.setAttribute(el2,"src","/assets/images/ptx.jpeg"),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n\n");return dom.appendChild(el1,el2),dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,block=hooks.block,inline=hooks.inline,subexpr=hooks.subexpr,concat=hooks.concat,attribute=hooks.attribute,content=hooks.content;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var element0=dom.childAt(fragment,[3,1,1]),element1=dom.childAt(fragment,[5]),morph0=dom.createMorphAt(element0,3,3),morph1=dom.createMorphAt(dom.childAt(element0,[5]),1,1),morph2=dom.createMorphAt(element1,1,1),attrMorph0=dom.createAttrMorph(element1,"class"),morph3=dom.createMorphAt(dom.childAt(fragment,[7,1,1]),3,3);return block(env,morph0,context,"each",[get(env,context,"projects")],{keyword:"project"},child0,null),inline(env,morph1,context,"project-creator",[],{ctx:get(env,context,"ctx")}),attribute(env,attrMorph0,element1,"class",concat(env,["welcome-screen__detail-container ",subexpr(env,context,"if",[get(env,context,"isDetailClosed"),"is-detail-closed"],{})])),content(env,morph2,context,"outlet"),block(env,morph3,context,"each",[get(env,context,"demos")],{keyword:"demo"},child1,null),fragment}}}()),Ember.TEMPLATES["welcome/demo"]=Ember.HTMLBars.template(function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createComment("");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,inline=hooks.inline;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(fragment,0,0,contextualElement);return dom.insertBoundary(fragment,null),dom.insertBoundary(fragment,0),inline(env,morph0,context,"demo-detail",[],{project:get(env,context,"model"),ctx:get(env,context,"ctx")}),fragment}}}()),Ember.TEMPLATES.workspace=Ember.HTMLBars.template(function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createElement("div");dom.setAttribute(el1,"id","main-container");var el2=dom.createComment("");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");dom.appendChild(el0,el1);var el1=dom.createComment("");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,content=hooks.content,get=hooks.get,inline=hooks.inline;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(dom.childAt(fragment,[0]),0,0),morph1=dom.createMorphAt(fragment,2,2,contextualElement);return dom.insertBoundary(fragment,null),content(env,morph0,context,"outlet"),inline(env,morph1,context,"workspace-control-panel",[],{workspace:get(env,context,"this")}),fragment}}}()),Ember.TEMPLATES["workspace/extractor"]=Ember.HTMLBars.template(function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createElement("div");dom.setAttribute(el1,"id","main-container__input-gallery-container");var el2=dom.createTextNode("\n\n    ");dom.appendChild(el1,el2);var el2=dom.createComment("");dom.appendChild(el1,el2);var el2=dom.createTextNode("\n\n    ");dom.appendChild(el1,el2);var el2=dom.createComment("");dom.appendChild(el1,el2);var el2=dom.createTextNode("\n\n");return dom.appendChild(el1,el2),dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,inline=hooks.inline,content=hooks.content;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var element0=dom.childAt(fragment,[0]),morph0=dom.createMorphAt(element0,1,1),morph1=dom.createMorphAt(element0,3,3);return inline(env,morph0,context,"image-gallery",[],{images:get(env,context,"images"),expand:"expand"}),content(env,morph1,context,"outlet"),fragment}}}()),Ember.TEMPLATES["workspace/extractor/image"]=Ember.HTMLBars.template(function(){var child0=function(){var child0=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("        ");dom.appendChild(el0,el1);var el1=dom.createComment("");dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,inline=hooks.inline;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(fragment,1,1,contextualElement);return inline(env,morph0,context,"visual-features",[],{img:get(env,context,"img"),features:get(env,context,"features")}),fragment}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("\n");dom.appendChild(el0,el1);var el1=dom.createComment("");dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,block=hooks.block;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(fragment,1,1,contextualElement);return block(env,morph0,context,"unless",[get(env,context,"isLoading")],{},child0,null),fragment}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createComment("");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,block=hooks.block;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(fragment,0,0,contextualElement);return dom.insertBoundary(fragment,null),dom.insertBoundary(fragment,0),block(env,morph0,context,"floating-window",[],{mainTitle:"FEATURES",subTitle:get(env,context,"model.filename"),close:"back",isLoading:get(env,context,"isLoading")},child0,null),fragment}}}()),Ember.TEMPLATES["workspace/images"]=Ember.HTMLBars.template(function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createElement("div");dom.setAttribute(el1,"id","main-container__input-gallery-container");var el2=dom.createTextNode("\n\n    ");dom.appendChild(el1,el2);var el2=dom.createComment("");dom.appendChild(el1,el2);var el2=dom.createTextNode("\n\n    ");dom.appendChild(el1,el2);var el2=dom.createComment("");dom.appendChild(el1,el2);var el2=dom.createTextNode("\n\n");return dom.appendChild(el1,el2),dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,inline=hooks.inline,content=hooks.content;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var element0=dom.childAt(fragment,[0]),morph0=dom.createMorphAt(element0,1,1),morph1=dom.createMorphAt(element0,3,3);return inline(env,morph0,context,"image-gallery",[],{images:get(env,context,"images"),canImport:get(env,context,"canImport"),expand:"expand",adapter:get(env,context,"adapter")}),content(env,morph1,context,"outlet"),fragment}}}()),Ember.TEMPLATES["workspace/images/detail"]=Ember.HTMLBars.template(function(){var child0=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("\n    ");dom.appendChild(el0,el1);var el1=dom.createComment("");dom.appendChild(el0,el1);var el1=dom.createTextNode("\n\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,inline=hooks.inline;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(fragment,1,1,contextualElement);return inline(env,morph0,context,"image-detail",[],{image:get(env,context,"model"),resource:get(env,context,"resource")}),fragment}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createComment("");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,block=hooks.block;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(fragment,0,0,contextualElement);return dom.insertBoundary(fragment,null),dom.insertBoundary(fragment,0),block(env,morph0,context,"floating-window",[],{mainTitle:"IMAGES",subTitle:get(env,context,"model.filename"),close:"back"},child0,null),fragment}}}()),Ember.TEMPLATES["workspace/matcher"]=Ember.HTMLBars.template(function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createComment("");dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");dom.appendChild(el0,el1);var el1=dom.createComment("");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,inline=hooks.inline,content=hooks.content;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(fragment,0,0,contextualElement),morph1=dom.createMorphAt(fragment,2,2,contextualElement);return dom.insertBoundary(fragment,null),dom.insertBoundary(fragment,0),inline(env,morph0,context,"match-grid",[],{images:get(env,context,"images"),matches:get(env,context,"model"),enter:"enter"}),content(env,morph1,context,"outlet"),fragment}}}()),Ember.TEMPLATES["workspace/matcher/pair"]=Ember.HTMLBars.template(function(){var child0=function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createTextNode("    ");dom.appendChild(el0,el1);var el1=dom.createElement("ul");dom.setAttribute(el1,"class","match-pair__visual-modes");var el2=dom.createTextNode("\n        ");dom.appendChild(el1,el2);var el2=dom.createElement("li"),el3=dom.createComment("");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n        ");dom.appendChild(el1,el2);var el2=dom.createElement("li"),el3=dom.createComment("");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n        ");dom.appendChild(el1,el2);var el2=dom.createElement("li"),el3=dom.createComment("");dom.appendChild(el2,el3),dom.appendChild(el1,el2);var el2=dom.createTextNode("\n    ");dom.appendChild(el1,el2),dom.appendChild(el0,el1);var el1=dom.createTextNode("\n    ");dom.appendChild(el0,el1);var el1=dom.createComment("");dom.appendChild(el0,el1);var el1=dom.createTextNode("\n");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,inline=hooks.inline;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var element0=dom.childAt(fragment,[1]),morph0=dom.createMorphAt(dom.childAt(element0,[1]),0,0),morph1=dom.createMorphAt(dom.childAt(element0,[3]),0,0),morph2=dom.createMorphAt(dom.childAt(element0,[5]),0,0),morph3=dom.createMorphAt(fragment,3,3,contextualElement);return inline(env,morph0,context,"match-mode-tab",[],{mode:"raw",current:get(env,context,"mode")}),inline(env,morph1,context,"match-mode-tab",[],{mode:"robust",current:get(env,context,"mode")}),inline(env,morph2,context,"match-mode-tab",[],{mode:"epipolar",current:get(env,context,"mode")}),inline(env,morph3,context,"visual-matching",[],{resource:get(env,context,"resource"),data:get(env,context,"model"),mode:get(env,context,"mode")}),fragment}}}();return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createComment("");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,block=hooks.block;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(fragment,0,0,contextualElement);return dom.insertBoundary(fragment,null),dom.insertBoundary(fragment,0),block(env,morph0,context,"floating-window",[],{mainTitle:"MATCHES",subTitle:get(env,context,"title"),close:"back"},child0,null),fragment}}}()),Ember.TEMPLATES["workspace/mvs"]=Ember.HTMLBars.template(function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createComment("");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,inline=hooks.inline;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(fragment,0,0,contextualElement);return dom.insertBoundary(fragment,null),dom.insertBoundary(fragment,0),inline(env,morph0,context,"multi-view-stereo",[],{surfels:get(env,context,"model")}),fragment}}}()),Ember.TEMPLATES["workspace/register"]=Ember.HTMLBars.template(function(){return{isHTMLBars:!0,revision:"Ember@1.11.3",blockParams:0,cachedFragment:null,hasRendered:!1,build:function(dom){var el0=dom.createDocumentFragment(),el1=dom.createComment("");return dom.appendChild(el0,el1),el0},render:function(context,env,contextualElement){var dom=env.dom,hooks=env.hooks,get=hooks.get,inline=hooks.inline;dom.detectNamespace(contextualElement);var fragment;env.useFragmentCache&&dom.canClone?(null===this.cachedFragment&&(fragment=this.build(dom),this.hasRendered?this.cachedFragment=fragment:this.hasRendered=!0),this.cachedFragment&&(fragment=dom.cloneNode(this.cachedFragment,!0))):fragment=this.build(dom);var morph0=dom.createMorphAt(fragment,0,0,contextualElement);return dom.insertBoundary(fragment,null),dom.insertBoundary(fragment,0),inline(env,morph0,context,"sparse-reconstruction",[],{sparse:get(env,context,"model.sparse"),cameras:get(env,context,"model.cameras")}),fragment}}}()),function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module){module.exports={name:"Hall-Demo",root:"/demo/Hall-Demo",images:[{id:0,name:"00000000",extension:".jpg"},{id:1,name:"00000001",extension:".jpg"},{id:2,name:"00000002",extension:".jpg"},{id:3,name:"00000003",extension:".jpg"},{id:4,name:"00000004",extension:".jpg"},{id:5,name:"00000005",extension:".jpg"},{id:6,name:"00000006",extension:".jpg"},{id:7,name:"00000007",extension:".jpg"},{id:8,name:"00000008",extension:".jpg"},{id:9,name:"00000009",extension:".jpg"},{id:10,name:"00000010",extension:".jpg"},{id:11,name:"00000011",extension:".jpg"},{id:12,name:"00000012",extension:".jpg"},{id:13,name:"00000013",extension:".jpg"},{id:14,name:"00000014",extension:".jpg"},{id:15,name:"00000015",extension:".jpg"},{id:16,name:"00000016",extension:".jpg"},{id:17,name:"00000017",extension:".jpg"},{id:18,name:"00000018",extension:".jpg"},{id:19,name:"00000019",extension:".jpg"},{id:20,name:"00000020",extension:".jpg"},{id:21,name:"00000021",extension:".jpg"},{id:22,name:"00000022",extension:".jpg"},{id:23,name:"00000023",extension:".jpg"},{id:24,name:"00000024",extension:".jpg"},{id:25,name:"00000025",extension:".jpg"},{id:26,name:"00000026",extension:".jpg"},{id:27,name:"00000027",extension:".jpg"},{id:28,name:"00000028",extension:".jpg"},{id:29,name:"00000029",extension:".jpg"},{id:30,name:"00000030",extension:".jpg"},{id:31,name:"00000031",extension:".jpg"},{id:32,name:"00000032",extension:".jpg"},{id:33,name:"00000033",extension:".jpg"},{id:34,name:"00000034",extension:".jpg"},{id:35,name:"00000035",extension:".jpg"},{id:36,name:"00000036",extension:".jpg"},{id:37,name:"00000037",extension:".jpg"},{id:38,name:"00000038",extension:".jpg"},{id:39,name:"00000039",extension:".jpg"},{id:40,name:"00000040",extension:".jpg"},{id:41,name:"00000041",extension:".jpg"},{id:42,name:"00000042",extension:".jpg"},{id:43,name:"00000043",extension:".jpg"},{id:44,name:"00000044",extension:".jpg"},{id:45,name:"00000045",extension:".jpg"},{id:46,name:"00000046",extension:".jpg"},{id:47,name:"00000047",extension:".jpg"},{id:48,name:"00000048",extension:".jpg"},{id:49,name:"00000049",extension:".jpg"},{id:50,name:"00000050",extension:".jpg"},{id:51,name:"00000051",extension:".jpg"},{id:52,name:"00000052",extension:".jpg"},{id:53,name:"00000053",extension:".jpg"},{id:54,name:"00000054",extension:".jpg"},{id:55,name:"00000055",extension:".jpg"},{id:56,name:"00000056",extension:".jpg"},{id:57,name:"00000057",extension:".jpg"},{id:58,name:"00000058",extension:".jpg"},{id:59,name:"00000059",extension:".jpg"},{id:60,name:"00000060",extension:".jpg"}],desc:'<p>This demo is created from PMVS&#39;s included hall demo image set (<a href="http://www.di.ens.fr/pmvs/" target="_blank">source</a>).</p><p>This demo is a reference project, it is mostly generated by external tools:</p><p>SIFT features are generated from Lowe&#39;s <em>SIFT</em> (<a target="_blank" href="http://www.cs.ubc.ca/~lowe/keypoints/">source</a>).</p><p>Feature matches are generated by <em>WebMatcher</em> (WebSFM&#39;s javascript implementation of kd-tree based ANN matcher).</p><p>Sparse reconstruction is recovered by Noah Snavely&#39;s <em>Bundler</em> (<a target="_blank" href="http://www.cs.cornell.edu/~snavely/bundler/">source</a>).</p><p>Dense reconstruction is generated by Yasutaka Furukawa&#39;s <em>PMVS</em> (<a target="_blank" href="http://www.di.ens.fr/pmvs/">source</a>).</p>',entries:["image","match","feature","calibration","mvs"]}},{}],2:[function(require,module){module.exports={name:"Leuven-City-Hall-Demo",root:"/demo/Leuven-City-Hall-Demo",images:[{id:0,name:"000",extension:".png"},{id:1,name:"001",extension:".png"},{id:2,name:"002",extension:".png"},{id:3,name:"003",extension:".png"},{id:4,name:"004",extension:".png"},{id:5,name:"005",extension:".png"},{id:6,name:"006",extension:".png"}],desc:'<p>This demo is created from Leuven cityhall image set (<a target="_blank" href="http://cvlab.epfl.ch/data/strechamvs">source</a>).</p><p>Structure-from-Motion of this demo is complete:</p><p>SIFT features are generated from <em>WebSIFT</em> (WebSFM&#39;s javascript implementation of SIFT).</p><p>Feature matches are generated by <em>WebMatcher</em> (WebSFM&#39;s javascript implementation of kd-tree based ANN matcher).</p><p>Sparse reconstruction is recovered by <em>WebRegister</em> (WebSFM&#39;s javascript implementation of Bundler and Sparse Bundle Adjustment), the initial pair of camera is still unstable.</p><p>Dense reconstruction is generated by Yasutaka Furukawa&#39;s <em>PMVS</em> (<a target="_blank" href="http://www.di.ens.fr/pmvs/">source</a>), WebSFM&#39;s implementation of PMVS is still under construction.</p>',entries:["image","feature","match","calibration","mvs"]}},{}],3:[function(require,module){module.exports={name:"Rosetta-Spacecraft",root:"/demo/Rosetta-Spacecraft",images:[{id:0,name:"Colour_image_of_comet",extension:".jpg"},{id:1,name:"Comet_on_5_September_2014",extension:".jpg"},{id:2,name:"Comet_on_7_August_a",extension:".jpg"},{id:3,name:"Comet_on_7_August_b",extension:".jpg"},{id:4,name:"Comet_on_7_December_2014_NavCam",extension:".jpg"},{id:5,name:"Comet_on_9_December_2014_NavCam",extension:".jpg"},{id:6,name:"Comet_on_10_December_2014_NavCam",extension:".jpg"},{id:7,name:"Comet_on_14_September_2014_-_NavCam",extension:".jpg"},{id:8,name:"Comet_on_17_November_NavCam",extension:".jpg"},{id:9,name:"Comet_on_19_September_2014_NavCam",extension:".jpg"},{id:10,name:"Comet_on_22_August_2014_-_NavCam",extension:".jpg"},{id:11,name:"Comet_on_24_September_NavCam",extension:".jpg"},{id:12,name:"Comet_on_4_November_NavCam",extension:".jpg"},{id:13,name:"Comet_on_12_January_2015_NavCam",extension:".jpg"},{id:14,name:"ESA_Rosetta_Navcam_20150122_mosaic-1024x906",extension:".jpg"},{id:15,name:"ESA_Rosetta_NavCam_20150131_Mosaic-1024x958",extension:".jpg"},{id:16,name:"ESA_Rosetta_NavCam_20150203_Mosaic-938x1024",extension:".jpg"},{id:17,name:"ESA_Rosetta_NAVCAM_20150118_mosaic-950x1024",extension:".jpg"},{id:18,name:"ESA_Rosetta_NAVCAM_20150121_mosaic-1024x969",extension:".jpg"},{id:19,name:"False_colour_comet_Hapi_region",extension:".jpg"},{id:20,name:"Comet_on_21_August_2014_-_NavCam",extension:".jpg"},{id:21,name:"Comet_on_17_August_2014_-_NavCam",extension:".jpg"},{id:22,name:"Comet_on_10_January_2015_NavCam",extension:".jpg"},{id:23,name:"Comet_on_1_January_2015_NavCam",extension:".jpg"},{id:24,name:"Comet_on_2_December_NavCam",extension:".jpg"},{id:25,name:"Agilkia_landing_site_6_November_2014",extension:".jpg"},{id:26,name:"Comet_on_1_December_2014_NavCam",extension:".jpg"}],desc:'<p>This demo is created using photos captured by <em>Rosetta Spacecraft</em> (<a href="http://rosetta.jpl.nasa.gov/gallery/images/comet-67p/churyumov-gerasimenko" target="_blank">source</a>).</p><p>Structure from Motion of this demo is incomplete, not enough matches are found between the images.<br/>This can be solved by adding manual matching into the application.</p><p>SIFT features are generated from <em>WebSIFT</em> (WebSFM&#39;s javascript implementation of SIFT).</p><p>Feature matches are generated by <em>WebMatcher</em> (WebSFM&#39;s javascript implementation of kd-tree based ANN matcher).</p>',entries:["image","feature","match"]}},{}],4:[function(require,module){"use strict";module.exports=[{name:"Hall-Demo",description:require("./Hall-Demo/description.js")},{name:"Leuven-City-Hall-Demo",description:require("./Leuven-City-Hall-Demo/description.js")},{name:"Rosetta-Spacecraft",description:require("./Rosetta-Spacecraft/description.js")}]},{"./Hall-Demo/description.js":1,"./Leuven-City-Hall-Demo/description.js":2,"./Rosetta-Spacecraft/description.js":3}],5:[function(){},{}],6:[function(require,module,exports){function Buffer(subject,encoding,noZero){if(!(this instanceof Buffer))return new Buffer(subject,encoding,noZero);var length,type=typeof subject;if("number"===type)length=+subject;else if("string"===type)length=Buffer.byteLength(subject,encoding);else{if("object"!==type||null===subject)throw new TypeError("must start with number, buffer, array or string");"Buffer"===subject.type&&isArray(subject.data)&&(subject=subject.data),length=+subject.length
}if(length>kMaxLength)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength.toString(16)+" bytes");0>length?length=0:length>>>=0;var self=this;Buffer.TYPED_ARRAY_SUPPORT?self=Buffer._augment(new Uint8Array(length)):(self.length=length,self._isBuffer=!0);var i;if(Buffer.TYPED_ARRAY_SUPPORT&&"number"==typeof subject.byteLength)self._set(subject);else if(isArrayish(subject))if(Buffer.isBuffer(subject))for(i=0;length>i;i++)self[i]=subject.readUInt8(i);else for(i=0;length>i;i++)self[i]=(subject[i]%256+256)%256;else if("string"===type)self.write(subject,0,encoding);else if("number"===type&&!Buffer.TYPED_ARRAY_SUPPORT&&!noZero)for(i=0;length>i;i++)self[i]=0;return length>0&&length<=Buffer.poolSize&&(self.parent=rootParent),self}function SlowBuffer(subject,encoding,noZero){if(!(this instanceof SlowBuffer))return new SlowBuffer(subject,encoding,noZero);var buf=new Buffer(subject,encoding,noZero);return delete buf.parent,buf}function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;length?(length=Number(length),length>remaining&&(length=remaining)):length=remaining;var strLen=string.length;if(strLen%2!==0)throw new Error("Invalid hex string");length>strLen/2&&(length=strLen/2);for(var i=0;length>i;i++){var byte=parseInt(string.substr(2*i,2),16);if(isNaN(byte))throw new Error("Invalid hex string");buf[offset+i]=byte}return i}function utf8Write(buf,string,offset,length){var charsWritten=blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length);return charsWritten}function asciiWrite(buf,string,offset,length){var charsWritten=blitBuffer(asciiToBytes(string),buf,offset,length);return charsWritten}function binaryWrite(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){var charsWritten=blitBuffer(base64ToBytes(string),buf,offset,length);return charsWritten}function utf16leWrite(buf,string,offset,length){var charsWritten=blitBuffer(utf16leToBytes(string,buf.length-offset),buf,offset,length);return charsWritten}function base64Slice(buf,start,end){return base64.fromByteArray(0===start&&end===buf.length?buf:buf.slice(start,end))}function utf8Slice(buf,start,end){var res="",tmp="";end=Math.min(buf.length,end);for(var i=start;end>i;i++)buf[i]<=127?(res+=decodeUtf8Char(tmp)+String.fromCharCode(buf[i]),tmp=""):tmp+="%"+buf[i].toString(16);return res+decodeUtf8Char(tmp)}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;end>i;i++)ret+=String.fromCharCode(127&buf[i]);return ret}function binarySlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;end>i;i++)ret+=String.fromCharCode(buf[i]);return ret}function hexSlice(buf,start,end){var len=buf.length;(!start||0>start)&&(start=0),(!end||0>end||end>len)&&(end=len);for(var out="",i=start;end>i;i++)out+=toHex(buf[i]);return out}function utf16leSlice(buf,start,end){for(var bytes=buf.slice(start,end),res="",i=0;i<bytes.length;i+=2)res+=String.fromCharCode(bytes[i]+256*bytes[i+1]);return res}function checkOffset(offset,ext,length){if(offset%1!==0||0>offset)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError("buffer must be a Buffer instance");if(value>max||min>value)throw new RangeError("value is out of bounds");if(offset+ext>buf.length)throw new RangeError("index out of range")}function objectWriteUInt16(buf,value,offset,littleEndian){0>value&&(value=65535+value+1);for(var i=0,j=Math.min(buf.length-offset,2);j>i;i++)buf[offset+i]=(value&255<<8*(littleEndian?i:1-i))>>>8*(littleEndian?i:1-i)}function objectWriteUInt32(buf,value,offset,littleEndian){0>value&&(value=4294967295+value+1);for(var i=0,j=Math.min(buf.length-offset,4);j>i;i++)buf[offset+i]=value>>>8*(littleEndian?i:3-i)&255}function checkIEEE754(buf,value,offset,ext,max,min){if(value>max||min>value)throw new RangeError("value is out of bounds");if(offset+ext>buf.length)throw new RangeError("index out of range");if(0>offset)throw new RangeError("index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,value,offset,4,3.4028234663852886e38,-3.4028234663852886e38),ieee754.write(buf,value,offset,littleEndian,23,4),offset+4}function writeDouble(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,value,offset,8,1.7976931348623157e308,-1.7976931348623157e308),ieee754.write(buf,value,offset,littleEndian,52,8),offset+8}function base64clean(str){if(str=stringtrim(str).replace(INVALID_BASE64_RE,""),str.length<2)return"";for(;str.length%4!==0;)str+="=";return str}function stringtrim(str){return str.trim?str.trim():str.replace(/^\s+|\s+$/g,"")}function isArrayish(subject){return isArray(subject)||Buffer.isBuffer(subject)||subject&&"object"==typeof subject&&"number"==typeof subject.length}function toHex(n){return 16>n?"0"+n.toString(16):n.toString(16)}function utf8ToBytes(string,units){units=units||1/0;for(var codePoint,length=string.length,leadSurrogate=null,bytes=[],i=0;length>i;i++){if(codePoint=string.charCodeAt(i),codePoint>55295&&57344>codePoint){if(!leadSurrogate){if(codePoint>56319){(units-=3)>-1&&bytes.push(239,191,189);continue}if(i+1===length){(units-=3)>-1&&bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(56320>codePoint){(units-=3)>-1&&bytes.push(239,191,189),leadSurrogate=codePoint;continue}codePoint=leadSurrogate-55296<<10|codePoint-56320|65536,leadSurrogate=null}else leadSurrogate&&((units-=3)>-1&&bytes.push(239,191,189),leadSurrogate=null);if(128>codePoint){if((units-=1)<0)break;bytes.push(codePoint)}else if(2048>codePoint){if((units-=2)<0)break;bytes.push(codePoint>>6|192,63&codePoint|128)}else if(65536>codePoint){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,63&codePoint|128)}else{if(!(2097152>codePoint))throw new Error("Invalid code point");if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,63&codePoint|128)}}return bytes}function asciiToBytes(str){for(var byteArray=[],i=0;i<str.length;i++)byteArray.push(255&str.charCodeAt(i));return byteArray}function utf16leToBytes(str,units){for(var c,hi,lo,byteArray=[],i=0;i<str.length&&!((units-=2)<0);i++)c=str.charCodeAt(i),hi=c>>8,lo=c%256,byteArray.push(lo),byteArray.push(hi);return byteArray}function base64ToBytes(str){return base64.toByteArray(base64clean(str))}function blitBuffer(src,dst,offset,length){for(var i=0;length>i&&!(i+offset>=dst.length||i>=src.length);i++)dst[i+offset]=src[i];return i}function decodeUtf8Char(str){try{return decodeURIComponent(str)}catch(err){return String.fromCharCode(65533)}}var base64=require("base64-js"),ieee754=require("ieee754"),isArray=require("is-array");exports.Buffer=Buffer,exports.SlowBuffer=SlowBuffer,exports.INSPECT_MAX_BYTES=50,Buffer.poolSize=8192;var kMaxLength=1073741823,rootParent={};Buffer.TYPED_ARRAY_SUPPORT=function(){try{var buf=new ArrayBuffer(0),arr=new Uint8Array(buf);return arr.foo=function(){return 42},42===arr.foo()&&"function"==typeof arr.subarray&&0===new Uint8Array(1).subarray(1,1).byteLength}catch(e){return!1}}(),Buffer.isBuffer=function(b){return!(null==b||!b._isBuffer)},Buffer.compare=function(a,b){if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);len>i&&a[i]===b[i];i++);return i!==len&&(x=a[i],y=b[i]),y>x?-1:x>y?1:0},Buffer.isEncoding=function(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(list,totalLength){if(!isArray(list))throw new TypeError("Usage: Buffer.concat(list[, length])");if(0===list.length)return new Buffer(0);if(1===list.length)return list[0];var i;if(void 0===totalLength)for(totalLength=0,i=0;i<list.length;i++)totalLength+=list[i].length;var buf=new Buffer(totalLength),pos=0;for(i=0;i<list.length;i++){var item=list[i];item.copy(buf,pos),pos+=item.length}return buf},Buffer.byteLength=function(str,encoding){var ret;switch(str+="",encoding||"utf8"){case"ascii":case"binary":case"raw":ret=str.length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":ret=2*str.length;break;case"hex":ret=str.length>>>1;break;case"utf8":case"utf-8":ret=utf8ToBytes(str).length;break;case"base64":ret=base64ToBytes(str).length;break;default:ret=str.length}return ret},Buffer.prototype.length=void 0,Buffer.prototype.parent=void 0,Buffer.prototype.toString=function(encoding,start,end){var loweredCase=!1;if(start>>>=0,end=void 0===end||1/0===end?this.length:end>>>0,encoding||(encoding="utf8"),0>start&&(start=0),end>this.length&&(end=this.length),start>=end)return"";for(;;)switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"binary":return binarySlice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase(),loweredCase=!0}},Buffer.prototype.equals=function(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b?!0:0===Buffer.compare(this,b)},Buffer.prototype.inspect=function(){var str="",max=exports.INSPECT_MAX_BYTES;return this.length>0&&(str=this.toString("hex",0,max).match(/.{2}/g).join(" "),this.length>max&&(str+=" ... ")),"<Buffer "+str+">"},Buffer.prototype.compare=function(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b?0:Buffer.compare(this,b)},Buffer.prototype.get=function(offset){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(offset)},Buffer.prototype.set=function(v,offset){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(v,offset)},Buffer.prototype.write=function(string,offset,length,encoding){if(isFinite(offset))isFinite(length)||(encoding=length,length=void 0);else{var swap=encoding;encoding=offset,offset=length,length=swap}if(offset=Number(offset)||0,0>length||0>offset||offset>this.length)throw new RangeError("attempt to write outside buffer bounds");var remaining=this.length-offset;length?(length=Number(length),length>remaining&&(length=remaining)):length=remaining,encoding=String(encoding||"utf8").toLowerCase();var ret;switch(encoding){case"hex":ret=hexWrite(this,string,offset,length);break;case"utf8":case"utf-8":ret=utf8Write(this,string,offset,length);break;case"ascii":ret=asciiWrite(this,string,offset,length);break;case"binary":ret=binaryWrite(this,string,offset,length);break;case"base64":ret=base64Write(this,string,offset,length);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":ret=utf16leWrite(this,string,offset,length);break;default:throw new TypeError("Unknown encoding: "+encoding)}return ret},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},Buffer.prototype.slice=function(start,end){var len=this.length;start=~~start,end=void 0===end?len:~~end,0>start?(start+=len,0>start&&(start=0)):start>len&&(start=len),0>end?(end+=len,0>end&&(end=0)):end>len&&(end=len),start>end&&(end=start);var newBuf;if(Buffer.TYPED_ARRAY_SUPPORT)newBuf=Buffer._augment(this.subarray(start,end));else{var sliceLen=end-start;newBuf=new Buffer(sliceLen,void 0,!0);for(var i=0;sliceLen>i;i++)newBuf[i]=this[i+start]}return newBuf.length&&(newBuf.parent=this.parent||this),newBuf},Buffer.prototype.readUIntLE=function(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val},Buffer.prototype.readUIntBE=function(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset+--byteLength],mul=1;byteLength>0&&(mul*=256);)val+=this[offset+--byteLength]*mul;return val},Buffer.prototype.readUInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),this[offset]},Buffer.prototype.readUInt16LE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]|this[offset+1]<<8},Buffer.prototype.readUInt16BE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]<<8|this[offset+1]},Buffer.prototype.readUInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+16777216*this[offset+3]},Buffer.prototype.readUInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),16777216*this[offset]+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])},Buffer.prototype.readIntLE=function(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return mul*=128,val>=mul&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readIntBE=function(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var i=byteLength,mul=1,val=this[offset+--i];i>0&&(mul*=256);)val+=this[offset+--i]*mul;return mul*=128,val>=mul&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),128&this[offset]?-1*(255-this[offset]+1):this[offset]},Buffer.prototype.readInt16LE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt16BE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24},Buffer.prototype.readInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]},Buffer.prototype.readFloatLE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!0,23,4)},Buffer.prototype.readFloatBE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!1,23,4)},Buffer.prototype.readDoubleLE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!0,52,8)},Buffer.prototype.readDoubleBE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!1,52,8)},Buffer.prototype.writeUIntLE=function(value,offset,byteLength,noAssert){value=+value,offset>>>=0,byteLength>>>=0,noAssert||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength),0);var mul=1,i=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)this[offset+i]=value/mul>>>0&255;return offset+byteLength},Buffer.prototype.writeUIntBE=function(value,offset,byteLength,noAssert){value=+value,offset>>>=0,byteLength>>>=0,noAssert||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength),0);var i=byteLength-1,mul=1;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)this[offset+i]=value/mul>>>0&255;return offset+byteLength},Buffer.prototype.writeUInt8=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),this[offset]=value,offset+1},Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset+3]=value>>>24,this[offset+2]=value>>>16,this[offset+1]=value>>>8,this[offset]=value):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeIntLE=function(value,offset,byteLength,noAssert){value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength-1)-1,-Math.pow(2,8*byteLength-1));var i=0,mul=1,sub=0>value?1:0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeIntBE=function(value,offset,byteLength,noAssert){value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength-1)-1,-Math.pow(2,8*byteLength-1));var i=byteLength-1,mul=1,sub=0>value?1:0;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeInt8=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),0>value&&(value=255+value+1),this[offset]=value,offset+1},Buffer.prototype.writeInt16LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeInt16BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeInt32LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value,this[offset+1]=value>>>8,this[offset+2]=value>>>16,this[offset+3]=value>>>24):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeInt32BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),0>value&&(value=4294967295+value+1),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeFloatLE=function(value,offset,noAssert){return writeFloat(this,value,offset,!0,noAssert)},Buffer.prototype.writeFloatBE=function(value,offset,noAssert){return writeFloat(this,value,offset,!1,noAssert)},Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){return writeDouble(this,value,offset,!0,noAssert)},Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){return writeDouble(this,value,offset,!1,noAssert)},Buffer.prototype.copy=function(target,target_start,start,end){var self=this;if(start||(start=0),end||0===end||(end=this.length),target_start>=target.length&&(target_start=target.length),target_start||(target_start=0),end>0&&start>end&&(end=start),end===start)return 0;if(0===target.length||0===self.length)return 0;if(0>target_start)throw new RangeError("targetStart out of bounds");if(0>start||start>=self.length)throw new RangeError("sourceStart out of bounds");if(0>end)throw new RangeError("sourceEnd out of bounds");end>this.length&&(end=this.length),target.length-target_start<end-start&&(end=target.length-target_start+start);var len=end-start;if(1e3>len||!Buffer.TYPED_ARRAY_SUPPORT)for(var i=0;len>i;i++)target[i+target_start]=this[i+start];else target._set(this.subarray(start,start+len),target_start);return len},Buffer.prototype.fill=function(value,start,end){if(value||(value=0),start||(start=0),end||(end=this.length),start>end)throw new RangeError("end < start");if(end!==start&&0!==this.length){if(0>start||start>=this.length)throw new RangeError("start out of bounds");if(0>end||end>this.length)throw new RangeError("end out of bounds");var i;if("number"==typeof value)for(i=start;end>i;i++)this[i]=value;else{var bytes=utf8ToBytes(value.toString()),len=bytes.length;for(i=start;end>i;i++)this[i]=bytes[i%len]}return this}},Buffer.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(Buffer.TYPED_ARRAY_SUPPORT)return new Buffer(this).buffer;for(var buf=new Uint8Array(this.length),i=0,len=buf.length;len>i;i+=1)buf[i]=this[i];return buf.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var BP=Buffer.prototype;Buffer._augment=function(arr){return arr.constructor=Buffer,arr._isBuffer=!0,arr._get=arr.get,arr._set=arr.set,arr.get=BP.get,arr.set=BP.set,arr.write=BP.write,arr.toString=BP.toString,arr.toLocaleString=BP.toString,arr.toJSON=BP.toJSON,arr.equals=BP.equals,arr.compare=BP.compare,arr.copy=BP.copy,arr.slice=BP.slice,arr.readUIntLE=BP.readUIntLE,arr.readUIntBE=BP.readUIntBE,arr.readUInt8=BP.readUInt8,arr.readUInt16LE=BP.readUInt16LE,arr.readUInt16BE=BP.readUInt16BE,arr.readUInt32LE=BP.readUInt32LE,arr.readUInt32BE=BP.readUInt32BE,arr.readIntLE=BP.readIntLE,arr.readIntBE=BP.readIntBE,arr.readInt8=BP.readInt8,arr.readInt16LE=BP.readInt16LE,arr.readInt16BE=BP.readInt16BE,arr.readInt32LE=BP.readInt32LE,arr.readInt32BE=BP.readInt32BE,arr.readFloatLE=BP.readFloatLE,arr.readFloatBE=BP.readFloatBE,arr.readDoubleLE=BP.readDoubleLE,arr.readDoubleBE=BP.readDoubleBE,arr.writeUInt8=BP.writeUInt8,arr.writeUIntLE=BP.writeUIntLE,arr.writeUIntBE=BP.writeUIntBE,arr.writeUInt16LE=BP.writeUInt16LE,arr.writeUInt16BE=BP.writeUInt16BE,arr.writeUInt32LE=BP.writeUInt32LE,arr.writeUInt32BE=BP.writeUInt32BE,arr.writeIntLE=BP.writeIntLE,arr.writeIntBE=BP.writeIntBE,arr.writeInt8=BP.writeInt8,arr.writeInt16LE=BP.writeInt16LE,arr.writeInt16BE=BP.writeInt16BE,arr.writeInt32LE=BP.writeInt32LE,arr.writeInt32BE=BP.writeInt32BE,arr.writeFloatLE=BP.writeFloatLE,arr.writeFloatBE=BP.writeFloatBE,arr.writeDoubleLE=BP.writeDoubleLE,arr.writeDoubleBE=BP.writeDoubleBE,arr.fill=BP.fill,arr.inspect=BP.inspect,arr.toArrayBuffer=BP.toArrayBuffer,arr};var INVALID_BASE64_RE=/[^+\/0-9A-z\-]/g},{"base64-js":7,ieee754:8,"is-array":9}],7:[function(require,module,exports){var lookup="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(exports){"use strict";function decode(elt){var code=elt.charCodeAt(0);return code===PLUS||code===PLUS_URL_SAFE?62:code===SLASH||code===SLASH_URL_SAFE?63:NUMBER>code?-1:NUMBER+10>code?code-NUMBER+26+26:UPPER+26>code?code-UPPER:LOWER+26>code?code-LOWER+26:void 0}function b64ToByteArray(b64){function push(v){arr[L++]=v}var i,j,l,tmp,placeHolders,arr;if(b64.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var len=b64.length;placeHolders="="===b64.charAt(len-2)?2:"="===b64.charAt(len-1)?1:0,arr=new Arr(3*b64.length/4-placeHolders),l=placeHolders>0?b64.length-4:b64.length;var L=0;for(i=0,j=0;l>i;i+=4,j+=3)tmp=decode(b64.charAt(i))<<18|decode(b64.charAt(i+1))<<12|decode(b64.charAt(i+2))<<6|decode(b64.charAt(i+3)),push((16711680&tmp)>>16),push((65280&tmp)>>8),push(255&tmp);return 2===placeHolders?(tmp=decode(b64.charAt(i))<<2|decode(b64.charAt(i+1))>>4,push(255&tmp)):1===placeHolders&&(tmp=decode(b64.charAt(i))<<10|decode(b64.charAt(i+1))<<4|decode(b64.charAt(i+2))>>2,push(tmp>>8&255),push(255&tmp)),arr}function uint8ToBase64(uint8){function encode(num){return lookup.charAt(num)}function tripletToBase64(num){return encode(num>>18&63)+encode(num>>12&63)+encode(num>>6&63)+encode(63&num)}var i,temp,length,extraBytes=uint8.length%3,output="";for(i=0,length=uint8.length-extraBytes;length>i;i+=3)temp=(uint8[i]<<16)+(uint8[i+1]<<8)+uint8[i+2],output+=tripletToBase64(temp);switch(extraBytes){case 1:temp=uint8[uint8.length-1],output+=encode(temp>>2),output+=encode(temp<<4&63),output+="==";break;case 2:temp=(uint8[uint8.length-2]<<8)+uint8[uint8.length-1],output+=encode(temp>>10),output+=encode(temp>>4&63),output+=encode(temp<<2&63),output+="="}return output}var Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,PLUS="+".charCodeAt(0),SLASH="/".charCodeAt(0),NUMBER="0".charCodeAt(0),LOWER="a".charCodeAt(0),UPPER="A".charCodeAt(0),PLUS_URL_SAFE="-".charCodeAt(0),SLASH_URL_SAFE="_".charCodeAt(0);exports.toByteArray=b64ToByteArray,exports.fromByteArray=uint8ToBase64}("undefined"==typeof exports?this.base64js={}:exports)},{}],8:[function(require,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isLE?nBytes-1:0,d=isLE?-1:1,s=buffer[offset+i];for(i+=d,e=s&(1<<-nBits)-1,s>>=-nBits,nBits+=eLen;nBits>0;e=256*e+buffer[offset+i],i+=d,nBits-=8);for(m=e&(1<<-nBits)-1,e>>=-nBits,nBits+=mLen;nBits>0;m=256*m+buffer[offset+i],i+=d,nBits-=8);if(0===e)e=1-eBias;else{if(e===eMax)return m?0/0:1/0*(s?-1:1);m+=Math.pow(2,mLen),e-=eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)},exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=23===mLen?Math.pow(2,-24)-Math.pow(2,-77):0,i=isLE?0:nBytes-1,d=isLE?1:-1,s=0>value||0===value&&0>1/value?1:0;for(value=Math.abs(value),isNaN(value)||1/0===value?(m=isNaN(value)?1:0,e=eMax):(e=Math.floor(Math.log(value)/Math.LN2),value*(c=Math.pow(2,-e))<1&&(e--,c*=2),value+=e+eBias>=1?rt/c:rt*Math.pow(2,1-eBias),value*c>=2&&(e++,c/=2),e+eBias>=eMax?(m=0,e=eMax):e+eBias>=1?(m=(value*c-1)*Math.pow(2,mLen),e+=eBias):(m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen),e=0));mLen>=8;buffer[offset+i]=255&m,i+=d,m/=256,mLen-=8);for(e=e<<mLen|m,eLen+=mLen;eLen>0;buffer[offset+i]=255&e,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=128*s}},{}],9:[function(require,module){var isArray=Array.isArray,str=Object.prototype.toString;module.exports=isArray||function(val){return!!val&&"[object Array]"==str.call(val)}},{}],10:[function(require,module){function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(arg){return"function"==typeof arg}function isNumber(arg){return"number"==typeof arg}function isObject(arg){return"object"==typeof arg&&null!==arg}function isUndefined(arg){return void 0===arg}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||0>n||isNaN(n))throw TypeError("n must be a positive number");return this._maxListeners=n,this},EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(this._events||(this._events={}),"error"===type&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length)){if(er=arguments[1],er instanceof Error)throw er;throw TypeError('Uncaught, unspecified "error" event.')}if(handler=this._events[type],isUndefined(handler))return!1;if(isFunction(handler))switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:for(len=arguments.length,args=new Array(len-1),i=1;len>i;i++)args[i-1]=arguments[i];handler.apply(this,args)}else if(isObject(handler)){for(len=arguments.length,args=new Array(len-1),i=1;len>i;i++)args[i-1]=arguments[i];for(listeners=handler.slice(),len=listeners.length,i=0;len>i;i++)listeners[i].apply(this,args)}return!0},EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener),this._events[type]?isObject(this._events[type])?this._events[type].push(listener):this._events[type]=[this._events[type],listener]:this._events[type]=listener,isObject(this._events[type])&&!this._events[type].warned){var m;m=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners,m&&m>0&&this._events[type].length>m&&(this._events[type].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[type].length),"function"==typeof console.trace&&console.trace())}return this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(type,listener){function g(){this.removeListener(type,g),fired||(fired=!0,listener.apply(this,arguments))}if(!isFunction(listener))throw TypeError("listener must be a function");var fired=!1;return g.listener=listener,this.on(type,g),this},EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;if(list=this._events[type],length=list.length,position=-1,list===listener||isFunction(list.listener)&&list.listener===listener)delete this._events[type],this._events.removeListener&&this.emit("removeListener",type,listener);else if(isObject(list)){for(i=length;i-->0;)if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}if(0>position)return this;1===list.length?(list.length=0,delete this._events[type]):list.splice(position,1),this._events.removeListener&&this.emit("removeListener",type,listener)}return this},EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[type]&&delete this._events[type],this;if(0===arguments.length){for(key in this._events)"removeListener"!==key&&this.removeAllListeners(key);return this.removeAllListeners("removeListener"),this._events={},this}if(listeners=this._events[type],isFunction(listeners))this.removeListener(type,listeners);else for(;listeners.length;)this.removeListener(type,listeners[listeners.length-1]);return delete this._events[type],this},EventEmitter.prototype.listeners=function(type){var ret;return ret=this._events&&this._events[type]?isFunction(this._events[type])?[this._events[type]]:this._events[type].slice():[]},EventEmitter.listenerCount=function(emitter,type){var ret;return ret=emitter._events&&emitter._events[type]?isFunction(emitter._events[type])?1:emitter._events[type].length:0}},{}],11:[function(require,module){module.exports="function"==typeof Object.create?function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})}:function(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}},{}],12:[function(require,module,exports){(function(process){function normalizeArray(parts,allowAboveRoot){for(var up=0,i=parts.length-1;i>=0;i--){var last=parts[i];"."===last?parts.splice(i,1):".."===last?(parts.splice(i,1),up++):up&&(parts.splice(i,1),up--)
}if(allowAboveRoot)for(;up--;up)parts.unshift("..");return parts}function filter(xs,f){if(xs.filter)return xs.filter(f);for(var res=[],i=0;i<xs.length;i++)f(xs[i],i,xs)&&res.push(xs[i]);return res}var splitPathRe=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,splitPath=function(filename){return splitPathRe.exec(filename).slice(1)};exports.resolve=function(){for(var resolvedPath="",resolvedAbsolute=!1,i=arguments.length-1;i>=-1&&!resolvedAbsolute;i--){var path=i>=0?arguments[i]:process.cwd();if("string"!=typeof path)throw new TypeError("Arguments to path.resolve must be strings");path&&(resolvedPath=path+"/"+resolvedPath,resolvedAbsolute="/"===path.charAt(0))}return resolvedPath=normalizeArray(filter(resolvedPath.split("/"),function(p){return!!p}),!resolvedAbsolute).join("/"),(resolvedAbsolute?"/":"")+resolvedPath||"."},exports.normalize=function(path){var isAbsolute=exports.isAbsolute(path),trailingSlash="/"===substr(path,-1);return path=normalizeArray(filter(path.split("/"),function(p){return!!p}),!isAbsolute).join("/"),path||isAbsolute||(path="."),path&&trailingSlash&&(path+="/"),(isAbsolute?"/":"")+path},exports.isAbsolute=function(path){return"/"===path.charAt(0)},exports.join=function(){var paths=Array.prototype.slice.call(arguments,0);return exports.normalize(filter(paths,function(p){if("string"!=typeof p)throw new TypeError("Arguments to path.join must be strings");return p}).join("/"))},exports.relative=function(from,to){function trim(arr){for(var start=0;start<arr.length&&""===arr[start];start++);for(var end=arr.length-1;end>=0&&""===arr[end];end--);return start>end?[]:arr.slice(start,end-start+1)}from=exports.resolve(from).substr(1),to=exports.resolve(to).substr(1);for(var fromParts=trim(from.split("/")),toParts=trim(to.split("/")),length=Math.min(fromParts.length,toParts.length),samePartsLength=length,i=0;length>i;i++)if(fromParts[i]!==toParts[i]){samePartsLength=i;break}for(var outputParts=[],i=samePartsLength;i<fromParts.length;i++)outputParts.push("..");return outputParts=outputParts.concat(toParts.slice(samePartsLength)),outputParts.join("/")},exports.sep="/",exports.delimiter=":",exports.dirname=function(path){var result=splitPath(path),root=result[0],dir=result[1];return root||dir?(dir&&(dir=dir.substr(0,dir.length-1)),root+dir):"."},exports.basename=function(path,ext){var f=splitPath(path)[2];return ext&&f.substr(-1*ext.length)===ext&&(f=f.substr(0,f.length-ext.length)),f},exports.extname=function(path){return splitPath(path)[3]};var substr="b"==="ab".substr(-1)?function(str,start,len){return str.substr(start,len)}:function(str,start,len){return 0>start&&(start=str.length+start),str.substr(start,len)}}).call(this,require("_process"))},{_process:13}],13:[function(require,module){function drainQueue(){if(!draining){draining=!0;for(var currentQueue,len=queue.length;len;){currentQueue=queue,queue=[];for(var i=-1;++i<len;)currentQueue[i]();len=queue.length}draining=!1}}function noop(){}var process=module.exports={},queue=[],draining=!1;process.nextTick=function(fun){queue.push(fun),draining||setTimeout(drainQueue,0)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},{}],14:[function(require,module){module.exports=function(arg){return arg&&"object"==typeof arg&&"function"==typeof arg.copy&&"function"==typeof arg.fill&&"function"==typeof arg.readUInt8}},{}],15:[function(require,module,exports){(function(process,global){function inspect(obj,opts){var ctx={seen:[],stylize:stylizeNoColor};return arguments.length>=3&&(ctx.depth=arguments[2]),arguments.length>=4&&(ctx.colors=arguments[3]),isBoolean(opts)?ctx.showHidden=opts:opts&&exports._extend(ctx,opts),isUndefined(ctx.showHidden)&&(ctx.showHidden=!1),isUndefined(ctx.depth)&&(ctx.depth=2),isUndefined(ctx.colors)&&(ctx.colors=!1),isUndefined(ctx.customInspect)&&(ctx.customInspect=!0),ctx.colors&&(ctx.stylize=stylizeWithColor),formatValue(ctx,obj,ctx.depth)}function stylizeWithColor(str,styleType){var style=inspect.styles[styleType];return style?"["+inspect.colors[style][0]+"m"+str+"["+inspect.colors[style][1]+"m":str}function stylizeNoColor(str){return str}function arrayToHash(array){var hash={};return array.forEach(function(val){hash[val]=!0}),hash}function formatValue(ctx,value,recurseTimes){if(ctx.customInspect&&value&&isFunction(value.inspect)&&value.inspect!==exports.inspect&&(!value.constructor||value.constructor.prototype!==value)){var ret=value.inspect(recurseTimes,ctx);return isString(ret)||(ret=formatValue(ctx,ret,recurseTimes)),ret}var primitive=formatPrimitive(ctx,value);if(primitive)return primitive;var keys=Object.keys(value),visibleKeys=arrayToHash(keys);if(ctx.showHidden&&(keys=Object.getOwnPropertyNames(value)),isError(value)&&(keys.indexOf("message")>=0||keys.indexOf("description")>=0))return formatError(value);if(0===keys.length){if(isFunction(value)){var name=value.name?": "+value.name:"";return ctx.stylize("[Function"+name+"]","special")}if(isRegExp(value))return ctx.stylize(RegExp.prototype.toString.call(value),"regexp");if(isDate(value))return ctx.stylize(Date.prototype.toString.call(value),"date");if(isError(value))return formatError(value)}var base="",array=!1,braces=["{","}"];if(isArray(value)&&(array=!0,braces=["[","]"]),isFunction(value)){var n=value.name?": "+value.name:"";base=" [Function"+n+"]"}if(isRegExp(value)&&(base=" "+RegExp.prototype.toString.call(value)),isDate(value)&&(base=" "+Date.prototype.toUTCString.call(value)),isError(value)&&(base=" "+formatError(value)),0===keys.length&&(!array||0==value.length))return braces[0]+base+braces[1];if(0>recurseTimes)return isRegExp(value)?ctx.stylize(RegExp.prototype.toString.call(value),"regexp"):ctx.stylize("[Object]","special");ctx.seen.push(value);var output;return output=array?formatArray(ctx,value,recurseTimes,visibleKeys,keys):keys.map(function(key){return formatProperty(ctx,value,recurseTimes,visibleKeys,key,array)}),ctx.seen.pop(),reduceToSingleString(output,base,braces)}function formatPrimitive(ctx,value){if(isUndefined(value))return ctx.stylize("undefined","undefined");if(isString(value)){var simple="'"+JSON.stringify(value).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ctx.stylize(simple,"string")}return isNumber(value)?ctx.stylize(""+value,"number"):isBoolean(value)?ctx.stylize(""+value,"boolean"):isNull(value)?ctx.stylize("null","null"):void 0}function formatError(value){return"["+Error.prototype.toString.call(value)+"]"}function formatArray(ctx,value,recurseTimes,visibleKeys,keys){for(var output=[],i=0,l=value.length;l>i;++i)output.push(hasOwnProperty(value,String(i))?formatProperty(ctx,value,recurseTimes,visibleKeys,String(i),!0):"");return keys.forEach(function(key){key.match(/^\d+$/)||output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,key,!0))}),output}function formatProperty(ctx,value,recurseTimes,visibleKeys,key,array){var name,str,desc;if(desc=Object.getOwnPropertyDescriptor(value,key)||{value:value[key]},desc.get?str=desc.set?ctx.stylize("[Getter/Setter]","special"):ctx.stylize("[Getter]","special"):desc.set&&(str=ctx.stylize("[Setter]","special")),hasOwnProperty(visibleKeys,key)||(name="["+key+"]"),str||(ctx.seen.indexOf(desc.value)<0?(str=isNull(recurseTimes)?formatValue(ctx,desc.value,null):formatValue(ctx,desc.value,recurseTimes-1),str.indexOf("\n")>-1&&(str=array?str.split("\n").map(function(line){return"  "+line}).join("\n").substr(2):"\n"+str.split("\n").map(function(line){return"   "+line}).join("\n"))):str=ctx.stylize("[Circular]","special")),isUndefined(name)){if(array&&key.match(/^\d+$/))return str;name=JSON.stringify(""+key),name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(name=name.substr(1,name.length-2),name=ctx.stylize(name,"name")):(name=name.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),name=ctx.stylize(name,"string"))}return name+": "+str}function reduceToSingleString(output,base,braces){var numLinesEst=0,length=output.reduce(function(prev,cur){return numLinesEst++,cur.indexOf("\n")>=0&&numLinesEst++,prev+cur.replace(/\u001b\[\d\d?m/g,"").length+1},0);return length>60?braces[0]+(""===base?"":base+"\n ")+" "+output.join(",\n  ")+" "+braces[1]:braces[0]+base+" "+output.join(", ")+" "+braces[1]}function isArray(ar){return Array.isArray(ar)}function isBoolean(arg){return"boolean"==typeof arg}function isNull(arg){return null===arg}function isNullOrUndefined(arg){return null==arg}function isNumber(arg){return"number"==typeof arg}function isString(arg){return"string"==typeof arg}function isSymbol(arg){return"symbol"==typeof arg}function isUndefined(arg){return void 0===arg}function isRegExp(re){return isObject(re)&&"[object RegExp]"===objectToString(re)}function isObject(arg){return"object"==typeof arg&&null!==arg}function isDate(d){return isObject(d)&&"[object Date]"===objectToString(d)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(arg){return"function"==typeof arg}function isPrimitive(arg){return null===arg||"boolean"==typeof arg||"number"==typeof arg||"string"==typeof arg||"symbol"==typeof arg||"undefined"==typeof arg}function objectToString(o){return Object.prototype.toString.call(o)}function pad(n){return 10>n?"0"+n.toString(10):n.toString(10)}function timestamp(){var d=new Date,time=[pad(d.getHours()),pad(d.getMinutes()),pad(d.getSeconds())].join(":");return[d.getDate(),months[d.getMonth()],time].join(" ")}function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}var formatRegExp=/%[sdj%]/g;exports.format=function(f){if(!isString(f)){for(var objects=[],i=0;i<arguments.length;i++)objects.push(inspect(arguments[i]));return objects.join(" ")}for(var i=1,args=arguments,len=args.length,str=String(f).replace(formatRegExp,function(x){if("%%"===x)return"%";if(i>=len)return x;switch(x){case"%s":return String(args[i++]);case"%d":return Number(args[i++]);case"%j":try{return JSON.stringify(args[i++])}catch(_){return"[Circular]"}default:return x}}),x=args[i];len>i;x=args[++i])str+=isNull(x)||!isObject(x)?" "+x:" "+inspect(x);return str},exports.deprecate=function(fn,msg){function deprecated(){if(!warned){if(process.throwDeprecation)throw new Error(msg);process.traceDeprecation?console.trace(msg):console.error(msg),warned=!0}return fn.apply(this,arguments)}if(isUndefined(global.process))return function(){return exports.deprecate(fn,msg).apply(this,arguments)};if(process.noDeprecation===!0)return fn;var warned=!1;return deprecated};var debugEnviron,debugs={};exports.debuglog=function(set){if(isUndefined(debugEnviron)&&(debugEnviron=process.env.NODE_DEBUG||""),set=set.toUpperCase(),!debugs[set])if(new RegExp("\\b"+set+"\\b","i").test(debugEnviron)){var pid=process.pid;debugs[set]=function(){var msg=exports.format.apply(exports,arguments);console.error("%s %d: %s",set,pid,msg)}}else debugs[set]=function(){};return debugs[set]},exports.inspect=inspect,inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=require("./support/isBuffer");var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];exports.log=function(){console.log("%s - %s",timestamp(),exports.format.apply(exports,arguments))},exports.inherits=require("inherits"),exports._extend=function(origin,add){if(!add||!isObject(add))return origin;for(var keys=Object.keys(add),i=keys.length;i--;)origin[keys[i]]=add[keys[i]];return origin}}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":14,_process:13,inherits:11}],16:[function(require,module){(function(Buffer){function compare1st(a,b){return a[0]-b[0]}function order(){var i,stride=this.stride,terms=new Array(stride.length);for(i=0;i<terms.length;++i)terms[i]=[Math.abs(stride[i]),i];terms.sort(compare1st);var result=new Array(terms.length);for(i=0;i<result.length;++i)result[i]=terms[i][1];return result}function compileConstructor(dtype,dimension){var className=["View",dimension,"d",dtype].join("");0>dimension&&(className="View_Nil"+dtype);var useGetters="generic"===dtype;if(-1===dimension){var code="function "+className+"(a){this.data=a;};var proto="+className+".prototype;proto.dtype='"+dtype+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+className+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+className+"(a){return new "+className+"(a);}",procedure=new Function(code);return procedure()}if(0===dimension){var code="function "+className+"(a,d) {this.data = a;this.offset = d};var proto="+className+".prototype;proto.dtype='"+dtype+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+className+"_copy() {return new "+className+"(this.data,this.offset)};proto.pick=function "+className+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+className+"_get(){return "+(useGetters?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+className+"_set(v){return "+(useGetters?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+className+"(a,b,c,d){return new "+className+"(a,d)}",procedure=new Function("TrivialArray",code);return procedure(CACHED_CONSTRUCTORS[dtype][0])}var code=["'use strict'"],indices=iota(dimension),args=indices.map(function(i){return"i"+i}),index_str="this.offset+"+indices.map(function(i){return"this.stride["+i+"]*i"+i}).join("+"),shapeArg=indices.map(function(i){return"b"+i}).join(","),strideArg=indices.map(function(i){return"c"+i}).join(",");code.push("function "+className+"(a,"+shapeArg+","+strideArg+",d){this.data=a","this.shape=["+shapeArg+"]","this.stride=["+strideArg+"]","this.offset=d|0}","var proto="+className+".prototype","proto.dtype='"+dtype+"'","proto.dimension="+dimension),code.push("Object.defineProperty(proto,'size',{get:function "+className+"_size(){return "+indices.map(function(i){return"this.shape["+i+"]"}).join("*"),"}})"),1===dimension?code.push("proto.order=[0]"):(code.push("Object.defineProperty(proto,'order',{get:"),4>dimension?(code.push("function "+className+"_order(){"),2===dimension?code.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===dimension&&code.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):code.push("ORDER})")),code.push("proto.set=function "+className+"_set("+args.join(",")+",v){"),code.push(useGetters?"return this.data.set("+index_str+",v)}":"return this.data["+index_str+"]=v}"),code.push("proto.get=function "+className+"_get("+args.join(",")+"){"),code.push(useGetters?"return this.data.get("+index_str+")}":"return this.data["+index_str+"]}"),code.push("proto.index=function "+className+"_index(",args.join(),"){return "+index_str+"}"),code.push("proto.hi=function "+className+"_hi("+args.join(",")+"){return new "+className+"(this.data,"+indices.map(function(i){return["(typeof i",i,"!=='number'||i",i,"<0)?this.shape[",i,"]:i",i,"|0"].join("")}).join(",")+","+indices.map(function(i){return"this.stride["+i+"]"}).join(",")+",this.offset)}");var a_vars=indices.map(function(i){return"a"+i+"=this.shape["+i+"]"}),c_vars=indices.map(function(i){return"c"+i+"=this.stride["+i+"]"});code.push("proto.lo=function "+className+"_lo("+args.join(",")+"){var b=this.offset,d=0,"+a_vars.join(",")+","+c_vars.join(","));for(var i=0;dimension>i;++i)code.push("if(typeof i"+i+"==='number'&&i"+i+">=0){d=i"+i+"|0;b+=c"+i+"*d;a"+i+"-=d}");code.push("return new "+className+"(this.data,"+indices.map(function(i){return"a"+i}).join(",")+","+indices.map(function(i){return"c"+i}).join(",")+",b)}"),code.push("proto.step=function "+className+"_step("+args.join(",")+"){var "+indices.map(function(i){return"a"+i+"=this.shape["+i+"]"}).join(",")+","+indices.map(function(i){return"b"+i+"=this.stride["+i+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var i=0;dimension>i;++i)code.push("if(typeof i"+i+"==='number'){d=i"+i+"|0;if(d<0){c+=b"+i+"*(a"+i+"-1);a"+i+"=ceil(-a"+i+"/d)}else{a"+i+"=ceil(a"+i+"/d)}b"+i+"*=d}");code.push("return new "+className+"(this.data,"+indices.map(function(i){return"a"+i}).join(",")+","+indices.map(function(i){return"b"+i}).join(",")+",c)}");for(var tShape=new Array(dimension),tStride=new Array(dimension),i=0;dimension>i;++i)tShape[i]="a[i"+i+"]",tStride[i]="b[i"+i+"]";code.push("proto.transpose=function "+className+"_transpose("+args+"){"+args.map(function(n,idx){return n+"=("+n+"===undefined?"+idx+":"+n+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+className+"(this.data,"+tShape.join(",")+","+tStride.join(",")+",this.offset)}"),code.push("proto.pick=function "+className+"_pick("+args+"){var a=[],b=[],c=this.offset");for(var i=0;dimension>i;++i)code.push("if(typeof i"+i+"==='number'&&i"+i+">=0){c=(c+this.stride["+i+"]*i"+i+")|0}else{a.push(this.shape["+i+"]);b.push(this.stride["+i+"])}");code.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),code.push("return function construct_"+className+"(data,shape,stride,offset){return new "+className+"(data,"+indices.map(function(i){return"shape["+i+"]"}).join(",")+","+indices.map(function(i){return"stride["+i+"]"}).join(",")+",offset)}");var procedure=new Function("CTOR_LIST","ORDER",code.join("\n"));return procedure(CACHED_CONSTRUCTORS[dtype],order)}function arrayDType(data){if(hasBuffer&&Buffer.isBuffer(data))return"buffer";if(hasTypedArrays)switch(Object.prototype.toString.call(data)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(data)?"array":"generic"}function wrappedNDArrayCtor(data,shape,stride,offset){if(void 0===data){var ctor=CACHED_CONSTRUCTORS.array[0];return ctor([])}"number"==typeof data&&(data=[data]),void 0===shape&&(shape=[data.length]);var d=shape.length;if(void 0===stride){stride=new Array(d);for(var i=d-1,sz=1;i>=0;--i)stride[i]=sz,sz*=shape[i]}if(void 0===offset){offset=0;for(var i=0;d>i;++i)stride[i]<0&&(offset-=(shape[i]-1)*stride[i])}for(var dtype=arrayDType(data),ctor_list=CACHED_CONSTRUCTORS[dtype];ctor_list.length<=d+1;)ctor_list.push(compileConstructor(dtype,ctor_list.length-1));var ctor=ctor_list[d+1];return ctor(data,shape,stride,offset)}var iota=require("iota-array"),hasTypedArrays="undefined"!=typeof Float64Array,hasBuffer="undefined"!=typeof Buffer,CACHED_CONSTRUCTORS={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};module.exports=wrappedNDArrayCtor}).call(this,require("buffer").Buffer)},{buffer:6,"iota-array":17}],17:[function(require,module){"use strict";function iota(n){for(var result=new Array(n),i=0;n>i;++i)result[i]=i;return result}module.exports=iota},{}],18:[function(require,module,exports){(function(global){"use strict";var numeric="undefined"==typeof exports?function(){}:exports;"undefined"!=typeof global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(f,interval){var t1,t2,n,i;for("undefined"==typeof interval&&(interval=15),n=.5,t1=new Date;;){for(n*=2,i=n;i>3;i-=4)f(),f(),f(),f();for(;i>0;)f(),i--;if(t2=new Date,t2-t1>interval)break}for(i=n;i>3;i-=4)f(),f(),f(),f();for(;i>0;)f(),i--;return t2=new Date,1e3*(3*n-1)/(t2-t1)},numeric._myIndexOf=function(w){var k,n=this.length;for(k=0;n>k;++k)if(this[k]===w)return k;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(x){function fmtnum(x){if(0===x)return"0";if(isNaN(x))return"NaN";if(0>x)return"-"+fmtnum(-x);if(isFinite(x)){var scale=Math.floor(Math.log(x)/Math.log(10)),normalized=x/Math.pow(10,scale),basic=normalized.toPrecision(numeric.precision);return 10===parseFloat(basic)&&(scale++,normalized=1,basic=normalized.toPrecision(numeric.precision)),parseFloat(basic).toString()+"e"+scale.toString()}return"Infinity"}function foo(x){var k;if("undefined"==typeof x)return ret.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof x)return ret.push('"'+x+'"'),!1;if("boolean"==typeof x)return ret.push(x.toString()),!1;if("number"==typeof x){var a=fmtnum(x),b=x.toPrecision(numeric.precision),c=parseFloat(x.toString()).toString(),d=[a,b,c,parseFloat(b).toString(),parseFloat(c).toString()];for(k=1;k<d.length;k++)d[k].length<a.length&&(a=d[k]);return ret.push(Array(numeric.precision+8-a.length).join(" ")+a),!1}if(null===x)return ret.push("null"),!1;if("function"==typeof x){ret.push(x.toString());var flag=!1;for(k in x)x.hasOwnProperty(k)&&(ret.push(flag?",\n":"\n{"),flag=!0,ret.push(k),ret.push(": \n"),foo(x[k]));return flag&&ret.push("}\n"),!0}if(x instanceof Array){if(x.length>numeric.largeArray)return ret.push("...Large Array..."),!0;var flag=!1;for(ret.push("["),k=0;k<x.length;k++)k>0&&(ret.push(","),flag&&ret.push("\n ")),flag=foo(x[k]);return ret.push("]"),!0}ret.push("{");var flag=!1;for(k in x)x.hasOwnProperty(k)&&(flag&&ret.push(",\n"),flag=!0,ret.push(k),ret.push(": \n"),foo(x[k]));return ret.push("}"),!0}var ret=[];return foo(x),ret.join("")},numeric.parseDate=function(d){function foo(d){if("string"==typeof d)return Date.parse(d.replace(/-/g,"/"));if(!(d instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var k,ret=[];for(k=0;k<d.length;k++)ret[k]=foo(d[k]);return ret}return foo(d)},numeric.parseFloat=function(d){function foo(d){if("string"==typeof d)return parseFloat(d);if(!(d instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var k,ret=[];for(k=0;k<d.length;k++)ret[k]=foo(d[k]);return ret}return foo(d)},numeric.parseCSV=function(t){var j,k,foo=t.split("\n"),ret=[],pat=/(([^'",]*)|('[^']*')|("[^"]*")),/g,patnum=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,stripper=function(n){return n.substr(0,n.length-1)},count=0;for(k=0;k<foo.length;k++){var baz,bar=(foo[k]+",").match(pat);if(bar.length>0){for(ret[count]=[],j=0;j<bar.length;j++)baz=stripper(bar[j]),ret[count][j]=patnum.test(baz)?parseFloat(baz):baz;count++}}return ret},numeric.toCSV=function(A){var i,j,m,n,row,ret,s=numeric.dim(A);for(m=s[0],n=s[1],ret=[],i=0;m>i;i++){for(row=[],j=0;m>j;j++)row[j]=A[i][j].toString();ret[i]=row.join(", ")}return ret.join("\n")+"\n"},numeric.getURL=function(url){var client=new XMLHttpRequest;return client.open("GET",url,!1),client.send(),client},numeric.imageURL=function(img){function base64(A){var i,x,y,z,p,q,r,s,n=A.length,key="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ret="";for(i=0;n>i;i+=3)x=A[i],y=A[i+1],z=A[i+2],p=x>>2,q=((3&x)<<4)+(y>>4),r=((15&y)<<2)+(z>>6),s=63&z,i+1>=n?r=s=64:i+2>=n&&(s=64),ret+=key.charAt(p)+key.charAt(q)+key.charAt(r)+key.charAt(s);return ret}function crc32Array(a,from,to){"undefined"==typeof from&&(from=0),"undefined"==typeof to&&(to=a.length);{var i,table=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],crc=-1,y=0;a.length}for(i=from;to>i;i++)y=255&(crc^a[i]),crc=crc>>>8^table[y];return-1^crc}var s1,s2,k,length,a,b,i,j,adler32,crc32,h=img[0].length,w=img[0][0].length,stream=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,w>>24&255,w>>16&255,w>>8&255,255&w,h>>24&255,h>>16&255,h>>8&255,255&h,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(crc32=crc32Array(stream,12,29),stream[29]=crc32>>24&255,stream[30]=crc32>>16&255,stream[31]=crc32>>8&255,stream[32]=255&crc32,s1=1,s2=0,i=0;h>i;i++){for(stream.push(h-1>i?0:1),a=3*w+1+(0===i)&255,b=3*w+1+(0===i)>>8&255,stream.push(a),stream.push(b),stream.push(255&~a),stream.push(255&~b),0===i&&stream.push(0),j=0;w>j;j++)for(k=0;3>k;k++)a=img[k][i][j],a=a>255?255:0>a?0:Math.round(a),s1=(s1+a)%65521,s2=(s2+s1)%65521,stream.push(a);stream.push(0)}return adler32=(s2<<16)+s1,stream.push(adler32>>24&255),stream.push(adler32>>16&255),stream.push(adler32>>8&255),stream.push(255&adler32),length=stream.length-41,stream[33]=length>>24&255,stream[34]=length>>16&255,stream[35]=length>>8&255,stream[36]=255&length,crc32=crc32Array(stream,37),stream.push(crc32>>24&255),stream.push(crc32>>16&255),stream.push(crc32>>8&255),stream.push(255&crc32),stream.push(0),stream.push(0),stream.push(0),stream.push(0),stream.push(73),stream.push(69),stream.push(78),stream.push(68),stream.push(174),stream.push(66),stream.push(96),stream.push(130),"data:image/png;base64,"+base64(stream)},numeric._dim=function(x){for(var ret=[];"object"==typeof x;)ret.push(x.length),x=x[0];return ret},numeric.dim=function(x){var y,z;return"object"==typeof x?(y=x[0],"object"==typeof y?(z=y[0],"object"==typeof z?numeric._dim(x):[x.length,y.length]):[x.length]):[]},numeric.mapreduce=function(body,init){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+init+';\nif(typeof x === "number") { var xi = x; '+body+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+body+";\n    xi = x[i-1];\n    "+body+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+body+"\n}\nreturn accum;")},numeric.mapreduce2=function(body,setup){return Function("x","var n = x.length;\nvar i,xi;\n"+setup+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+body+";\n}\nreturn accum;")},numeric.same=function same(x,y){var i,n;if(!(x instanceof Array&&y instanceof Array))return!1;if(n=x.length,n!==y.length)return!1;for(i=0;n>i;i++)if(x[i]!==y[i]){if("object"!=typeof x[i])return!1;if(!same(x[i],y[i]))return!1}return!0},numeric.rep=function(s,v,k){"undefined"==typeof k&&(k=0);var i,n=s[k],ret=Array(n);if(k===s.length-1){for(i=n-2;i>=0;i-=2)ret[i+1]=v,ret[i]=v;return-1===i&&(ret[0]=v),ret}for(i=n-1;i>=0;i--)ret[i]=numeric.rep(s,v,k+1);return ret},numeric.dotMMsmall=function(x,y){var i,j,k,p,q,r,ret,foo,bar,woo,i0;for(p=x.length,q=y.length,r=y[0].length,ret=Array(p),i=p-1;i>=0;i--){for(foo=Array(r),bar=x[i],k=r-1;k>=0;k--){for(woo=bar[q-1]*y[q-1][k],j=q-2;j>=1;j-=2)i0=j-1,woo+=bar[j]*y[j][k]+bar[i0]*y[i0][k];0===j&&(woo+=bar[0]*y[0][k]),foo[k]=woo}ret[i]=foo}return ret},numeric._getCol=function(A,j,x){var i,n=A.length;for(i=n-1;i>0;--i)x[i]=A[i][j],--i,x[i]=A[i][j];0===i&&(x[0]=A[0][j])},numeric.dotMMbig=function(x,y){var xj,i,j,z,gc=numeric._getCol,p=y.length,v=Array(p),m=x.length,n=y[0].length,A=new Array(m),VV=numeric.dotVV;for(--p,--m,i=m;-1!==i;--i)A[i]=Array(n);for(--n,i=n;-1!==i;--i)for(gc(y,i,v),j=m;-1!==j;--j)z=0,xj=x[j],A[j][i]=VV(xj,v);return A},numeric.dotMV=function(x,y){var i,p=x.length,ret=(y.length,Array(p)),dotVV=numeric.dotVV;for(i=p-1;i>=0;i--)ret[i]=dotVV(x[i],y);return ret},numeric.dotVM=function(x,y){var j,k,p,q,ret,woo,i0;for(p=x.length,q=y[0].length,ret=Array(q),k=q-1;k>=0;k--){for(woo=x[p-1]*y[p-1][k],j=p-2;j>=1;j-=2)i0=j-1,woo+=x[j]*y[j][k]+x[i0]*y[i0][k];0===j&&(woo+=x[0]*y[0][k]),ret[k]=woo}return ret},numeric.dotVV=function(x,y){var i,i1,n=x.length,ret=x[n-1]*y[n-1];for(i=n-2;i>=1;i-=2)i1=i-1,ret+=x[i]*y[i]+x[i1]*y[i1];return 0===i&&(ret+=x[0]*y[0]),ret},numeric.dot=function(x,y){var d=numeric.dim;switch(1e3*d(x).length+d(y).length){case 2002:return y.length<10?numeric.dotMMsmall(x,y):numeric.dotMMbig(x,y);case 2001:return numeric.dotMV(x,y);case 1002:return numeric.dotVM(x,y);case 1001:return numeric.dotVV(x,y);case 1e3:return numeric.mulVS(x,y);case 1:return numeric.mulSV(x,y);case 0:return x*y;default:throw new Error("numeric.dot only works on vectors and matrices")
}},numeric.diag=function(d){var i,i1,j,Ai,n=d.length,A=Array(n);for(i=n-1;i>=0;i--){for(Ai=Array(n),i1=i+2,j=n-1;j>=i1;j-=2)Ai[j]=0,Ai[j-1]=0;for(j>i&&(Ai[j]=0),Ai[i]=d[i],j=i-1;j>=1;j-=2)Ai[j]=0,Ai[j-1]=0;0===j&&(Ai[0]=0),A[i]=Ai}return A},numeric.getDiag=function(A){var i,n=Math.min(A.length,A[0].length),ret=Array(n);for(i=n-1;i>=1;--i)ret[i]=A[i][i],--i,ret[i]=A[i][i];return 0===i&&(ret[0]=A[0][0]),ret},numeric.identity=function(n){return numeric.diag(numeric.rep([n],1))},numeric.pointwise=function(params,body,setup){"undefined"==typeof setup&&(setup="");var k,p,fun=[],avec=/\[i\]$/,thevec="",haveret=!1;for(k=0;k<params.length;k++)avec.test(params[k])?(p=params[k].substring(0,params[k].length-3),thevec=p):p=params[k],"ret"===p&&(haveret=!0),fun.push(p);return fun[params.length]="_s",fun[params.length+1]="_k",fun[params.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+thevec+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(haveret?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+params.join(",")+",_s,_k+1);\n    return ret;\n}\n"+setup+"\nfor(i=_n-1;i!==-1;--i) {\n    "+body+"\n}\nreturn ret;",Function.apply(null,fun)},numeric.pointwise2=function(params,body,setup){"undefined"==typeof setup&&(setup="");var k,p,fun=[],avec=/\[i\]$/,thevec="",haveret=!1;for(k=0;k<params.length;k++)avec.test(params[k])?(p=params[k].substring(0,params[k].length-3),thevec=p):p=params[k],"ret"===p&&(haveret=!0),fun.push(p);return fun[params.length]="var _n = "+thevec+".length;\nvar i"+(haveret?"":", ret = Array(_n)")+";\n"+setup+"\nfor(i=_n-1;i!==-1;--i) {\n"+body+"\n}\nreturn ret;",Function.apply(null,fun)},numeric._biforeach=function _biforeach(x,y,s,k,f){if(k===s.length-1)return void f(x,y);var i,n=s[k];for(i=n-1;i>=0;i--)_biforeach("object"==typeof x?x[i]:x,"object"==typeof y?y[i]:y,s,k+1,f)},numeric._biforeach2=function _biforeach2(x,y,s,k,f){if(k===s.length-1)return f(x,y);var i,n=s[k],ret=Array(n);for(i=n-1;i>=0;--i)ret[i]=_biforeach2("object"==typeof x?x[i]:x,"object"==typeof y?y[i]:y,s,k+1,f);return ret},numeric._foreach=function _foreach(x,s,k,f){if(k===s.length-1)return void f(x);var i,n=s[k];for(i=n-1;i>=0;i--)_foreach(x[i],s,k+1,f)},numeric._foreach2=function _foreach2(x,s,k,f){if(k===s.length-1)return f(x);var i,n=s[k],ret=Array(n);for(i=n-1;i>=0;i--)ret[i]=_foreach2(x[i],s,k+1,f);return ret},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var i,o;for(i=0;i<numeric.mathfuns2.length;++i)o=numeric.mathfuns2[i],numeric.ops2[o]=o;for(i in numeric.ops2)if(numeric.ops2.hasOwnProperty(i)){o=numeric.ops2[i];var code,codeeq,setup="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,i)?(setup="var "+o+" = Math."+o+";\n",code=function(r,x,y){return r+" = "+o+"("+x+","+y+")"},codeeq=function(x,y){return x+" = "+o+"("+x+","+y+")"}):(code=function(r,x,y){return r+" = "+x+" "+o+" "+y},codeeq=numeric.opseq.hasOwnProperty(i+"eq")?function(x,y){return x+" "+o+"= "+y}:function(x,y){return x+" = "+x+" "+o+" "+y}),numeric[i+"VV"]=numeric.pointwise2(["x[i]","y[i]"],code("ret[i]","x[i]","y[i]"),setup),numeric[i+"SV"]=numeric.pointwise2(["x","y[i]"],code("ret[i]","x","y[i]"),setup),numeric[i+"VS"]=numeric.pointwise2(["x[i]","y"],code("ret[i]","x[i]","y"),setup),numeric[i]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+i+"VV, VS = numeric."+i+"VS, SV = numeric."+i+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+codeeq("x","y")+"\n}\nreturn x;\n"),numeric[o]=numeric[i],numeric[i+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],codeeq("ret[i]","x[i]"),setup),numeric[i+"eqS"]=numeric.pointwise2(["ret[i]","x"],codeeq("ret[i]","x"),setup),numeric[i+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+i+"eqV, S = numeric."+i+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(i=0;i<numeric.mathfuns2.length;++i)o=numeric.mathfuns2[i],delete numeric.ops2[o];for(i=0;i<numeric.mathfuns.length;++i)o=numeric.mathfuns[i],numeric.ops1[o]=o;for(i in numeric.ops1)numeric.ops1.hasOwnProperty(i)&&(setup="",o=numeric.ops1[i],-1!==numeric.myIndexOf.call(numeric.mathfuns,i)&&Math.hasOwnProperty(o)&&(setup="var "+o+" = Math."+o+";\n"),numeric[i+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+o+"(ret[i]);",setup),numeric[i+"eq"]=Function("x",'if(typeof x !== "object") return '+o+"x\nvar i;\nvar V = numeric."+i+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[i+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+o+"(x[i]);",setup),numeric[i]=Function("x",'if(typeof x !== "object") return '+o+"(x)\nvar i;\nvar V = numeric."+i+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(i=0;i<numeric.mathfuns.length;++i)o=numeric.mathfuns[i],delete numeric.ops1[o];for(i in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(i)&&(o=numeric.mapreducers[i],numeric[i+"V"]=numeric.mapreduce2(o[0],o[1]),numeric[i]=Function("x","s","k",o[1]+'if(typeof x !== "object") {    xi = x;\n'+o[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+i+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+o[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(x,y){return"object"==typeof x?"object"==typeof y?numeric.truncVV(x,y):numeric.truncVS(x,y):"object"==typeof y?numeric.truncSV(x,y):Math.round(x/y)*y},numeric.inv=function(x){var Ai,Aj,Ii,Ij,i,j,k,x,s=numeric.dim(x),abs=Math.abs,m=s[0],n=s[1],A=numeric.clone(x),I=numeric.identity(m);for(j=0;n>j;++j){var i0=-1,v0=-1;for(i=j;i!==m;++i)k=abs(A[i][j]),k>v0&&(i0=i,v0=k);for(Aj=A[i0],A[i0]=A[j],A[j]=Aj,Ij=I[i0],I[i0]=I[j],I[j]=Ij,x=Aj[j],k=j;k!==n;++k)Aj[k]/=x;for(k=n-1;-1!==k;--k)Ij[k]/=x;for(i=m-1;-1!==i;--i)if(i!==j){for(Ai=A[i],Ii=I[i],x=Ai[j],k=j+1;k!==n;++k)Ai[k]-=Aj[k]*x;for(k=n-1;k>0;--k)Ii[k]-=Ij[k]*x,--k,Ii[k]-=Ij[k]*x;0===k&&(Ii[0]-=Ij[0]*x)}}return I},numeric.det=function(x){var s=numeric.dim(x);if(2!==s.length||s[0]!==s[1])throw new Error("numeric: det() only works on square matrices");var i,j,k,Aj,Ai,alpha,temp,k1,n=s[0],ret=1,A=numeric.clone(x);for(j=0;n-1>j;j++){for(k=j,i=j+1;n>i;i++)Math.abs(A[i][j])>Math.abs(A[k][j])&&(k=i);for(k!==j&&(temp=A[k],A[k]=A[j],A[j]=temp,ret*=-1),Aj=A[j],i=j+1;n>i;i++){for(Ai=A[i],alpha=Ai[j]/Aj[j],k=j+1;n-1>k;k+=2)k1=k+1,Ai[k]-=Aj[k]*alpha,Ai[k1]-=Aj[k1]*alpha;k!==n&&(Ai[k]-=Aj[k]*alpha)}if(0===Aj[j])return 0;ret*=Aj[j]}return ret*A[j][j]},numeric.transpose=function(x){var i,j,A0,A1,Bj,m=x.length,n=x[0].length,ret=Array(n);for(j=0;n>j;j++)ret[j]=Array(m);for(i=m-1;i>=1;i-=2){for(A1=x[i],A0=x[i-1],j=n-1;j>=1;--j)Bj=ret[j],Bj[i]=A1[j],Bj[i-1]=A0[j],--j,Bj=ret[j],Bj[i]=A1[j],Bj[i-1]=A0[j];0===j&&(Bj=ret[0],Bj[i]=A1[0],Bj[i-1]=A0[0])}if(0===i){for(A0=x[0],j=n-1;j>=1;--j)ret[j][0]=A0[j],--j,ret[j][0]=A0[j];0===j&&(ret[0][0]=A0[0])}return ret},numeric.negtranspose=function(x){var i,j,A0,A1,Bj,m=x.length,n=x[0].length,ret=Array(n);for(j=0;n>j;j++)ret[j]=Array(m);for(i=m-1;i>=1;i-=2){for(A1=x[i],A0=x[i-1],j=n-1;j>=1;--j)Bj=ret[j],Bj[i]=-A1[j],Bj[i-1]=-A0[j],--j,Bj=ret[j],Bj[i]=-A1[j],Bj[i-1]=-A0[j];0===j&&(Bj=ret[0],Bj[i]=-A1[0],Bj[i-1]=-A0[0])}if(0===i){for(A0=x[0],j=n-1;j>=1;--j)ret[j][0]=-A0[j],--j,ret[j][0]=-A0[j];0===j&&(ret[0][0]=-A0[0])}return ret},numeric._random=function _random(s,k){var i,rnd,n=s[k],ret=Array(n);if(k===s.length-1){for(rnd=Math.random,i=n-1;i>=1;i-=2)ret[i]=rnd(),ret[i-1]=rnd();return 0===i&&(ret[0]=rnd()),ret}for(i=n-1;i>=0;i--)ret[i]=_random(s,k+1);return ret},numeric.random=function(s){return numeric._random(s,0)},numeric.norm2=function(x){return Math.sqrt(numeric.norm2Squared(x))},numeric.linspace=function(a,b,n){if("undefined"==typeof n&&(n=Math.max(Math.round(b-a)+1,1)),2>n)return 1===n?[a]:[];var i,ret=Array(n);for(n--,i=n;i>=0;i--)ret[i]=(i*b+(n-i)*a)/n;return ret},numeric.getBlock=function(x,from,to){function foo(x,k){var i,a=from[k],n=to[k]-a,ret=Array(n);if(k===s.length-1){for(i=n;i>=0;i--)ret[i]=x[i+a];return ret}for(i=n;i>=0;i--)ret[i]=foo(x[i+a],k+1);return ret}var s=numeric.dim(x);return foo(x,0)},numeric.setBlock=function(x,from,to,B){function foo(x,y,k){var i,a=from[k],n=to[k]-a;if(k===s.length-1)for(i=n;i>=0;i--)x[i+a]=y[i];for(i=n;i>=0;i--)foo(x[i+a],y[i],k+1)}var s=numeric.dim(x);return foo(x,B,0),x},numeric.getRange=function(A,I,J){var i,j,Bi,AI,m=I.length,n=J.length,B=Array(m);for(i=m-1;-1!==i;--i)for(B[i]=Array(n),Bi=B[i],AI=A[I[i]],j=n-1;-1!==j;--j)Bi[j]=AI[J[j]];return B},numeric.blockMatrix=function(X){var s=numeric.dim(X);if(s.length<4)return numeric.blockMatrix([X]);var M,N,i,j,Xij,m=s[0],n=s[1];for(M=0,N=0,i=0;m>i;++i)M+=X[i][0].length;for(j=0;n>j;++j)N+=X[0][j][0].length;var Z=Array(M);for(i=0;M>i;++i)Z[i]=Array(N);var J,ZI,k,l,Xijk,I=0;for(i=0;m>i;++i){for(J=N,j=n-1;-1!==j;--j)for(Xij=X[i][j],J-=Xij[0].length,k=Xij.length-1;-1!==k;--k)for(Xijk=Xij[k],ZI=Z[I+k],l=Xijk.length-1;-1!==l;--l)ZI[J+l]=Xijk[l];I+=X[i][0].length}return Z},numeric.tensor=function(x,y){if("number"==typeof x||"number"==typeof y)return numeric.mul(x,y);var s1=numeric.dim(x),s2=numeric.dim(y);if(1!==s1.length||1!==s2.length)throw new Error("numeric: tensor product is only defined for vectors");var Ai,i,j,xi,m=s1[0],n=s2[0],A=Array(m);for(i=m-1;i>=0;i--){for(Ai=Array(n),xi=x[i],j=n-1;j>=3;--j)Ai[j]=xi*y[j],--j,Ai[j]=xi*y[j],--j,Ai[j]=xi*y[j],--j,Ai[j]=xi*y[j];for(;j>=0;)Ai[j]=xi*y[j],--j;A[i]=Ai}return A},numeric.T=function(x,y){this.x=x,this.y=y},numeric.t=function(x,y){return new numeric.T(x,y)},numeric.Tbinop=function(rr,rc,cr,cc,setup){numeric.indexOf;if("string"!=typeof setup){var k;setup="";for(k in numeric)numeric.hasOwnProperty(k)&&(rr.indexOf(k)>=0||rc.indexOf(k)>=0||cr.indexOf(k)>=0||cc.indexOf(k)>=0)&&k.length>1&&(setup+="var "+k+" = numeric."+k+";\n")}return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+setup+"\nif(x.y) {  if(y.y) {    return new numeric.T("+cc+");\n  }\n  return new numeric.T("+cr+");\n}\nif(y.y) {\n  return new numeric.T("+rc+");\n}\nreturn new numeric.T("+rr+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var mul=numeric.mul,div=numeric.div;if(this.y){var d=numeric.add(mul(this.x,this.x),mul(this.y,this.y));return new numeric.T(div(this.x,d),div(numeric.neg(this.y),d))}return new T(div(1,this.x))},numeric.T.prototype.div=function div(y){if(y instanceof numeric.T||(y=new numeric.T(y)),y.y)return this.mul(y.reciprocal());var div=numeric.div;return this.y?new numeric.T(div(this.x,y.x),div(this.y,y.x)):new numeric.T(div(this.x,y.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var t=numeric.transpose,x=this.x,y=this.y;return y?new numeric.T(t(x),t(y)):new numeric.T(t(x))},numeric.T.prototype.transjugate=function(){var t=numeric.transpose,x=this.x,y=this.y;return y?new numeric.T(t(x),numeric.negtranspose(y)):new numeric.T(t(x))},numeric.Tunop=function(r,c,s){return"string"!=typeof s&&(s=""),Function("var x = this;\n"+s+"\nif(x.y) {  "+c+";\n}\n"+r+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var A=this;if("undefined"==typeof A.y)return new numeric.T(numeric.inv(A.x));var i,j,k,Aix,Aiy,Ajx,Ajy,Rix,Riy,Rjx,Rjy,i,j,k,d,d1,ax,ay,bx,by,temp,n=A.x.length,Rx=numeric.identity(n),Ry=numeric.rep([n,n],0),Ax=numeric.clone(A.x),Ay=numeric.clone(A.y);for(i=0;n>i;i++){for(ax=Ax[i][i],ay=Ay[i][i],d=ax*ax+ay*ay,k=i,j=i+1;n>j;j++)ax=Ax[j][i],ay=Ay[j][i],d1=ax*ax+ay*ay,d1>d&&(k=j,d=d1);for(k!==i&&(temp=Ax[i],Ax[i]=Ax[k],Ax[k]=temp,temp=Ay[i],Ay[i]=Ay[k],Ay[k]=temp,temp=Rx[i],Rx[i]=Rx[k],Rx[k]=temp,temp=Ry[i],Ry[i]=Ry[k],Ry[k]=temp),Aix=Ax[i],Aiy=Ay[i],Rix=Rx[i],Riy=Ry[i],ax=Aix[i],ay=Aiy[i],j=i+1;n>j;j++)bx=Aix[j],by=Aiy[j],Aix[j]=(bx*ax+by*ay)/d,Aiy[j]=(by*ax-bx*ay)/d;for(j=0;n>j;j++)bx=Rix[j],by=Riy[j],Rix[j]=(bx*ax+by*ay)/d,Riy[j]=(by*ax-bx*ay)/d;for(j=i+1;n>j;j++){for(Ajx=Ax[j],Ajy=Ay[j],Rjx=Rx[j],Rjy=Ry[j],ax=Ajx[i],ay=Ajy[i],k=i+1;n>k;k++)bx=Aix[k],by=Aiy[k],Ajx[k]-=bx*ax-by*ay,Ajy[k]-=by*ax+bx*ay;for(k=0;n>k;k++)bx=Rix[k],by=Riy[k],Rjx[k]-=bx*ax-by*ay,Rjy[k]-=by*ax+bx*ay}}for(i=n-1;i>0;i--)for(Rix=Rx[i],Riy=Ry[i],j=i-1;j>=0;j--)for(Rjx=Rx[j],Rjy=Ry[j],ax=Ax[j][i],ay=Ay[j][i],k=n-1;k>=0;k--)bx=Rix[k],by=Riy[k],Rjx[k]-=ax*bx-ay*by,Rjy[k]-=ax*by+ay*bx;return new numeric.T(Rx,Ry)},numeric.T.prototype.get=function(i){var ik,x=this.x,y=this.y,k=0,n=i.length;if(y){for(;n>k;)ik=i[k],x=x[ik],y=y[ik],k++;return new numeric.T(x,y)}for(;n>k;)ik=i[k],x=x[ik],k++;return new numeric.T(x)},numeric.T.prototype.set=function(i,v){var ik,x=this.x,y=this.y,k=0,n=i.length,vx=v.x,vy=v.y;if(0===n)return vy?this.y=vy:y&&(this.y=void 0),this.x=x,this;if(vy){for(y||(y=numeric.rep(numeric.dim(x),0),this.y=y);n-1>k;)ik=i[k],x=x[ik],y=y[ik],k++;return ik=i[k],x[ik]=vx,y[ik]=vy,this}if(y){for(;n-1>k;)ik=i[k],x=x[ik],y=y[ik],k++;return ik=i[k],x[ik]=vx,y[ik]=vx instanceof Array?numeric.rep(numeric.dim(vx),0):0,this}for(;n-1>k;)ik=i[k],x=x[ik],k++;return ik=i[k],x[ik]=vx,this},numeric.T.prototype.getRows=function(i0,i1){var j,ry,n=i1-i0+1,rx=Array(n),x=this.x,y=this.y;for(j=i0;i1>=j;j++)rx[j-i0]=x[j];if(y){for(ry=Array(n),j=i0;i1>=j;j++)ry[j-i0]=y[j];return new numeric.T(rx,ry)}return new numeric.T(rx)},numeric.T.prototype.setRows=function(i0,i1,A){var j,rx=this.x,ry=this.y,x=A.x,y=A.y;for(j=i0;i1>=j;j++)rx[j]=x[j-i0];if(y)for(ry||(ry=numeric.rep(numeric.dim(rx),0),this.y=ry),j=i0;i1>=j;j++)ry[j]=y[j-i0];else if(ry)for(j=i0;i1>=j;j++)ry[j]=numeric.rep([x[j-i0].length],0);return this},numeric.T.prototype.getRow=function(k){var x=this.x,y=this.y;return y?new numeric.T(x[k],y[k]):new numeric.T(x[k])},numeric.T.prototype.setRow=function(i,v){var rx=this.x,ry=this.y,x=v.x,y=v.y;return rx[i]=x,y?(ry||(ry=numeric.rep(numeric.dim(rx),0),this.y=ry),ry[i]=y):ry&&(ry=numeric.rep([x.length],0)),this},numeric.T.prototype.getBlock=function(from,to){var x=this.x,y=this.y,b=numeric.getBlock;return y?new numeric.T(b(x,from,to),b(y,from,to)):new numeric.T(b(x,from,to))},numeric.T.prototype.setBlock=function(from,to,A){A instanceof numeric.T||(A=new numeric.T(A));var x=this.x,y=this.y,b=numeric.setBlock,Ax=A.x,Ay=A.y;return Ay?(y||(this.y=numeric.rep(numeric.dim(this),0),y=this.y),b(x,from,to,Ax),b(y,from,to,Ay),this):(b(x,from,to,Ax),void(y&&b(y,from,to,numeric.rep(numeric.dim(Ax),0))))},numeric.T.rep=function(s,v){var T=numeric.T;v instanceof T||(v=new T(v));var x=v.x,y=v.y,r=numeric.rep;return y?new T(r(s,x),r(s,y)):new T(r(s,x))},numeric.T.diag=function diag(d){d instanceof numeric.T||(d=new numeric.T(d));var x=d.x,y=d.y,diag=numeric.diag;return y?new numeric.T(diag(x),diag(y)):new numeric.T(diag(x))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(n){return new numeric.T(numeric.identity(n))},numeric.T.prototype.getDiag=function(){var n=numeric,x=this.x,y=this.y;return y?new n.T(n.getDiag(x),n.getDiag(y)):new n.T(n.getDiag(x))},numeric.house=function(x){var v=numeric.clone(x),s=x[0]>=0?1:-1,alpha=s*numeric.norm2(x);v[0]+=alpha;var foo=numeric.norm2(v);if(0===foo)throw new Error("eig: internal error");return numeric.div(v,foo)},numeric.toUpperHessenberg=function(me){var s=numeric.dim(me);if(2!==s.length||s[0]!==s[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var i,j,k,x,v,B,C,Ai,Ci,Qi,m=s[0],A=numeric.clone(me),Q=numeric.identity(m);for(j=0;m-2>j;j++){for(x=Array(m-j-1),i=j+1;m>i;i++)x[i-j-1]=A[i][j];if(numeric.norm2(x)>0){for(v=numeric.house(x),B=numeric.getBlock(A,[j+1,j],[m-1,m-1]),C=numeric.tensor(v,numeric.dot(v,B)),i=j+1;m>i;i++)for(Ai=A[i],Ci=C[i-j-1],k=j;m>k;k++)Ai[k]-=2*Ci[k-j];for(B=numeric.getBlock(A,[0,j+1],[m-1,m-1]),C=numeric.tensor(numeric.dot(B,v),v),i=0;m>i;i++)for(Ai=A[i],Ci=C[i],k=j+1;m>k;k++)Ai[k]-=2*Ci[k-j-1];for(B=Array(m-j-1),i=j+1;m>i;i++)B[i-j-1]=Q[i];for(C=numeric.tensor(v,numeric.dot(v,B)),i=j+1;m>i;i++)for(Qi=Q[i],Ci=C[i-j-1],k=0;m>k;k++)Qi[k]-=2*Ci[k]}}return{H:A,Q:Q}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(H,maxiter){"undefined"==typeof maxiter&&(maxiter=1e4),H=numeric.clone(H);var x,v,a,b,c,d,det,tr,Hloc,Qi,Hi,B,C,Ci,i,j,k,iter,s=(numeric.clone(H),numeric.dim(H)),m=s[0],Q=numeric.identity(m);if(3>m)return{Q:Q,B:[[0,m-1]]};var epsilon=numeric.epsilon;for(iter=0;maxiter>iter;iter++){for(j=0;m-1>j;j++)if(Math.abs(H[j+1][j])<epsilon*(Math.abs(H[j][j])+Math.abs(H[j+1][j+1]))){var QH1=numeric.QRFrancis(numeric.getBlock(H,[0,0],[j,j]),maxiter),QH2=numeric.QRFrancis(numeric.getBlock(H,[j+1,j+1],[m-1,m-1]),maxiter);for(B=Array(j+1),i=0;j>=i;i++)B[i]=Q[i];for(C=numeric.dot(QH1.Q,B),i=0;j>=i;i++)Q[i]=C[i];for(B=Array(m-j-1),i=j+1;m>i;i++)B[i-j-1]=Q[i];for(C=numeric.dot(QH2.Q,B),i=j+1;m>i;i++)Q[i]=C[i-j-1];return{Q:Q,B:QH1.B.concat(numeric.add(QH2.B,j+1))}}if(a=H[m-2][m-2],b=H[m-2][m-1],c=H[m-1][m-2],d=H[m-1][m-1],tr=a+d,det=a*d-b*c,Hloc=numeric.getBlock(H,[0,0],[2,2]),tr*tr>=4*det){var s1,s2;s1=.5*(tr+Math.sqrt(tr*tr-4*det)),s2=.5*(tr-Math.sqrt(tr*tr-4*det)),Hloc=numeric.add(numeric.sub(numeric.dot(Hloc,Hloc),numeric.mul(Hloc,s1+s2)),numeric.diag(numeric.rep([3],s1*s2)))}else Hloc=numeric.add(numeric.sub(numeric.dot(Hloc,Hloc),numeric.mul(Hloc,tr)),numeric.diag(numeric.rep([3],det)));for(x=[Hloc[0][0],Hloc[1][0],Hloc[2][0]],v=numeric.house(x),B=[H[0],H[1],H[2]],C=numeric.tensor(v,numeric.dot(v,B)),i=0;3>i;i++)for(Hi=H[i],Ci=C[i],k=0;m>k;k++)Hi[k]-=2*Ci[k];for(B=numeric.getBlock(H,[0,0],[m-1,2]),C=numeric.tensor(numeric.dot(B,v),v),i=0;m>i;i++)for(Hi=H[i],Ci=C[i],k=0;3>k;k++)Hi[k]-=2*Ci[k];for(B=[Q[0],Q[1],Q[2]],C=numeric.tensor(v,numeric.dot(v,B)),i=0;3>i;i++)for(Qi=Q[i],Ci=C[i],k=0;m>k;k++)Qi[k]-=2*Ci[k];var J;for(j=0;m-2>j;j++){for(k=j;j+1>=k;k++)if(Math.abs(H[k+1][k])<epsilon*(Math.abs(H[k][k])+Math.abs(H[k+1][k+1]))){var QH1=numeric.QRFrancis(numeric.getBlock(H,[0,0],[k,k]),maxiter),QH2=numeric.QRFrancis(numeric.getBlock(H,[k+1,k+1],[m-1,m-1]),maxiter);for(B=Array(k+1),i=0;k>=i;i++)B[i]=Q[i];for(C=numeric.dot(QH1.Q,B),i=0;k>=i;i++)Q[i]=C[i];for(B=Array(m-k-1),i=k+1;m>i;i++)B[i-k-1]=Q[i];for(C=numeric.dot(QH2.Q,B),i=k+1;m>i;i++)Q[i]=C[i-k-1];return{Q:Q,B:QH1.B.concat(numeric.add(QH2.B,k+1))}}for(J=Math.min(m-1,j+3),x=Array(J-j),i=j+1;J>=i;i++)x[i-j-1]=H[i][j];for(v=numeric.house(x),B=numeric.getBlock(H,[j+1,j],[J,m-1]),C=numeric.tensor(v,numeric.dot(v,B)),i=j+1;J>=i;i++)for(Hi=H[i],Ci=C[i-j-1],k=j;m>k;k++)Hi[k]-=2*Ci[k-j];for(B=numeric.getBlock(H,[0,j+1],[m-1,J]),C=numeric.tensor(numeric.dot(B,v),v),i=0;m>i;i++)for(Hi=H[i],Ci=C[i],k=j+1;J>=k;k++)Hi[k]-=2*Ci[k-j-1];for(B=Array(J-j),i=j+1;J>=i;i++)B[i-j-1]=Q[i];for(C=numeric.tensor(v,numeric.dot(v,B)),i=j+1;J>=i;i++)for(Qi=Q[i],Ci=C[i-j-1],k=0;m>k;k++)Qi[k]-=2*Ci[k]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(A,maxiter){var i,k,Q0,j,a,b,c,d,p1,p2,disc,x,y,p,q,n1,n2,QH=numeric.toUpperHessenberg(A),QB=numeric.QRFrancis(QH.H,maxiter),T=numeric.T,n=A.length,B=QB.B,H=numeric.dot(QB.Q,numeric.dot(QH.H,numeric.transpose(QB.Q))),Q=new T(numeric.dot(QB.Q,QH.Q)),m=B.length,sqrt=Math.sqrt;for(k=0;m>k;k++)if(i=B[k][0],i===B[k][1]);else{if(j=i+1,a=H[i][i],b=H[i][j],c=H[j][i],d=H[j][j],0===b&&0===c)continue;p1=-a-d,p2=a*d-b*c,disc=p1*p1-4*p2,disc>=0?(x=0>p1?-.5*(p1-sqrt(disc)):-.5*(p1+sqrt(disc)),n1=(a-x)*(a-x)+b*b,n2=c*c+(d-x)*(d-x),n1>n2?(n1=sqrt(n1),p=(a-x)/n1,q=b/n1):(n2=sqrt(n2),p=c/n2,q=(d-x)/n2),Q0=new T([[q,-p],[p,q]]),Q.setRows(i,j,Q0.dot(Q.getRows(i,j)))):(x=-.5*p1,y=.5*sqrt(-disc),n1=(a-x)*(a-x)+b*b,n2=c*c+(d-x)*(d-x),n1>n2?(n1=sqrt(n1+y*y),p=(a-x)/n1,q=b/n1,x=0,y/=n1):(n2=sqrt(n2+y*y),p=c/n2,q=(d-x)/n2,x=y/n2,y=0),Q0=new T([[q,-p],[p,q]],[[x,y],[y,-x]]),Q.setRows(i,j,Q0.dot(Q.getRows(i,j))))}var R=Q.dot(A).dot(Q.transjugate()),n=A.length,E=numeric.T.identity(n);for(j=0;n>j;j++)if(j>0)for(k=j-1;k>=0;k--){var Rk=R.get([k,k]),Rj=R.get([j,j]);numeric.neq(Rk.x,Rj.x)||numeric.neq(Rk.y,Rj.y)?(x=R.getRow(k).getBlock([k],[j-1]),y=E.getRow(j).getBlock([k],[j-1]),E.set([j,k],R.get([k,j]).neg().sub(x.dot(y)).div(Rk.sub(Rj)))):E.setRow(j,E.getRow(k))}for(j=0;n>j;j++)x=E.getRow(j),E.setRow(j,x.div(x.norm2()));return E=E.transpose(),E=Q.transjugate().dot(E),{lambda:R.getDiag(),E:E}},numeric.ccsSparse=function(A){var n,foo,i,j,m=A.length,counts=[];for(i=m-1;-1!==i;--i){foo=A[i];for(j in foo){for(j=parseInt(j);j>=counts.length;)counts[counts.length]=0;0!==foo[j]&&counts[j]++}}var n=counts.length,Ai=Array(n+1);for(Ai[0]=0,i=0;n>i;++i)Ai[i+1]=Ai[i]+counts[i];var Aj=Array(Ai[n]),Av=Array(Ai[n]);for(i=m-1;-1!==i;--i){foo=A[i];for(j in foo)0!==foo[j]&&(counts[j]--,Aj[Ai[j]+counts[j]]=i,Av[Ai[j]+counts[j]]=foo[j])}return[Ai,Aj,Av]},numeric.ccsFull=function(A){var i,j,j0,j1,Ai=A[0],Aj=A[1],Av=A[2],s=numeric.ccsDim(A),m=s[0],n=s[1],B=numeric.rep([m,n],0);for(i=0;n>i;i++)for(j0=Ai[i],j1=Ai[i+1],j=j0;j1>j;++j)B[Aj[j]][i]=Av[j];return B},numeric.ccsTSolve=function(A,b,x,bj,xj){function dfs(j){var k;if(0===x[j]){for(x[j]=1,k=Ai[j];k<Ai[j+1];++k)dfs(Aj[k]);xj[n]=j,++n}}var Ai=A[0],Aj=A[1],Av=A[2],m=Ai.length-1,max=Math.max,n=0;"undefined"==typeof bj&&(x=numeric.rep([m],0)),"undefined"==typeof bj&&(bj=numeric.linspace(0,x.length-1)),"undefined"==typeof xj&&(xj=[]);var i,j,j0,j1,k,l,a;for(i=bj.length-1;-1!==i;--i)dfs(bj[i]);for(xj.length=n,i=xj.length-1;-1!==i;--i)x[xj[i]]=0;for(i=bj.length-1;-1!==i;--i)j=bj[i],x[j]=b[j];for(i=xj.length-1;-1!==i;--i){for(j=xj[i],j0=Ai[j],j1=max(Ai[j+1],j0),k=j0;k!==j1;++k)if(Aj[k]===j){x[j]/=Av[k];break}for(a=x[j],k=j0;k!==j1;++k)l=Aj[k],l!==j&&(x[l]-=a*Av[k])}return x},numeric.ccsDFS=function(n){this.k=Array(n),this.k1=Array(n),this.j=Array(n)},numeric.ccsDFS.prototype.dfs=function(J,Ai,Aj,x,xj,Pinv){var foo,km,k11,m=0,n=xj.length,k=this.k,k1=this.k1,j=this.j;if(0===x[J])for(x[J]=1,j[0]=J,k[0]=km=Ai[J],k1[0]=k11=Ai[J+1];;)if(km>=k11){if(xj[n]=j[m],0===m)return;++n,--m,km=k[m],k11=k1[m]}else foo=Pinv[Aj[km]],0===x[foo]?(x[foo]=1,k[m]=km,++m,j[m]=foo,km=Ai[foo],k1[m]=k11=Ai[foo+1]):++km},numeric.ccsLPSolve=function(A,B,x,xj,I,Pinv,dfs){var i,i0,i1,j,j0,j1,k,l,a,Ai=A[0],Aj=A[1],Av=A[2],Bi=(Ai.length-1,B[0]),Bj=B[1],Bv=B[2];for(i0=Bi[I],i1=Bi[I+1],xj.length=0,i=i0;i1>i;++i)dfs.dfs(Pinv[Bj[i]],Ai,Aj,x,xj,Pinv);for(i=xj.length-1;-1!==i;--i)x[xj[i]]=0;for(i=i0;i!==i1;++i)j=Pinv[Bj[i]],x[j]=Bv[i];for(i=xj.length-1;-1!==i;--i){for(j=xj[i],j0=Ai[j],j1=Ai[j+1],k=j0;j1>k;++k)if(Pinv[Aj[k]]===j){x[j]/=Av[k];break}for(a=x[j],k=j0;j1>k;++k)l=Pinv[Aj[k]],l!==j&&(x[l]-=a*Av[k])}return x},numeric.ccsLUP1=function(A,threshold){var i,j,k,a,e,c,d,m=A[0].length-1,L=[numeric.rep([m+1],0),[],[]],U=[numeric.rep([m+1],0),[],[]],Li=L[0],Lj=L[1],Lv=L[2],Ui=U[0],Uj=U[1],Uv=U[2],x=numeric.rep([m],0),xj=numeric.rep([m],0),sol=numeric.ccsLPSolve,abs=(Math.max,Math.abs),P=numeric.linspace(0,m-1),Pinv=numeric.linspace(0,m-1),dfs=new numeric.ccsDFS(m);for("undefined"==typeof threshold&&(threshold=1),i=0;m>i;++i){for(sol(L,A,x,xj,i,Pinv,dfs),a=-1,e=-1,j=xj.length-1;-1!==j;--j)k=xj[j],i>=k||(c=abs(x[k]),c>a&&(e=k,a=c));for(abs(x[i])<threshold*a&&(j=P[i],a=P[e],P[i]=a,Pinv[a]=i,P[e]=j,Pinv[j]=e,a=x[i],x[i]=x[e],x[e]=a),a=Li[i],e=Ui[i],d=x[i],Lj[a]=P[i],Lv[a]=1,++a,j=xj.length-1;-1!==j;--j)k=xj[j],c=x[k],xj[j]=0,x[k]=0,i>=k?(Uj[e]=k,Uv[e]=c,++e):(Lj[a]=P[k],Lv[a]=c/d,++a);Li[i+1]=a,Ui[i+1]=e}for(j=Lj.length-1;-1!==j;--j)Lj[j]=Pinv[Lj[j]];return{L:L,U:U,P:P,Pinv:Pinv}},numeric.ccsDFS0=function(n){this.k=Array(n),this.k1=Array(n),this.j=Array(n)},numeric.ccsDFS0.prototype.dfs=function(J,Ai,Aj,x,xj,Pinv){var foo,km,k11,m=0,n=xj.length,k=this.k,k1=this.k1,j=this.j;if(0===x[J])for(x[J]=1,j[0]=J,k[0]=km=Ai[Pinv[J]],k1[0]=k11=Ai[Pinv[J]+1];;){if(isNaN(km))throw new Error("Ow!");if(km>=k11){if(xj[n]=Pinv[j[m]],0===m)return;++n,--m,km=k[m],k11=k1[m]}else foo=Aj[km],0===x[foo]?(x[foo]=1,k[m]=km,++m,j[m]=foo,foo=Pinv[foo],km=Ai[foo],k1[m]=k11=Ai[foo+1]):++km}},numeric.ccsLPSolve0=function(A,B,y,xj,I,Pinv,P,dfs){var i,i0,i1,j,j0,j1,k,l,a,Ai=A[0],Aj=A[1],Av=A[2],Bi=(Ai.length-1,B[0]),Bj=B[1],Bv=B[2];for(i0=Bi[I],i1=Bi[I+1],xj.length=0,i=i0;i1>i;++i)dfs.dfs(Bj[i],Ai,Aj,y,xj,Pinv,P);for(i=xj.length-1;-1!==i;--i)j=xj[i],y[P[j]]=0;for(i=i0;i!==i1;++i)j=Bj[i],y[j]=Bv[i];for(i=xj.length-1;-1!==i;--i){for(j=xj[i],l=P[j],j0=Ai[j],j1=Ai[j+1],k=j0;j1>k;++k)if(Aj[k]===l){y[l]/=Av[k];break}for(a=y[l],k=j0;j1>k;++k)y[Aj[k]]-=a*Av[k];y[l]=a}},numeric.ccsLUP0=function(A,threshold){var i,j,k,a,e,c,d,m=A[0].length-1,L=[numeric.rep([m+1],0),[],[]],U=[numeric.rep([m+1],0),[],[]],Li=L[0],Lj=L[1],Lv=L[2],Ui=U[0],Uj=U[1],Uv=U[2],y=numeric.rep([m],0),xj=numeric.rep([m],0),sol=numeric.ccsLPSolve0,abs=(Math.max,Math.abs),P=numeric.linspace(0,m-1),Pinv=numeric.linspace(0,m-1),dfs=new numeric.ccsDFS0(m);for("undefined"==typeof threshold&&(threshold=1),i=0;m>i;++i){for(sol(L,A,y,xj,i,Pinv,P,dfs),a=-1,e=-1,j=xj.length-1;-1!==j;--j)k=xj[j],i>=k||(c=abs(y[P[k]]),c>a&&(e=k,a=c));for(abs(y[P[i]])<threshold*a&&(j=P[i],a=P[e],P[i]=a,Pinv[a]=i,P[e]=j,Pinv[j]=e),a=Li[i],e=Ui[i],d=y[P[i]],Lj[a]=P[i],Lv[a]=1,++a,j=xj.length-1;-1!==j;--j)k=xj[j],c=y[P[k]],xj[j]=0,y[P[k]]=0,i>=k?(Uj[e]=k,Uv[e]=c,++e):(Lj[a]=P[k],Lv[a]=c/d,++a);Li[i+1]=a,Ui[i+1]=e}for(j=Lj.length-1;-1!==j;--j)Lj[j]=Pinv[Lj[j]];return{L:L,U:U,P:P,Pinv:Pinv}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(A){return[numeric.sup(A[1])+1,A[0].length-1]},numeric.ccsGetBlock=function(A,i,j){var s=numeric.ccsDim(A),m=s[0],n=s[1];"undefined"==typeof i?i=numeric.linspace(0,m-1):"number"==typeof i&&(i=[i]),"undefined"==typeof j?j=numeric.linspace(0,n-1):"number"==typeof j&&(j=[j]);var p,q,r,jq,ip,P=i.length,Q=j.length,Bi=numeric.rep([n],0),Bj=[],Bv=[],B=[Bi,Bj,Bv],Ai=A[0],Aj=A[1],Av=A[2],x=numeric.rep([m],0),count=0,flags=numeric.rep([m],0);for(q=0;Q>q;++q){jq=j[q];var q0=Ai[jq],q1=Ai[jq+1];for(p=q0;q1>p;++p)r=Aj[p],flags[r]=1,x[r]=Av[p];for(p=0;P>p;++p)ip=i[p],flags[ip]&&(Bj[count]=p,Bv[count]=x[i[p]],++count);for(p=q0;q1>p;++p)r=Aj[p],flags[r]=0;Bi[q+1]=count}return B},numeric.ccsDot=function(A,B){var i,j,k,j0,j1,i0,i1,l,p,a,b,Ai=A[0],Aj=A[1],Av=A[2],Bi=B[0],Bj=B[1],Bv=B[2],sA=numeric.ccsDim(A),sB=numeric.ccsDim(B),m=sA[0],o=(sA[1],sB[1]),x=numeric.rep([m],0),flags=numeric.rep([m],0),xj=Array(m),Ci=numeric.rep([o],0),Cj=[],Cv=[],C=[Ci,Cj,Cv];for(k=0;k!==o;++k){for(j0=Bi[k],j1=Bi[k+1],p=0,j=j0;j1>j;++j)for(a=Bj[j],b=Bv[j],i0=Ai[a],i1=Ai[a+1],i=i0;i1>i;++i)l=Aj[i],0===flags[l]&&(xj[p]=l,flags[l]=1,p+=1),x[l]=x[l]+Av[i]*b;for(j0=Ci[k],j1=j0+p,Ci[k+1]=j1,j=p-1;-1!==j;--j)b=j0+j,i=xj[j],Cj[b]=i,Cv[b]=x[i],flags[i]=0,x[i]=0;Ci[k+1]=Ci[k]+p}return C},numeric.ccsLUPSolve=function(LUP,B){var L=LUP.L,U=LUP.U,Bi=(LUP.P,B[0]),flag=!1;"object"!=typeof Bi&&(B=[[0,B.length],numeric.linspace(0,B.length-1),B],Bi=B[0],flag=!0);var i,j,j0,j1,k,J,Bj=B[1],Bv=B[2],n=L[0].length-1,m=Bi.length-1,x=numeric.rep([n],0),xj=Array(n),b=numeric.rep([n],0),bj=Array(n),Xi=numeric.rep([m+1],0),Xj=[],Xv=[],sol=numeric.ccsTSolve,N=0;for(i=0;m>i;++i){for(k=0,j0=Bi[i],j1=Bi[i+1],j=j0;j1>j;++j)J=LUP.Pinv[Bj[j]],bj[k]=J,b[J]=Bv[j],++k;for(bj.length=k,sol(L,b,x,bj,xj),j=bj.length-1;-1!==j;--j)b[bj[j]]=0;if(sol(U,x,b,xj,bj),flag)return b;for(j=xj.length-1;-1!==j;--j)x[xj[j]]=0;for(j=bj.length-1;-1!==j;--j)J=bj[j],Xj[N]=J,Xv[N]=b[J],b[J]=0,++N;Xi[i+1]=N}return[Xi,Xj,Xv]},numeric.ccsbinop=function(body,setup){return"undefined"==typeof setup&&(setup=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+setup+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+body+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")
}(),numeric.ccsScatter=function(A){var i,Ai=A[0],Aj=A[1],Av=A[2],n=numeric.sup(Aj)+1,m=Ai.length,Ri=numeric.rep([n],0),Rj=Array(m),Rv=Array(m),counts=numeric.rep([n],0);for(i=0;m>i;++i)counts[Aj[i]]++;for(i=0;n>i;++i)Ri[i+1]=Ri[i]+counts[i];var k,Aii,ptr=Ri.slice(0);for(i=0;m>i;++i)Aii=Aj[i],k=ptr[Aii],Rj[k]=Ai[i],Rv[k]=Av[i],ptr[Aii]=ptr[Aii]+1;return[Ri,Rj,Rv]},numeric.ccsGather=function(A){var i,j,j0,j1,p,Ai=A[0],Aj=A[1],Av=A[2],n=Ai.length-1,m=Aj.length,Ri=Array(m),Rj=Array(m),Rv=Array(m);for(p=0,i=0;n>i;++i)for(j0=Ai[i],j1=Ai[i+1],j=j0;j!==j1;++j)Rj[p]=i,Ri[p]=Aj[j],Rv[p]=Av[j],++p;return[Ri,Rj,Rv]},numeric.sdim=function dim(A,ret,k){if("undefined"==typeof ret&&(ret=[]),"object"!=typeof A)return ret;"undefined"==typeof k&&(k=0),k in ret||(ret[k]=0),A.length>ret[k]&&(ret[k]=A.length);var i;for(i in A)A.hasOwnProperty(i)&&dim(A[i],ret,k+1);return ret},numeric.sclone=function clone(A,k,n){"undefined"==typeof k&&(k=0),"undefined"==typeof n&&(n=numeric.sdim(A).length);var i,ret=Array(A.length);if(k===n-1){for(i in A)A.hasOwnProperty(i)&&(ret[i]=A[i]);return ret}for(i in A)A.hasOwnProperty(i)&&(ret[i]=clone(A[i],k+1,n));return ret},numeric.sdiag=function(d){var i,i1,n=d.length,ret=Array(n);for(i=n-1;i>=1;i-=2)i1=i-1,ret[i]=[],ret[i][i]=d[i],ret[i1]=[],ret[i1][i1]=d[i1];return 0===i&&(ret[0]=[],ret[0][0]=d[i]),ret},numeric.sidentity=function(n){return numeric.sdiag(numeric.rep([n],1))},numeric.stranspose=function(A){{var i,j,Ai,ret=[];A.length}for(i in A)if(A.hasOwnProperty(i)){Ai=A[i];for(j in Ai)Ai.hasOwnProperty(j)&&("object"!=typeof ret[j]&&(ret[j]=[]),ret[j][i]=Ai[j])}return ret},numeric.sLUP=function(){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(A,B){var Ai,BTk,i,j,k,accum,reti,p=A.length,BT=(B.length,numeric.stranspose(B)),r=BT.length,ret=Array(p);for(i=p-1;i>=0;i--){for(reti=[],Ai=A[i],k=r-1;k>=0;k--){accum=0,BTk=BT[k];for(j in Ai)Ai.hasOwnProperty(j)&&j in BTk&&(accum+=Ai[j]*BTk[j]);accum&&(reti[k]=accum)}ret[i]=reti}return ret},numeric.sdotMV=function(A,x){var Ai,i,j,accum,p=A.length,ret=Array(p);for(i=p-1;i>=0;i--){Ai=A[i],accum=0;for(j in Ai)Ai.hasOwnProperty(j)&&x[j]&&(accum+=Ai[j]*x[j]);accum&&(ret[i]=accum)}return ret},numeric.sdotVM=function(x,A){var i,j,Ai,alpha,ret=[];for(i in x)if(x.hasOwnProperty(i)){Ai=A[i],alpha=x[i];for(j in Ai)Ai.hasOwnProperty(j)&&(ret[j]||(ret[j]=0),ret[j]+=alpha*Ai[j])}return ret},numeric.sdotVV=function(x,y){var i,ret=0;for(i in x)x[i]&&y[i]&&(ret+=x[i]*y[i]);return ret},numeric.sdot=function(A,B){var m=numeric.sdim(A).length,n=numeric.sdim(B).length,k=1e3*m+n;switch(k){case 0:return A*B;case 1001:return numeric.sdotVV(A,B);case 2001:return numeric.sdotMV(A,B);case 1002:return numeric.sdotVM(A,B);case 2002:return numeric.sdotMM(A,B);default:throw new Error("numeric.sdot not implemented for tensors of order "+m+" and "+n)}},numeric.sscatter=function(V){var Vij,i,j,Aj,n=V[0].length,m=V.length,A=[];for(i=n-1;i>=0;--i)if(V[m-1][i]){for(Aj=A,j=0;m-2>j;j++)Vij=V[j][i],Aj[Vij]||(Aj[Vij]=[]),Aj=Aj[Vij];Aj[V[j][i]]=V[j+1][i]}return A},numeric.sgather=function gather(A,ret,k){"undefined"==typeof ret&&(ret=[]),"undefined"==typeof k&&(k=[]);var n,i,Ai;n=k.length;for(i in A)if(A.hasOwnProperty(i))if(k[n]=parseInt(i),Ai=A[i],"number"==typeof Ai){if(Ai){if(0===ret.length)for(i=n+1;i>=0;--i)ret[i]=[];for(i=n;i>=0;--i)ret[i].push(k[i]);ret[n+1].push(Ai)}}else gather(Ai,ret,k);return k.length>n&&k.pop(),ret},numeric.cLU=function(A){var i,j,k,a,b,c,I=A[0],J=A[1],V=A[2],p=I.length,m=0;for(i=0;p>i;i++)I[i]>m&&(m=I[i]);m++;var Ui,Uj,alpha,L=Array(m),U=Array(m),left=numeric.rep([m],1/0),right=numeric.rep([m],-1/0);for(k=0;p>k;k++)i=I[k],j=J[k],j<left[i]&&(left[i]=j),j>right[i]&&(right[i]=j);for(i=0;m-1>i;i++)right[i]>right[i+1]&&(right[i+1]=right[i]);for(i=m-1;i>=1;i--)left[i]<left[i-1]&&(left[i-1]=left[i]);var countL=0,countU=0;for(i=0;m>i;i++)U[i]=numeric.rep([right[i]-left[i]+1],0),L[i]=numeric.rep([i-left[i]],0),countL+=i-left[i]+1,countU+=right[i]-i+1;for(k=0;p>k;k++)i=I[k],U[i][J[k]-left[i]]=V[k];for(i=0;m-1>i;i++)for(a=i-left[i],Ui=U[i],j=i+1;left[j]<=i&&m>j;j++)if(b=i-left[j],c=right[i]-i,Uj=U[j],alpha=Uj[b]/Ui[a]){for(k=1;c>=k;k++)Uj[k+b]-=alpha*Ui[k+a];L[j][i-left[j]]=alpha}var p,q,foo,Ui=[],Uj=[],Uv=[],Li=[],Lj=[],Lv=[];for(p=0,q=0,i=0;m>i;i++){for(a=left[i],b=right[i],foo=U[i],j=i;b>=j;j++)foo[j-a]&&(Ui[p]=i,Uj[p]=j,Uv[p]=foo[j-a],p++);for(foo=L[i],j=a;i>j;j++)foo[j-a]&&(Li[q]=i,Lj[q]=j,Lv[q]=foo[j-a],q++);Li[q]=i,Lj[q]=i,Lv[q]=1,q++}return{U:[Ui,Uj,Uv],L:[Li,Lj,Lv]}},numeric.cLUsolve=function(lu,b){var i,k,L=lu.L,U=lu.U,ret=numeric.clone(b),Li=L[0],Lj=L[1],Lv=L[2],Ui=U[0],Uj=U[1],Uv=U[2],p=Ui.length,m=(Li.length,ret.length);for(k=0,i=0;m>i;i++){for(;Lj[k]<i;)ret[i]-=Lv[k]*ret[Lj[k]],k++;k++}for(k=p-1,i=m-1;i>=0;i--){for(;Uj[k]>i;)ret[i]-=Uv[k]*ret[Uj[k]],k--;ret[i]/=Uv[k],k--}return ret},numeric.cgrid=function(n,shape){"number"==typeof n&&(n=[n,n]);var i,j,count,ret=numeric.rep(n,-1);if("function"!=typeof shape)switch(shape){case"L":shape=function(i,j){return i>=n[0]/2||j<n[1]/2};break;default:shape=function(){return!0}}for(count=0,i=1;i<n[0]-1;i++)for(j=1;j<n[1]-1;j++)shape(i,j)&&(ret[i][j]=count,count++);return ret},numeric.cdelsq=function(g){var i,j,k,p,q,dir=[[-1,0],[0,-1],[0,1],[1,0]],s=numeric.dim(g),m=s[0],n=s[1],Li=[],Lj=[],Lv=[];for(i=1;m-1>i;i++)for(j=1;n-1>j;j++)if(!(g[i][j]<0)){for(k=0;4>k;k++)p=i+dir[k][0],q=j+dir[k][1],g[p][q]<0||(Li.push(g[i][j]),Lj.push(g[p][q]),Lv.push(-1));Li.push(g[i][j]),Lj.push(g[i][j]),Lv.push(4)}return[Li,Lj,Lv]},numeric.cdotMV=function(A,x){var ret,k,N,Ai=A[0],Aj=A[1],Av=A[2],p=Ai.length;for(N=0,k=0;p>k;k++)Ai[k]>N&&(N=Ai[k]);for(N++,ret=numeric.rep([N],0),k=0;p>k;k++)ret[Ai[k]]+=Av[k]*x[Aj[k]];return ret},numeric.Spline=function(x,yl,yr,kl,kr){this.x=x,this.yl=yl,this.yr=yr,this.kl=kl,this.kr=kr},numeric.Spline.prototype._at=function(x1,p){var x1,a,b,t,x=this.x,yl=this.yl,yr=this.yr,kl=this.kl,kr=this.kr,add=numeric.add,sub=numeric.sub,mul=numeric.mul;a=sub(mul(kl[p],x[p+1]-x[p]),sub(yr[p+1],yl[p])),b=add(mul(kr[p+1],x[p]-x[p+1]),sub(yr[p+1],yl[p])),t=(x1-x[p])/(x[p+1]-x[p]);var s=t*(1-t);return add(add(add(mul(1-t,yl[p]),mul(t,yr[p+1])),mul(a,s*(1-t))),mul(b,s*t))},numeric.Spline.prototype.at=function(x0){if("number"==typeof x0){var p,q,mid,x=this.x,n=x.length,floor=Math.floor;for(p=0,q=n-1;q-p>1;)mid=floor((p+q)/2),x[mid]<=x0?p=mid:q=mid;return this._at(x0,p)}var i,n=x0.length,ret=Array(n);for(i=n-1;-1!==i;--i)ret[i]=this.at(x0[i]);return ret},numeric.Spline.prototype.diff=function(){var i,dx,dy,x=this.x,yl=this.yl,yr=this.yr,kl=this.kl,kr=this.kr,n=yl.length,zl=kl,zr=kr,pl=Array(n),pr=Array(n),add=numeric.add,mul=numeric.mul,div=numeric.div,sub=numeric.sub;for(i=n-1;-1!==i;--i)dx=x[i+1]-x[i],dy=sub(yr[i+1],yl[i]),pl[i]=div(add(mul(dy,6),mul(kl[i],-4*dx),mul(kr[i+1],-2*dx)),dx*dx),pr[i+1]=div(add(mul(dy,-6),mul(kl[i],2*dx),mul(kr[i+1],4*dx)),dx*dx);return new numeric.Spline(x,zl,zr,pl,pr)},numeric.Spline.prototype.roots=function(){function sqr(x){return x*x}var ret=[],x=this.x,yl=this.yl,yr=this.yr,kl=this.kl,kr=this.kr;"number"==typeof yl[0]&&(yl=[yl],yr=[yr],kl=[kl],kr=[kr]);var i,j,k,ai,bi,ci,di,ri,k0,k1,y0,y1,A,B,D,dx,cx,stops,z0,z1,zm,t0,t1,tm,m=yl.length,n=x.length-1,ret=Array(m),sqrt=Math.sqrt;for(i=0;i!==m;++i){for(ai=yl[i],bi=yr[i],ci=kl[i],di=kr[i],ri=[],j=0;j!==n;j++){for(j>0&&bi[j]*ai[j]<0&&ri.push(x[j]),dx=x[j+1]-x[j],cx=x[j],y0=ai[j],y1=bi[j+1],k0=ci[j]/dx,k1=di[j+1]/dx,D=sqr(k0-k1+3*(y0-y1))+12*k1*y0,A=k1+3*y0+2*k0-3*y1,B=3*(k1+k0+2*(y0-y1)),0>=D?(z0=A/B,stops=z0>x[j]&&z0<x[j+1]?[x[j],z0,x[j+1]]:[x[j],x[j+1]]):(z0=(A-sqrt(D))/B,z1=(A+sqrt(D))/B,stops=[x[j]],z0>x[j]&&z0<x[j+1]&&stops.push(z0),z1>x[j]&&z1<x[j+1]&&stops.push(z1),stops.push(x[j+1])),t0=stops[0],z0=this._at(t0,j),k=0;k<stops.length-1;k++)if(t1=stops[k+1],z1=this._at(t1,j),0!==z0)if(0===z1||z0*z1>0)t0=t1,z0=z1;else{for(var side=0;;){if(tm=(z0*t1-z1*t0)/(z0-z1),t0>=tm||tm>=t1)break;if(zm=this._at(tm,j),zm*z1>0)t1=tm,z1=zm,-1===side&&(z0*=.5),side=-1;else{if(!(zm*z0>0))break;t0=tm,z0=zm,1===side&&(z1*=.5),side=1}}ri.push(tm),t0=stops[k+1],z0=this._at(t0,j)}else ri.push(t0),t0=t1,z0=z1;0===z1&&ri.push(t1)}ret[i]=ri}return"number"==typeof this.yl[0]?ret[0]:ret},numeric.spline=function(x,y,k1,kn){var i,n=x.length,b=[],dx=[],dy=[],sub=numeric.sub,mul=numeric.mul,add=numeric.add;for(i=n-2;i>=0;i--)dx[i]=x[i+1]-x[i],dy[i]=sub(y[i+1],y[i]);("string"==typeof k1||"string"==typeof kn)&&(k1=kn="periodic");var T=[[],[],[]];switch(typeof k1){case"undefined":b[0]=mul(3/(dx[0]*dx[0]),dy[0]),T[0].push(0,0),T[1].push(0,1),T[2].push(2/dx[0],1/dx[0]);break;case"string":b[0]=add(mul(3/(dx[n-2]*dx[n-2]),dy[n-2]),mul(3/(dx[0]*dx[0]),dy[0])),T[0].push(0,0,0),T[1].push(n-2,0,1),T[2].push(1/dx[n-2],2/dx[n-2]+2/dx[0],1/dx[0]);break;default:b[0]=k1,T[0].push(0),T[1].push(0),T[2].push(1)}for(i=1;n-1>i;i++)b[i]=add(mul(3/(dx[i-1]*dx[i-1]),dy[i-1]),mul(3/(dx[i]*dx[i]),dy[i])),T[0].push(i,i,i),T[1].push(i-1,i,i+1),T[2].push(1/dx[i-1],2/dx[i-1]+2/dx[i],1/dx[i]);switch(typeof kn){case"undefined":b[n-1]=mul(3/(dx[n-2]*dx[n-2]),dy[n-2]),T[0].push(n-1,n-1),T[1].push(n-2,n-1),T[2].push(1/dx[n-2],2/dx[n-2]);break;case"string":T[1][T[1].length-1]=0;break;default:b[n-1]=kn,T[0].push(n-1),T[1].push(n-1),T[2].push(1)}b="number"!=typeof b[0]?numeric.transpose(b):[b];var k=Array(b.length);if("string"==typeof k1)for(i=k.length-1;-1!==i;--i)k[i]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(T)),b[i]),k[i][n-1]=k[i][0];else for(i=k.length-1;-1!==i;--i)k[i]=numeric.cLUsolve(numeric.cLU(T),b[i]);return k="number"==typeof y[0]?k[0]:numeric.transpose(k),new numeric.Spline(x,y,y,k,k)},numeric.fftpow2=function fftpow2(x,y){var n=x.length;if(1!==n){var i,j,cos=Math.cos,sin=Math.sin,xe=Array(n/2),ye=Array(n/2),xo=Array(n/2),yo=Array(n/2);for(j=n/2,i=n-1;-1!==i;--i)--j,xo[j]=x[i],yo[j]=y[i],--i,xe[j]=x[i],ye[j]=y[i];fftpow2(xe,ye),fftpow2(xo,yo),j=n/2;var t,ci,si,k=-6.283185307179586/n;for(i=n-1;-1!==i;--i)--j,-1===j&&(j=n/2-1),t=k*i,ci=cos(t),si=sin(t),x[i]=xe[j]+ci*xo[j]-si*yo[j],y[i]=ye[j]+ci*yo[j]+si*xo[j]}},numeric._ifftpow2=function _ifftpow2(x,y){var n=x.length;if(1!==n){var i,j,cos=Math.cos,sin=Math.sin,xe=Array(n/2),ye=Array(n/2),xo=Array(n/2),yo=Array(n/2);for(j=n/2,i=n-1;-1!==i;--i)--j,xo[j]=x[i],yo[j]=y[i],--i,xe[j]=x[i],ye[j]=y[i];_ifftpow2(xe,ye),_ifftpow2(xo,yo),j=n/2;var t,ci,si,k=6.283185307179586/n;for(i=n-1;-1!==i;--i)--j,-1===j&&(j=n/2-1),t=k*i,ci=cos(t),si=sin(t),x[i]=xe[j]+ci*xo[j]-si*yo[j],y[i]=ye[j]+ci*yo[j]+si*xo[j]}},numeric.ifftpow2=function(x,y){numeric._ifftpow2(x,y),numeric.diveq(x,x.length),numeric.diveq(y,y.length)},numeric.convpow2=function(ax,ay,bx,by){numeric.fftpow2(ax,ay),numeric.fftpow2(bx,by);var i,axi,bxi,ayi,byi,n=ax.length;for(i=n-1;-1!==i;--i)axi=ax[i],ayi=ay[i],bxi=bx[i],byi=by[i],ax[i]=axi*bxi-ayi*byi,ay[i]=axi*byi+ayi*bxi;numeric.ifftpow2(ax,ay)},numeric.T.prototype.fft=function(){{var k,t,x=this.x,y=this.y,n=x.length,log=Math.log,log2=log(2),p=Math.ceil(log(2*n-1)/log2),m=Math.pow(2,p),cx=numeric.rep([m],0),cy=numeric.rep([m],0),cos=Math.cos,sin=Math.sin,c=-3.141592653589793/n,a=numeric.rep([m],0),b=numeric.rep([m],0);Math.floor(n/2)}for(k=0;n>k;k++)a[k]=x[k];if("undefined"!=typeof y)for(k=0;n>k;k++)b[k]=y[k];for(cx[0]=1,k=1;m/2>=k;k++)t=c*k*k,cx[k]=cos(t),cy[k]=sin(t),cx[m-k]=cos(t),cy[m-k]=sin(t);var X=new numeric.T(a,b),Y=new numeric.T(cx,cy);return X=X.mul(Y),numeric.convpow2(X.x,X.y,numeric.clone(Y.x),numeric.neg(Y.y)),X=X.mul(Y),X.x.length=n,X.y.length=n,X},numeric.T.prototype.ifft=function(){{var k,t,x=this.x,y=this.y,n=x.length,log=Math.log,log2=log(2),p=Math.ceil(log(2*n-1)/log2),m=Math.pow(2,p),cx=numeric.rep([m],0),cy=numeric.rep([m],0),cos=Math.cos,sin=Math.sin,c=3.141592653589793/n,a=numeric.rep([m],0),b=numeric.rep([m],0);Math.floor(n/2)}for(k=0;n>k;k++)a[k]=x[k];if("undefined"!=typeof y)for(k=0;n>k;k++)b[k]=y[k];for(cx[0]=1,k=1;m/2>=k;k++)t=c*k*k,cx[k]=cos(t),cy[k]=sin(t),cx[m-k]=cos(t),cy[m-k]=sin(t);var X=new numeric.T(a,b),Y=new numeric.T(cx,cy);return X=X.mul(Y),numeric.convpow2(X.x,X.y,numeric.clone(Y.x),numeric.neg(Y.y)),X=X.mul(Y),X.x.length=n,X.y.length=n,X.div(n)},numeric.gradient=function(f,x){var n=x.length,f0=f(x);if(isNaN(f0))throw new Error("gradient: f(x) is a NaN!");var i,f1,f2,errest,t0,t1,t2,d1,d2,N,max=Math.max,x0=numeric.clone(x),J=Array(n),max=(numeric.div,numeric.sub,Math.max),eps=.001,abs=Math.abs,min=Math.min,it=0;for(i=0;n>i;i++)for(var h=max(1e-6*f0,1e-8);;){if(++it,it>20)throw new Error("Numerical gradient fails");if(x0[i]=x[i]+h,f1=f(x0),x0[i]=x[i]-h,f2=f(x0),x0[i]=x[i],isNaN(f1)||isNaN(f2))h/=16;else{if(J[i]=(f1-f2)/(2*h),t0=x[i]-h,t1=x[i],t2=x[i]+h,d1=(f1-f0)/h,d2=(f0-f2)/h,N=max(abs(J[i]),abs(f0),abs(f1),abs(f2),abs(t0),abs(t1),abs(t2),1e-8),errest=min(max(abs(d1-J[i]),abs(d2-J[i]),abs(d1-d2))/N,h/N),!(errest>eps))break;h/=16}}return J},numeric.uncmin=function(f,x0,tol,gradient,maxit,callback,options){var grad=numeric.gradient;"undefined"==typeof options&&(options={}),"undefined"==typeof tol&&(tol=1e-8),"undefined"==typeof gradient&&(gradient=function(x){return grad(f,x)}),"undefined"==typeof maxit&&(maxit=1e3),x0=numeric.clone(x0);var f1,df0,n=x0.length,f0=f(x0);if(isNaN(f0))throw new Error("uncmin: f(x0) is a NaN!");var max=Math.max,norm2=numeric.norm2;tol=max(tol,numeric.epsilon);var step,g0,g1,s,x1,y,Hy,ys,t,nstep,H1=options.Hinv||numeric.identity(n),dot=numeric.dot,sub=(numeric.inv,numeric.sub),add=numeric.add,ten=numeric.tensor,div=numeric.div,mul=numeric.mul,all=numeric.all,isfinite=numeric.isFinite,neg=numeric.neg,it=0,msg="";for(g0=gradient(x0);maxit>it;){if("function"==typeof callback&&callback(it,x0,f0,g0,H1)){msg="Callback returned true";break}if(!all(isfinite(g0))){msg="Gradient has Infinity or NaN";break}if(step=neg(dot(H1,g0)),!all(isfinite(step))){msg="Search direction has Infinity or NaN";break}if(nstep=norm2(step),tol>nstep){msg="Newton step smaller than tol";break}for(t=1,df0=dot(g0,step),x1=x0;maxit>it&&!(tol>t*nstep)&&(s=mul(step,t),x1=add(x0,s),f1=f(x1),f1-f0>=.1*t*df0||isNaN(f1));)t*=.5,++it;if(tol>t*nstep){msg="Line search step size smaller than tol";break}if(it===maxit){msg="maxit reached during line search";break}g1=gradient(x1),y=sub(g1,g0),ys=dot(y,s),Hy=dot(H1,y),H1=sub(add(H1,mul((ys+dot(y,Hy))/(ys*ys),ten(s,s))),div(add(ten(Hy,s),ten(s,Hy)),ys)),x0=x1,f0=f1,g0=g1,++it}return{solution:x0,f:f0,gradient:g0,invHessian:H1,iterations:it,message:msg}},numeric.Dopri=function(x,y,f,ymid,iterations,msg,events){this.x=x,this.y=y,this.f=f,this.ymid=ymid,this.iterations=iterations,this.events=events,this.message=msg},numeric.Dopri.prototype._at=function(xi,j){function sqr(x){return x*x}var x0,x1,xh,y0,y1,yh,xi,h,p,q,w,sol=this,xs=sol.x,ys=sol.y,k1=sol.f,ymid=sol.ymid,c=(xs.length,Math.floor,.5),add=numeric.add,mul=numeric.mul,sub=numeric.sub;return x0=xs[j],x1=xs[j+1],y0=ys[j],y1=ys[j+1],h=x1-x0,xh=x0+c*h,yh=ymid[j],p=sub(k1[j],mul(y0,1/(x0-xh)+2/(x0-x1))),q=sub(k1[j+1],mul(y1,1/(x1-xh)+2/(x1-x0))),w=[sqr(xi-x1)*(xi-xh)/sqr(x0-x1)/(x0-xh),sqr(xi-x0)*sqr(xi-x1)/sqr(x0-xh)/sqr(x1-xh),sqr(xi-x0)*(xi-xh)/sqr(x1-x0)/(x1-xh),(xi-x0)*sqr(xi-x1)*(xi-xh)/sqr(x0-x1)/(x0-xh),(xi-x1)*sqr(xi-x0)*(xi-xh)/sqr(x0-x1)/(x1-xh)],add(add(add(add(mul(y0,w[0]),mul(yh,w[1])),mul(y1,w[2])),mul(p,w[3])),mul(q,w[4]))},numeric.Dopri.prototype.at=function(x){var i,j,k,floor=Math.floor;if("number"!=typeof x){var n=x.length,ret=Array(n);for(i=n-1;-1!==i;--i)ret[i]=this.at(x[i]);return ret}var x0=this.x;for(i=0,j=x0.length-1;j-i>1;)k=floor(.5*(i+j)),x0[k]<=x?i=k:j=k;return this._at(x,i)},numeric.dopri=function(x0,x1,y0,f,tol,maxit,event){"undefined"==typeof tol&&(tol=1e-6),"undefined"==typeof maxit&&(maxit=1e3);var k2,k3,k4,k5,k6,k7,er,j,y1,erinf,e0,e1,ev,xs=[x0],ys=[y0],k1=[f(x0,y0)],ymid=[],A2=.2,A3=[.075,.225],A4=[44/45,-56/15,32/9],A5=[19372/6561,-25360/2187,64448/6561,-212/729],A6=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],b=[35/384,0,500/1113,125/192,-2187/6784,11/84],bm=[.10013431883002395,0,.3918321794184259,-0.02982460176594817,.05893268337240795,-0.04497888809104361,.023904308236133973],c=[.2,.3,.8,8/9,1,1],e=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],i=0,h=(x1-x0)/10,it=0,add=numeric.add,mul=numeric.mul,min=(Math.max,Math.min),abs=Math.abs,norminf=numeric.norminf,pow=Math.pow,any=numeric.any,lt=numeric.lt,and=numeric.and,ret=(numeric.sub,new numeric.Dopri(xs,ys,k1,ymid,-1,""));for("function"==typeof event&&(e0=event(x0,y0));x1>x0&&maxit>it;)if(++it,x0+h>x1&&(h=x1-x0),k2=f(x0+c[0]*h,add(y0,mul(A2*h,k1[i]))),k3=f(x0+c[1]*h,add(add(y0,mul(A3[0]*h,k1[i])),mul(A3[1]*h,k2))),k4=f(x0+c[2]*h,add(add(add(y0,mul(A4[0]*h,k1[i])),mul(A4[1]*h,k2)),mul(A4[2]*h,k3))),k5=f(x0+c[3]*h,add(add(add(add(y0,mul(A5[0]*h,k1[i])),mul(A5[1]*h,k2)),mul(A5[2]*h,k3)),mul(A5[3]*h,k4))),k6=f(x0+c[4]*h,add(add(add(add(add(y0,mul(A6[0]*h,k1[i])),mul(A6[1]*h,k2)),mul(A6[2]*h,k3)),mul(A6[3]*h,k4)),mul(A6[4]*h,k5))),y1=add(add(add(add(add(y0,mul(k1[i],h*b[0])),mul(k3,h*b[2])),mul(k4,h*b[3])),mul(k5,h*b[4])),mul(k6,h*b[5])),k7=f(x0+h,y1),er=add(add(add(add(add(mul(k1[i],h*e[0]),mul(k3,h*e[2])),mul(k4,h*e[3])),mul(k5,h*e[4])),mul(k6,h*e[5])),mul(k7,h*e[6])),erinf="number"==typeof er?abs(er):norminf(er),erinf>tol){if(h=.2*h*pow(tol/erinf,.25),x0+h===x0){ret.msg="Step size became too small";break}}else{if(ymid[i]=add(add(add(add(add(add(y0,mul(k1[i],h*bm[0])),mul(k3,h*bm[2])),mul(k4,h*bm[3])),mul(k5,h*bm[4])),mul(k6,h*bm[5])),mul(k7,h*bm[6])),++i,xs[i]=x0+h,ys[i]=y1,k1[i]=k7,"function"==typeof event){var yi,xi,xl=x0,xr=x0+.5*h;if(e1=event(xr,ymid[i-1]),ev=and(lt(e0,0),lt(0,e1)),any(ev)||(xl=xr,xr=x0+h,e0=e1,e1=event(xr,y1),ev=and(lt(e0,0),lt(0,e1))),any(ev)){for(var en,ei,side=0,sl=1,sr=1;;){if("number"==typeof e0)xi=(sr*e1*xl-sl*e0*xr)/(sr*e1-sl*e0);else for(xi=xr,j=e0.length-1;-1!==j;--j)e0[j]<0&&e1[j]>0&&(xi=min(xi,(sr*e1[j]*xl-sl*e0[j]*xr)/(sr*e1[j]-sl*e0[j])));if(xl>=xi||xi>=xr)break;yi=ret._at(xi,i-1),ei=event(xi,yi),en=and(lt(e0,0),lt(0,ei)),any(en)?(xr=xi,e1=ei,ev=en,sr=1,-1===side?sl*=.5:sl=1,side=-1):(xl=xi,e0=ei,sl=1,1===side?sr*=.5:sr=1,side=1)}return y1=ret._at(.5*(x0+xi),i-1),ret.f[i]=f(xi,yi),ret.x[i]=xi,ret.y[i]=yi,ret.ymid[i-1]=y1,ret.events=ev,ret.iterations=it,ret}}x0+=h,y0=y1,e0=e1,h=min(.8*h*pow(tol/erinf,.25),4*h)}return ret.iterations=it,ret},numeric.LU=function(A,fast){fast=fast||!1;var i,j,k,absAjk,Akk,Ak,Pk,Ai,max,abs=Math.abs,n=A.length,n1=n-1,P=new Array(n);for(fast||(A=numeric.clone(A)),k=0;n>k;++k){for(Pk=k,Ak=A[k],max=abs(Ak[k]),j=k+1;n>j;++j)absAjk=abs(A[j][k]),absAjk>max&&(max=absAjk,Pk=j);for(P[k]=Pk,Pk!=k&&(A[k]=A[Pk],A[Pk]=Ak,Ak=A[k]),Akk=Ak[k],i=k+1;n>i;++i)A[i][k]/=Akk;for(i=k+1;n>i;++i){for(Ai=A[i],j=k+1;n1>j;++j)Ai[j]-=Ai[k]*Ak[j],++j,Ai[j]-=Ai[k]*Ak[j];j===n1&&(Ai[j]-=Ai[k]*Ak[j])}}return{LU:A,P:P}},numeric.LUsolve=function(LUP,b){var i,j,Pi,LUi,tmp,LU=LUP.LU,n=LU.length,x=numeric.clone(b),P=LUP.P;for(i=n-1;-1!==i;--i)x[i]=b[i];for(i=0;n>i;++i)for(Pi=P[i],P[i]!==i&&(tmp=x[i],x[i]=x[Pi],x[Pi]=tmp),LUi=LU[i],j=0;i>j;++j)x[i]-=x[j]*LUi[j];for(i=n-1;i>=0;--i){for(LUi=LU[i],j=i+1;n>j;++j)x[i]-=x[j]*LUi[j];x[i]/=LUi[i]}return x},numeric.solve=function(A,b,fast){return numeric.LUsolve(numeric.LU(A,fast),b)},numeric.echelonize=function(A){var i,j,k,l,Ai,Ii,Z,a,s=numeric.dim(A),m=s[0],n=s[1],I=numeric.identity(m),P=Array(m),abs=Math.abs,diveq=numeric.diveq;for(A=numeric.clone(A),i=0;m>i;++i){for(k=0,Ai=A[i],Ii=I[i],j=1;n>j;++j)abs(Ai[k])<abs(Ai[j])&&(k=j);for(P[i]=k,diveq(Ii,Ai[k]),diveq(Ai,Ai[k]),j=0;m>j;++j)if(j!==i){for(Z=A[j],a=Z[k],l=n-1;-1!==l;--l)Z[l]-=Ai[l]*a;for(Z=I[j],l=m-1;-1!==l;--l)Z[l]-=Ii[l]*a}}return{I:I,A:A,P:P}},numeric.__solveLP=function(c,A,b,tol,maxit,x,flag){var y,H,count,g,sum=numeric.sum,mul=(numeric.log,numeric.mul),sub=numeric.sub,dot=numeric.dot,div=numeric.div,add=numeric.add,m=c.length,n=b.length,unbounded=!1,i0=0,alpha=1,transpose=(numeric.transpose(A),numeric.svd,numeric.transpose),sqrt=(numeric.leq,Math.sqrt),abs=Math.abs,min=(numeric.muleq,numeric.norminf,numeric.any,Math.min),all=numeric.all,gt=numeric.gt,p=Array(m),A0=Array(n),solve=(numeric.rep([n],1),numeric.solve),z=sub(b,dot(A,x)),dotcc=dot(c,c);for(count=i0;maxit>count;++count){var i,d;for(i=n-1;-1!==i;--i)A0[i]=div(A[i],z[i]);var A1=transpose(A0);for(i=m-1;-1!==i;--i)p[i]=sum(A1[i]);alpha=.25*abs(dotcc/dot(c,p));var a1=100*sqrt(dotcc/dot(p,p));for((!isFinite(alpha)||alpha>a1)&&(alpha=a1),g=add(c,mul(alpha,p)),H=dot(A1,A0),i=m-1;-1!==i;--i)H[i][i]+=1;d=solve(H,div(g,alpha),!0);var t0=div(z,dot(A,d)),t=1;for(i=n-1;-1!==i;--i)t0[i]<0&&(t=min(t,-.999*t0[i]));if(y=sub(x,mul(d,t)),z=sub(b,dot(A,y)),!all(gt(z,0)))return{solution:x,message:"",iterations:count};if(x=y,tol>alpha)return{solution:y,message:"",iterations:count};if(flag){var s=dot(c,g),Ag=dot(A,g);for(unbounded=!0,i=n-1;-1!==i;--i)if(s*Ag[i]<0){unbounded=!1;break}}else unbounded=x[m-1]>=0?!1:!0;if(unbounded)return{solution:y,message:"Unbounded",iterations:count}}return{solution:x,message:"maximum iteration count exceeded",iterations:count}},numeric._solveLP=function(c,A,b,tol,maxit){var y,m=c.length,n=b.length,sub=(numeric.sum,numeric.log,numeric.mul,numeric.sub),dot=numeric.dot,c0=(numeric.div,numeric.add,numeric.rep([m],0).concat([1])),J=numeric.rep([n,1],-1),A0=numeric.blockMatrix([[A,J]]),b0=b,y=numeric.rep([m],0).concat(Math.max(0,numeric.sup(numeric.neg(b)))+1),x0=numeric.__solveLP(c0,A0,b0,tol,maxit,y,!1),x=numeric.clone(x0.solution);x.length=m;var foo=numeric.inf(sub(b,dot(A,x)));if(0>foo)return{solution:0/0,message:"Infeasible",iterations:x0.iterations};var ret=numeric.__solveLP(c,A,b,tol,maxit-x0.iterations,x,!0);return ret.iterations+=x0.iterations,ret},numeric.solveLP=function(c,A,b,Aeq,beq,tol,maxit){if("undefined"==typeof maxit&&(maxit=1e3),"undefined"==typeof tol&&(tol=numeric.epsilon),"undefined"==typeof Aeq)return numeric._solveLP(c,A,b,tol,maxit);var i,m=Aeq.length,n=Aeq[0].length,o=A.length,B=numeric.echelonize(Aeq),flags=numeric.rep([n],0),P=B.P,Q=[];for(i=P.length-1;-1!==i;--i)flags[P[i]]=1;for(i=n-1;-1!==i;--i)0===flags[i]&&Q.push(i);var g=numeric.getRange,I=numeric.linspace(0,m-1),J=numeric.linspace(0,o-1),Aeq2=g(Aeq,I,Q),A1=g(A,J,P),A2=g(A,J,Q),dot=numeric.dot,sub=numeric.sub,A3=dot(A1,B.I),A4=sub(A2,dot(A3,Aeq2)),b4=sub(b,dot(A3,beq)),c1=Array(P.length),c2=Array(Q.length);for(i=P.length-1;-1!==i;--i)c1[i]=c[P[i]];for(i=Q.length-1;-1!==i;--i)c2[i]=c[Q[i]];var c4=sub(c2,dot(c1,dot(B.I,Aeq2))),S=numeric._solveLP(c4,A4,b4,tol,maxit),x2=S.solution;if(x2!==x2)return S;var x1=dot(B.I,sub(beq,dot(Aeq2,x2))),x=Array(c.length);for(i=P.length-1;-1!==i;--i)x[P[i]]=x1[i];for(i=Q.length-1;-1!==i;--i)x[Q[i]]=x2[i];return{solution:x,message:S.message,iterations:S.iterations}},numeric.MPStoLP=function(MPS){function err(e){throw new Error("MPStoLP: "+e+"\nLine "+i+": "+MPS[i]+"\nCurrent state: "+states[state]+"\n")}MPS instanceof String&&MPS.split("\n");var i,j,z,name,state=0,states=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],n=MPS.length,N=0,rows={},sign=[],rl=0,vars={},nv=0,c=[],A=[],b=[];for(i=0;n>i;++i){z=MPS[i];var w0=z.match(/\S*/g),w=[];for(j=0;j<w0.length;++j)""!==w0[j]&&w.push(w0[j]);if(0!==w.length){for(j=0;j<states.length&&z.substr(0,states[j].length)!==states[j];++j);if(j<states.length){if(state=j,1===j&&(name=w[1]),6===j)return{name:name,c:c,A:numeric.transpose(A),b:b,rows:rows,vars:vars}}else switch(state){case 0:case 1:err("Unexpected line");case 2:switch(w[0]){case"N":0===N?N=w[1]:err("Two or more N rows");break;case"L":rows[w[1]]=rl,sign[rl]=1,b[rl]=0,++rl;break;case"G":rows[w[1]]=rl,sign[rl]=-1,b[rl]=0,++rl;break;case"E":rows[w[1]]=rl,sign[rl]=0,b[rl]=0,++rl;break;default:err("Parse error "+numeric.prettyPrint(w))}break;case 3:vars.hasOwnProperty(w[0])||(vars[w[0]]=nv,c[nv]=0,A[nv]=numeric.rep([rl],0),++nv);var p=vars[w[0]];for(j=1;j<w.length;j+=2)if(w[j]!==N){var q=rows[w[j]];A[p][q]=(sign[q]<0?-1:1)*parseFloat(w[j+1])}else c[p]=parseFloat(w[j+1]);break;case 4:for(j=1;j<w.length;j+=2)b[rows[w[j]]]=(sign[rows[w[j]]]<0?-1:1)*parseFloat(w[j+1]);break;case 5:break;case 6:err("Internal error")}}}err("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(pool,math,width,chunks,significance,overflow,startdenom){function ARC4(key){var t,u,me=this,keylen=key.length,i=0,j=me.i=me.j=me.m=0;for(me.S=[],me.c=[],keylen||(key=[keylen++]);width>i;)me.S[i]=i++;for(i=0;width>i;i++)t=me.S[i],j=lowbits(j+t+key[i%keylen]),u=me.S[j],me.S[i]=u,me.S[j]=t;me.g=function(count){var s=me.S,i=lowbits(me.i+1),t=s[i],j=lowbits(me.j+t),u=s[j];s[i]=u,s[j]=t;for(var r=s[lowbits(t+u)];--count;)i=lowbits(i+1),t=s[i],j=lowbits(j+t),u=s[j],s[i]=u,s[j]=t,r=r*width+s[lowbits(t+u)];return me.i=i,me.j=j,r},me.g(width)}function flatten(obj,depth,result,prop,typ){if(result=[],typ=typeof obj,depth&&"object"==typ)for(prop in obj)if(prop.indexOf("S")<5)try{result.push(flatten(obj[prop],depth-1))}catch(e){}return result.length?result:obj+("string"!=typ?"\x00":"")}function mixkey(seed,key,smear,j){for(seed+="",smear=0,j=0;j<seed.length;j++)key[lowbits(j)]=lowbits((smear^=19*key[lowbits(j)])+seed.charCodeAt(j));seed="";for(j in key)seed+=String.fromCharCode(key[j]);return seed}function lowbits(n){return n&width-1}math.seedrandom=function(seed,use_entropy){var arc4,key=[];return seed=mixkey(flatten(use_entropy?[seed,pool]:arguments.length?seed:[(new Date).getTime(),pool,window],3),key),arc4=new ARC4(key),mixkey(arc4.S,pool),math.random=function(){for(var n=arc4.g(chunks),d=startdenom,x=0;significance>n;)n=(n+x)*width,d*=width,x=arc4.g(1);for(;n>=overflow;)n/=2,d/=2,x>>>=1;return(n+x)/d},seed},startdenom=math.pow(width,chunks),significance=math.pow(2,significance),overflow=2*significance,mixkey(math.random(),pool)}([],numeric.seedrandom,256,6,52),function(exports){function base0to1(A){if("object"!=typeof A)return A;var i,ret=[],n=A.length;for(i=0;n>i;i++)ret[i+1]=base0to1(A[i]);return ret}function base1to0(A){if("object"!=typeof A)return A;var i,ret=[],n=A.length;for(i=1;n>i;i++)ret[i-1]=base1to0(A[i]);return ret}function dpori(a,lda,n){var i,j,k,kp1,t;for(k=1;n>=k;k+=1){for(a[k][k]=1/a[k][k],t=-a[k][k],i=1;k>i;i+=1)a[i][k]=t*a[i][k];if(kp1=k+1,kp1>n)break;for(j=kp1;n>=j;j+=1)for(t=a[k][j],a[k][j]=0,i=1;k>=i;i+=1)a[i][j]=a[i][j]+t*a[i][k]}}function dposl(a,lda,n,b){var i,k,kb,t;for(k=1;n>=k;k+=1){for(t=0,i=1;k>i;i+=1)t+=a[i][k]*b[i];b[k]=(b[k]-t)/a[k][k]}for(kb=1;n>=kb;kb+=1)for(k=n+1-kb,b[k]=b[k]/a[k][k],t=-b[k],i=1;k>i;i+=1)b[i]=b[i]+t*a[i][k]}function dpofa(a,lda,n,info){var i,j,jm1,k,t,s;for(j=1;n>=j;j+=1){if(info[1]=j,s=0,jm1=j-1,1>jm1){if(s=a[j][j]-s,0>=s)break;a[j][j]=Math.sqrt(s)}else{for(k=1;jm1>=k;k+=1){for(t=a[k][j],i=1;k>i;i+=1)t-=a[i][j]*a[i][k];t/=a[k][k],a[k][j]=t,s+=t*t}if(s=a[j][j]-s,0>=s)break;a[j][j]=Math.sqrt(s)}info[1]=0}}function qpgen2(dmat,dvec,fddmat,n,sol,crval,amat,bvec,fdamat,q,meq,iact,nact,iter,work,ierr){function fn_goto_50(){for(iter[1]=iter[1]+1,l=iwsv,i=1;q>=i;i+=1){for(l+=1,sum=-bvec[i],j=1;n>=j;j+=1)sum+=amat[j][i]*sol[j];if(Math.abs(sum)<vsmall&&(sum=0),i>meq)work[l]=sum;else if(work[l]=-Math.abs(sum),sum>0){for(j=1;n>=j;j+=1)amat[j][i]=-amat[j][i];bvec[i]=-bvec[i]}}for(i=1;nact>=i;i+=1)work[iwsv+iact[i]]=0;for(nvl=0,temp=0,i=1;q>=i;i+=1)work[iwsv+i]<temp*work[iwnbv+i]&&(nvl=i,temp=work[iwsv+i]/work[iwnbv+i]);return 0===nvl?999:0}function fn_goto_55(){for(i=1;n>=i;i+=1){for(sum=0,j=1;n>=j;j+=1)sum+=dmat[j][i]*amat[j][nvl];work[i]=sum}for(l1=iwzv,i=1;n>=i;i+=1)work[l1+i]=0;for(j=nact+1;n>=j;j+=1)for(i=1;n>=i;i+=1)work[l1+i]=work[l1+i]+dmat[i][j]*work[j];for(t1inf=!0,i=nact;i>=1;i-=1){for(sum=work[i],l=iwrm+i*(i+3)/2,l1=l-i,j=i+1;nact>=j;j+=1)sum-=work[l]*work[iwrv+j],l+=j;if(sum/=work[l1],work[iwrv+i]=sum,iact[i]<meq)break;if(0>sum)break;t1inf=!1,it1=i}if(!t1inf)for(t1=work[iwuv+it1]/work[iwrv+it1],i=1;nact>=i&&!(iact[i]<meq)&&!(work[iwrv+i]<0);i+=1)temp=work[iwuv+i]/work[iwrv+i],t1>temp&&(t1=temp,it1=i);for(sum=0,i=iwzv+1;iwzv+n>=i;i+=1)sum+=work[i]*work[i];if(Math.abs(sum)<=vsmall){if(t1inf)return ierr[1]=1,999;for(i=1;nact>=i;i+=1)work[iwuv+i]=work[iwuv+i]-t1*work[iwrv+i];return work[iwuv+nact+1]=work[iwuv+nact+1]+t1,700}for(sum=0,i=1;n>=i;i+=1)sum+=work[iwzv+i]*amat[i][nvl];for(tt=-work[iwsv+nvl]/sum,t2min=!0,t1inf||tt>t1&&(tt=t1,t2min=!1),i=1;n>=i;i+=1)sol[i]=sol[i]+tt*work[iwzv+i],Math.abs(sol[i])<vsmall&&(sol[i]=0);for(crval[1]=crval[1]+tt*sum*(tt/2+work[iwuv+nact+1]),i=1;nact>=i;i+=1)work[iwuv+i]=work[iwuv+i]-tt*work[iwrv+i];if(work[iwuv+nact+1]=work[iwuv+nact+1]+tt,!t2min){for(sum=-bvec[nvl],j=1;n>=j;j+=1)sum+=sol[j]*amat[j][nvl];if(nvl>meq)work[iwsv+nvl]=sum;else if(work[iwsv+nvl]=-Math.abs(sum),sum>0){for(j=1;n>=j;j+=1)amat[j][nvl]=-amat[j][nvl];bvec[nvl]=-bvec[nvl]}return 700}for(nact+=1,iact[nact]=nvl,l=iwrm+(nact-1)*nact/2+1,i=1;nact-1>=i;i+=1)work[l]=work[i],l+=1;if(nact===n)work[l]=work[n];else{for(i=n;i>=nact+1&&0!==work[i]&&(gc=Math.max(Math.abs(work[i-1]),Math.abs(work[i])),gs=Math.min(Math.abs(work[i-1]),Math.abs(work[i])),temp=work[i-1]>=0?Math.abs(gc*Math.sqrt(1+gs*gs/(gc*gc))):-Math.abs(gc*Math.sqrt(1+gs*gs/(gc*gc))),gc=work[i-1]/temp,gs=work[i]/temp,1!==gc);i-=1)if(0===gc)for(work[i-1]=gs*temp,j=1;n>=j;j+=1)temp=dmat[j][i-1],dmat[j][i-1]=dmat[j][i],dmat[j][i]=temp;else for(work[i-1]=temp,nu=gs/(1+gc),j=1;n>=j;j+=1)temp=gc*dmat[j][i-1]+gs*dmat[j][i],dmat[j][i]=nu*(dmat[j][i-1]+temp)-dmat[j][i],dmat[j][i-1]=temp;work[l]=work[nact]}return 0}function fn_goto_797(){if(l=iwrm+it1*(it1+1)/2+1,l1=l+it1,0===work[l1])return 798;if(gc=Math.max(Math.abs(work[l1-1]),Math.abs(work[l1])),gs=Math.min(Math.abs(work[l1-1]),Math.abs(work[l1])),temp=work[l1-1]>=0?Math.abs(gc*Math.sqrt(1+gs*gs/(gc*gc))):-Math.abs(gc*Math.sqrt(1+gs*gs/(gc*gc))),gc=work[l1-1]/temp,gs=work[l1]/temp,1===gc)return 798;if(0===gc){for(i=it1+1;nact>=i;i+=1)temp=work[l1-1],work[l1-1]=work[l1],work[l1]=temp,l1+=i;for(i=1;n>=i;i+=1)temp=dmat[i][it1],dmat[i][it1]=dmat[i][it1+1],dmat[i][it1+1]=temp}else{for(nu=gs/(1+gc),i=it1+1;nact>=i;i+=1)temp=gc*work[l1-1]+gs*work[l1],work[l1]=nu*(work[l1-1]+temp)-work[l1],work[l1-1]=temp,l1+=i;for(i=1;n>=i;i+=1)temp=gc*dmat[i][it1]+gs*dmat[i][it1+1],dmat[i][it1+1]=nu*(dmat[i][it1]+temp)-dmat[i][it1+1],dmat[i][it1]=temp}return 0}function fn_goto_798(){for(l1=l-it1,i=1;it1>=i;i+=1)work[l1]=work[l],l+=1,l1+=1;return work[iwuv+it1]=work[iwuv+it1+1],iact[it1]=iact[it1+1],it1+=1,nact>it1?797:0}function fn_goto_799(){return work[iwuv+nact]=work[iwuv+nact+1],work[iwuv+nact+1]=0,iact[nact]=0,nact-=1,iter[2]=iter[2]+1,0}var i,j,l,l1,info,it1,iwzv,iwrv,iwrm,iwsv,iwuv,nvl,r,iwnbv,temp,sum,t1,tt,gc,gs,nu,t1inf,t2min,vsmall,tmpa,tmpb,go;r=Math.min(n,q),l=2*n+r*(r+5)/2+2*q+1,vsmall=1e-60;do vsmall+=vsmall,tmpa=1+.1*vsmall,tmpb=1+.2*vsmall;while(1>=tmpa||1>=tmpb);for(i=1;n>=i;i+=1)work[i]=dvec[i];for(i=n+1;l>=i;i+=1)work[i]=0;for(i=1;q>=i;i+=1)iact[i]=0;if(info=[],0===ierr[1]){if(dpofa(dmat,fddmat,n,info),0!==info[1])return void(ierr[1]=2);dposl(dmat,fddmat,n,dvec),dpori(dmat,fddmat,n)}else{for(j=1;n>=j;j+=1)for(sol[j]=0,i=1;j>=i;i+=1)sol[j]=sol[j]+dmat[i][j]*dvec[i];for(j=1;n>=j;j+=1)for(dvec[j]=0,i=j;n>=i;i+=1)dvec[j]=dvec[j]+dmat[j][i]*sol[i]}for(crval[1]=0,j=1;n>=j;j+=1)for(sol[j]=dvec[j],crval[1]=crval[1]+work[j]*sol[j],work[j]=0,i=j+1;n>=i;i+=1)dmat[i][j]=0;for(crval[1]=-crval[1]/2,ierr[1]=0,iwzv=n,iwrv=iwzv+n,iwuv=iwrv+r,iwrm=iwuv+r+1,iwsv=iwrm+r*(r+1)/2,iwnbv=iwsv+q,i=1;q>=i;i+=1){for(sum=0,j=1;n>=j;j+=1)sum+=amat[j][i]*amat[j][i];work[iwnbv+i]=Math.sqrt(sum)}for(nact=0,iter[1]=0,iter[2]=0,go=0;;){if(go=fn_goto_50(),999===go)return;for(;;){if(go=fn_goto_55(),0===go)break;if(999===go)return;if(700===go)if(it1===nact)fn_goto_799();else{for(;;)if(fn_goto_797(),go=fn_goto_798(),797!==go)break;fn_goto_799()}}}}function solveQP(Dmat,dvec,Amat,bvec,meq,factorized){Dmat=base0to1(Dmat),dvec=base0to1(dvec),Amat=base0to1(Amat);var i,n,q,nact,r,message,crval=[],iact=[],sol=[],work=[],iter=[];if(meq=meq||0,factorized=factorized?base0to1(factorized):[void 0,0],bvec=bvec?base0to1(bvec):[],n=Dmat.length-1,q=Amat[1].length-1,!bvec)for(i=1;q>=i;i+=1)bvec[i]=0;
for(i=1;q>=i;i+=1)iact[i]=0;for(nact=0,r=Math.min(n,q),i=1;n>=i;i+=1)sol[i]=0;for(crval[1]=0,i=1;2*n+r*(r+5)/2+2*q+1>=i;i+=1)work[i]=0;for(i=1;2>=i;i+=1)iter[i]=0;return qpgen2(Dmat,dvec,n,n,sol,crval,Amat,bvec,n,q,meq,iact,nact,iter,work,factorized),message="",1===factorized[1]&&(message="constraints are inconsistent, no solution!"),2===factorized[1]&&(message="matrix D in quadratic function is not positive definite!"),{solution:base1to0(sol),value:base1to0(crval),unconstrained_solution:base1to0(dvec),iterations:base1to0(iter),iact:base1to0(iact),message:message}}exports.solveQP=solveQP}(numeric),numeric.svd=function(A){function pythag(a,b){return a=Math.abs(a),b=Math.abs(b),a>b?a*Math.sqrt(1+b*b/a/a):0==b?a:b*Math.sqrt(1+a*a/b/b)}var temp,prec=numeric.epsilon,tolerance=1e-64/prec,itmax=50,c=0,i=0,j=0,k=0,l=0,u=numeric.clone(A),m=u.length,n=u[0].length;if(n>m)throw"Need more rows than columns";var e=new Array(n),q=new Array(n);for(i=0;n>i;i++)e[i]=q[i]=0;var v=numeric.rep([n,n],0),f=0,g=0,h=0,x=0,y=0,z=0,s=0;for(i=0;n>i;i++){for(e[i]=g,s=0,l=i+1,j=i;m>j;j++)s+=u[j][i]*u[j][i];if(tolerance>=s)g=0;else for(f=u[i][i],g=Math.sqrt(s),f>=0&&(g=-g),h=f*g-s,u[i][i]=f-g,j=l;n>j;j++){for(s=0,k=i;m>k;k++)s+=u[k][i]*u[k][j];for(f=s/h,k=i;m>k;k++)u[k][j]+=f*u[k][i]}for(q[i]=g,s=0,j=l;n>j;j++)s+=u[i][j]*u[i][j];if(tolerance>=s)g=0;else{for(f=u[i][i+1],g=Math.sqrt(s),f>=0&&(g=-g),h=f*g-s,u[i][i+1]=f-g,j=l;n>j;j++)e[j]=u[i][j]/h;for(j=l;m>j;j++){for(s=0,k=l;n>k;k++)s+=u[j][k]*u[i][k];for(k=l;n>k;k++)u[j][k]+=s*e[k]}}y=Math.abs(q[i])+Math.abs(e[i]),y>x&&(x=y)}for(i=n-1;-1!=i;i+=-1){if(0!=g){for(h=g*u[i][i+1],j=l;n>j;j++)v[j][i]=u[i][j]/h;for(j=l;n>j;j++){for(s=0,k=l;n>k;k++)s+=u[i][k]*v[k][j];for(k=l;n>k;k++)v[k][j]+=s*v[k][i]}}for(j=l;n>j;j++)v[i][j]=0,v[j][i]=0;v[i][i]=1,g=e[i],l=i}for(i=n-1;-1!=i;i+=-1){for(l=i+1,g=q[i],j=l;n>j;j++)u[i][j]=0;if(0!=g){for(h=u[i][i]*g,j=l;n>j;j++){for(s=0,k=l;m>k;k++)s+=u[k][i]*u[k][j];for(f=s/h,k=i;m>k;k++)u[k][j]+=f*u[k][i]}for(j=i;m>j;j++)u[j][i]=u[j][i]/g}else for(j=i;m>j;j++)u[j][i]=0;u[i][i]+=1}for(prec*=x,k=n-1;-1!=k;k+=-1)for(var iteration=0;itmax>iteration;iteration++){var test_convergence=!1;for(l=k;-1!=l;l+=-1){if(Math.abs(e[l])<=prec){test_convergence=!0;break}if(Math.abs(q[l-1])<=prec)break}if(!test_convergence){c=0,s=1;var l1=l-1;for(i=l;k+1>i&&(f=s*e[i],e[i]=c*e[i],!(Math.abs(f)<=prec));i++)for(g=q[i],h=pythag(f,g),q[i]=h,c=g/h,s=-f/h,j=0;m>j;j++)y=u[j][l1],z=u[j][i],u[j][l1]=y*c+z*s,u[j][i]=-y*s+z*c}if(z=q[k],l==k){if(0>z)for(q[k]=-z,j=0;n>j;j++)v[j][k]=-v[j][k];break}if(iteration>=itmax-1)throw"Error: no convergence.";for(x=q[l],y=q[k-1],g=e[k-1],h=e[k],f=((y-z)*(y+z)+(g-h)*(g+h))/(2*h*y),g=pythag(f,1),f=0>f?((x-z)*(x+z)+h*(y/(f-g)-h))/x:((x-z)*(x+z)+h*(y/(f+g)-h))/x,c=1,s=1,i=l+1;k+1>i;i++){for(g=e[i],y=q[i],h=s*g,g=c*g,z=pythag(f,h),e[i-1]=z,c=f/z,s=h/z,f=x*c+g*s,g=-x*s+g*c,h=y*s,y*=c,j=0;n>j;j++)x=v[j][i-1],z=v[j][i],v[j][i-1]=x*c+z*s,v[j][i]=-x*s+z*c;for(z=pythag(f,h),q[i-1]=z,c=f/z,s=h/z,f=c*g+s*y,x=-s*g+c*y,j=0;m>j;j++)y=u[j][i-1],z=u[j][i],u[j][i-1]=y*c+z*s,u[j][i]=-y*s+z*c}e[l]=0,e[k]=f,q[k]=x}for(i=0;i<q.length;i++)q[i]<prec&&(q[i]=0);for(i=0;n>i;i++)for(j=i-1;j>=0;j--)if(q[j]<q[i]){for(c=q[j],q[j]=q[i],q[i]=c,k=0;k<u.length;k++)temp=u[k][i],u[k][i]=u[k][j],u[k][j]=temp;for(k=0;k<v.length;k++)temp=v[k][i],v[k][i]=v[k][j],v[k][j]=temp;i=j}return{U:u,S:q,V:v}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],19:[function(require,module,exports){(function(global){exports.Vector=require("./vector"),global.$V=exports.Vector.create,exports.Matrix=require("./matrix"),global.$M=exports.Matrix.create,exports.Line=require("./line"),global.$L=exports.Line.create,exports.Plane=require("./plane"),global.$P=exports.Plane.create,exports.Line.Segment=require("./line.segment"),exports.Sylvester=require("./sylvester")}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./line":20,"./line.segment":21,"./matrix":22,"./plane":23,"./sylvester":24,"./vector":25}],20:[function(require,module){function Line(){}var Vector=require("./vector"),Matrix=require("./matrix"),Plane=require("./plane"),Sylvester=require("./sylvester");Line.prototype={eql:function(line){return this.isParallelTo(line)&&this.contains(line.anchor)},dup:function(){return Line.create(this.anchor,this.direction)},translate:function(vector){var V=vector.elements||vector;return Line.create([this.anchor.elements[0]+V[0],this.anchor.elements[1]+V[1],this.anchor.elements[2]+(V[2]||0)],this.direction)},isParallelTo:function(obj){if(obj.normal||obj.start&&obj.end)return obj.isParallelTo(this);var theta=this.direction.angleFrom(obj.direction);return Math.abs(theta)<=Sylvester.precision||Math.abs(theta-Math.PI)<=Sylvester.precision},distanceFrom:function(obj){if(obj.normal||obj.start&&obj.end)return obj.distanceFrom(this);if(obj.direction){if(this.isParallelTo(obj))return this.distanceFrom(obj.anchor);var N=this.direction.cross(obj.direction).toUnitVector().elements,A=this.anchor.elements,B=obj.anchor.elements;return Math.abs((A[0]-B[0])*N[0]+(A[1]-B[1])*N[1]+(A[2]-B[2])*N[2])}var P=obj.elements||obj,A=this.anchor.elements,D=this.direction.elements,PA1=P[0]-A[0],PA2=P[1]-A[1],PA3=(P[2]||0)-A[2],modPA=Math.sqrt(PA1*PA1+PA2*PA2+PA3*PA3);if(0===modPA)return 0;var cosTheta=(PA1*D[0]+PA2*D[1]+PA3*D[2])/modPA,sin2=1-cosTheta*cosTheta;return Math.abs(modPA*Math.sqrt(0>sin2?0:sin2))},contains:function(obj){if(obj.start&&obj.end)return this.contains(obj.start)&&this.contains(obj.end);var dist=this.distanceFrom(obj);return null!==dist&&dist<=Sylvester.precision},positionOf:function(point){if(!this.contains(point))return null;var P=point.elements||point,A=this.anchor.elements,D=this.direction.elements;return(P[0]-A[0])*D[0]+(P[1]-A[1])*D[1]+((P[2]||0)-A[2])*D[2]},liesIn:function(plane){return plane.contains(this)},intersects:function(obj){return obj.normal?obj.intersects(this):!this.isParallelTo(obj)&&this.distanceFrom(obj)<=Sylvester.precision},intersectionWith:function(obj){if(obj.normal||obj.start&&obj.end)return obj.intersectionWith(this);if(!this.intersects(obj))return null;var P=this.anchor.elements,X=this.direction.elements,Q=obj.anchor.elements,Y=obj.direction.elements,X1=X[0],X2=X[1],X3=X[2],Y1=Y[0],Y2=Y[1],Y3=Y[2],PsubQ1=P[0]-Q[0],PsubQ2=P[1]-Q[1],PsubQ3=P[2]-Q[2],XdotQsubP=-X1*PsubQ1-X2*PsubQ2-X3*PsubQ3,YdotPsubQ=Y1*PsubQ1+Y2*PsubQ2+Y3*PsubQ3,XdotX=X1*X1+X2*X2+X3*X3,YdotY=Y1*Y1+Y2*Y2+Y3*Y3,XdotY=X1*Y1+X2*Y2+X3*Y3,k=(XdotQsubP*YdotY/XdotX+XdotY*YdotPsubQ)/(YdotY-XdotY*XdotY);return Vector.create([P[0]+k*X1,P[1]+k*X2,P[2]+k*X3])},pointClosestTo:function(obj){if(obj.start&&obj.end){var P=obj.pointClosestTo(this);return null===P?null:this.pointClosestTo(P)}if(obj.direction){if(this.intersects(obj))return this.intersectionWith(obj);if(this.isParallelTo(obj))return null;var D=this.direction.elements,E=obj.direction.elements,D1=D[0],D2=D[1],D3=D[2],E1=E[0],E2=E[1],E3=E[2],x=D3*E1-D1*E3,y=D1*E2-D2*E1,z=D2*E3-D3*E2,N=[x*E3-y*E2,y*E1-z*E3,z*E2-x*E1],P=Plane.create(obj.anchor,N);return P.intersectionWith(this)}var P=obj.elements||obj;if(this.contains(P))return Vector.create(P);var A=this.anchor.elements,D=this.direction.elements,D1=D[0],D2=D[1],D3=D[2],A1=A[0],A2=A[1],A3=A[2],x=D1*(P[1]-A2)-D2*(P[0]-A1),y=D2*((P[2]||0)-A3)-D3*(P[1]-A2),z=D3*(P[0]-A1)-D1*((P[2]||0)-A3),V=Vector.create([D2*x-D3*z,D3*y-D1*x,D1*z-D2*y]),k=this.distanceFrom(P)/V.modulus();return Vector.create([P[0]+V.elements[0]*k,P[1]+V.elements[1]*k,(P[2]||0)+V.elements[2]*k])},rotate:function(t,line){"undefined"==typeof line.direction&&(line=Line.create(line.to3D(),Vector.k));var R=Matrix.Rotation(t,line.direction).elements,C=line.pointClosestTo(this.anchor).elements,A=this.anchor.elements,D=this.direction.elements,C1=C[0],C2=C[1],C3=C[2],A1=A[0],A2=A[1],A3=A[2],x=A1-C1,y=A2-C2,z=A3-C3;return Line.create([C1+R[0][0]*x+R[0][1]*y+R[0][2]*z,C2+R[1][0]*x+R[1][1]*y+R[1][2]*z,C3+R[2][0]*x+R[2][1]*y+R[2][2]*z],[R[0][0]*D[0]+R[0][1]*D[1]+R[0][2]*D[2],R[1][0]*D[0]+R[1][1]*D[1]+R[1][2]*D[2],R[2][0]*D[0]+R[2][1]*D[1]+R[2][2]*D[2]])},reverse:function(){return Line.create(this.anchor,this.direction.x(-1))},reflectionIn:function(obj){if(obj.normal){var A=this.anchor.elements,D=this.direction.elements,A1=A[0],A2=A[1],A3=A[2],D1=D[0],D2=D[1],D3=D[2],newA=this.anchor.reflectionIn(obj).elements,AD1=A1+D1,AD2=A2+D2,AD3=A3+D3,Q=obj.pointClosestTo([AD1,AD2,AD3]).elements,newD=[Q[0]+(Q[0]-AD1)-newA[0],Q[1]+(Q[1]-AD2)-newA[1],Q[2]+(Q[2]-AD3)-newA[2]];return Line.create(newA,newD)}if(obj.direction)return this.rotate(Math.PI,obj);var P=obj.elements||obj;return Line.create(this.anchor.reflectionIn([P[0],P[1],P[2]||0]),this.direction)},setVectors:function(anchor,direction){if(anchor=Vector.create(anchor),direction=Vector.create(direction),2==anchor.elements.length&&anchor.elements.push(0),2==direction.elements.length&&direction.elements.push(0),anchor.elements.length>3||direction.elements.length>3)return null;var mod=direction.modulus();return 0===mod?null:(this.anchor=anchor,this.direction=Vector.create([direction.elements[0]/mod,direction.elements[1]/mod,direction.elements[2]/mod]),this)}},Line.create=function(anchor,direction){var L=new Line;return L.setVectors(anchor,direction)},Line.X=Line.create(Vector.Zero(3),Vector.i),Line.Y=Line.create(Vector.Zero(3),Vector.j),Line.Z=Line.create(Vector.Zero(3),Vector.k),module.exports=Line},{"./matrix":22,"./plane":23,"./sylvester":24,"./vector":25}],21:[function(require,module){var Line=require("./line"),Vector=require("./vector");Line.Segment=function(){},Line.Segment.prototype={eql:function(segment){return this.start.eql(segment.start)&&this.end.eql(segment.end)||this.start.eql(segment.end)&&this.end.eql(segment.start)},dup:function(){return Line.Segment.create(this.start,this.end)},length:function(){var A=this.start.elements,B=this.end.elements,C1=B[0]-A[0],C2=B[1]-A[1],C3=B[2]-A[2];return Math.sqrt(C1*C1+C2*C2+C3*C3)},toVector:function(){var A=this.start.elements,B=this.end.elements;return Vector.create([B[0]-A[0],B[1]-A[1],B[2]-A[2]])},midpoint:function(){var A=this.start.elements,B=this.end.elements;return Vector.create([(B[0]+A[0])/2,(B[1]+A[1])/2,(B[2]+A[2])/2])},bisectingPlane:function(){return Plane.create(this.midpoint(),this.toVector())},translate:function(vector){var V=vector.elements||vector,S=this.start.elements,E=this.end.elements;return Line.Segment.create([S[0]+V[0],S[1]+V[1],S[2]+(V[2]||0)],[E[0]+V[0],E[1]+V[1],E[2]+(V[2]||0)])},isParallelTo:function(obj){return this.line.isParallelTo(obj)},distanceFrom:function(obj){var P=this.pointClosestTo(obj);return null===P?null:P.distanceFrom(obj)},contains:function(obj){if(obj.start&&obj.end)return this.contains(obj.start)&&this.contains(obj.end);var P=(obj.elements||obj).slice();if(2==P.length&&P.push(0),this.start.eql(P))return!0;var S=this.start.elements,V=Vector.create([S[0]-P[0],S[1]-P[1],S[2]-(P[2]||0)]),vect=this.toVector();return V.isAntiparallelTo(vect)&&V.modulus()<=vect.modulus()},intersects:function(obj){return null!==this.intersectionWith(obj)},intersectionWith:function(obj){if(!this.line.intersects(obj))return null;var P=this.line.intersectionWith(obj);return this.contains(P)?P:null},pointClosestTo:function(obj){if(obj.normal){var V=this.line.intersectionWith(obj);return null===V?null:this.pointClosestTo(V)}var P=this.line.pointClosestTo(obj);return null===P?null:this.contains(P)?P:(this.line.positionOf(P)<0?this.start:this.end).dup()},setPoints:function(startPoint,endPoint){return startPoint=Vector.create(startPoint).to3D(),endPoint=Vector.create(endPoint).to3D(),null===startPoint||null===endPoint?null:(this.line=Line.create(startPoint,endPoint.subtract(startPoint)),this.start=startPoint,this.end=endPoint,this)}},Line.Segment.create=function(v1,v2){var S=new Line.Segment;return S.setPoints(v1,v2)},module.exports=Line.Segment},{"./line":20,"./vector":25}],22:[function(require,module){function identSize(M,m,n,k){for(var e=M.elements,i=k-1;i--;){for(var row=[],j=0;n>j;j++)row.push(j==i?1:0);e.unshift(row)}for(var i=k-1;m>i;i++)for(;e[i].length<n;)e[i].unshift(0);return $M(e)}function pca(X){var Sigma=X.transpose().x(X).x(1/X.rows()),svd=Sigma.svd();return{U:svd.U,S:svd.S}}function svdJs(){for(var A=this,V=Matrix.I(A.rows()),S=A.transpose(),U=Matrix.I(A.cols()),err=Number.MAX_VALUE,i=0,maxLoop=100;err>2.2737e-13&&maxLoop>i;){var qr=S.transpose().qrJs();S=qr.R,V=V.x(qr.Q),qr=S.transpose().qrJs(),U=U.x(qr.Q),S=qr.R;var e=S.triu(1).unroll().norm(),f=S.diagonal().norm();0==f&&(f=1),err=e/f,i++}for(var ss=S.diagonal(),s=[],i=1;i<=ss.cols();i++){var ssn=ss.e(i);if(s.push(Math.abs(ssn)),0>ssn)for(var j=0;j<U.rows();j++)V.elements[j][i-1]=-V.elements[j][i-1]}return{U:U,S:$V(s).toDiagonalMatrix(),V:V}}function svdPack(){var result=lapack.sgesvd("A","A",this.elements);return{U:$M(result.U),S:$M(result.S).column(1).toDiagonalMatrix(),V:$M(result.VT).transpose()}}function qrJs(){for(var m=this.rows(),n=this.cols(),Q=Matrix.I(m),A=this,k=1;k<Math.min(m,n);k++){for(var ak=A.slice(k,0,k,k).col(1),oneZero=[1];oneZero.length<=m-k;)oneZero.push(0);oneZero=$V(oneZero);var vk=ak.add(oneZero.x(ak.norm()*Math.sign(ak.e(1)))),Vk=$M(vk),Hk=Matrix.I(m-k+1).subtract(Vk.x(2).x(Vk.transpose()).div(Vk.transpose().x(Vk).e(1,1))),Qk=identSize(Hk,m,n,k);A=Qk.x(A),Q=Q.x(Qk)}return{Q:Q,R:A}}function qrPack(){var qr=lapack.qr(this.elements);return{Q:$M(qr.Q),R:$M(qr.R)}}function Matrix(){}function luPack(){var lu=lapack.lu(this.elements);return{L:$M(lu.L),U:$M(lu.U),P:$M(lu.P)}}function luJs(){for(var A=this.dup(),L=Matrix.I(A.rows()),P=Matrix.I(A.rows()),U=Matrix.Zeros(A.rows(),A.cols()),p=1,k=1;k<=Math.min(A.cols(),A.rows());k++){P=A.partialPivot(k,p,P,A,L);for(var i=k+1;i<=A.rows();i++){var l=A.e(i,p)/A.e(k,p);L.elements[i-1][k-1]=l;for(var j=k+1;j<=A.cols();j++)A.elements[i-1][j-1]-=A.e(k,j)*l}for(var j=k;j<=A.cols();j++)U.elements[k-1][j-1]=A.e(k,j);p<A.cols()&&p++}return{L:L,U:U,P:P}}function getLapack(){try{return require("lapack")}catch(e){}}{var fs=require("fs"),Sylvester=require("./sylvester");require("./vector")}Matrix.prototype={solve:function(b){var lu=this.lu();b=lu.P.x(b);var y=lu.L.forwardSubstitute(b),x=lu.U.backSubstitute(y);return lu.P.x(x)},pcaProject:function(k,U){var U=U||pca(this).U,Ureduce=U.slice(1,U.rows(),1,k);return{Z:this.x(Ureduce),U:U}},pcaRecover:function(U){var k=this.cols(),Ureduce=U.slice(1,U.rows(),1,k);return this.x(Ureduce.transpose())},triu:function(k){return k||(k=0),this.map(function(x,i,j){return j-i>=k?x:0})},unroll:function(){for(var v=[],i=1;i<=this.cols();i++)for(var j=1;j<=this.rows();j++)v.push(this.e(j,i));return $V(v)},slice:function(startRow,endRow,startCol,endCol){var x=[];for(0==endRow&&(endRow=this.rows()),0==endCol&&(endCol=this.cols()),i=startRow;endRow>=i;i++){var row=[];for(j=startCol;endCol>=j;j++)row.push(this.e(i,j));x.push(row)}return $M(x)},e:function(i,j){return 1>i||i>this.elements.length||1>j||j>this.elements[0].length?null:this.elements[i-1][j-1]},row:function(i){return i>this.elements.length?null:$V(this.elements[i-1])},col:function(j){if(j>this.elements[0].length)return null;for(var col=[],n=this.elements.length,i=0;n>i;i++)col.push(this.elements[i][j-1]);return $V(col)},dimensions:function(){return{rows:this.elements.length,cols:this.elements[0].length}},rows:function(){return this.elements.length},cols:function(){return this.elements[0].length},approxEql:function(matrix){return this.eql(matrix,Sylvester.approxPrecision)},eql:function(matrix,precision){var M=matrix.elements||matrix;if("undefined"==typeof M[0][0]&&(M=Matrix.create(M).elements),this.elements.length!=M.length||this.elements[0].length!=M[0].length)return!1;for(var j,i=this.elements.length,nj=this.elements[0].length;i--;)for(j=nj;j--;)if(Math.abs(this.elements[i][j]-M[i][j])>(precision||Sylvester.precision))return!1;return!0},dup:function(){return Matrix.create(this.elements)},map:function(fn){for(var j,els=[],i=this.elements.length,nj=this.elements[0].length;i--;)for(j=nj,els[i]=[];j--;)els[i][j]=fn(this.elements[i][j],i+1,j+1);return Matrix.create(els)},isSameSizeAs:function(matrix){var M=matrix.elements||matrix;return"undefined"==typeof M[0][0]&&(M=Matrix.create(M).elements),this.elements.length==M.length&&this.elements[0].length==M[0].length},add:function(matrix){if("number"==typeof matrix)return this.map(function(x){return x+matrix});var M=matrix.elements||matrix;return"undefined"==typeof M[0][0]&&(M=Matrix.create(M).elements),this.isSameSizeAs(M)?this.map(function(x,i,j){return x+M[i-1][j-1]}):null},subtract:function(matrix){if("number"==typeof matrix)return this.map(function(x){return x-matrix});var M=matrix.elements||matrix;return"undefined"==typeof M[0][0]&&(M=Matrix.create(M).elements),this.isSameSizeAs(M)?this.map(function(x,i,j){return x-M[i-1][j-1]}):null},canMultiplyFromLeft:function(matrix){var M=matrix.elements||matrix;return"undefined"==typeof M[0][0]&&(M=Matrix.create(M).elements),this.elements[0].length==M.length},mulOp:function(matrix,op){if(!matrix.elements)return this.map(function(x){return op(x,matrix)});var returnVector=matrix.modulus?!0:!1,M=matrix.elements||matrix;if("undefined"==typeof M[0][0]&&(M=Matrix.create(M).elements),!this.canMultiplyFromLeft(M))return null;for(var rowThis,rowElem,sum,j,k,e=this.elements,elements=[],m=e.length,n=M[0].length,o=e[0].length,i=m;i--;){for(rowElem=[],rowThis=e[i],j=n;j--;){for(sum=0,k=o;k--;)sum+=op(rowThis[k],M[k][j]);rowElem[j]=sum}elements[i]=rowElem}var M=Matrix.create(elements);return returnVector?M.col(1):M},div:function(matrix){return this.mulOp(matrix,function(x,y){return x/y})},multiply:function(matrix){return this.mulOp(matrix,function(x,y){return x*y})},x:function(matrix){return this.multiply(matrix)},elementMultiply:function(v){return this.map(function(k,i,j){return v.e(i,j)*k})},sum:function(){var sum=0;return this.map(function(x){sum+=x}),sum},mean:function(){for(var dim=this.dimensions(),r=[],i=1;i<=dim.cols;i++)r.push(this.col(i).sum()/dim.rows);return $V(r)},column:function(n){return this.col(n)},log:function(){return this.map(function(x){return Math.log(x)})},minor:function(a,b,c,d){for(var i,nj,j,elements=[],ni=c,rows=this.elements.length,cols=this.elements[0].length;ni--;)for(i=c-ni-1,elements[i]=[],nj=d;nj--;)j=d-nj-1,elements[i][j]=this.elements[(a+i-1)%rows][(b+j-1)%cols];return Matrix.create(elements)},transpose:function(){for(var i,j,rows=this.elements.length,cols=this.elements[0].length,elements=[],i=cols;i--;)for(j=rows,elements[i]=[];j--;)elements[i][j]=this.elements[j][i];return Matrix.create(elements)},isSquare:function(){return this.elements.length==this.elements[0].length},max:function(){for(var j,m=0,i=this.elements.length,nj=this.elements[0].length;i--;)for(j=nj;j--;)Math.abs(this.elements[i][j])>Math.abs(m)&&(m=this.elements[i][j]);return m},indexOf:function(x){var i,j,ni=this.elements.length,nj=this.elements[0].length;for(i=0;ni>i;i++)for(j=0;nj>j;j++)if(this.elements[i][j]==x)return{i:i+1,j:j+1};return null},diagonal:function(){if(!this.isSquare)return null;for(var els=[],n=this.elements.length,i=0;n>i;i++)els.push(this.elements[i][i]);return $V(els)},toRightTriangular:function(){var els,i,j,p,M=this.dup(),n=this.elements.length,np=this.elements[0].length;for(i=0;n>i;i++){if(0==M.elements[i][i])for(j=i+1;n>j;j++)if(0!=M.elements[j][i]){for(els=[],p=0;np>p;p++)els.push(M.elements[i][p]+M.elements[j][p]);M.elements[i]=els;break}if(0!=M.elements[i][i])for(j=i+1;n>j;j++){var multiplier=M.elements[j][i]/M.elements[i][i];for(els=[],p=0;np>p;p++)els.push(i>=p?0:M.elements[j][p]-M.elements[i][p]*multiplier);M.elements[j]=els}}return M},toUpperTriangular:function(){return this.toRightTriangular()},determinant:function(){if(!this.isSquare())return null;if(1==this.cols&&1==this.rows)return this.row(1);if(0==this.cols&&0==this.rows)return 1;for(var M=this.toRightTriangular(),det=M.elements[0][0],n=M.elements.length,i=1;n>i;i++)det*=M.elements[i][i];return det},det:function(){return this.determinant()},isSingular:function(){return this.isSquare()&&0===this.determinant()},trace:function(){if(!this.isSquare())return null;for(var tr=this.elements[0][0],n=this.elements.length,i=1;n>i;i++)tr+=this.elements[i][i];return tr},tr:function(){return this.trace()},rank:function(){for(var j,M=this.toRightTriangular(),rank=0,i=this.elements.length,nj=this.elements[0].length;i--;)for(j=nj;j--;)if(Math.abs(M.elements[i][j])>Sylvester.precision){rank++;break}return rank},rk:function(){return this.rank()},augment:function(matrix){var M=matrix.elements||matrix;"undefined"==typeof M[0][0]&&(M=Matrix.create(M).elements);var j,T=this.dup(),cols=T.elements[0].length,i=T.elements.length,nj=M[0].length;if(i!=M.length)return null;for(;i--;)for(j=nj;j--;)T.elements[i][cols+j]=M[i][j];return T},inverse:function(){if(!this.isSquare()||this.isSingular())return null;for(var j,p,els,divisor,new_element,n=this.elements.length,i=n,M=this.augment(Matrix.I(n)).toRightTriangular(),np=M.elements[0].length,inverse_elements=[];i--;){for(els=[],inverse_elements[i]=[],divisor=M.elements[i][i],p=0;np>p;p++)new_element=M.elements[i][p]/divisor,els.push(new_element),p>=n&&inverse_elements[i].push(new_element);for(M.elements[i]=els,j=i;j--;){for(els=[],p=0;np>p;p++)els.push(M.elements[j][p]-M.elements[i][p]*M.elements[j][i]);M.elements[j]=els}}return Matrix.create(inverse_elements)},inv:function(){return this.inverse()},round:function(){return this.map(function(x){return Math.round(x)})},snapTo:function(x){return this.map(function(p){return Math.abs(p-x)<=Sylvester.precision?x:p})},inspect:function(){for(var matrix_rows=[],n=this.elements.length,i=0;n>i;i++)matrix_rows.push($V(this.elements[i]).inspect());return matrix_rows.join("\n")},toArray:function(){for(var matrix_rows=[],n=this.elements.length,i=0;n>i;i++)matrix_rows.push(this.elements[i]);return matrix_rows},setElements:function(els){var i,j,elements=els.elements||els;if("undefined"!=typeof elements[0][0]){for(i=elements.length,this.elements=[];i--;)for(j=elements[i].length,this.elements[i]=[];j--;)this.elements[i][j]=elements[i][j];return this}var n=elements.length;for(this.elements=[],i=0;n>i;i++)this.elements.push([elements[i]]);return this},maxColumnIndexes:function(){for(var maxes=[],i=1;i<=this.rows();i++){for(var max=null,maxIndex=-1,j=1;j<=this.cols();j++)(null===max||this.e(i,j)>max)&&(max=this.e(i,j),maxIndex=j);maxes.push(maxIndex)}return $V(maxes)},maxColumns:function(){for(var maxes=[],i=1;i<=this.rows();i++){for(var max=null,j=1;j<=this.cols();j++)(null===max||this.e(i,j)>max)&&(max=this.e(i,j));maxes.push(max)}return $V(maxes)},minColumnIndexes:function(){for(var mins=[],i=1;i<=this.rows();i++){for(var min=null,minIndex=-1,j=1;j<=this.cols();j++)(null===min||this.e(i,j)<min)&&(min=this.e(i,j),minIndex=j);mins.push(minIndex)}return $V(mins)},minColumns:function(){for(var mins=[],i=1;i<=this.rows();i++){for(var min=null,j=1;j<=this.cols();j++)(null===min||this.e(i,j)<min)&&(min=this.e(i,j));mins.push(min)}return $V(mins)},partialPivot:function(k,j,P,A){for(var maxIndex=0,maxValue=0,i=k;i<=A.rows();i++)Math.abs(A.e(i,j))>maxValue&&(maxValue=Math.abs(A.e(k,j)),maxIndex=i);if(maxIndex!=k){var tmp=A.elements[k-1];A.elements[k-1]=A.elements[maxIndex-1],A.elements[maxIndex-1]=tmp,P.elements[k-1][k-1]=0,P.elements[k-1][maxIndex-1]=1,P.elements[maxIndex-1][maxIndex-1]=0,P.elements[maxIndex-1][k-1]=1}return P},forwardSubstitute:function(b){for(var xa=[],i=1;i<=this.rows();i++){for(var w=0,j=1;i>j;j++)w+=this.e(i,j)*xa[j-1];xa.push((b.e(i)-w)/this.e(i,i))}return $V(xa)},backSubstitute:function(b){for(var xa=[],i=this.rows();i>0;i--){for(var w=0,j=this.cols();j>i;j--)w+=this.e(i,j)*xa[this.rows()-j];xa.push((b.e(i)-w)/this.e(i,i))}return $V(xa.reverse())},luPack:luPack,luJs:luJs,svdJs:svdJs,svdPack:svdPack,qrJs:qrJs,qrPack:qrPack};var lapack;(lapack=getLapack())?(Matrix.prototype.svd=svdPack,Matrix.prototype.qr=qrPack,Matrix.prototype.lu=luPack):(Matrix.prototype.svd=svdJs,Matrix.prototype.qr=qrJs,Matrix.prototype.lu=luJs),Matrix.create=function(aElements){var M=(new Matrix).setElements(aElements);return M},Matrix.I=function(n){for(var j,els=[],i=n;i--;)for(j=n,els[i]=[];j--;)els[i][j]=i==j?1:0;return Matrix.create(els)},Matrix.loadFile=function(file){for(var contents=fs.readFileSync(file,"utf-8"),matrix=[],rowArray=contents.split("\n"),i=0;i<rowArray.length;i++){var d=rowArray[i].split(",");d.length>1&&matrix.push(d)}var M=new Matrix;return M.setElements(matrix)},Matrix.Diagonal=function(elements){for(var i=elements.length,M=Matrix.I(i);i--;)M.elements[i][i]=elements[i];return M},Matrix.Rotation=function(theta,a){if(!a)return Matrix.create([[Math.cos(theta),-Math.sin(theta)],[Math.sin(theta),Math.cos(theta)]]);var axis=a.dup();if(3!=axis.elements.length)return null;var mod=axis.modulus(),x=axis.elements[0]/mod,y=axis.elements[1]/mod,z=axis.elements[2]/mod,s=Math.sin(theta),c=Math.cos(theta),t=1-c;return Matrix.create([[t*x*x+c,t*x*y-s*z,t*x*z+s*y],[t*x*y+s*z,t*y*y+c,t*y*z-s*x],[t*x*z-s*y,t*y*z+s*x,t*z*z+c]])},Matrix.RotationX=function(t){var c=Math.cos(t),s=Math.sin(t);return Matrix.create([[1,0,0],[0,c,-s],[0,s,c]])},Matrix.RotationY=function(t){var c=Math.cos(t),s=Math.sin(t);return Matrix.create([[c,0,s],[0,1,0],[-s,0,c]])},Matrix.RotationZ=function(t){var c=Math.cos(t),s=Math.sin(t);return Matrix.create([[c,-s,0],[s,c,0],[0,0,1]])},Matrix.Random=function(n,m){return 1===arguments.length&&(m=n),Matrix.Zero(n,m).map(function(){return Math.random()})},Matrix.Fill=function(n,m,v){2===arguments.length&&(v=m,m=n);for(var j,els=[],i=n;i--;)for(j=m,els[i]=[];j--;)els[i][j]=v;return Matrix.create(els)},Matrix.Zero=function(n,m){return Matrix.Fill(n,m,0)},Matrix.Zeros=function(n,m){return Matrix.Zero(n,m)},Matrix.One=function(n,m){return Matrix.Fill(n,m,1)},Matrix.Ones=function(n,m){return Matrix.One(n,m)},module.exports=Matrix},{"./sylvester":24,"./vector":25,fs:5,lapack:100}],23:[function(require,module){function Plane(){}var Vector=require("./vector"),Matrix=require("./matrix"),Line=require("./line"),Sylvester=require("./sylvester");Plane.prototype={eql:function(plane){return this.contains(plane.anchor)&&this.isParallelTo(plane)},dup:function(){return Plane.create(this.anchor,this.normal)},translate:function(vector){var V=vector.elements||vector;return Plane.create([this.anchor.elements[0]+V[0],this.anchor.elements[1]+V[1],this.anchor.elements[2]+(V[2]||0)],this.normal)},isParallelTo:function(obj){var theta;return obj.normal?(theta=this.normal.angleFrom(obj.normal),Math.abs(theta)<=Sylvester.precision||Math.abs(Math.PI-theta)<=Sylvester.precision):obj.direction?this.normal.isPerpendicularTo(obj.direction):null},isPerpendicularTo:function(plane){var theta=this.normal.angleFrom(plane.normal);return Math.abs(Math.PI/2-theta)<=Sylvester.precision},distanceFrom:function(obj){if(this.intersects(obj)||this.contains(obj))return 0;if(obj.anchor){var A=this.anchor.elements,B=obj.anchor.elements,N=this.normal.elements;return Math.abs((A[0]-B[0])*N[0]+(A[1]-B[1])*N[1]+(A[2]-B[2])*N[2])}var P=obj.elements||obj,A=this.anchor.elements,N=this.normal.elements;return Math.abs((A[0]-P[0])*N[0]+(A[1]-P[1])*N[1]+(A[2]-(P[2]||0))*N[2])},contains:function(obj){if(obj.normal)return null;if(obj.direction)return this.contains(obj.anchor)&&this.contains(obj.anchor.add(obj.direction));var P=obj.elements||obj,A=this.anchor.elements,N=this.normal.elements,diff=Math.abs(N[0]*(A[0]-P[0])+N[1]*(A[1]-P[1])+N[2]*(A[2]-(P[2]||0)));return diff<=Sylvester.precision},intersects:function(obj){return"undefined"==typeof obj.direction&&"undefined"==typeof obj.normal?null:!this.isParallelTo(obj)},intersectionWith:function(obj){if(!this.intersects(obj))return null;if(obj.direction){var A=obj.anchor.elements,D=obj.direction.elements,P=this.anchor.elements,N=this.normal.elements,multiplier=(N[0]*(P[0]-A[0])+N[1]*(P[1]-A[1])+N[2]*(P[2]-A[2]))/(N[0]*D[0]+N[1]*D[1]+N[2]*D[2]);return Vector.create([A[0]+D[0]*multiplier,A[1]+D[1]*multiplier,A[2]+D[2]*multiplier])}if(obj.normal){for(var direction=this.normal.cross(obj.normal).toUnitVector(),N=this.normal.elements,A=this.anchor.elements,O=obj.normal.elements,B=obj.anchor.elements,solver=Matrix.Zero(2,2),i=0;solver.isSingular();)i++,solver=Matrix.create([[N[i%3],N[(i+1)%3]],[O[i%3],O[(i+1)%3]]]);for(var inverse=solver.inverse().elements,x=N[0]*A[0]+N[1]*A[1]+N[2]*A[2],y=O[0]*B[0]+O[1]*B[1]+O[2]*B[2],intersection=[inverse[0][0]*x+inverse[0][1]*y,inverse[1][0]*x+inverse[1][1]*y],anchor=[],j=1;3>=j;j++)anchor.push(i==j?0:intersection[(j+(5-i)%3)%3]);return Line.create(anchor,direction)}},pointClosestTo:function(point){var P=point.elements||point,A=this.anchor.elements,N=this.normal.elements,dot=(A[0]-P[0])*N[0]+(A[1]-P[1])*N[1]+(A[2]-(P[2]||0))*N[2];return Vector.create([P[0]+N[0]*dot,P[1]+N[1]*dot,(P[2]||0)+N[2]*dot])},rotate:function(t,line){var R=t.determinant?t.elements:Matrix.Rotation(t,line.direction).elements,C=line.pointClosestTo(this.anchor).elements,A=this.anchor.elements,N=this.normal.elements,C1=C[0],C2=C[1],C3=C[2],A1=A[0],A2=A[1],A3=A[2],x=A1-C1,y=A2-C2,z=A3-C3;return Plane.create([C1+R[0][0]*x+R[0][1]*y+R[0][2]*z,C2+R[1][0]*x+R[1][1]*y+R[1][2]*z,C3+R[2][0]*x+R[2][1]*y+R[2][2]*z],[R[0][0]*N[0]+R[0][1]*N[1]+R[0][2]*N[2],R[1][0]*N[0]+R[1][1]*N[1]+R[1][2]*N[2],R[2][0]*N[0]+R[2][1]*N[1]+R[2][2]*N[2]])},reflectionIn:function(obj){if(obj.normal){var A=this.anchor.elements,N=this.normal.elements,A1=A[0],A2=A[1],A3=A[2],N1=N[0],N2=N[1],N3=N[2],newA=this.anchor.reflectionIn(obj).elements,AN1=A1+N1,AN2=A2+N2,AN3=A3+N3,Q=obj.pointClosestTo([AN1,AN2,AN3]).elements,newN=[Q[0]+(Q[0]-AN1)-newA[0],Q[1]+(Q[1]-AN2)-newA[1],Q[2]+(Q[2]-AN3)-newA[2]];return Plane.create(newA,newN)}if(obj.direction)return this.rotate(Math.PI,obj);var P=obj.elements||obj;return Plane.create(this.anchor.reflectionIn([P[0],P[1],P[2]||0]),this.normal)},setVectors:function(anchor,v1,v2){if(anchor=Vector.create(anchor),anchor=anchor.to3D(),null===anchor)return null;if(v1=Vector.create(v1),v1=v1.to3D(),null===v1)return null;if("undefined"==typeof v2)v2=null;else if(v2=Vector.create(v2),v2=v2.to3D(),null===v2)return null;var normal,mod,A1=anchor.elements[0],A2=anchor.elements[1],A3=anchor.elements[2],v11=v1.elements[0],v12=v1.elements[1],v13=v1.elements[2];if(null!==v2){var v21=v2.elements[0],v22=v2.elements[1],v23=v2.elements[2];if(normal=Vector.create([(v12-A2)*(v23-A3)-(v13-A3)*(v22-A2),(v13-A3)*(v21-A1)-(v11-A1)*(v23-A3),(v11-A1)*(v22-A2)-(v12-A2)*(v21-A1)]),mod=normal.modulus(),0===mod)return null;normal=Vector.create([normal.elements[0]/mod,normal.elements[1]/mod,normal.elements[2]/mod])}else{if(mod=Math.sqrt(v11*v11+v12*v12+v13*v13),0===mod)return null;normal=Vector.create([v1.elements[0]/mod,v1.elements[1]/mod,v1.elements[2]/mod])}return this.anchor=anchor,this.normal=normal,this}},Plane.create=function(anchor,v1,v2){var P=new Plane;return P.setVectors(anchor,v1,v2)},Plane.XY=Plane.create(Vector.Zero(3),Vector.k),Plane.YZ=Plane.create(Vector.Zero(3),Vector.i),Plane.ZX=Plane.create(Vector.Zero(3),Vector.j),Plane.YX=Plane.XY,Plane.ZY=Plane.YZ,Plane.XZ=Plane.ZX,Plane.fromPoints=function(points){var i,P,n,N,A,B,C,D,theta,prevN,np=points.length,list=[],totalN=Vector.Zero(3);for(i=0;np>i;i++){if(P=Vector.create(points[i]).to3D(),null===P)return null;if(list.push(P),n=list.length,n>2){if(A=list[n-1].elements,B=list[n-2].elements,C=list[n-3].elements,N=Vector.create([(A[1]-B[1])*(C[2]-B[2])-(A[2]-B[2])*(C[1]-B[1]),(A[2]-B[2])*(C[0]-B[0])-(A[0]-B[0])*(C[2]-B[2]),(A[0]-B[0])*(C[1]-B[1])-(A[1]-B[1])*(C[0]-B[0])]).toUnitVector(),n>3&&(theta=N.angleFrom(prevN),null!==theta&&!(Math.abs(theta)<=Sylvester.precision||Math.abs(theta-Math.PI)<=Sylvester.precision)))return null;totalN=totalN.add(N),prevN=N}}return A=list[1].elements,B=list[0].elements,C=list[n-1].elements,D=list[n-2].elements,totalN=totalN.add(Vector.create([(A[1]-B[1])*(C[2]-B[2])-(A[2]-B[2])*(C[1]-B[1]),(A[2]-B[2])*(C[0]-B[0])-(A[0]-B[0])*(C[2]-B[2]),(A[0]-B[0])*(C[1]-B[1])-(A[1]-B[1])*(C[0]-B[0])]).toUnitVector()).add(Vector.create([(B[1]-C[1])*(D[2]-C[2])-(B[2]-C[2])*(D[1]-C[1]),(B[2]-C[2])*(D[0]-C[0])-(B[0]-C[0])*(D[2]-C[2]),(B[0]-C[0])*(D[1]-C[1])-(B[1]-C[1])*(D[0]-C[0])]).toUnitVector()),Plane.create(list[0],totalN)
},module.exports=Plane},{"./line":20,"./matrix":22,"./sylvester":24,"./vector":25}],24:[function(require,module){Math.sign=function(x){return 0>x?-1:1};var Sylvester={precision:1e-6,approxPrecision:1e-5};module.exports=Sylvester},{}],25:[function(require,module){function Vector(){}var Sylvester=require("./sylvester"),Matrix=require("./matrix");Vector.prototype={norm:function(){for(var n=this.elements.length,sum=0;n--;)sum+=Math.pow(this.elements[n],2);return Math.sqrt(sum)},e:function(i){return 1>i||i>this.elements.length?null:this.elements[i-1]},dimensions:function(){return{rows:1,cols:this.elements.length}},rows:function(){return 1},cols:function(){return this.elements.length},modulus:function(){return Math.sqrt(this.dot(this))},eql:function(vector){var n=this.elements.length,V=vector.elements||vector;if(n!=V.length)return!1;for(;n--;)if(Math.abs(this.elements[n]-V[n])>Sylvester.precision)return!1;return!0},dup:function(){return Vector.create(this.elements)},map:function(fn){var elements=[];return this.each(function(x,i){elements.push(fn(x,i))}),Vector.create(elements)},each:function(fn){for(var n=this.elements.length,i=0;n>i;i++)fn(this.elements[i],i+1)},toUnitVector:function(){var r=this.modulus();return 0===r?this.dup():this.map(function(x){return x/r})},angleFrom:function(vector){var V=vector.elements||vector,n=this.elements.length;if(n!=V.length)return null;var dot=0,mod1=0,mod2=0;if(this.each(function(x,i){dot+=x*V[i-1],mod1+=x*x,mod2+=V[i-1]*V[i-1]}),mod1=Math.sqrt(mod1),mod2=Math.sqrt(mod2),mod1*mod2===0)return null;var theta=dot/(mod1*mod2);return-1>theta&&(theta=-1),theta>1&&(theta=1),Math.acos(theta)},isParallelTo:function(vector){var angle=this.angleFrom(vector);return null===angle?null:angle<=Sylvester.precision},isAntiparallelTo:function(vector){var angle=this.angleFrom(vector);return null===angle?null:Math.abs(angle-Math.PI)<=Sylvester.precision},isPerpendicularTo:function(vector){var dot=this.dot(vector);return null===dot?null:Math.abs(dot)<=Sylvester.precision},add:function(value){var V=value.elements||value;return this.map(this.elements.length!=V.length?function(v){return v+value}:function(x,i){return x+V[i-1]})},subtract:function(v){if("number"==typeof v)return this.map(function(k){return k-v});var V=v.elements||v;return this.elements.length!=V.length?null:this.map(function(x,i){return x-V[i-1]})},multiply:function(k){return this.map(function(x){return x*k})},elementMultiply:function(v){return this.map(function(k,i){return v.e(i)*k})},sum:function(){var sum=0;return this.map(function(x){sum+=x}),sum},chomp:function(n){for(var elements=[],i=n;i<this.elements.length;i++)elements.push(this.elements[i]);return Vector.create(elements)},top:function(n){for(var elements=[],i=0;n>i;i++)elements.push(this.elements[i]);return Vector.create(elements)},augment:function(elements){for(var newElements=this.elements,i=0;i<elements.length;i++)newElements.push(elements[i]);return Vector.create(newElements)},x:function(k){return this.multiply(k)},log:function(){return Vector.log(this)},elementDivide:function(vector){return this.map(function(v,i){return v/vector.e(i)})},product:function(){var p=1;return this.map(function(v){p*=v}),p},dot:function(vector){var V=vector.elements||vector,product=0,n=this.elements.length;if(n!=V.length)return null;for(;n--;)product+=this.elements[n]*V[n];return product},cross:function(vector){var B=vector.elements||vector;if(3!=this.elements.length||3!=B.length)return null;var A=this.elements;return Vector.create([A[1]*B[2]-A[2]*B[1],A[2]*B[0]-A[0]*B[2],A[0]*B[1]-A[1]*B[0]])},max:function(){for(var m=0,i=this.elements.length;i--;)Math.abs(this.elements[i])>Math.abs(m)&&(m=this.elements[i]);return m},maxIndex:function(){for(var m=0,i=this.elements.length,maxIndex=-1;i--;)Math.abs(this.elements[i])>Math.abs(m)&&(m=this.elements[i],maxIndex=i+1);return maxIndex},indexOf:function(x){for(var index=null,n=this.elements.length,i=0;n>i;i++)null===index&&this.elements[i]==x&&(index=i+1);return index},toDiagonalMatrix:function(){return Matrix.Diagonal(this.elements)},round:function(){return this.map(function(x){return Math.round(x)})},transpose:function(){for(var rows=this.elements.length,elements=[],i=0;rows>i;i++)elements.push([this.elements[i]]);return Matrix.create(elements)},snapTo:function(x){return this.map(function(y){return Math.abs(y-x)<=Sylvester.precision?x:y})},distanceFrom:function(obj){if(obj.anchor||obj.start&&obj.end)return obj.distanceFrom(this);var V=obj.elements||obj;if(V.length!=this.elements.length)return null;var part,sum=0;return this.each(function(x,i){part=x-V[i-1],sum+=part*part}),Math.sqrt(sum)},liesOn:function(line){return line.contains(this)},liesIn:function(plane){return plane.contains(this)},rotate:function(t,obj){var V,x,y,z,R=null;switch(t.determinant&&(R=t.elements),this.elements.length){case 2:return V=obj.elements||obj,2!=V.length?null:(R||(R=Matrix.Rotation(t).elements),x=this.elements[0]-V[0],y=this.elements[1]-V[1],Vector.create([V[0]+R[0][0]*x+R[0][1]*y,V[1]+R[1][0]*x+R[1][1]*y]));case 3:if(!obj.direction)return null;var C=obj.pointClosestTo(this).elements;return R||(R=Matrix.Rotation(t,obj.direction).elements),x=this.elements[0]-C[0],y=this.elements[1]-C[1],z=this.elements[2]-C[2],Vector.create([C[0]+R[0][0]*x+R[0][1]*y+R[0][2]*z,C[1]+R[1][0]*x+R[1][1]*y+R[1][2]*z,C[2]+R[2][0]*x+R[2][1]*y+R[2][2]*z]);default:return null}},reflectionIn:function(obj){if(obj.anchor){var P=this.elements.slice(),C=obj.pointClosestTo(P).elements;return Vector.create([C[0]+(C[0]-P[0]),C[1]+(C[1]-P[1]),C[2]+(C[2]-(P[2]||0))])}var Q=obj.elements||obj;return this.elements.length!=Q.length?null:this.map(function(x,i){return Q[i-1]+(Q[i-1]-x)})},to3D:function(){var V=this.dup();switch(V.elements.length){case 3:break;case 2:V.elements.push(0);break;default:return null}return V},inspect:function(){return"["+this.elements.join(", ")+"]"},setElements:function(els){return this.elements=(els.elements||els).slice(),this}},Vector.create=function(elements){var V=new Vector;return V.setElements(elements)},Vector.i=Vector.create([1,0,0]),Vector.j=Vector.create([0,1,0]),Vector.k=Vector.create([0,0,1]),Vector.Random=function(n){for(var elements=[];n--;)elements.push(Math.random());return Vector.create(elements)},Vector.Fill=function(n,v){for(var elements=[];n--;)elements.push(v);return Vector.create(elements)},Vector.Zero=function(n){return Vector.Fill(n,0)},Vector.One=function(n){return Vector.Fill(n,1)},Vector.log=function(v){return v.map(function(x){return Math.log(x)})},module.exports=Vector},{"./matrix":22,"./sylvester":24}],26:[function(require,module,exports){(function(){function createReduce(dir){function iterator(obj,iteratee,memo,keys,index,length){for(;index>=0&&length>index;index+=dir){var currentKey=keys?keys[index]:index;memo=iteratee(memo,obj[currentKey],currentKey,obj)}return memo}return function(obj,iteratee,memo,context){iteratee=optimizeCb(iteratee,context,4);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=dir>0?0:length-1;return arguments.length<3&&(memo=obj[keys?keys[index]:index],index+=dir),iterator(obj,iteratee,memo,keys,index,length)}}function createIndexFinder(dir){return function(array,predicate,context){predicate=cb(predicate,context);for(var length=null!=array&&array.length,index=dir>0?0:length-1;index>=0&&length>index;index+=dir)if(predicate(array[index],index,array))return index;return-1}}function collectNonEnumProps(obj,keys){var nonEnumIdx=nonEnumerableProps.length,constructor=obj.constructor,proto=_.isFunction(constructor)&&constructor.prototype||ObjProto,prop="constructor";for(_.has(obj,prop)&&!_.contains(keys,prop)&&keys.push(prop);nonEnumIdx--;)prop=nonEnumerableProps[nonEnumIdx],prop in obj&&obj[prop]!==proto[prop]&&!_.contains(keys,prop)&&keys.push(prop)}var root=this,previousUnderscore=root._,ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype,push=ArrayProto.push,slice=ArrayProto.slice,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,nativeCreate=Object.create,Ctor=function(){},_=function(obj){return obj instanceof _?obj:this instanceof _?void(this._wrapped=obj):new _(obj)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=_),exports._=_):root._=_,_.VERSION="1.8.2";var optimizeCb=function(func,context,argCount){if(void 0===context)return func;switch(null==argCount?3:argCount){case 1:return function(value){return func.call(context,value)};case 2:return function(value,other){return func.call(context,value,other)};case 3:return function(value,index,collection){return func.call(context,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(context,accumulator,value,index,collection)}}return function(){return func.apply(context,arguments)}},cb=function(value,context,argCount){return null==value?_.identity:_.isFunction(value)?optimizeCb(value,context,argCount):_.isObject(value)?_.matcher(value):_.property(value)};_.iteratee=function(value,context){return cb(value,context,1/0)};var createAssigner=function(keysFunc,undefinedOnly){return function(obj){var length=arguments.length;if(2>length||null==obj)return obj;for(var index=1;length>index;index++)for(var source=arguments[index],keys=keysFunc(source),l=keys.length,i=0;l>i;i++){var key=keys[i];undefinedOnly&&void 0!==obj[key]||(obj[key]=source[key])}return obj}},baseCreate=function(prototype){if(!_.isObject(prototype))return{};if(nativeCreate)return nativeCreate(prototype);Ctor.prototype=prototype;var result=new Ctor;return Ctor.prototype=null,result},MAX_ARRAY_INDEX=Math.pow(2,53)-1,isArrayLike=function(collection){var length=collection&&collection.length;return"number"==typeof length&&length>=0&&MAX_ARRAY_INDEX>=length};_.each=_.forEach=function(obj,iteratee,context){iteratee=optimizeCb(iteratee,context);var i,length;if(isArrayLike(obj))for(i=0,length=obj.length;length>i;i++)iteratee(obj[i],i,obj);else{var keys=_.keys(obj);for(i=0,length=keys.length;length>i;i++)iteratee(obj[keys[i]],keys[i],obj)}return obj},_.map=_.collect=function(obj,iteratee,context){iteratee=cb(iteratee,context);for(var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,results=Array(length),index=0;length>index;index++){var currentKey=keys?keys[index]:index;results[index]=iteratee(obj[currentKey],currentKey,obj)}return results},_.reduce=_.foldl=_.inject=createReduce(1),_.reduceRight=_.foldr=createReduce(-1),_.find=_.detect=function(obj,predicate,context){var key;return key=isArrayLike(obj)?_.findIndex(obj,predicate,context):_.findKey(obj,predicate,context),void 0!==key&&-1!==key?obj[key]:void 0},_.filter=_.select=function(obj,predicate,context){var results=[];return predicate=cb(predicate,context),_.each(obj,function(value,index,list){predicate(value,index,list)&&results.push(value)}),results},_.reject=function(obj,predicate,context){return _.filter(obj,_.negate(cb(predicate)),context)},_.every=_.all=function(obj,predicate,context){predicate=cb(predicate,context);for(var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=0;length>index;index++){var currentKey=keys?keys[index]:index;if(!predicate(obj[currentKey],currentKey,obj))return!1}return!0},_.some=_.any=function(obj,predicate,context){predicate=cb(predicate,context);for(var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=0;length>index;index++){var currentKey=keys?keys[index]:index;if(predicate(obj[currentKey],currentKey,obj))return!0}return!1},_.contains=_.includes=_.include=function(obj,target,fromIndex){return isArrayLike(obj)||(obj=_.values(obj)),_.indexOf(obj,target,"number"==typeof fromIndex&&fromIndex)>=0},_.invoke=function(obj,method){var args=slice.call(arguments,2),isFunc=_.isFunction(method);return _.map(obj,function(value){var func=isFunc?method:value[method];return null==func?func:func.apply(value,args)})},_.pluck=function(obj,key){return _.map(obj,_.property(key))},_.where=function(obj,attrs){return _.filter(obj,_.matcher(attrs))},_.findWhere=function(obj,attrs){return _.find(obj,_.matcher(attrs))},_.max=function(obj,iteratee,context){var value,computed,result=-1/0,lastComputed=-1/0;if(null==iteratee&&null!=obj){obj=isArrayLike(obj)?obj:_.values(obj);for(var i=0,length=obj.length;length>i;i++)value=obj[i],value>result&&(result=value)}else iteratee=cb(iteratee,context),_.each(obj,function(value,index,list){computed=iteratee(value,index,list),(computed>lastComputed||computed===-1/0&&result===-1/0)&&(result=value,lastComputed=computed)});return result},_.min=function(obj,iteratee,context){var value,computed,result=1/0,lastComputed=1/0;if(null==iteratee&&null!=obj){obj=isArrayLike(obj)?obj:_.values(obj);for(var i=0,length=obj.length;length>i;i++)value=obj[i],result>value&&(result=value)}else iteratee=cb(iteratee,context),_.each(obj,function(value,index,list){computed=iteratee(value,index,list),(lastComputed>computed||1/0===computed&&1/0===result)&&(result=value,lastComputed=computed)});return result},_.shuffle=function(obj){for(var rand,set=isArrayLike(obj)?obj:_.values(obj),length=set.length,shuffled=Array(length),index=0;length>index;index++)rand=_.random(0,index),rand!==index&&(shuffled[index]=shuffled[rand]),shuffled[rand]=set[index];return shuffled},_.sample=function(obj,n,guard){return null==n||guard?(isArrayLike(obj)||(obj=_.values(obj)),obj[_.random(obj.length-1)]):_.shuffle(obj).slice(0,Math.max(0,n))},_.sortBy=function(obj,iteratee,context){return iteratee=cb(iteratee,context),_.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iteratee(value,index,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;if(a!==b){if(a>b||void 0===a)return 1;if(b>a||void 0===b)return-1}return left.index-right.index}),"value")};var group=function(behavior){return function(obj,iteratee,context){var result={};return iteratee=cb(iteratee,context),_.each(obj,function(value,index){var key=iteratee(value,index,obj);behavior(result,value,key)}),result}};_.groupBy=group(function(result,value,key){_.has(result,key)?result[key].push(value):result[key]=[value]}),_.indexBy=group(function(result,value,key){result[key]=value}),_.countBy=group(function(result,value,key){_.has(result,key)?result[key]++:result[key]=1}),_.toArray=function(obj){return obj?_.isArray(obj)?slice.call(obj):isArrayLike(obj)?_.map(obj,_.identity):_.values(obj):[]},_.size=function(obj){return null==obj?0:isArrayLike(obj)?obj.length:_.keys(obj).length},_.partition=function(obj,predicate,context){predicate=cb(predicate,context);var pass=[],fail=[];return _.each(obj,function(value,key,obj){(predicate(value,key,obj)?pass:fail).push(value)}),[pass,fail]},_.first=_.head=_.take=function(array,n,guard){return null==array?void 0:null==n||guard?array[0]:_.initial(array,array.length-n)},_.initial=function(array,n,guard){return slice.call(array,0,Math.max(0,array.length-(null==n||guard?1:n)))},_.last=function(array,n,guard){return null==array?void 0:null==n||guard?array[array.length-1]:_.rest(array,Math.max(0,array.length-n))},_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,null==n||guard?1:n)},_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,strict,startIndex){for(var output=[],idx=0,i=startIndex||0,length=input&&input.length;length>i;i++){var value=input[i];if(isArrayLike(value)&&(_.isArray(value)||_.isArguments(value))){shallow||(value=flatten(value,shallow,strict));var j=0,len=value.length;for(output.length+=len;len>j;)output[idx++]=value[j++]}else strict||(output[idx++]=value)}return output};_.flatten=function(array,shallow){return flatten(array,shallow,!1)},_.without=function(array){return _.difference(array,slice.call(arguments,1))},_.uniq=_.unique=function(array,isSorted,iteratee,context){if(null==array)return[];_.isBoolean(isSorted)||(context=iteratee,iteratee=isSorted,isSorted=!1),null!=iteratee&&(iteratee=cb(iteratee,context));for(var result=[],seen=[],i=0,length=array.length;length>i;i++){var value=array[i],computed=iteratee?iteratee(value,i,array):value;isSorted?(i&&seen===computed||result.push(value),seen=computed):iteratee?_.contains(seen,computed)||(seen.push(computed),result.push(value)):_.contains(result,value)||result.push(value)}return result},_.union=function(){return _.uniq(flatten(arguments,!0,!0))},_.intersection=function(array){if(null==array)return[];for(var result=[],argsLength=arguments.length,i=0,length=array.length;length>i;i++){var item=array[i];if(!_.contains(result,item)){for(var j=1;argsLength>j&&_.contains(arguments[j],item);j++);j===argsLength&&result.push(item)}}return result},_.difference=function(array){var rest=flatten(arguments,!0,!0,1);return _.filter(array,function(value){return!_.contains(rest,value)})},_.zip=function(){return _.unzip(arguments)},_.unzip=function(array){for(var length=array&&_.max(array,"length").length||0,result=Array(length),index=0;length>index;index++)result[index]=_.pluck(array,index);return result},_.object=function(list,values){for(var result={},i=0,length=list&&list.length;length>i;i++)values?result[list[i]]=values[i]:result[list[i][0]]=list[i][1];return result},_.indexOf=function(array,item,isSorted){var i=0,length=array&&array.length;if("number"==typeof isSorted)i=0>isSorted?Math.max(0,length+isSorted):isSorted;else if(isSorted&&length)return i=_.sortedIndex(array,item),array[i]===item?i:-1;if(item!==item)return _.findIndex(slice.call(array,i),_.isNaN);for(;length>i;i++)if(array[i]===item)return i;return-1},_.lastIndexOf=function(array,item,from){var idx=array?array.length:0;if("number"==typeof from&&(idx=0>from?idx+from+1:Math.min(idx,from+1)),item!==item)return _.findLastIndex(slice.call(array,0,idx),_.isNaN);for(;--idx>=0;)if(array[idx]===item)return idx;return-1},_.findIndex=createIndexFinder(1),_.findLastIndex=createIndexFinder(-1),_.sortedIndex=function(array,obj,iteratee,context){iteratee=cb(iteratee,context,1);for(var value=iteratee(obj),low=0,high=array.length;high>low;){var mid=Math.floor((low+high)/2);iteratee(array[mid])<value?low=mid+1:high=mid}return low},_.range=function(start,stop,step){arguments.length<=1&&(stop=start||0,start=0),step=step||1;for(var length=Math.max(Math.ceil((stop-start)/step),0),range=Array(length),idx=0;length>idx;idx++,start+=step)range[idx]=start;return range};var executeBound=function(sourceFunc,boundFunc,context,callingContext,args){if(!(callingContext instanceof boundFunc))return sourceFunc.apply(context,args);var self=baseCreate(sourceFunc.prototype),result=sourceFunc.apply(self,args);return _.isObject(result)?result:self};_.bind=function(func,context){if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError("Bind must be called on a function");var args=slice.call(arguments,2),bound=function(){return executeBound(func,bound,context,this,args.concat(slice.call(arguments)))};return bound},_.partial=function(func){var boundArgs=slice.call(arguments,1),bound=function(){for(var position=0,length=boundArgs.length,args=Array(length),i=0;length>i;i++)args[i]=boundArgs[i]===_?arguments[position++]:boundArgs[i];for(;position<arguments.length;)args.push(arguments[position++]);return executeBound(func,bound,this,this,args)};return bound},_.bindAll=function(obj){var i,key,length=arguments.length;if(1>=length)throw new Error("bindAll must be passed function names");for(i=1;length>i;i++)key=arguments[i],obj[key]=_.bind(obj[key],obj);return obj},_.memoize=function(func,hasher){var memoize=function(key){var cache=memoize.cache,address=""+(hasher?hasher.apply(this,arguments):key);return _.has(cache,address)||(cache[address]=func.apply(this,arguments)),cache[address]};return memoize.cache={},memoize},_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)},_.defer=_.partial(_.delay,_,1),_.throttle=function(func,wait,options){var context,args,result,timeout=null,previous=0;options||(options={});var later=function(){previous=options.leading===!1?0:_.now(),timeout=null,result=func.apply(context,args),timeout||(context=args=null)};return function(){var now=_.now();previous||options.leading!==!1||(previous=now);var remaining=wait-(now-previous);return context=this,args=arguments,0>=remaining||remaining>wait?(timeout&&(clearTimeout(timeout),timeout=null),previous=now,result=func.apply(context,args),timeout||(context=args=null)):timeout||options.trailing===!1||(timeout=setTimeout(later,remaining)),result}},_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result,later=function(){var last=_.now()-timestamp;wait>last&&last>=0?timeout=setTimeout(later,wait-last):(timeout=null,immediate||(result=func.apply(context,args),timeout||(context=args=null)))};return function(){context=this,args=arguments,timestamp=_.now();var callNow=immediate&&!timeout;return timeout||(timeout=setTimeout(later,wait)),callNow&&(result=func.apply(context,args),context=args=null),result}},_.wrap=function(func,wrapper){return _.partial(wrapper,func)},_.negate=function(predicate){return function(){return!predicate.apply(this,arguments)}},_.compose=function(){var args=arguments,start=args.length-1;return function(){for(var i=start,result=args[start].apply(this,arguments);i--;)result=args[i].call(this,result);return result}},_.after=function(times,func){return function(){return--times<1?func.apply(this,arguments):void 0}},_.before=function(times,func){var memo;return function(){return--times>0&&(memo=func.apply(this,arguments)),1>=times&&(func=null),memo}},_.once=_.partial(_.before,2);var hasEnumBug=!{toString:null}.propertyIsEnumerable("toString"),nonEnumerableProps=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];_.keys=function(obj){if(!_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var keys=[];for(var key in obj)_.has(obj,key)&&keys.push(key);return hasEnumBug&&collectNonEnumProps(obj,keys),keys},_.allKeys=function(obj){if(!_.isObject(obj))return[];var keys=[];for(var key in obj)keys.push(key);return hasEnumBug&&collectNonEnumProps(obj,keys),keys},_.values=function(obj){for(var keys=_.keys(obj),length=keys.length,values=Array(length),i=0;length>i;i++)values[i]=obj[keys[i]];return values},_.mapObject=function(obj,iteratee,context){iteratee=cb(iteratee,context);for(var currentKey,keys=_.keys(obj),length=keys.length,results={},index=0;length>index;index++)currentKey=keys[index],results[currentKey]=iteratee(obj[currentKey],currentKey,obj);return results},_.pairs=function(obj){for(var keys=_.keys(obj),length=keys.length,pairs=Array(length),i=0;length>i;i++)pairs[i]=[keys[i],obj[keys[i]]];return pairs},_.invert=function(obj){for(var result={},keys=_.keys(obj),i=0,length=keys.length;length>i;i++)result[obj[keys[i]]]=keys[i];return result},_.functions=_.methods=function(obj){var names=[];for(var key in obj)_.isFunction(obj[key])&&names.push(key);return names.sort()},_.extend=createAssigner(_.allKeys),_.extendOwn=_.assign=createAssigner(_.keys),_.findKey=function(obj,predicate,context){predicate=cb(predicate,context);for(var key,keys=_.keys(obj),i=0,length=keys.length;length>i;i++)if(key=keys[i],predicate(obj[key],key,obj))return key},_.pick=function(object,oiteratee,context){var iteratee,keys,result={},obj=object;if(null==obj)return result;_.isFunction(oiteratee)?(keys=_.allKeys(obj),iteratee=optimizeCb(oiteratee,context)):(keys=flatten(arguments,!1,!1,1),iteratee=function(value,key,obj){return key in obj},obj=Object(obj));for(var i=0,length=keys.length;length>i;i++){var key=keys[i],value=obj[key];iteratee(value,key,obj)&&(result[key]=value)}return result},_.omit=function(obj,iteratee,context){if(_.isFunction(iteratee))iteratee=_.negate(iteratee);else{var keys=_.map(flatten(arguments,!1,!1,1),String);iteratee=function(value,key){return!_.contains(keys,key)}}return _.pick(obj,iteratee,context)},_.defaults=createAssigner(_.allKeys,!0),_.clone=function(obj){return _.isObject(obj)?_.isArray(obj)?obj.slice():_.extend({},obj):obj},_.tap=function(obj,interceptor){return interceptor(obj),obj},_.isMatch=function(object,attrs){var keys=_.keys(attrs),length=keys.length;if(null==object)return!length;for(var obj=Object(object),i=0;length>i;i++){var key=keys[i];if(attrs[key]!==obj[key]||!(key in obj))return!1}return!0};var eq=function(a,b,aStack,bStack){if(a===b)return 0!==a||1/a===1/b;if(null==a||null==b)return a===b;a instanceof _&&(a=a._wrapped),b instanceof _&&(b=b._wrapped);var className=toString.call(a);if(className!==toString.call(b))return!1;switch(className){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!==+a?+b!==+b:0===+a?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}var areArrays="[object Array]"===className;if(!areArrays){if("object"!=typeof a||"object"!=typeof b)return!1;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor)&&"constructor"in a&&"constructor"in b)return!1}aStack=aStack||[],bStack=bStack||[];for(var length=aStack.length;length--;)if(aStack[length]===a)return bStack[length]===b;if(aStack.push(a),bStack.push(b),areArrays){if(length=a.length,length!==b.length)return!1;for(;length--;)if(!eq(a[length],b[length],aStack,bStack))return!1}else{var key,keys=_.keys(a);if(length=keys.length,_.keys(b).length!==length)return!1;for(;length--;)if(key=keys[length],!_.has(b,key)||!eq(a[key],b[key],aStack,bStack))return!1}return aStack.pop(),bStack.pop(),!0};_.isEqual=function(a,b){return eq(a,b)},_.isEmpty=function(obj){return null==obj?!0:isArrayLike(obj)&&(_.isArray(obj)||_.isString(obj)||_.isArguments(obj))?0===obj.length:0===_.keys(obj).length},_.isElement=function(obj){return!(!obj||1!==obj.nodeType)},_.isArray=nativeIsArray||function(obj){return"[object Array]"===toString.call(obj)},_.isObject=function(obj){var type=typeof obj;return"function"===type||"object"===type&&!!obj},_.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(name){_["is"+name]=function(obj){return toString.call(obj)==="[object "+name+"]"}}),_.isArguments(arguments)||(_.isArguments=function(obj){return _.has(obj,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(_.isFunction=function(obj){return"function"==typeof obj||!1}),_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))},_.isNaN=function(obj){return _.isNumber(obj)&&obj!==+obj},_.isBoolean=function(obj){return obj===!0||obj===!1||"[object Boolean]"===toString.call(obj)},_.isNull=function(obj){return null===obj},_.isUndefined=function(obj){return void 0===obj},_.has=function(obj,key){return null!=obj&&hasOwnProperty.call(obj,key)},_.noConflict=function(){return root._=previousUnderscore,this},_.identity=function(value){return value},_.constant=function(value){return function(){return value}},_.noop=function(){},_.property=function(key){return function(obj){return null==obj?void 0:obj[key]}},_.propertyOf=function(obj){return null==obj?function(){}:function(key){return obj[key]}},_.matcher=_.matches=function(attrs){return attrs=_.extendOwn({},attrs),function(obj){return _.isMatch(obj,attrs)}},_.times=function(n,iteratee,context){var accum=Array(Math.max(0,n));iteratee=optimizeCb(iteratee,context,1);for(var i=0;n>i;i++)accum[i]=iteratee(i);return accum},_.random=function(min,max){return null==max&&(max=min,min=0),min+Math.floor(Math.random()*(max-min+1))},_.now=Date.now||function(){return(new Date).getTime()};var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},unescapeMap=_.invert(escapeMap),createEscaper=function(map){var escaper=function(match){return map[match]},source="(?:"+_.keys(map).join("|")+")",testRegexp=RegExp(source),replaceRegexp=RegExp(source,"g");return function(string){return string=null==string?"":""+string,testRegexp.test(string)?string.replace(replaceRegexp,escaper):string}};_.escape=createEscaper(escapeMap),_.unescape=createEscaper(unescapeMap),_.result=function(object,property,fallback){var value=null==object?void 0:object[property];return void 0===value&&(value=fallback),_.isFunction(value)?value.call(object):value};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/,escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},escaper=/\\|'|\r|\n|\u2028|\u2029/g,escapeChar=function(match){return"\\"+escapes[match]};_.template=function(text,settings,oldSettings){!settings&&oldSettings&&(settings=oldSettings),settings=_.defaults({},settings,_.templateSettings);var matcher=RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g"),index=0,source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){return source+=text.slice(index,offset).replace(escaper,escapeChar),index=offset+match.length,escape?source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'":interpolate?source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'":evaluate&&(source+="';\n"+evaluate+"\n__p+='"),match}),source+="';\n",settings.variable||(source="with(obj||{}){\n"+source+"}\n"),source="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{var render=new Function(settings.variable||"obj","_",source)}catch(e){throw e.source=source,e}var template=function(data){return render.call(this,data,_)},argument=settings.variable||"obj";return template.source="function("+argument+"){\n"+source+"}",template},_.chain=function(obj){var instance=_(obj);return instance._chain=!0,instance};var result=function(instance,obj){return instance._chain?_(obj).chain():obj};_.mixin=function(obj){_.each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];return push.apply(args,arguments),result(this,func.apply(_,args))}})},_.mixin(_),_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;return method.apply(obj,arguments),"shift"!==name&&"splice"!==name||0!==obj.length||delete obj[0],result(this,obj)}}),_.each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result(this,method.apply(this._wrapped,arguments))}}),_.prototype.value=function(){return this._wrapped},_.prototype.valueOf=_.prototype.toJSON=_.prototype.value,_.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return _})}).call(this)},{}],27:[function(require,module){"use strict";var _=require("underscore"),Project=require("../models/Project.js"),IDBAdapter=require("../store/StorageAdapter.js"),utils=require("../utils.js"),settings=require("../settings.js"),LOCAL_STORES=settings.LOCAL_STORE,demos=require("../../../demo/demos.js"),DemoProject=require("../models/DemoProject.js");module.exports=Ember.Controller.extend({projects:[],demos:[],currentProject:null,adapter:null,onSwichProject:function(){Ember.Logger.debug("project switch triggered!");var project=this.get("currentProject"),oldadapter=this.get("adapter");oldadapter&&(oldadapter.close(),this.set("adapter",null)),project&&this.set("adapter",new IDBAdapter(project.get("name"))),project?localStorage.setItem(LOCAL_STORES.PROJECT,project.get("name")):localStorage.removeItem(LOCAL_STORES.PROJECT)}.observes("currentProject"),promiseProject:function(){var project=this.get("currentProject");return null===project?Promise.reject():Promise.resolve(project)},promiseDeleteProject:function(project){var _self=this,currentProject=this.get("currentProject");
return currentProject&&currentProject.get("name")===project.get("name")&&this.set("currentProject",null),new Promise(function(resolve){_self.set("isDeleting",!0);var request=indexedDB.deleteDatabase(project.get("name"));request.onsuccess=function(){_self.get("projects").removeObject(project),resolve(project)}})},nameAvaliable:function(name){var demos=this.get("demos"),projects=this.get("projects");return _.isUndefined(demos.findBy("name",name))&&_.isUndefined(projects.findBy("name",name))},initRecover:function(){var storedProjects=utils.getLocalStorage(LOCAL_STORES.PROJECTS);_.isArray(storedProjects)&&this.set("projects",storedProjects.map(function(p){return Project.create(p)})),this.set("demos",demos.map(function(config){return DemoProject.create(config.description)}));var currentProject,projectName=localStorage.getItem(LOCAL_STORES.PROJECT);_.isString(projectName)&&(currentProject=this.get("projects").findBy("name",projectName)||this.get("demos").findBy("name",projectName)||null,this.set("currentProject",currentProject))}.on("init"),watchProjects:function(){this.send("syncProjects")}.observes("projects.length"),actions:{enter:function(project){this.set("currentProject",project),this.transitionToRoute("workspace.images")},createProject:function(project){this.get("projects").pushObject(project)},syncDemos:function(){utils.setLocalStorage(LOCAL_STORES.DEMOS,this.get("demos").map(function(model){return model.getProperties(model.get("storedProperties"))}))},syncProjects:function(){utils.setLocalStorage(LOCAL_STORES.PROJECTS,this.get("projects").map(function(model){return model.getProperties(model.get("storedProperties"))}))}}})},{"../../../demo/demos.js":4,"../models/DemoProject.js":66,"../models/Project.js":69,"../settings.js":87,"../store/StorageAdapter.js":88,"../utils.js":89,underscore:26}],28:[function(require,module){module.exports=Ember.Controller.extend({actions:{display:function(){}}})},{}],29:[function(require,module){"use strict";{var settings=(require("../utils.js"),require("../settings.js")),RESOURCE=settings.RESOURCE;require("../models/Image.js")}module.exports=Ember.Controller.extend({needs:["context"],ctx:Ember.computed.alias("controllers.context"),model:Ember.computed.alias("project"),project:Ember.computed.alias("ctx.currentProject"),root:Ember.computed.alias("model.root"),adapter:Ember.computed.alias("ctx.adapter"),isDemo:Ember.computed.alias("model.isDemo"),downloader:Ember.inject.service(),promiseResource:function(name,metadata){var project=this.get("project");return project.get("isDemo")?this.promiseDemoResource(name,metadata):this.promiseLocalResource(name,metadata)},promiseDemoResource:function(name,metadata){if(!this.get("model")||!this.get("model.isDemo"))throw"Demo object invalid";var url,datatype,desc,root=this.get("root"),downloader=this.get("downloader");switch(name){case RESOURCE.IMAGES:url=root+name,datatype="json",desc="Download image list";break;case RESOURCE.FULLIMAGES:url=root+"/images/"+metadata.get("name")+metadata.get("extension"),datatype="arraybuffer",desc=metadata.get("name")+metadata.get("extension");break;case RESOURCE.FEATURE_POINTS:url=root+name+"/"+metadata.get("name")+".point",datatype="arraybuffer",desc=metadata.get("name")+".points";break;case RESOURCE.FEATURE_VECTORS:url=root+name+"/"+metadata.get("name")+".vector",datatype="arraybuffer",desc=metadata.get("name")+".vector";break;case RESOURCE.MATCHES:url=root+name,datatype="json",desc="Loading match table";break;case RESOURCE.MVS_POINTS:url=root+name,datatype="arraybuffer",desc="Dense point cloud";break;case RESOURCE.MVS_COLORS:url=root+name,datatype="arraybuffer",desc="Dense point cloud texture";break;case RESOURCE.SPARSE_POINTS:url=root+name,datatype="arraybuffer",desc="Sparse point cloud";break;case RESOURCE.SPARSE_COLORS:url=root+name,datatype="arraybuffer",desc="Sparse point cloud texture";break;case RESOURCE.CAMERAS:url=root+name,datatype="json",desc="Loading camera parameters";break;default:throw"Invalid resource"}return downloader.assign(url,datatype,desc).get("promise")},promiseLocalResource:function(name,metadata){var adapter=this.get("adapter");switch(name){case RESOURCE.IMAGES:return adapter.promiseAll(name).then(function(results){return results.map(function(entry){var key=entry.key,value=entry.value;return value.id=key,value})});case RESOURCE.FULLIMAGES:return adapter.promiseData(name,metadata.get("id"));default:throw"Invalid resource"}}})},{"../models/Image.js":67,"../settings.js":87,"../utils.js":89}],30:[function(require,module){"use strict";{var utils=require("../utils.js"),settings=(require("../models/Worker.js"),require("../settings.js")),STATES=settings.STATES,TASK_STATE=settings.TASK_STATES;settings.TASKS}module.exports=Ember.Controller.extend({workers:[],queue:[],state:STATES.STOPPED,poolSize:4,script:null,promiseReady:function(){var _self=this;return this.promised||(this.promised=utils.promiseScript().then(function(dataurl){_self.set("script",dataurl)})),this.promised},promiseTask:function(task){switch(task.set("state",TASK_STATE.PENDING),task.get("type")){default:throw"Task not implemented yet"}return new Promise(function(resolve){task.set("callback",resolve)})},suspend:function(){},resume:function(){},onResize:function(){}.observes("poolSize"),onStateChange:function(){this.get("state")===STATES.STOPPED?this.suspend():this.get("state")===STATES.RUNNING&&this.resume()}.observes("state")})},{"../models/Worker.js":71,"../settings.js":87,"../utils.js":89}],31:[function(require,module){"use strict";var Image=(require("underscore"),require("../models/Image.js")),settings=(require("../utils.js"),require("../settings.js")),RESOURCE=settings.RESOURCE;module.exports=Ember.Controller.extend({needs:["context","projectResource","scheduler"],scheduler:Ember.computed.alias("controllers.scheduler"),workers:Ember.computed.alias("scheduler.workers"),threadPoolSize:Ember.computed.alias("scheduler.poolSize"),resource:Ember.computed.alias("controllers.projectResource"),ctx:Ember.computed.alias("controllers.context"),project:Ember.computed.alias("ctx.currentProject"),adapter:Ember.computed.alias("ctx.adapter"),isRunning:!1,actions:{enter:function(route){this.transitionToRoute(route)},back:function(){this.transitionToRoute("welcome")}},images:function(){return this.get("resource").promiseResource(RESOURCE.IMAGES).then(function(images){return images.map(function(image){return image._id=image.id,Image.create(image)}).sortBy("id")})}.property("project")})},{"../models/Image.js":67,"../settings.js":87,"../utils.js":89,underscore:26}],32:[function(require){"use strict";window.Promise=Promise||Ember.RSVP.Promise,jQuery.event.props.push("dataTransfer");var App=window.App=Ember.Application.create();App.Router.map(function(){this.route("welcome",function(){this.route("demo",{path:"/demo/:name"})}),this.route("workspace",function(){this.route("images",function(){this.route("detail",{path:"/:id"})}),this.route("extractor",function(){this.route("image",{path:"/:id"})}),this.route("matcher",function(){this.route("pair")}),this.route("register",function(){}),this.route("mvs",function(){})})}),App.ApplicationRoute=Ember.Route.extend(),App.IndexRoute=require("./routes/Index.js"),App.WelcomeRoute=require("./routes/Welcome.js"),App.WelcomeIndexRoute=require("./routes/WelcomeIndex.js"),App.WelcomeDemoRoute=require("./routes/WelcomeDemo.js"),App.WorkspaceRoute=require("./routes/Workspace.js"),App.WorkspaceIndexRoute=Ember.Route.extend(),App.WorkspaceImagesRoute=require("./routes/WorkspaceImages.js"),App.WorkspaceImagesIndexRoute=Ember.Route.extend(),App.WorkspaceImagesDetailRoute=require("./routes/WorkspaceImagesDetail.js"),App.WorkspaceExtractorRoute=require("./routes/WorkspaceExtractor.js"),App.WorkspaceExtractorIndexRoute=Ember.Route.extend(),App.WorkspaceExtractorImageRoute=require("./routes/WorkspaceExtractorImage.js"),App.WorkspaceMatcherRoute=require("./routes/WorkspaceMatcher.js"),App.WorkspaceMatcherIndexRoute=Ember.Route.extend(),App.WorkspaceMatcherPairRoute=require("./routes/WorkspaceMatcherPair.js"),App.WorkspaceRegisterRoute=require("./routes/WorkspaceRegister.js"),App.WorkspaceRegisterIndexRoute=Ember.Route.extend(),App.WorkspaceMvsRoute=require("./routes/WorkspaceMvs.js"),App.WorkspaceMvsIndexRoute=Ember.Route.extend(),App.MultiViewStereoComponent=require("./components/multi-view-stereo.js"),App.SparseReconstructionComponent=require("./components/sparse-reconstruction.js"),App.ProjectThumbnailComponent=require("./components/project-thumbnail.js"),App.ProjectCreatorComponent=require("./components/project-creator.js"),App.WorkspaceProgressBarComponent=require("./components/workspace-progress-bar.js"),App.DemoThumbnailComponent=require("./components/demo-thumbnail.js"),App.MatchGridComponent=require("./components/match-grid.js"),App.MatchGridNodeComponent=require("./components/match-grid-node.js"),App.ImageDetailComponent=require("./components/image-detail.js"),App.DynamicImageComponent=require("./components/dynamic-image.js"),App.ImageImporterComponent=require("./components/image-importer.js"),App.DemoDetailComponent=require("./components/demo-detail.js"),App.CpuSettingComponent=require("./components/cpu-setting.js"),App.CpuSettingNodeComponent=require("./components/cpu-setting-node.js"),App.WorkspaceControlPanelComponent=require("./components/workspace-control-panel.js"),App.VisualFeaturesComponent=require("./components/visual-features.js"),App.FloatingWindowComponent=require("./components/floating-window.js"),App.VisualMatchingComponent=require("./components/visual-matching.js"),App.MatchModeTabComponent=require("./components/match-mode-tab.js"),App.ImageGalleryComponent=require("./components/image-gallery.js"),App.MessageTrayComponent=require("./components/message-tray.js"),App.BasicMessageComponent=require("./components/basic-message.js"),App.TaskMessageComponent=require("./components/task-message.js"),App.MessagesService=require("./services/messgaes.js"),App.DownloaderService=require("./services/downloader.js"),App.ContextController=require("./ResourceControllers/context.js"),App.SchedulerController=require("./ResourceControllers/scheduler.js"),App.ProjectResourceController=require("./ResourceControllers/project-resource.js"),App.MessageController=require("./ResourceControllers/message.js"),App.WelcomeController=require("./controllers/Welcome.js"),App.WelcomeDemoController=require("./controllers/WelcomeDemo.js"),App.WorkspaceController=require("./ResourceControllers/workspace.js"),App.WorkspaceImagesController=require("./controllers/WorkspaceImages.js"),App.WorkspaceImagesDetailController=require("./controllers/WorkspaceImagesDetail.js"),App.WorkspaceExtractorController=require("./controllers/WorkspaceExtractor.js"),App.WorkspaceExtractorImageController=require("./controllers/WorkspaceExtractorImage.js"),App.WorkspaceMatcherController=require("./controllers/WorkspaceMatcher.js"),App.WorkspaceMatcherPairController=require("./controllers/WorkspaceMatcherPair.js"),App.TracksController=Ember.ObjectController.extend(),App.WorkspaceRegisterController=require("./controllers/WorkspaceRegister.js"),App.WorkspaceMvsController=Ember.Controller.extend()},{"./ResourceControllers/context.js":27,"./ResourceControllers/message.js":28,"./ResourceControllers/project-resource.js":29,"./ResourceControllers/scheduler.js":30,"./ResourceControllers/workspace.js":31,"./components/basic-message.js":33,"./components/cpu-setting-node.js":34,"./components/cpu-setting.js":35,"./components/demo-detail.js":36,"./components/demo-thumbnail.js":37,"./components/dynamic-image.js":38,"./components/floating-window.js":39,"./components/image-detail.js":40,"./components/image-gallery.js":41,"./components/image-importer.js":42,"./components/match-grid-node.js":43,"./components/match-grid.js":44,"./components/match-mode-tab.js":45,"./components/message-tray.js":46,"./components/multi-view-stereo.js":47,"./components/project-creator.js":48,"./components/project-thumbnail.js":49,"./components/sparse-reconstruction.js":50,"./components/task-message.js":51,"./components/visual-features.js":52,"./components/visual-matching.js":53,"./components/workspace-control-panel.js":54,"./components/workspace-progress-bar.js":55,"./controllers/Welcome.js":56,"./controllers/WelcomeDemo.js":57,"./controllers/WorkspaceExtractor.js":58,"./controllers/WorkspaceExtractorImage.js":59,"./controllers/WorkspaceImages.js":60,"./controllers/WorkspaceImagesDetail.js":61,"./controllers/WorkspaceMatcher.js":62,"./controllers/WorkspaceMatcherPair.js":63,"./controllers/WorkspaceRegister.js":64,"./routes/Index.js":72,"./routes/Welcome.js":73,"./routes/WelcomeDemo.js":74,"./routes/WelcomeIndex.js":75,"./routes/Workspace.js":76,"./routes/WorkspaceExtractor.js":77,"./routes/WorkspaceExtractorImage.js":78,"./routes/WorkspaceImages.js":79,"./routes/WorkspaceImagesDetail.js":80,"./routes/WorkspaceMatcher.js":81,"./routes/WorkspaceMatcherPair.js":82,"./routes/WorkspaceMvs.js":83,"./routes/WorkspaceRegister.js":84,"./services/downloader.js":85,"./services/messgaes.js":86}],33:[function(require,module){module.exports=Ember.Component.extend({messages:Ember.inject.service(),queue:Ember.computed.alias("messages.queue"),message:null,tagName:"li",classNames:"basic-message",actions:{dismiss:function(){var message=this.get("message"),queue=this.get("queue");queue.removeObject(message)}}})},{}],34:[function(require,module){"use strict";module.exports=Ember.Component.extend({index:null,grid:null,selected:Ember.computed.alias("grid.selected"),hoverAt:Ember.computed.alias("grid.hoverAt"),classNames:["controll-panel__cpu-setting__node"],isEnabled:function(){return this.get("index")<this.get("selected")}.property("selected"),willEnable:function(){return!this.get("isEnabled")&&this.get("index")<=this.get("hoverAt")}.property("isEnabled","hoverAt"),willDisable:function(){return this.get("isEnabled")&&this.get("index")>this.get("hoverAt")}.property("isEnabled","hoverAt"),mouseEnter:function(){this.set("hoverAt",this.get("index"))},actions:{enable:function(){this.set("selected",this.get("index")+1)}}})},{}],35:[function(require,module){"use strict";module.exports=Ember.Component.extend({workspace:null,size:Ember.computed.alias("workspace.threadPoolSize"),classNames:["controll-panel__cpu-setting"],hoverAt:4,selected:4,onChangeSetting:function(){this.set("size",this.get("selected"))}.observes("selected")})},{}],36:[function(require,module){"use strict";var utils=(require("underscore"),require("../utils.js"));module.exports=Ember.Component.extend({project:null,ctx:null,attributeBindings:["style"],classNames:"demo-detail",classNameBindings:["isExpanded"],isExpanded:!1,style:function(){return"background-image: url("+this.get("project.root")+"/profile.jpeg)"}.property("project.root"),inflate:function(){var _self=this;return utils.promiseDelay(0).then(function(){_self.set("isExpanded",!0)})}.on("didInsertElement"),actions:{close:function(){var _self=this;this.set("isExpanded",!1),utils.promiseDelay(500).then(function(){_self.get("ctx").transitionToRoute("welcome")})},enter:function(){this.get("ctx").send("enter",this.get("project"))}}})},{"../utils.js":89,underscore:26}],37:[function(require,module){"use strict";module.exports=Ember.Component.extend({project:null,ctx:null,isExpanded:Ember.computed.alias("project.isExpanded"),tagName:"div",classNameBindings:["isExpanded"],classNames:"welcome-screen__demos__thumbnail",isConfirmDelete:!1,backgroundStyle:function(){return"background-image:url("+this.get("project.root")+"/thumbnail.jpg)"}.property("project.root")})},{}],38:[function(require,module){"use strict";var DragZoomMixin=require("../mixins/DragZoom.js");module.exports=Ember.Component.extend(DragZoomMixin,{tagName:"img",classNames:["dynamic-image"],attributeBindings:["src"],src:null,wheel:function(e){var img=this.get("element"),currentWidth=img.width,currentHeight=img.height,speed=.04,nextWidth=currentWidth*(e.deltaY<0?1+speed:1-speed),nextHeight=currentHeight*(e.deltaY<0?1+speed:1-speed);nextWidth>=img.naturalWidth?jQuery(img).css("width",img.naturalWidth).css("height",img.naturalHeight):nextWidth>500&&jQuery(img).css("width",nextWidth).css("height",nextHeight)}})},{"../mixins/DragZoom.js":65}],39:[function(require,module){module.exports=Ember.Component.extend({actions:{close:function(){this.sendAction("close")}}})},{}],40:[function(require,module){"use strict";var settings=require("../settings.js"),RESOURCE=settings.RESOURCE;module.exports=Ember.Component.extend({classNames:["image-detail__container"],image:null,resource:null,isLoadng:!0,dataurl:null,onNewImage:function(){this.set("isLoading",!0);var _self=this;return this.get("resource").promiseResource(RESOURCE.FULLIMAGES,this.get("image")).then(function(data){var domstring=URL.createObjectURL(new Blob([data]));_self.set("dataurl",domstring),_self.set("isLoading",!1)})}.observes("image").on("init")})},{"../settings.js":87}],41:[function(require,module){"use strict";module.exports=Ember.Component.extend({tagName:"ul",classNames:"image-gallery",canImport:!1,actions:{expand:function(item){this.sendAction("expand",item)}}})},{}],42:[function(require,module){"use strict";var _=require("underscore"),Image=require("../models/Image.js");module.exports=Ember.Component.extend({adapter:null,images:null,isActive:!1,tagName:"div",classNames:["main-container__input-gallery__input"],classNameBindings:["isActive"],dragOver:function(e){e.preventDefault()},dragEnter:function(e){e.preventDefault(),this.set("isActive",!0)},dragLeave:function(e){e.preventDefault(),this.set("isActive",!1)},drop:function(e){var files=e.dataTransfer.files,adapter=this.get("adapter"),images=this.get("images");e.preventDefault(),this.set("isActive",!1),_.range(files.length).forEach(function(i){var file=files[i];console.log(file),adapter.processImageFile(file).then(function(data){var image=Image.create(data);images.pushObject(image)})})}})},{"../models/Image.js":67,underscore:26}],43:[function(require,module){"use strict";module.exports=Ember.Component.extend({data:null,tagName:"div",classNames:"match-grid__node",classNameBindings:["isDiag","isConnected","isRobust"],from:null,to:null,isConnected:function(){return!!this.get("data")}.property("data"),isRobust:function(){return!!this.get("data.robust")}.property("data"),isDiag:function(){return this.get("from")===this.get("to")}.property("from","to"),click:function(){this.get("isRobust")&&this.sendAction("action",{from:this.get("from"),to:this.get("to")})}})},{}],44:[function(require,module){"use strict";module.exports=Ember.Component.extend({images:null,matches:null,tagName:"div",classNames:["match-grid"],hover:null,mouseLeave:function(){this.set("hover",null)},gridsizeInit:function(){return 2*this.get("gridsizeMin")}.property("gridsizeMin"),gridsizeMax:function(){return 100*this.get("images.length")}.property("images.length"),gridsizeMin:function(){return 40*this.get("images.length")}.property("images.length"),wheel:function(e){e.preventDefault();var GRID_SIZE_MAX=this.get("gridsizeMax"),GRID_SIZE_MIN=this.get("gridsizeMin"),$grid=jQuery(".match-grid__body"),currentSize=$grid.height(),speed=.02,nextSize=currentSize*(e.deltaY<0?1+speed:1-speed);nextSize>GRID_SIZE_MIN&&GRID_SIZE_MAX>nextSize&&$grid.css("width",nextSize).css("height",nextSize)},actions:{enter:function(param){this.sendAction("enter",param)}}})},{}],45:[function(require,module){module.exports=Ember.Component.extend({classNames:["match-mode-tab"],classNameBindings:["isCurrent"],isCurrent:function(){return this.get("current")===this.get("mode")}.property("current","mode"),click:function(){this.set("current",this.get("mode"))}})},{}],46:[function(require,module){module.exports=Ember.Component.extend({messages:Ember.inject.service(),queue:Ember.computed.alias("messages.queue"),tagName:"div",classNames:"message-tray",expanded:!0,actions:{expand:function(){this.get("queue.length")>0&&this.set("expanded",!0)},close:function(){this.set("expanded",!1)}}})},{}],47:[function(require,module){"use strict";var THREE=require("three"),OrbitControls=require("three-orbit-controls")(THREE);module.exports=Ember.Component.extend({tagName:"div",className:["main-container__stereo-container"],geometry:null,camera:null,scene:null,light:null,prepareRendering:function(){var width=window.innerWidth,height=window.innerHeight,renderer=new THREE.WebGLRenderer;renderer.setClearColor(15000804,1),renderer.setSize(width,height),this.get("element").appendChild(renderer.domElement);var camera=new THREE.PerspectiveCamera(45,width/height,.1,1e4);camera.position.x=500,camera.position.y=500,camera.position.z=500;var scene=new THREE.Scene,light=new THREE.PointLight(16777215);light.position.set(0,300,200);var control=new OrbitControls(camera,renderer.domElement);scene.add(light),scene.add(camera),scene.add(this.getPointCloud()),control.addEventListener("change",function(){renderer.render(scene,camera)}),renderer.render(scene,camera)}.on("didInsertElement"),getPointCloud:function(){for(var points=this.get("surfels.points"),colors=this.get("surfels.colors"),bufferSize=colors.length,colorBuffer=new Float32Array(bufferSize),i=0;bufferSize>i;i++)colorBuffer[i]=colors[i]/255;var SCALE=40,surfelsGeometry=new THREE.BufferGeometry;surfelsGeometry.addAttribute("position",new THREE.BufferAttribute(points,3)),surfelsGeometry.addAttribute("color",new THREE.BufferAttribute(colorBuffer,3));var surfelsMaterial=new THREE.PointCloudMaterial({vertexColors:!0,size:4,blending:THREE.AdditiveBlending}),surfels=new THREE.PointCloud(surfelsGeometry,surfelsMaterial);return surfels.scale.set(SCALE,SCALE,SCALE),surfels.rotation.z=5,surfels}})},{three:113,"three-orbit-controls":112}],48:[function(require,module){"use strict";var Project=require("../models/Project.js");module.exports=Ember.Component.extend({ctx:null,tagName:"div",classNames:"welcome-screen__projects__new",classNameBindings:["isInvalid"],defaultName:"my-project",newProjectName:"",isInvalid:function(){var name=this.get("newProjectName"),ctx=this.get("ctx"),isValid=ctx.nameAvaliable(name)||""===name;return!isValid}.property("newProjectName"),actions:{createProject:function(){function getNextDefaultName(i){if(i){var name=defaultName+"-"+i;return ctx.nameAvaliable(name)?name:getNextDefaultName(i+1)}return ctx.nameAvaliable(defaultName)?defaultName:getNextDefaultName(2)}var defaultName=this.get("defaultName"),name=this.get("newProjectName"),ctx=this.get("ctx");if(!this.get("isInvalid")){""===name&&(name=getNextDefaultName());var project=Project.create({name:name});this.set("newProjectName",""),ctx.send("createProject",project)}}}})},{"../models/Project.js":69}],49:[function(require,module){"use strict";module.exports=Ember.Component.extend({project:null,ctx:null,tagName:"div",classNames:["welcome-screen__projects__thumbnail"],isConfirmDelete:!1,actions:{enter:function(){this.get("ctx").send("enter",this.get("project"))},"delete":function(){this.set("isConfirmDelete",!1),this.get("ctx").promiseDeleteProject(this.get("project"))},confirmDelete:function(){this.toggleProperty("isConfirmDelete")},cancelDelete:function(){this.set("isConfirmDelete",!1)}}})},{}],50:[function(require,module){"use strict";var _=require("underscore"),la=require("sylvester"),THREE=(la.Matrix,la.Vector,require("three")),OrbitControls=require("three-orbit-controls")(THREE),V3=THREE.Vector3,camUtils=require("../../math/projections.js"),vis3d=(require("../../utils/cord.js"),require("../../visualization/vis3d.js"));module.exports=Ember.Component.extend({geometry:null,camera:null,scene:null,prepareRendering:function(){var width=window.innerWidth,height=window.innerHeight,SCALE=20,renderer=new THREE.WebGLRenderer;renderer.setClearColor(15000804,1),renderer.setSize(width,height),this.get("element").appendChild(renderer.domElement);var camera=new THREE.PerspectiveCamera(45,width/height,.1,1e4),scene=new THREE.Scene,light=new THREE.PointLight(16777215),control=new OrbitControls(camera,renderer.domElement);light.position.set(0,300,200),this.set("scene",scene),this.set("camera",camera),scene.add(light),scene.add(camera);var recovered=new THREE.Object3D;recovered.add(this.getCameras()),recovered.add(this.getPointCloud()),recovered.scale.set(SCALE,SCALE,SCALE),scene.add(recovered),camera.position.set(400,400,400),camera.lookAt(new V3(0,0,0)),control.addEventListener("change",function(){renderer.render(scene,camera)}),renderer.render(scene,camera)}.on("didInsertElement"),getPointCloud:function(){for(var points=this.get("sparse.points"),colors=this.get("sparse.colors"),bufferSize=colors.length,colorBuffer=new Float32Array(bufferSize),i=0;bufferSize>i;i++)colorBuffer[i]=colors[i]/255;var surfelsGeometry=new THREE.BufferGeometry;surfelsGeometry.addAttribute("position",new THREE.BufferAttribute(points,3)),surfelsGeometry.addAttribute("color",new THREE.BufferAttribute(colorBuffer,3));var pointsMaterial=new THREE.PointCloudMaterial({size:3,vertexColors:!0,blending:THREE.AdditiveBlending});return new THREE.PointCloud(surfelsGeometry,pointsMaterial)},getCameras:function(){var cameras=new THREE.Object3D,cDict=this.get("cameras");return _.each(cDict,function(cam){var calibrated=camUtils.stored2calibrated(cam);cameras.add(vis3d.getCameraFrame(calibrated))}),cameras}})},{"../../math/projections.js":92,"../../utils/cord.js":93,"../../visualization/vis3d.js":98,sylvester:19,three:113,"three-orbit-controls":112,underscore:26}],51:[function(require,module){module.exports=Ember.Component.extend({messages:Ember.inject.service(),message:null,task:Ember.computed.alias("message.task"),progress:Ember.computed.alias("task.progress"),content:Ember.computed.alias("task.desc"),tagName:"li",classNames:"task-message",onFinish:function(){this.get("task.isDone")&&this.get("messages.queue").removeObject(this.get("message"))}.observes("task.state").on("init")})},{}],52:[function(require,module){"use strict";var ndarray=require("ndarray"),drawFeatures=require("../../visualization/features.js"),DragZoomMixin=require("../mixins/DragZoom.js");module.exports=Ember.Component.extend(DragZoomMixin,{img:null,features:null,tagName:"canvas",classNames:["visual-features"],onNewImage:function(){this.renderCanvas();var img=this.get("element"),$img=jQuery(img);$img.css("width",img.width).css("height",img.height)}.observes("img").on("didInsertElement"),renderCanvas:function(){var img=this.get("img"),width=img.width,height=img.height,canvas=this.get("element"),markSize=Math.max(3,Math.round(Math.max(width,height)/400)),typed=new Float32Array(this.get("features")),amount=typed.length/4,ndbuffer=ndarray(typed,[amount,4]);canvas.width=width,canvas.height=height;var ctx=canvas.getContext("2d");ctx.drawImage(img,0,0,width,height),drawFeatures.fromBuffer(ctx,ndbuffer,0,0,1,{markSize:markSize})},wheel:function(e){var canvas=this.get("element"),currentWidth=this.$().width(),currentHeight=this.$().height(),speed=.04,nextWidth=currentWidth*(e.deltaY<0?1+speed:1-speed),nextHeight=currentHeight*(e.deltaY<0?1+speed:1-speed);nextWidth>=canvas.width?jQuery(canvas).css("width",canvas.width).css("height",canvas.height):nextWidth>500&&jQuery(canvas).css("width",nextWidth).css("height",nextHeight)}})},{"../../visualization/features.js":96,"../mixins/DragZoom.js":65,ndarray:16}],53:[function(require,module){var _=require("underscore"),ndarray=require("ndarray"),la=require("sylvester"),Matrix=la.Matrix,DragZoomMixin=(la.Vector,require("../mixins/DragZoom.js")),utils=require("../utils.js"),settings=require("../settings.js"),visualMatches=require("../../visualization/matches.js"),randomUtils=require("../../utils/random.js"),RESOURCE=settings.RESOURCE;module.exports=Ember.Component.extend(DragZoomMixin,{tagName:"canvas",resource:null,data:null,preRender:function(){var _self=this,resource=this.get("resource"),from=this.get("data.from"),to=this.get("data.to");Promise.all([resource.promiseResource(RESOURCE.FULLIMAGES,from).then(utils.promiseBufferImage),resource.promiseResource(RESOURCE.FULLIMAGES,to).then(utils.promiseBufferImage),resource.promiseResource(RESOURCE.FEATURE_POINTS,from),resource.promiseResource(RESOURCE.FEATURE_POINTS,to)]).then(function(results){var img1=results[0],img2=results[1],points1=new Float32Array(results[2]),points2=new Float32Array(results[3]);_self.set("img1",img1),_self.set("img2",img2),_self.set("points1",ndarray(points1,[points1.length/4,4])),_self.set("points2",ndarray(points2,[points2.length/4,4])),_self.drawContent()})}.on("didInsertElement").observes("data.from","data.to"),drawContent:function(){switch(this.get("mode")){case"epipolar":this.drawRobust();break;case"robust":this.drawMatches(this.get("data.robust"));break;case"raw":this.drawMatches(this.get("data.raw"));break;default:throw"Invalid visual matches mode!"}}.observes("mode"),drawRobust:function(){var robust=this.get("data.robust"),F=Matrix.create(this.get("data.F")),img1=this.get("img1"),img2=this.get("img2"),points1=this.get("points1"),points2=this.get("points2"),canv=this.get("element"),ctx=canv.getContext("2d"),config=visualMatches.drawImagePair(img1,img2,canv,1500);_.sample(robust,50).forEach(function(match){var i1=match[0],i2=match[1],pair=[{row:points1.get(i1,0),col:points1.get(i1,1)},{row:points2.get(i2,0),col:points2.get(i2,1)}];visualMatches.drawDetailedMatches(ctx,config,F,pair,randomUtils.genRGBString(),img1,img2)})},drawMatches:function(matches){var img1=this.get("img1"),img2=this.get("img2"),points1=this.get("points1"),points2=this.get("points2"),canv=this.get("element"),ctx=canv.getContext("2d"),config=visualMatches.drawImagePair(img1,img2,canv,1500);visualMatches.drawMatches(config,ctx,matches,points1,points2)},wheel:function(e){var canvas=this.get("element"),currentWidth=this.$().width(),currentHeight=this.$().height(),speed=.04,nextWidth=currentWidth*(e.deltaY<0?1+speed:1-speed),nextHeight=currentHeight*(e.deltaY<0?1+speed:1-speed);nextWidth>=canvas.width?jQuery(canvas).css("width",canvas.width).css("height",canvas.height):nextWidth>500&&jQuery(canvas).css("width",nextWidth).css("height",nextHeight)}})},{"../../utils/random.js":94,"../../visualization/matches.js":97,"../mixins/DragZoom.js":65,"../settings.js":87,"../utils.js":89,ndarray:16,sylvester:19,underscore:26}],54:[function(require,module){"use strict";module.exports=Ember.Component.extend({workspace:null,tagName:"aside",elementId:"controll-panel",expandInput:!0,expandProgress:!0,expandRegister:!0,expandStereo:!0,actions:{close:function(){this.get("workspace").send("back")},enter:function(target){this.get("workspace").send("enter",target)},toggleMenu:function(name){switch(name){case"input":this.toggleProperty("expandInput");break;case"progress":this.toggleProperty("expandProgress");break;case"register":this.toggleProperty("expandRegister");break;case"stereo":this.toggleProperty("expandStereo");break;default:throw"invalid menu toggle"}}}})},{}],55:[function(require,module){"use strict";var STAGES=require("../settings.js").STAGES;module.exports=Ember.Component.extend({workspace:null,expand:!1,actions:{toggleExpand:function(){this.toggleProperty("expand")}},description:function(){switch(this.get("workspace.model.stage")){case STAGES.BEFORE:return"Sturcture from Motion";case STAGES.EXTRACTOR:return"extracting SIFT features";case STAGES.MATCHING:return"matching features between two-views";case STAGES.TRACKING:return"tracking consistent tracks from matches";case STAGES.REGISTER:return"Calibrating Cameras";default:throw"invalid application stage"}}.property("workspace.stage")})},{"../settings.js":87}],56:[function(require,module){"use strict";module.exports=Ember.ObjectController.extend({needs:["scheduler","context"],ctx:Ember.computed.alias("controllers.context"),demos:Ember.computed.alias("ctx.demos"),projects:Ember.computed.alias("ctx.projects"),scheduler:Ember.computed.alias("controllers.scheduler"),isDetailClosed:!0})},{}],57:[function(require,module){"use strict";{var settings=require("../settings.js");settings.DEMO_ENTRY}module.exports=Ember.ObjectController.extend({needs:["context"],ctx:Ember.computed.alias("controllers.context")})
},{"../settings.js":87}],58:[function(require,module){"use strict";module.exports=Ember.Controller.extend({images:Ember.computed.alias("model"),actions:{expand:function(model){this.transitionToRoute("workspace.extractor.image",model)}}})},{}],59:[function(require,module){"use strict";var utils=require("../utils.js"),settings=require("../settings.js"),RESOURCE=settings.RESOURCE;module.exports=Ember.ObjectController.extend({needs:["workspace","projectResource"],resource:Ember.computed.alias("controllers.projectResource"),img:null,features:null,isLoading:!0,actions:{back:function(){this.transitionToRoute("workspace.extractor")}},onNewImage:function(){this.set("isLoading",!0);var _self=this,resource=this.get("resource");return Promise.all([resource.promiseResource(RESOURCE.FULLIMAGES,_self.get("model")).then(utils.promiseBufferImage),resource.promiseResource(RESOURCE.FEATURE_POINTS,_self.get("model"))]).then(function(results){_self.setProperties({img:results[0],features:results[1],isLoading:!1})})}.observes("model")})},{"../settings.js":87,"../utils.js":89}],60:[function(require,module){"use strict";var Image=require("../models/Image.js");module.exports=Ember.Controller.extend({needs:["workspace"],adapter:Ember.computed.alias("controllers.workspace.adapter"),project:Ember.computed.alias("controllers.workspace.project"),images:Ember.computed.alias("model"),queue:[],canImport:function(){return!this.get("project.isDemo")}.property("project.isDemo"),actions:{expand:function(model){this.transitionToRoute("workspace.images.detail",model)}},inProgress:function(){return 0!==this.get("queue.length")}.property("queue.length"),importImageFile:function(file){var _self=this,adapter=this.get("adapter"),queue=this.get("queue");queue.addObject(file),adapter.processImageFile(file).then(function(image){queue.removeObject(file),_self.get("model").pushObject(Image.create(image))})}})},{"../models/Image.js":67}],61:[function(require,module){"use strict";module.exports=Ember.Controller.extend({needs:["projectResource"],resource:Ember.computed.alias("controllers.projectResource"),actions:{back:function(){this.transitionToRoute("workspace.images")}}})},{}],62:[function(require,module){"use strict";module.exports=Ember.Controller.extend({images:Ember.computed.alias("model.images"),raw:Ember.computed.alias("model.raw"),robust:Ember.computed.alias("model.robust"),actions:{enter:function(param){this.transitionToRoute("workspace.matcher.pair",{queryParams:param})}}})},{}],63:[function(require,module){"use strict";module.exports=Ember.Controller.extend({needs:["projectResource"],resource:Ember.computed.alias("controllers.projectResource"),queryParams:["from","to","mode"],mode:"epipolar",title:function(){return this.get("model.from.filename")+" to "+this.get("model.to.filename")}.property("from","to"),actions:{back:function(){this.transitionTo("workspace.matcher")}}})},{}],64:[function(require,module){"use strict";module.exports=Ember.Controller.extend({focus:null,actions:{focus:function(cam){this.set("focus",cam)}}})},{}],65:[function(require,module){module.exports=Ember.Mixin.create({makeDrag:function(){this.$().draggable()}.on("didInsertElement"),registerWheel:function(){var _self=this;jQuery(this.get("element")).on("wheel",function(e){_self.wheel(e.originalEvent)})}.on("didInsertElement")})},{}],66:[function(require,module){"use strict";var settings=(require("underscore"),require("../settings.js")),ENTRIES=settings.DEMO_ENTRY,Project=require("./Project.js");module.exports=Project.extend({isDemo:!0,availableResources:[],root:null,entries:[],hasFeature:function(){return this.get("entries").contains(ENTRIES.FEATURE)}.property("entries"),hasMatch:function(){return this.get("entries").contains(ENTRIES.MATCH)}.property("entries"),hasCalibration:function(){return this.get("entries").contains(ENTRIES.CALIBRATION)}.property("entries"),hasMVS:function(){return this.get("entries").contains(ENTRIES.MVS)}.property("entries"),images:null})},{"../settings.js":87,"./Project.js":69,underscore:26}],67:[function(require,module){"use strict";module.exports=Ember.Object.extend({id:null,file:null,thumbnail:null,isReady:!0,width:null,height:null,filename:function(){return this.get("name")+this.get("extension")}.property("name","extension"),isHorizontal:function(){return this.get("width")>this.get("height")}.property("width","height")})},{}],68:[function(require,module){"use strict";var _=require("underscore"),shortcuts=require("../../utils/shortcuts.js");module.exports=Ember.Object.extend({images:[],matches:[],connectedGroups:function(){var groups=[];return this.get("matches").forEach(function(match){if(match.robust){var foundFrom=groups.find(function(e){return e.contains(match.from)}),foundTo=groups.find(function(e){return e.contains(match.to)});if(foundFrom&&foundTo)foundFrom!==foundTo&&(foundFrom.addObjects(foundTo),groups.removeObject(foundTo));else if(foundFrom||foundTo){var found=foundFrom||foundTo;found.addObjects([match.from,match.to])}else groups.push([match.from,match.to])}}),groups}.property("matches.length"),table:function(){var connected=this.get("connectedGroups"),images=this.get("images"),size=images.length,matches=this.get("matches"),table=shortcuts.array2d(size,size,!1);return connected.forEach(function(group){group.length>=2&&shortcuts.iterPairs(group,function(from,to){table[from][to]=table[to][from]=!0})}),images.forEach(function(img){var i=img.get("id");table[i][i]={isDiag:!0,image:img}}),matches.forEach(function(entry){var from=entry.from,to=entry.to;entry.hasRaw=!0,table[from][to]=table[to][from]=entry}),table}.property("matches.length","connectedGroups","images.length"),getMatches:function(i1,i2){var from=parseInt(i1,10),to=parseInt(i2,10);if(from>to)return this.getMatches(i2,i1);var images=this.get("images"),matches=this.get("matches"),img1=images.findBy("id",from),img2=images.findBy("id",to),data=_.find(matches,function(e){return e.from===from&&e.to===to});return img1&&img2&&data&&data.robust?{from:img1,to:img2,raw:data.raw,robust:data.robust,F:data.F}:void 0}})},{"../../utils/shortcuts.js":95,underscore:26}],69:[function(require,module){"use strict";var STAGES=require("../settings.js").STAGES;module.exports=Ember.Object.extend({name:null,images:null,finishedSIFT:[],siftFinished:function(){return this.get("images.length")===this.get("finishedSIFT.length")}.property("images.length","finishedSIFT.length"),bundlerFinished:!1,mvsFinished:!1,isFinished:function(){return this.get("siftFinished")&&this.get("bundlerFinished")&&this.get("mvsFinished")}.property("siftFinished","bundlerFinished","mvsFinished"),stage:STAGES.BEFORE,storedProperties:["name"]})},{"../settings.js":87}],70:[function(require,module){"use strict";var STATES=require("../settings.js").TASK_STATES;module.exports=Ember.Object.extend({state:STATES.UNASSIGNED,desc:"task",data:null,type:null,promise:null,progress:null,isDone:function(){return this.get("state")===STATES.FINISHED}.property("state")})},{"../settings.js":87}],71:[function(require,module){"use strict";module.exports=Ember.Object.extend({script:null,worker:null})},{}],72:[function(require,module){"use strict";module.exports=Ember.Route.extend({model:function(){return this.controllerFor("context").promiseProject()},afterModel:function(){this.transitionTo("workspace")},actions:{error:function(){this.transitionTo("welcome")}}})},{}],73:[function(require,module){"use strict";module.exports=Ember.Route.extend({setupController:function(){this.controllerFor("context").set("currentProject",null)}})},{}],74:[function(require,module){"use strict";module.exports=Ember.Route.extend({model:function(params){return this.controllerFor("context").get("demos").findBy("name",params.name)||Promise.reject()},serialize:function(model){return{name:model.get("name")}},actions:{error:function(){this.transitionTo("welcome")},didTransition:function(){this.controllerFor("welcome").set("isDetailClosed",!1)}}})},{}],75:[function(require,module){"use strict";module.exports=Ember.Route.extend({setupController:function(){this.controllerFor("welcome").set("isDetailClosed",!0)}})},{}],76:[function(require,module){"use strict";module.exports=Ember.Route.extend({model:function(){return this.controllerFor("context").promiseProject()},actions:{error:function(error,transition){transition.abort()}}})},{}],77:[function(require,module){"use strict";module.exports=Ember.Route.extend({model:function(){return this.controllerFor("workspace").get("images")}})},{}],78:[function(require,module){"use strict";module.exports=Ember.Route.extend({model:function(params){return this.modelFor("workspace.extractor").findBy("id",parseInt(params.id))},serialize:function(model){return{id:model.get("id")}}})},{}],79:[function(require,module){"use strict";module.exports=Ember.Route.extend({needs:["context"],adapter:Ember.computed.alias("context.adapter"),model:function(){return this.controllerFor("workspace").get("images")}})},{}],80:[function(require,module){"use strict";module.exports=Ember.Route.extend({model:function(params){return this.modelFor("workspace.images").findBy("id",parseInt(params.id))},serialize:function(model){return{id:model.get("id")}}})},{}],81:[function(require,module){"use strict";var Matches=require("../models/Matches.js"),settings=require("../settings.js"),RESOURCES=settings.RESOURCE;module.exports=Ember.Route.extend({model:function(){var resource=this.controllerFor("projectResource");return Promise.all([this.controllerFor("workspace").get("images"),resource.promiseResource(RESOURCES.MATCHES).catch(function(){return[]})]).then(function(results){return Matches.create({images:results[0],matches:results[1]})})}})},{"../models/Matches.js":68,"../settings.js":87}],82:[function(require,module){"use strict";module.exports=Ember.Route.extend({queryParams:{from:{refreshModel:!0},to:{refreshModel:!0}},model:function(params,transition){var match=this.modelFor("workspace.matcher").getMatches(params.from,params.to);return match?match:void transition.abort()},serialize:function(model){return{from:model.get("from.id"),to:model.get("to.id")}},actions:{error:function(error,transition){transition.abort()}}})},{}],83:[function(require,module){"use strict";var settings=require("../settings.js"),RESOURCES=settings.RESOURCE;module.exports=Ember.Route.extend({model:function(){var resources=this.controllerFor("projectResource");return Promise.all([resources.promiseResource(RESOURCES.MVS_POINTS),resources.promiseResource(RESOURCES.MVS_COLORS)]).then(function(results){var pointsArray=new Float32Array(results[0]),colorsArray=new Uint8Array(results[1]),size=pointsArray.length/3;return{points:pointsArray,colors:colorsArray,size:size}})}})},{"../settings.js":87}],84:[function(require,module){"use strict";var settings=require("../settings.js"),RESOURCES=settings.RESOURCE;module.exports=Ember.Route.extend({model:function(){var resources=this.controllerFor("projectResource");return Promise.all([resources.promiseResource(RESOURCES.SPARSE_POINTS),resources.promiseResource(RESOURCES.SPARSE_COLORS),resources.promiseResource(RESOURCES.CAMERAS)]).then(function(results){var pointsArray=new Float32Array(results[0]),colorsArray=new Uint8Array(results[1]),size=pointsArray.length/3;return{sparse:{points:pointsArray,colors:colorsArray,size:size},cameras:results[2]}})}})},{"../settings.js":87}],85:[function(require,module){"use strict";var Task=require("../models/Task.js"),settings=require("../settings.js"),STATES=settings.TASK_STATES,TASK_TYPES=settings.TASKS;module.exports=Ember.Controller.extend({messages:Ember.inject.service(),assign:function(url,datatype,desc){var messages=this.get("messages"),task=Task.create({desc:desc,data:{url:url,type:datatype},type:TASK_TYPES.DOWNLOAD}),msg={task:task};messages.notify(msg);var prom=new Promise(function(resolve,reject){function attempt(){request=new XMLHttpRequest,request.open("GET",url),request.onload=function(){200===request.status?complete():failed()},request.onerror=failed,request.ontimeout=retry,request.onabort=failed,request.onprogress=progress,request.responseType=datatype,request.send()}function complete(){terminate(),resolve(request.response)}function progress(evt){evt.lengthComputable&&task.setProperties({progress:Math.round(100*evt.loaded/evt.total)})}function failed(){terminate(),reject()}function retry(){attempt()}function terminate(){task.set("state",STATES.FINISHED),messages.get("queue").removeObject(msg)}var request;attempt()});return task.set("promise",prom),task}})},{"../models/Task.js":70,"../settings.js":87}],86:[function(require,module){module.exports=Ember.Service.extend({queue:[],notify:function(msg){this.get("queue").pushObject(msg)},resume:function(){var queue=this.get("queue");notifications.forEach(function(noti){var delaytime=1e3*noti.delay,name=noti.name;localStorage.getItem(name)||setTimeout(function(){queue.pushObject(noti.message),localStorage.setItem(name,"notified")},delaytime)})}.on("init")});var notifications=[{name:"incomplete",delay:5,message:{content:"WebSFM is still under construction, please try the demos, create new project won't work. More information on the welcome page."}},{name:"ptx",delay:20,message:{content:"I am looking for job, if you like this project, contact me."}}]},{}],87:[function(require,module){"use strict";module.exports.RESOURCE={FEATURES:"/sift.json",FEATURE_POINTS:"/feature.point",FEATURE_VECTORS:"/feature.vector",FULLIMAGES:"/images",IMAGES:"/images.json",MATCHES:"/matches.json",RAW_MATCHES:"/matches/matches.raw.json",ROBUST_MATCHES:"/matches/matches.robust.json",SPARSE:"/calibration/sparse.json",CAMERAS:"/cameras.json",SPARSE_POINTS:"/calibration/sparse.points",SPARSE_COLORS:"/calibration/sparse.colors",MVS_POINTS:"/mvs/surfels.points",MVS_COLORS:"/mvs/surfels.colors",SINGLETONS:"singletons"},module.exports.STAGES={BEFORE:0,EXTRACTOR:1,MATCHING:2,TRACKING:3,REGISTER:4,STEREO:5,MVS:6,AFTER:7},module.exports.STATES={RUNNING:0,STOPPED:1,DONE:2},module.exports.STORES={FEATURES:"features",FULLIMAGES:"fullimages",THUMBNAILS:"thumbnails",IMAGES:"images",MATCHES:"matches",SINGLETONS:"singletons",TRACKS:"tracks",VIEWS:"views",MVS:"mvs",BUNDLER:"bundler",MVS_POINTS:"mvs_points",MVS_COLORS:"mvs_colors"},module.exports.LOCAL_STORE={DEMOS:"demos",PROJECTS:"projects",PROJECT:"project"},module.exports.DEMO_ENTRY={IMAGE:"image",FEATURE:"feature",MATCH:"match",CALIBRATION:"calibration",MVS:"mvs"},module.exports.WORKER_MSG_TYPE={ASSIGN:0,ABORT:1,PROGRESS:2,ACK_ASSIGN:3,ACK_ABORT:4},module.exports.TASKS={SIFT:0,MATCHING:1,STEREO:2,TRACKING:3,DOWNLOAD:4},module.exports.TASK_STATES={UNASSIGNED:0,PENDING:1,RUNNING:2,FINISHED:3},module.exports.DOWNLOAD_THRESHOLD=5,module.exports.WORKER_SCRIPT="/build/worker.js",module.exports.WORKER_STATE={IDLE:0,BUSY:1}},{}],88:[function(require,module){"use strict";function StorageAdapter(projectName){this.project=projectName,this.connection=null}var _=require("underscore"),settings=require("../settings.js"),RESOURCE=(settings.STORES,settings.RESOURCE),utils=require("../utils.js");module.exports=StorageAdapter,StorageAdapter.prototype={close:function(){this.connection&&(this.connection.close(),delete this.connection)},promiseDB:function(){var _self=this;return this.connection?Promise.resolve(this.connection):new Promise(function(resolve,reject){var request=indexedDB.open(_self.project,30);request.onupgradeneeded=function(e){console.log("upgrade"),_self.connection=e.target.result,_self.createStores(_self.connection)},request.onsuccess=function(e){_self.connection=e.target.result,resolve(_self.connection)},request.onerror=function(reason){Ember.Logger.debug(reason),reject()}})},createStores:function(db){console.log("create"),db.objectStoreNames.contains(RESOURCE.IMAGES)||db.createObjectStore(RESOURCE.IMAGES,{autoIncrement:!0}).createIndex("name","name",{unique:!0}),[RESOURCE.FEATURE_POINTS,RESOURCE.FEATURE_VECTORS,RESOURCE.SINGLETONS,RESOURCE.FULLIMAGES,RESOURCE.ROBUST_MATCHES,RESOURCE.RAW_MATCHES].forEach(function(name){db.objectStoreNames.contains(name)||db.createObjectStore(name)})},processImageFile:function(file){var image,domimg,_self=this,domstring=URL.createObjectURL(file);return utils.promiseLoadImage(domstring).then(function(img){return domimg=img,image={filename:file.name,width:img.width,height:img.height,thumbnail:utils.getImageThumbnail(domimg)},_self.promiseAddData(RESOURCE.IMAGES,image)}).then(function(newid){return image.id=newid,utils.promiseFileBuffer(file)}).then(function(buffer){return _self.promiseSetData(RESOURCE.FULLIMAGES,image.id,buffer)}).then(function(){return image})},promiseData:function(store,key){var _self=this;return new Promise(function(resolve,reject){_self.promiseDB().then(function(db){db.transaction(store).objectStore(store).get(key).onsuccess=function(e){var result=e.target.result;_.isUndefined(result)?reject(result):resolve(result)}})})},promiseSetData:function(store,key,data){var _self=this;return new Promise(function(resolve){_self.promiseDB().then(function(db){var request=db.transaction(store,"readwrite").objectStore(store).put(data,key);request.onsuccess=function(e){resolve(e.target.result)},request.onerror=function(e){console.log(e)}})})},promiseAddData:function(store,data){var _self=this;return new Promise(function(resolve){_self.promiseDB().then(function(db){db.transaction(store,"readwrite").objectStore(store).add(data).onsuccess=function(e){resolve(e.target.result)}})})},promiseRemoveData:function(store,key){var _self=this;return new Promise(function(resolve){_self.promiseDB().then(function(db){db.transaction(store,"readwrite").objectStore(store).delete(key).onsuccess=function(){resolve(!0)}})})},promiseClear:function(store){var _self=this;return new Promise(function(resolve){_self.promiseDB().then(function(db){db.transaction(store,"readwrite").objectStore(store).clear().onsuccess=function(){resolve(!0)}})})},promiseFindBy:function(store,index,key){var _self=this;return new Promise(function(resolve,reject){_self.promiseDB().then(function(db){db.transaction(store).objectStore(store).index(index).get(key).onsuccess=function(e){var result=e.target.result;_.isUndefined(result)?reject(result):resolve(result)}})})},promiseAll:function(store){var _self=this;return new Promise(function(resolve){var results=[];_self.queryEach(store,function(key,value){results.push({key:key,value:value})},function(){resolve(results)})})},queryEach:function(name,callback,terminate){this.promiseDB().then(function(db){db.transaction(name).objectStore(name).openCursor().onsuccess=function(e){var cursor=e.target.result;cursor?(callback(cursor.key,cursor.value),cursor.continue()):terminate()}})}}},{"../settings.js":87,"../utils.js":89,underscore:26}],89:[function(require,module,exports){"use strict";var _=require("underscore");module.exports.promiseDownload=function(url,datatype){return new Promise(function(resolve,reject){var request=new XMLHttpRequest;request.open("GET",url),request.onload=function(){resolve(request.response)},request.onerror=reject,request.ontimeout=reject,request.onabort=reject,request.responseType=datatype,request.send()})},module.exports.getUUID=function(){return(new Date).getTime()},module.exports.promiseBlob=function(blob){return new Promise(function(resolve){var reader=new FileReader;reader.onload=function(){resolve(reader.result)},reader.readAsText(blob)})},module.exports.getLocalStorage=function(key){var result=localStorage.getItem(key);return null===result||void 0===result?null:JSON.parse(result)},module.exports.setLocalStorage=function(key,value){localStorage.setItem(key,JSON.stringify(value))},module.exports.promiseFileBuffer=function(file){return new Promise(function(resolve){var reader=new FileReader;reader.onload=function(){resolve(reader.result)},reader.readAsArrayBuffer(file)})},module.exports.promiseLoadImage=function(url){return new Promise(function(resolve,reject){var img=document.createElement("img");img.onload=function(){resolve(img)},img.onerror=reject,img.ontimeout=reject,img.onabort=reject,img.src=url})},module.exports.promiseBufferImage=function(buffer){var blob=new Blob([buffer]),domstring=URL.createObjectURL(blob);return exports.promiseLoadImage(domstring)},module.exports.promiseFileDataUrl=function(file){return new Promise(function(resolve){var reader=new FileReader;reader.onload=function(){resolve(reader.result)},reader.readAsDataURL(file)})},module.exports.getImageThumbnail=function(img){var canvas=document.createElement("canvas"),ctx=canvas.getContext("2d"),aspectRatio=img.width/img.height;return canvas.width=200,canvas.height=200,aspectRatio>1?ctx.drawImage(img,0,0,200*aspectRatio,200):ctx.drawImage(img,0,0,200,200*aspectRatio),canvas.toDataURL()},module.exports.promiseJSON=function(url){return new Promise(function(resolve,reject){jQuery.ajax({url:url,dataType:"json"}).done(resolve).fail(reject)})},module.exports.requireJSON=function(url){function promiseRetry(){return exports.promiseJSON(url).catch(promiseRetry)}return promiseRetry()},module.exports.requireImageFile=function(url){function promiseRetry(){return exports.promiseImageFile(url).catch(promiseRetry)}return promiseRetry()},module.exports.promiseImageFile=function(url){return new Promise(function(resolve,reject){var request=new XMLHttpRequest;request.open("GET",url),request.onload=function(){resolve(request.response)},request.onerror=reject,request.ontimeout=reject,request.onabort=reject,request.responseType="blob",request.send()})},module.exports.promiseScript=function(){},module.exports.promiseDelay=function(t){return new Promise(function(resolve){_.delay(function(){resolve()},t)})}},{underscore:26}],90:[function(require,module,exports){"use strict";function rotateX(angle){return Matrix.create([[1,0,0],[0,Math.cos(angle),-Math.sin(angle)],[0,Math.sin(angle),Math.cos(angle)]])}function rotateY(angle){return Matrix.create([[Math.cos(angle),0,Math.sin(angle)],[0,1,0],[-Math.sin(angle),0,Math.cos(angle)]])}function rotateZ(angle){return Matrix.create([[Math.cos(angle),-Math.sin(angle),0],[Math.sin(angle),Math.cos(angle),0],[0,0,1]])}var la=require("sylvester"),Matrix=la.Matrix,Vector=la.Vector,cord=require("../utils/cord.js");module.exports.getRotation=function(x,y,z){return rotateX(x).x(rotateY(y)).x(rotateZ(z))},module.exports.getRotationFromEuler=function(alpha,beta,gamma){return rotateZ(gamma).transpose().x(rotateX(beta).transpose()).x(rotateZ(alpha).transpose())},module.exports.getEulerAngles=function(R){var rotated,RR=R.transpose(),x=Vector.create([1,0,0]),y=Vector.create([0,1,0]),z=Vector.create([0,0,1]),X=RR.x(x),Z=(RR.x(y),RR.x(z)),N=Vector.create([1,-Z.e(1)/Z.e(2),0]),NN=Vector.create([1,-Z.e(1)/Z.e(2),0]).x(-1),alpha=Math.min(exports.getRightHandRotation([x.e(1),x.e(2)],[N.e(1),N.e(2)]),exports.getRightHandRotation([x.e(1),x.e(2)],[NN.e(1),NN.e(2)]));rotated=rotateZ(alpha).transpose();var zz=rotated.x(z),ZZ=rotated.x(Z),beta=exports.getRightHandRotation([zz.e(2),zz.e(3)],[ZZ.e(2),ZZ.e(3)]);rotated=rotateX(beta).transpose().x(rotated);var XX=rotated.x(X),gamma=exports.getRightHandRotation([x.e(1),x.e(2)],[XX.e(1),XX.e(2)]);return[alpha,beta,gamma]},module.exports.getRightHandRotation=function(fromV,toV){var x1=fromV[0],y1=fromV[1],x2=toV[0],y2=toV[1],fromAng=Math.atan2(y1,x1),toAng=Math.atan2(y2,x2);return toAng=toAng>=fromAng?toAng:toAng+2*Math.PI,toAng-fromAng},module.exports.getPoint2Line=function(point,line){var a=line.e(1),b=line.e(2),modulus=Math.sqrt(a*a+b*b)*point.e(3);return Math.abs(point.dot(line)/modulus)},module.exports.getDistanceRC=function(rc1,rc2){var dr=rc1.row-rc2.row,dc=rc1.col-rc2.col;return Math.sqrt(dr*dr+dc*dc)},module.exports.getNormalizedDist=function(rc1,rc2,cam){var dr=(rc1.row-rc2.row)/cam.height,dc=(rc1.col-rc2.col)/cam.width;return Math.sqrt(dr*dr+dc*dc)},module.exports.distHomo2D=function(p1,p2){return module.exports.getDistanceRC(cord.img2RC(p1),cord.img2RC(p2))}},{"../utils/cord.js":93,sylvester:19}],91:[function(require,module,exports){"use strict";var _=require("underscore"),la=require("sylvester"),Matrix=la.Matrix,Vector=la.Vector,numeric=require("numeric");exports.toVector=function(arr){return arr.sparse&&(arr=arr.toDenseVector()),Vector.create(arr)},exports.toMatrix=function(arr){return arr.sparse&&(arr=arr.toDense()),Matrix.create(arr)},module.exports.crossVector=function(v){return Matrix.create([[0,-v.e(3),v.e(2)],[v.e(3),0,-v.e(1)],[-v.e(2),v.e(1),0]])},module.exports.matrixInfiniteNorm=function(m){var row,col,cursor,rows=m.rows(),cols=m.cols(),max=-1/0;for(row=1;rows>=row;row++)for(col=1;cols>=col;col++)cursor=Math.abs(m.e(row,col)),cursor>max&&(max=cursor);return max},exports.sparseInfiniteNorm=function(m){var max=-1/0;return m.sparse[2].forEach(function(x){var cursor=Math.abs(x);cursor>max&&(max=cursor)}),max},module.exports.vectorInfiniteNorm=function(v){var max=-1/0;return v.each(function(x){var cursor=Math.abs(x);cursor>max&&(max=cursor)}),max},module.exports.svd=function(m){var usv=numeric.svd(m.elements);return{U:Matrix.create(usv.U),S:Vector.create(usv.S),V:Matrix.create(usv.V)}},module.exports.svdSolve=function(A){var solve=numeric.svd(A.elements),V=Matrix.create(solve.V);return V.col(A.cols())},module.exports.flattenMatrix=function(m){return Vector.create(_.flatten(m.elements))},module.exports.inflateVector=function(v,rows,cols){if(rows*cols!==v.elements.length)throw"dimensions does not match, can not inflate!";return Matrix.create(_.range(rows).map(function(row){return v.elements.slice(row*cols,row*cols+cols)}))},module.exports.normalizedMatrix=function(m){var row,col,cursor,rows=m.rows(),cols=m.cols(),memo=0;for(row=1;rows>=row;row++)for(col=1;cols>=col;col++)cursor=m.e(row,col),memo+=cursor*cursor;return m.x(1/Math.sqrt(memo))},module.exports.getFeatureDistance=function(f1,f2){var index,cursor,vector1=f1.vector,vector2=f2.vector,memo=0,range=f1.vector.length;for(index=0;range>index;index++)cursor=vector1[index]-vector2[index],memo+=cursor*cursor;return memo}},{numeric:18,sylvester:19,underscore:26}],92:[function(require,module,exports){"use strict";function normalizeMatrix(m){var modulus=Vector.create(_.flatten(m.elements)).modulus();return m.x(1/modulus)}var _=require("underscore"),la=require("sylvester"),Matrix=la.Matrix,Vector=la.Vector,geoUtils=require("./geometry-utils.js"),laUtils=require("./la-utils.js");exports.stored2calibrated=function(stored){var R=geoUtils.getRotationFromEuler.apply(null,stored.r),t=laUtils.toVector(stored.t),T=exports.Rt2T(R,t),K=exports.getK(stored.f,stored.px,stored.py),P=exports.KRt2P(K,R,t);return{K:K,R:R,t:t,T:T,P:P,focal:stored.f,px:stored.px,py:stored.py,cam:stored.shape}},exports.model2P=function(model){return exports.KRt2P(model.K,model.R,model.t)},exports.model2T=function(model){return exports.Rt2T(model.R,model.t)},exports.Rt2T=function(R,t){return R.transpose().x(t).x(-1)},exports.RT2t=function(R,T){return R.x(T).x(-1)},exports.params2model=function(params){return{K:exports.getK(params.f,params.px,params.py),R:geoUtils.getRotationFromEuler.apply(null,params.r),t:laUtils.toVector(params.t)}},exports.inflateCameraParams=function(params){return{r:params.slice(0,3),t:params.slice(3,6),f:params[6],px:params[7],py:params[8],k1:params[9],k2:params[10]}},exports.flattenCameraParams=function(cam){var r=cam.r,t=cam.t;return r.concat(t).concat([cam.f,cam.px,cam.py,cam.k1,cam.k2])},exports.getRelativePose=function(R1,t1,R2,t2){var R=R2.x(R1.transpose()),t=R.x(t1).x(-1).add(t2);return{R:R,t:t}},exports.getPerspective=function(R,t){return R.augment(t).transpose().augment(Vector.create([0,0,0,1])).transpose()},exports.getT=function(R,t){return R.transpose().x(t).x(-1)},exports.getEssentialMatrix=function(R1,t1,R2,t2){var pos=exports.getRelativePose(R1,t1,R2,t2),R=pos.R,t=pos.t,T=R.transpose().x(t).x(-1),Tx=Matrix.create([[0,-T.e(3),T.e(2)],[T.e(3),0,-T.e(1)],[-T.e(2),T.e(1),0]]),E=Tx.x(R.transpose());return normalizeMatrix(E)},exports.getCalibrationMatrix=function(focal,width,height){return laUtils.toMatrix([[focal,0,width/2],[0,focal,height/2],[0,0,1]])},exports.getK=function(focal,px,py){return laUtils.toMatrix([[focal,0,px],[0,focal,py],[0,0,1]])},exports.getProjectionMatrix=function(R,t,focal,width,height){var K=exports.getCalibrationMatrix(focal,width,height).augment(Vector.create([0,0,0])),P=R.augment(t).transpose().augment(Vector.create([0,0,0,1])).transpose();return K.x(P)},exports.getFundamentalMatrix=function(R1,t1,f1,cam1,R2,t2,f2,cam2){var E=exports.getEssentialMatrix(R1,t1,R2,t2),K1=exports.getCalibrationMatrix(f1,cam1.width,cam1.height),K2=exports.getCalibrationMatrix(f2,cam2.width,cam2.height),F=K1.transpose().inverse().x(E).x(K2.inverse());return normalizeMatrix(F)},exports.getDistortedProjection=function(R,t,K){return function(X){var P=R.x(X).add(t);return K.x(P)}},exports.params2P=function(cam){var r=cam.r,R=geoUtils.getRotationFromEuler(r[0],r[1],r[2]),t=laUtils.toVector(cam.t),K=exports.getK(cam.f,cam.px,cam.py);return exports.KRt2P(K,R,t)},exports.KRt2P=function(K,R,t){return K.x(R.augment(t))}},{"./geometry-utils.js":90,"./la-utils.js":91,sylvester:19,underscore:26}],93:[function(require,module,exports){"use strict";function rt2canvas(rt,width,height){var row=Math.round(rt.row),col=Math.round(rt.col);return row>=0&&col>=0&&height>=row&&width>=col?{row:row,col:col}:null}var la=require("sylvester"),Matrix=la.Matrix,Vector=la.Vector;module.exports.getStandardRt=function(R,t){return{R:BUNDLER_CONVERSION.x(R),t:BUNDLER_CONVERSION.x(t)}};var BUNDLER_CONVERSION=Matrix.create([[1,0,0],[0,-1,0],[0,0,-1]]);module.exports.rc2img=function(row,col){return[col,row,1]},module.exports.img2RC=function(point){return point=point.x(1/point.e(3)),{row:point.e(2),col:point.e(1)}},module.exports.featureToImg=function(f){return exports.rc2img(f.row,f.col)},module.exports.feature2img=function(f){return Vector.create(exports.rc2img(f.row,f.col))},module.exports.rc2x=function(f){return Vector.create(exports.rc2img(f.row,f.col))},module.exports.imgline2points=function(line,cam){var results=[],width=cam.width,height=cam.height,p00=Vector.create([0,0,1]),p01=Vector.create([0,height,1]),p11=Vector.create([width,height,1]),p10=Vector.create([width,0,1]);return[p00.cross(p01),p00.cross(p10),p01.cross(p11),p10.cross(p11)].map(function(edge){return edge.cross(line)}).forEach(function(point){var rt=rt2canvas(exports.img2RC(point),width,height);rt&&results.push(rt)}),results},module.exports.toHomo3D=function(p){return Vector.create([p.e(1),p.e(2),p.e(3),1])},module.exports.toInhomo3D=function(p){var deno=p.e(4);return Vector.create([p.e(1)/deno,p.e(2)/deno,p.e(3)/deno])}},{sylvester:19}],94:[function(require,module,exports){"use strict";var _=require("underscore"),la=require("sylvester"),Matrix=la.Matrix,Vector=la.Vector,ndarray=require("ndarray"),DEFAULT_CAMERA={width:3008,height:2e3};module.exports.getRandomImgCord=function(cam){return cam=cam||DEFAULT_CAMERA,Vector.create([Math.random()*cam.width,Math.random()*cam.height,1])},module.exports.getRandomRT=function(cam){return cam=cam||DEFAULT_CAMERA,{row:Math.random()*cam.height,col:Math.random()*cam.width}},module.exports.genRGBString=function(){function getInt(){return Math.floor(255*Math.random())}return"rgb("+getInt()+","+getInt()+","+getInt()+")"},module.exports.getRandomFeature=function(cam){return cam=cam||DEFAULT_CAMERA,{row:Math.floor(cam.height*Math.random()),col:Math.floor(cam.width*Math.random()),vector:_.range(128).map(function(){return Math.floor(128*Math.random())})}},module.exports.getRandomLinearEquationSet=function(solve,rows){var cols;return solve?cols=solve.elements.length:(cols=6+Math.floor(10*Math.random()),solve=Vector.Random(cols)),rows=rows||cols+4+Math.floor(10*Math.random()),Matrix.create(_.range(rows).map(function(){return module.exports.getRandomOrthogonalVector(solve).elements}))},module.exports.getRandomOrthogonalVector=function(v){var cursor,dims=v.elements.length,ind=Math.floor(dims*Math.random()),result=Vector.Random(dims),memo=0;for(cursor=0;dims>cursor;cursor++)cursor!=ind&&(memo+=v.elements[cursor]*result.elements[cursor]);return result.elements[ind]=-memo/v.elements[ind],result
},exports.genRandomVectorBuffer=function(length,width){var i,vi,tarr=new Uint8Array(length*width),buffer=ndarray(tarr,[length,width]);for(i=0;length>i;i++)for(vi=0;width>vi;vi++)buffer.set(i,vi,Math.round(255*Math.random()));return buffer}},{ndarray:16,sylvester:19,underscore:26}],95:[function(require,module,exports){"use strict";exports.zeros=function(length){var i,result=new Array(length);for(i=0;length>i;i++)result[i]=0;return result},exports.iterPairs=function(arr,callback){var length=arr.length;if(!(2>length)){var cur1,cur2,counter=0;for(cur1=0;length-1>cur1;cur1++)for(cur2=cur1+1;length>cur2;cur2++)callback(arr[cur1],arr[cur2],counter),counter++}},exports.array2d=function(s1,s2,v){var cur1,cur2,curArr,arr=new Array(s1);for(cur1=0;s1>cur1;cur1++)for(curArr=arr[cur1]=new Array(s2),cur2=0;s2>cur2;cur2++)curArr[cur2]=v;return arr}},{}],96:[function(require,module,exports){"use strict";var _=require("underscore");exports.fromBuffer=function(ctx,buffer,offsetX,offsetY,scale,options){scale=scale||1,options=options||{},_.defaults(options,{color:"red",markSize:3}),ctx.beginPath(),ctx.strokeStyle=options.color,ctx.lineWidth=options.markSize/2;var cursor,x,y,length=buffer.shape[0];for(cursor=0;length>cursor;cursor++)x=offsetX+scale*buffer.get(cursor,1),y=offsetY+scale*buffer.get(cursor,0),ctx.moveTo(x-options.markSize,y),ctx.lineTo(x+options.markSize,y),ctx.moveTo(x,y-options.markSize),ctx.lineTo(x,y+options.markSize);ctx.stroke()},exports.fromRC=function(ctx,features,offsetX,offsetY,scale,options){options=options||{},_.defaults(options,{color:"red",markSize:3}),ctx.beginPath(),ctx.strokeStyle=options.color,ctx.lineWidth=options.markSize/2,features.forEach(function(feature){var x=offsetX+scale*feature.col,y=offsetY+scale*feature.row;ctx.moveTo(x-options.markSize,y),ctx.lineTo(x+options.markSize,y),ctx.moveTo(x,y-options.markSize),ctx.lineTo(x,y+options.markSize)}),ctx.stroke()}},{underscore:26}],97:[function(require,module,exports){"use strict";function drawPoint(ctx,x,y){var markSize=7;ctx.moveTo(x-markSize,y),ctx.lineTo(x+markSize,y),ctx.moveTo(x,y-markSize),ctx.lineTo(x,y+markSize)}var la=(require("underscore"),require("sylvester")),drawFeatures=(la.Matrix,la.Vector,require("./features.js").fromBuffer),cord=require("../utils/cord.js");exports.drawImagePair=function(img1,img2,canvas,fixedWidth){var PADDING=10,heightV=img1.height/img1.width+img2.height/img2.width,widthH=img1.width/img1.height+img2.width/img2.height,alignV=(widthH>1?widthH:1/widthH)>2*(heightV>1?heightV:1/heightV),ratio1=alignV?fixedWidth/img1.width:(fixedWidth-PADDING)/widthH/img1.height,ratio2=alignV?fixedWidth/img2.width:(fixedWidth-PADDING)/widthH/img2.height;canvas.width=fixedWidth,canvas.height=alignV?heightV*fixedWidth:fixedWidth/widthH;var width1=img1.width*ratio1,height1=img1.height*ratio1,width2=img2.width*ratio2,height2=img2.height*ratio2,ctx=canvas.getContext("2d");ctx.clearRect(0,0,canvas.width,canvas.height),ctx.drawImage(img1,0,0,width1,height1),alignV?ctx.drawImage(img2,0,height1+PADDING,width2,height2):ctx.drawImage(img2,width1+PADDING,0,width2,height2);var offsetX,offsetY;return alignV?(offsetX=0,offsetY=img1.height*ratio1+PADDING):(offsetX=img1.width*ratio1+PADDING,offsetY=0),{alignX:alignV,ratio1:ratio1,ratio2:ratio2,padding:PADDING,offsetX:offsetX,offsetY:offsetY,cam1:{width:img1.width,height:img1.height},cam2:{width:img2.width,height:img2.height}}},exports.drawMatches=function(config,ctx,matches,features1,features2){var offsetX=config.offsetX,offsetY=config.offsetY;drawFeatures(ctx,features1,0,0,config.ratio1),drawFeatures(ctx,features2,offsetX,offsetY,config.ratio2,{color:"green"}),ctx.beginPath(),ctx.strokeStyle="black",ctx.lineWidth=1,matches.forEach(function(match){var i1=match[0],i2=match[1],row1=features1.get(i1,0),col1=features1.get(i1,1),row2=features2.get(i2,0),col2=features2.get(i2,1),x1=config.ratio1*col1,y1=config.ratio1*row1,x2=config.ratio2*col2+offsetX,y2=config.ratio2*row2+offsetY;ctx.moveTo(x1,y1),ctx.lineTo(x2,y2)}),ctx.stroke()},exports.drawDetailedMatches=function(ctx,config,F,pair,color,cam1,cam2){var f1=pair[0],f2=pair[1],p1=cord.rc2x(f1),p2=cord.rc2x(f2),line1=cord.imgline2points(F.x(p2),cam1),line2=cord.imgline2points(F.transpose().x(p1),cam2);2===line1.length&&2===line2.length&&(ctx.beginPath(),ctx.strokeStyle=color,ctx.lineWidth=2,ctx.moveTo(line1[0].col*config.ratio1,line1[0].row*config.ratio1),ctx.lineTo(line1[1].col*config.ratio1,line1[1].row*config.ratio1),ctx.moveTo(line2[0].col*config.ratio2+config.offsetX,line2[0].row*config.ratio2+config.offsetY),ctx.lineTo(line2[1].col*config.ratio2+config.offsetX,line2[1].row*config.ratio2+config.offsetY),ctx.stroke(),ctx.beginPath(),ctx.strokeStyle=color,ctx.lineWidth=5,drawPoint(ctx,config.ratio1*f1.col,config.ratio1*f1.row),drawPoint(ctx,config.offsetX+config.ratio2*f2.col,config.offsetY+config.ratio2*f2.row),ctx.stroke())}},{"../utils/cord.js":93,"./features.js":96,sylvester:19,underscore:26}],98:[function(require,module,exports){"use strict";function array2glvector(elements){return new THREE.Vector3(elements[0],elements[1],elements[2])}var THREE=require("three"),la=require("sylvester"),laUtils=(la.Matrix,la.Vector,require("../math/la-utils.js"));exports.getCoordinateFrame=function(){var axisGeo=new THREE.Geometry;axisGeo.vertices=[new THREE.Vector3(0,0,0),new THREE.Vector3(500,0,0),new THREE.Vector3(0,0,0),new THREE.Vector3(0,500,0),new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,500)];var axisMaterial=new THREE.LineBasicMaterial({color:4605510});return new THREE.Line(axisGeo,axisMaterial,THREE.LinePieces)},exports.getCameraFrame=function(camera){var R=camera.R,t=camera.t,focal=camera.focal,height=camera.cam.height,width=camera.cam.width,px=camera.px,py=camera.py,camMaterial=new THREE.LineBasicMaterial({color:16711680}),Ri=R.transpose(),T=Ri.x(t).x(-1),ratio=1/focal,offset=laUtils.toVector([px,py,0]),c1=laUtils.toVector([width,height,focal]).subtract(offset).x(ratio),c2=laUtils.toVector([width,0,focal]).subtract(offset).x(ratio),c3=laUtils.toVector([0,0,focal]).subtract(offset).x(ratio),c4=laUtils.toVector([0,height,focal]).subtract(offset).x(ratio),corner1=Ri.x(c1.subtract(t)),corner2=Ri.x(c2.subtract(t)),corner3=Ri.x(c3.subtract(t)),corner4=Ri.x(c4.subtract(t)),camPosition=array2glvector(T.elements),corner1Position=array2glvector(corner1.elements),corner2Position=array2glvector(corner2.elements),corner3Position=array2glvector(corner3.elements),corner4Position=array2glvector(corner4.elements),camerasGeo=new THREE.Geometry;return camerasGeo.vertices=[camPosition,corner1Position,camPosition,corner2Position,camPosition,corner3Position,camPosition,corner4Position,corner1Position,corner2Position,corner2Position,corner3Position,corner3Position,corner4Position,corner4Position,corner1Position],new THREE.Line(camerasGeo,camMaterial,THREE.LinePieces)}},{"../math/la-utils.js":91,sylvester:19,three:113}],99:[function(require,module){function fortranArrayToJSMatrix(fortranArray,m,n){for(var a,array=[],columnOffset=m*elementSize,i=0;m>i;i++){for(var row=[],rowStart=i*elementSize,j=0;n>j;j++)a=fortranArray.seek(columnOffset*j+rowStart),row.push(a.getFloat());array.push(row)}return array}function jsMatrixToFortranArray(array){for(var m=array.length,n=array[0].length,fortranArrayStart=fortranArray=new FFI.Pointer(m*n*elementSize),j=0;n>j;j++)for(var i=0;m>i;i++)fortranArray.putFloat(array[i][j]),fortranArray=fortranArray.seek(elementSize);return fortranArrayStart}function fortranArrayToJSArray(fortranArray,n){for(var array=[],i=0;n>i;i++)array.push(fortranArray.getFloat()),fortranArray=fortranArray.seek(elementSize);return array}function fortranIntArrayToJSArray(fortranArray,n){for(var array=[],i=0;n>i;i++)array.push(fortranArray.getInt32()),fortranArray=fortranArray.seek(4);return array}var FFI=require("node-ffi"),elementSize=4;module.exports.fortranArrayToJSMatrix=fortranArrayToJSMatrix,module.exports.jsMatrixToFortranArray=jsMatrixToFortranArray,module.exports.fortranArrayToJSArray=fortranArrayToJSArray,module.exports.fortranIntArrayToJSArray=fortranIntArrayToJSArray},{"node-ffi":106}],100:[function(require,module,exports){var lapack=require("./lapack.js");exports.sgeqrf=lapack.sgeqrf,exports.sgesvd=lapack.sgesvd,exports.qr=lapack.qr,exports.lu=lapack.lu,exports.sgetrf=lapack.sgetrf,exports.sgesv=lapack.sgesv},{"./lapack.js":101}],101:[function(require,module,exports){function eye(m){for(var matrix=[],i=0;m>i;i++){var row=[];matrix.push(row);for(var j=0;m>j;j++)row.push(i==j?1:0)}return matrix}function matrixOp(matrix,callback){var m=matrix.length,n=matrix[0].length,f_m=new FFI.Pointer(FORTRAN_INT),f_n=new FFI.Pointer(FORTRAN_INT),f_a=fortranArray.jsMatrixToFortranArray(matrix),f_lda=new FFI.Pointer(FORTRAN_INT);f_m.putInt32(m),f_n.putInt32(n),f_lda.putInt32(Math.max(1,m)),callback(m,n,f_m,f_n,f_a,f_lda)}function zeroBottomLeft(matrix){for(var i=1;i<matrix.length;i++)for(var j=0;i>j&&j<matrix[0].length;j++)matrix[i][j]=0;return matrix}function sgesv(a,b){var f_info=new FFI.Pointer(FORTRAN_INT),result={};return matrixOp(a,function(am,an,af_m,af_n,f_a){var f_ipiv=new FFI.Pointer(am*FORTRAN_INT);matrixOp(b,function(bm,bn,bf_m,bf_n,f_b){LAPACK.sgesv_(af_m,bf_n,f_a,af_n,f_ipiv,f_b,bf_m,f_info),result.X=fortranArray.fortranArrayToJSMatrix(f_b,bm,bn),result.P=ipivToP(bm,fortranArray.fortranIntArrayToJSArray(f_ipiv,bm))})}),result}function qr(matrix){var result;return sgeqrf(matrix,function(qr,m,n,f_m,f_n,f_a,f_lda,f_tau,f_work,f_lwork,f_info){var f_k=new FFI.Pointer(FORTRAN_INT);f_k.putInt32(Math.min(m,n)),LAPACK.sorgqr_(f_m,f_n,f_k,f_a,f_lda,f_tau,f_work,f_lwork,f_info),qr.Q=fortranArray.fortranArrayToJSMatrix(f_a,m,n),qr.R=zeroBottomLeft(qr.R),result=qr}),result}function sgeqrf(matrix,callback){var qr;return matrixOp(matrix,function(m,n,f_m,f_n,f_a,f_lda){var f_work,f_tau=new FFI.Pointer(m*n*FORTRAN_FLOAT),f_info=new FFI.Pointer(FORTRAN_INT),f_lwork=new FFI.Pointer(FORTRAN_INT);f_lwork.putInt32(-1),f_work=new FFI.Pointer(FORTRAN_INT),LAPACK.sgeqrf_(f_m,f_n,f_a,f_lda,f_tau,f_work,f_lwork,f_info),lwork=f_work.getFloat(),f_work=new FFI.Pointer(lwork*FORTRAN_FLOAT),f_lwork.putInt32(lwork),LAPACK.sgeqrf_(f_m,f_n,f_a,f_lda,f_tau,f_work,f_lwork,f_info),qr={R:fortranArray.fortranArrayToJSMatrix(f_a,m,n),tau:fortranArray.fortranArrayToJSArray(f_tau,Math.min(m,n))},callback&&(qr=callback(qr,m,n,f_m,f_n,f_a,f_lda,f_tau,f_work,f_lwork,f_info))}),qr}function cloneMatrix(matrix,height,width){var clone=[];height=height||matrix.length,width=width||matrix[0].length;for(var i=0;height>i;i++){var row=[];clone.push(row);for(var j=0;width>j;j++)row.push(matrix[i][j])}return clone}function swapRows(matrix,i,j){var tmp=matrix[j];return matrix[j]=matrix[i],matrix[i]=tmp,matrix}function lu(matrix){for(var result=sgetrf(matrix),P=ipivToP(matrix.length,result.IPIV),L=cloneMatrix(result.LU),i=(n=Math.min(matrix.length,matrix[0].length),0);i<L.length;i++)for(var j=i;j<L[i].length;j++)L[i][j]=i==j?1:0;return{L:L,U:zeroBottomLeft(cloneMatrix(result.LU,n,n)),P:P,IPIV:result.IPIV}}function ipivToP(m,ipiv){for(var P=eye(m),i=0;i<ipiv.length;i++)i!=ipiv[i]-1&&swapRows(P,i,ipiv[i]-1);return P}function sgetrf(matrix){var result={};return matrixOp(matrix,function(m,n,f_m,f_n,f_a){var f_ipiv=new FFI.Pointer(Math.min(m,n)*FORTRAN_INT),f_info=new FFI.Pointer(FORTRAN_INT);LAPACK.sgetrf_(f_m,f_n,f_a,f_m,f_ipiv,f_info),result.LU=fortranArray.fortranArrayToJSMatrix(f_a,m,n),result.IPIV=fortranArray.fortranIntArrayToJSArray(f_ipiv,Math.min(m,n))}),result}function sgesvd(jobu,jobvt,matrix){var f_jobu=new FFI.Pointer(FORTRAN_CHAR),f_jobvt=new FFI.Pointer(FORTRAN_CHAR);f_jobu.putChar(jobu.charCodeAt(0)),f_jobvt.putChar(jobvt.charCodeAt(0));var svd;return matrixOp(matrix,function(m,n,f_m,f_n,f_a,f_lda){var f_s=new FFI.Pointer(Math.pow(Math.min(m,n),2)*FORTRAN_FLOAT),f_u=new FFI.Pointer(Math.pow(m,2)*FORTRAN_FLOAT),f_ldu=new FFI.Pointer(FORTRAN_INT);f_ldu.putInt32(m);var f_vt=new FFI.Pointer(Math.pow(n,2)*FORTRAN_FLOAT),f_ldvt=new FFI.Pointer(FORTRAN_INT);f_ldvt.putInt32(n);var lwork=-1,f_work=new FFI.Pointer(FORTRAN_FLOAT),f_lwork=new FFI.Pointer(FORTRAN_INT);f_lwork.putInt32(lwork);var f_info=new FFI.Pointer(FORTRAN_INT);LAPACK.sgesvd_(f_jobu,f_jobvt,f_m,f_n,f_a,f_lda,f_s,f_u,f_ldu,f_vt,f_ldvt,f_work,f_lwork,f_info),lwork=f_work.getFloat(),f_work=new FFI.Pointer(lwork*FORTRAN_FLOAT),f_lwork.putInt32(lwork),LAPACK.sgesvd_(f_jobu,f_jobvt,f_m,f_n,f_a,f_lda,f_s,f_u,f_ldu,f_vt,f_ldvt,f_work,f_lwork,f_info),svd={U:fortranArray.fortranArrayToJSMatrix(f_u,m,m),S:fortranArray.fortranArrayToJSMatrix(f_s,n,n),VT:fortranArray.fortranArrayToJSMatrix(f_vt,n,n)}}),svd}var LAPACK,fortranArray=require("./fortranArray"),FFI=require("node-ffi");try{LAPACK=new FFI.Library("liblapack",{sgeqrf_:["void",["pointer","pointer","pointer","pointer","pointer","pointer","pointer","pointer"]],sorgqr_:["void",["pointer","pointer","pointer","pointer","pointer","pointer","pointer","pointer","pointer"]],sgesvd_:["void",["pointer","pointer","pointer","pointer","pointer","pointer","pointer","pointer","pointer","pointer","pointer","pointer","pointer","pointer"]],sgetrf_:["void",["pointer","pointer","pointer","pointer","pointer","pointer"]],sgesv_:["void",["pointer","pointer","pointer","pointer","pointer","pointer","pointer","pointer"]]})}catch(e){console.log("!!! node-lapack requires the native lapack to be built as a shared lib."),console.log(e)}var FORTRAN_INT=4,FORTRAN_CHAR=1,FORTRAN_FLOAT=4;exports.sgeqrf=sgeqrf,exports.sgesvd=sgesvd,exports.sgetrf=sgetrf,exports.sgesv=sgesv,exports.qr=qr,exports.lu=lu},{"./fortranArray":99,"node-ffi":106}],102:[function(require,module){function Callback(typedata,func){var retType=typedata[0],types=typedata[1];this._cif=new ffi.CIF(retType,types),this._info=new ffi.CallbackInfo(this._cif.getPointer(),function(retval,params){var pptr=params.clone(),args=types.map(function(type){return ffi.derefValuePtr(type,pptr.getPointer(!0))}),result=func.apply(null,args);"void"!==retType&&retval["put"+ffi.TYPE_TO_POINTER_METHOD_MAP[retType]](result)}),this.pointer=this._info.pointer}var ffi=require("./ffi");module.exports=Callback,Callback.prototype.getPointer=function(){return this.pointer}},{"./ffi":106}],103:[function(require,module){function CIF(rtype,types){if(!ffi.isValidReturnType(rtype))throw new Error("Invalid Return Type: "+rtype);var numArgs=types.length;this._argtypesptr=new ffi.Pointer(types.length*ffi.Bindings.FFI_TYPE_SIZE),this._rtypeptr=ffi.ffiTypeFor(rtype);for(var tptr=this._argtypesptr.clone(),i=0;numArgs>i;i++){var typeName=types[i];if(!ffi.isValidParamType(typeName))throw new Error("Invalid Type: "+typeName);var ffiType=ffi.ffiTypeFor(typeName);tptr.putPointer(ffiType,!0)}this.pointer=ffi.Bindings.prepCif(numArgs,this._rtypeptr,this._argtypesptr)}var ffi=require("./ffi");module.exports=CIF,CIF.prototype.getPointer=function(){return this.pointer}},{"./ffi":106}],104:[function(require,module){function DynamicLibrary(path,mode){if(this._handle=dlopen(path,mode||DynamicLibrary.FLAGS.RTLD_NOW),this._handle.isNull()){var match,err=this.error();if(match=err.match(/^(([^ \t()])+\.so([^ \t:()])*):([ \t])*invalid ELF header$/)){var content=read(match[1],"ascii");if(match=content.match(/GROUP *\( *(([^ )])+)/))return DynamicLibrary.call(this,match[1],mode)}throw new Error("Dynamic Linking Error: "+err)}}var ffi=require("./ffi"),read=require("fs").readFileSync,dlopen=ffi.ForeignFunction(ffi.Bindings.StaticFunctions.dlopen,"pointer",["string","int32"]),dlclose=ffi.ForeignFunction(ffi.Bindings.StaticFunctions.dlclose,"int32",["pointer"]),dlsym=ffi.ForeignFunction(ffi.Bindings.StaticFunctions.dlsym,"pointer",["pointer","string"]),dlerror=ffi.ForeignFunction(ffi.Bindings.StaticFunctions.dlerror,"string",[]);module.exports=DynamicLibrary,DynamicLibrary.FLAGS={RTLD_LAZY:1,RTLD_NOW:2,RTLD_LOCAL:4,RTLD_GLOBAL:8},DynamicLibrary.prototype.close=function(){return dlclose(this._handle)},DynamicLibrary.prototype.get=function(symbol){var ptr=dlsym(this._handle,symbol);if(ptr.isNull())throw new Error("Dynamic Symbol Retrieval Error: "+this.error());return ptr},DynamicLibrary.prototype.error=function(){return dlerror()}},{"./ffi":106,fs:5}],105:[function(require,module){(function(process){function errno(){return errnoPtr().getInt32()}var ffi=require("./ffi"),errnoPtr=null;if("darwin"==process.platform||"mac"==process.platform){var __error=(new ffi.DynamicLibrary).get("__error");errnoPtr=ffi.ForeignFunction(__error,"pointer",[])}else if("win32"==process.platform){var _errno=new ffi.DynamicLibrary("msvcrt.dll").get("_errno");errnoPtr=ffi.ForeignFunction(_errno,"pointer",[])}else{var errnoGlobal=(new ffi.DynamicLibrary).get("errno");errnoPtr=function(){return errnoGlobal}}module.exports=errno}).call(this,require("_process"))},{"./ffi":106,_process:13}],106:[function(require,module){function sizeof(type){return ffi.isStructType(type)?type.__structInfo__.size:ffi.Bindings.TYPE_SIZE_MAP[type]}function ffiTypeFor(type){return ffi.isStructType(type)?type._ffiType().ref():ffi.Bindings.FFI_TYPES[type]}function isStructType(type){return!!type.__isStructType__}var ffi=module.exports;ffi.Bindings=require("bindings")("ffi_bindings.node"),ffi.VERSION="0.5.0",ffi.TYPE_TO_POINTER_METHOD_MAP={uint8:"UInt8",int8:"Int8",uint8:"UInt8",int16:"Int16",uint16:"UInt16",int32:"Int32",uint32:"UInt32",int64:"Int64",uint64:"UInt64","float":"Float","double":"Double",string:"CString",pointer:"Pointer"},ffi.SIZE_TO_POINTER_METHOD_MAP={1:"Int8",2:"Int16",4:"Int32",8:"Int64"},ffi.PLATFORM_LIBRARY_EXTENSIONS={linux:".so",linux2:".so",sunos:".so",solaris:".so",darwin:".dylib",mac:".dylib",win32:".dll"},ffi.NON_SPECIFIC_TYPES={"byte":"Byte","char":"Char",uchar:"UChar","short":"Short",ushort:"UShort","int":"Int",uint:"UInt","long":"Long",ulong:"ULong",longlong:"LongLong",ulonglong:"ULongLong",size_t:"SizeT"},ffi.isValidParamType=function(type){return ffi.isStructType(type)||void 0!=ffi.Bindings.FFI_TYPES[type]},ffi.isValidReturnType=function(type){return ffi.isValidParamType(type)||"void"==type},ffi.derefValuePtr=function(type,ptr){if(!ffi.isValidParamType(type))throw new Error("Invalid Type: "+type);if(ffi.isStructType(type))return new type(ptr);if("void"==type)return null;var dptr=ptr;return"string"==type&&(dptr=ptr.getPointer(),dptr.isNull())?null:dptr["get"+ffi.TYPE_TO_POINTER_METHOD_MAP[type]]()},ffi.derefValuePtrFunc=function(type){if(!ffi.isValidParamType(type))throw new Error("Invalid Type: "+type);if(ffi.isStructType(type))return function(ptr){return new type(ptr)};if("void"==type)return function(){return null};var getf="get"+ffi.TYPE_TO_POINTER_METHOD_MAP[type];return"string"==type?function(ptr){var dptr=ptr.getPointer();return dptr.isNull()?null:dptr[getf]()}:function(ptr){return ptr[getf]()}},ffi.sizeOf=ffi.sizeof=sizeof,ffi.ffiTypeFor=ffiTypeFor,ffi.isStructType=isStructType,ffi.free=ffi.Bindings.free,ffi.CallbackInfo=ffi.Bindings.CallbackInfo,ffi.Pointer=require("./pointer"),ffi.CIF=require("./cif"),ffi.ForeignFunction=require("./foreign_function"),ffi.DynamicLibrary=require("./dynamic_library"),ffi.Library=require("./library"),ffi.Callback=require("./callback"),ffi.Struct=require("./struct"),ffi.errno=require("./errno"),ffi.FFI_TYPE=ffi.Struct([["size_t","size"],["ushort","alignment"],["ushort","type"],["pointer","elements"]])},{"./callback":102,"./cif":103,"./dynamic_library":104,"./errno":105,"./foreign_function":107,"./library":108,"./pointer":109,"./struct":110,bindings:111}],107:[function(require,module){(function(Buffer){function ForeignFunction(ptr,returnType,types,async){if(!(this instanceof ForeignFunction))return new ForeignFunction(ptr,returnType,types,async);var numArgs=types.length,drefVal=ffi.derefValuePtrFunc(returnType),result=new ffi.Pointer(ffi.sizeOf(returnType)),argsList=new ffi.Pointer(numArgs*POINTER_SIZE),cif=new ffi.CIF(returnType,types),caller=new ffi.Bindings.ForeignCaller(cif.getPointer(),ptr,argsList,result,async);this._=cif;var argputf=types.map(function(type,i){var argPtr=argsList.seek(i*POINTER_SIZE);if(ffi.isStructType(type))return function(val){argPtr.putPointer(val.ref())};var valPtr=new ffi.Pointer(ffi.sizeOf(type));if(argPtr.putPointer(valPtr),"string"==type)return function(val){var ptr=ffi.Pointer.NULL;if("undefined"!=typeof val&&null!==val){var len=Buffer.byteLength(val,"utf8");ptr=new ffi.Pointer(len+1),ptr.putCString(val)}valPtr.putPointer(ptr)};if("pointer"==type)return function(val){valPtr._putPointer(val)};var putCall="put"+ffi.TYPE_TO_POINTER_METHOD_MAP[type];return function(val){valPtr[putCall](val)}}),proxy=function(){if(arguments.length!==numArgs)throw new Error("Function arguments did not meet specification");for(var i=0;numArgs>i;i++)argputf[i](arguments[i]);var r=caller.exec();if(async){var emitter=new EventEmitter;return r.on("success",function(){emitter.emit("success",drefVal(result))}),emitter}return drefVal(result)};return proxy.getFunction=function(){return this},proxy}var ffi=require("./ffi"),EventEmitter=require("events").EventEmitter,POINTER_SIZE=ffi.Bindings.POINTER_SIZE;module.exports=ForeignFunction,ForeignFunction.build=ForeignFunction}).call(this,require("buffer").Buffer)},{"./ffi":106,buffer:6,events:10}],108:[function(require,module){(function(process){function Library(libfile,funcs){libfile&&-1===libfile.indexOf(EXT)&&(libfile+=EXT);var lib={},dl=new ffi.DynamicLibrary(libfile||null,RTLD_NOW);return funcs&&Object.keys(funcs).forEach(function(func){var fptr=dl.get(func),info=funcs[func];if(fptr.isNull())throw new Error('DynamicLibrary "'+libfile+'" returned NULL function pointer for "'+func+'"');var resultType=info[0],paramTypes=info[1],fopts=info[2],async=fopts?fopts.async:!1;lib[func]=ffi.ForeignFunction(fptr,resultType,paramTypes,async)}),lib}var ffi=require("./ffi"),EXT=ffi.PLATFORM_LIBRARY_EXTENSIONS[process.platform],RTLD_NOW=ffi.DynamicLibrary.FLAGS.RTLD_NOW;module.exports=Library}).call(this,require("_process"))},{"./ffi":106,_process:13}],109:[function(require,module){(function(Buffer){var ffi=require("./ffi"),util=require("util"),Pointer=module.exports=ffi.Bindings.Pointer;Pointer.prototype.attach=function(friend){Array.isArray(friend.__attached)||(friend.__attached=[]),friend.__attached.push(this)},Pointer.prototype.clone=function(){return this.seek(0)},Pointer.prototype.putPointer=function(ptr,seek){var p=ptr&&"pointer"in ptr?ptr.pointer:ptr;return this._putPointer(p,seek)},Pointer.prototype.inspect=function(depth,hidden,colors){return'<Pointer address="'+util.inspect(this.address,hidden,depth-1,colors)+'" allocated="'+util.inspect(this.allocated,hidden,depth-1,colors)+'" free="'+util.inspect(this.free,hidden,depth-1,colors)+'">'},Pointer.isPointer=function(p){return p instanceof Pointer},Pointer.alloc=function(type,value){var size="string"==type?Buffer.byteLength(value,"utf8")+1:ffi.sizeOf(type),ptr=new Pointer(size);if(ptr["put"+ffi.TYPE_TO_POINTER_METHOD_MAP[type]](value),"string"==type){var dptr=new ffi.Pointer(ffi.Bindings.TYPE_SIZE_MAP.pointer);return ptr.attach(dptr),dptr.putPointer(ptr),dptr}return ptr},Object.keys(ffi.NON_SPECIFIC_TYPES).forEach(function(type){var method=ffi.NON_SPECIFIC_TYPES[type],suffix=ffi.TYPE_TO_POINTER_METHOD_MAP[type];if(!suffix){var size=ffi.sizeOf(type),szFunc=ffi.SIZE_TO_POINTER_METHOD_MAP[size],signed="byte"!==type&&"size_t"!=type&&"u"!=type[0];suffix=(signed?"":"U")+szFunc}ffi.TYPE_TO_POINTER_METHOD_MAP[type]=suffix,Pointer.prototype["put"+method]=Pointer.prototype["put"+suffix],Pointer.prototype["get"+method]=Pointer.prototype["get"+suffix]}),Pointer.NULL=new Pointer(0)}).call(this,require("buffer").Buffer)},{"./ffi":106,buffer:6,util:15}],110:[function(require,module){(function(Buffer){function Struct(){function read(ptr,name){var info=struct.struct[name],fptr=ptr.seek(info.offset);return ffi.isStructType(info.type)?new info.type(fptr):"string"==info.type?fptr.getPointer().getCString():fptr["get"+ffi.TYPE_TO_POINTER_METHOD_MAP[info.type]]()}function write(ptr,name,val){var info=struct.struct[name],fptr=ptr.seek(info.offset);if(ffi.isStructType(info.type))new info.type(fptr,val);else{if("string"!=info.type)return fptr["put"+ffi.TYPE_TO_POINTER_METHOD_MAP[info.type]](val);if("undefined"==typeof val||null===val)return fptr.putPointer(ffi.Pointer.NULL);var len=Buffer.byteLength(val,"utf8"),strPtr=new ffi.Pointer(len+1);strPtr.putCString(val),fptr.putPointer(strPtr)}}var struct={},fields=arguments;if(arguments.length>0){var firstArg=arguments[0];Array.isArray(firstArg)&&firstArg.length>0&&Array.isArray(firstArg[0])&&(fields=firstArg)}struct.struct={},struct.members=[],struct.size=0,struct.alignment=0;for(var i=0,len=fields.length;len>i;i++){var field=fields[i],type=field[0],name=field[1];if(name in struct.struct)throw new Error("Error when constructing Struct: "+name+" field specified twice!");var stype=ffi.isStructType(type),sz=ffi.sizeOf(type),asz=stype?type.__structInfo__.alignment:sz;struct.alignment=Math.max(struct.alignment,asz);var left=struct.size%struct.alignment,offset=struct.size;sz>left&&(offset+=left),struct.size=offset+sz,struct.struct[name]={name:name,type:type,size:sz,offset:offset},struct.members.push(name)}var left=struct.size%struct.alignment;left&&(struct.size+=struct.alignment-left);var constructor=function(arg,data){if(!(this instanceof constructor))return new constructor(arg,data);if(ffi.Pointer.isPointer(arg)?(this.pointer=arg,arg=data):this.pointer=new ffi.Pointer(struct.size),arg)for(var key in arg)write(this.pointer,key,arg[key])};return constructor._ffiType=function(){if(this._ffiTypeCached)return this._ffiTypeCached;var props=this.__structInfo__.struct,propNames=Object.keys(props),numProps=propNames.length,t=new ffi.FFI_TYPE;t.size=0,t.alignment=0,t.type=13,t.elements=new ffi.Pointer(ffi.Bindings.POINTER_SIZE*(numProps+1));for(var tptr=t.elements.clone(),i=0;numProps>i;i++){var prop=props[propNames[i]];tptr.putPointer(ffi.ffiTypeFor(prop.type),!0)}return tptr.putPointer(ffi.Pointer.NULL),this._ffiTypeCached=t},struct.members.forEach(function(field){Object.defineProperty(constructor.prototype,field,{get:function(){return read(this.pointer,field)},set:function(val){write(this.pointer,field,val)},enumerable:!0,configurable:!0})}),1==constructor.prototype.__isStructInstance__,constructor.prototype.__structInfo__=struct,constructor.prototype.ref=function(){return this.pointer},constructor.__isStructType__=!0,constructor.__structInfo__=struct,constructor}var ffi=require("./ffi");module.exports=Struct}).call(this,require("buffer").Buffer)},{"./ffi":106,buffer:6}],111:[function(require,module,exports){(function(process,__filename){function bindings(opts){"string"==typeof opts?opts={bindings:opts}:opts||(opts={}),opts.__proto__=defaults,opts.module_root||(opts.module_root=exports.getRoot(exports.getFileName())),".node"!=path.extname(opts.bindings)&&(opts.bindings+=".node");for(var n,b,err,tries=[],i=0,l=opts.try.length;l>i;i++){n=join.apply(null,opts.try[i].map(function(p){return opts[p]||p})),tries.push(n);try{return b=opts.path?require.resolve(n):require(n),opts.path||(b.path=n),b}catch(e){if(!/not find/i.test(e.message))throw e}}throw err=new Error("Could not locate the bindings file. Tried:\n"+tries.map(function(a){return opts.arrow+a}).join("\n")),err.tries=tries,err}var fs=require("fs"),path=require("path"),join=path.join,dirname=path.dirname,exists=fs.existsSync||path.existsSync,defaults={arrow:process.env.NODE_BINDINGS_ARROW||" → ",compiled:process.env.NODE_BINDINGS_COMPILED_DIR||"compiled",platform:process.platform,arch:process.arch,version:process.versions.node,bindings:"bindings.node","try":[["module_root","build","bindings"],["module_root","build","Debug","bindings"],["module_root","build","Release","bindings"],["module_root","out","Debug","bindings"],["module_root","Debug","bindings"],["module_root","out","Release","bindings"],["module_root","Release","bindings"],["module_root","build","default","bindings"],["module_root","compiled","version","platform","arch","bindings"]]};module.exports=exports=bindings,exports.getFileName=function(calling_file){var fileName,origPST=Error.prepareStackTrace,origSTL=Error.stackTraceLimit,dummy={};return Error.stackTraceLimit=10,Error.prepareStackTrace=function(e,st){for(var i=0,l=st.length;l>i;i++)if(fileName=st[i].getFileName(),fileName!==__filename){if(!calling_file)return;if(fileName!==calling_file)return}},Error.captureStackTrace(dummy),dummy.stack,Error.prepareStackTrace=origPST,Error.stackTraceLimit=origSTL,fileName},exports.getRoot=function(file){for(var prev,dir=dirname(file);;){if("."===dir&&(dir=process.cwd()),exists(join(dir,"package.json"))||exists(join(dir,"node_modules")))return dir;if(prev===dir)throw new Error('Could not find module root given file: "'+file+'". Do you have a `package.json` file? ');prev=dir,dir=join(dir,"..")}}}).call(this,require("_process"),"/../../../node_modules/lapack/node_modules/node-ffi/node_modules/bindings/bindings.js")},{_process:13,fs:5,path:12}],112:[function(require,module){module.exports=function(THREE){function OrbitControls(object,domElement){function getAutoRotationAngle(){return 2*Math.PI/60/60*scope.autoRotateSpeed}function getZoomScale(){return Math.pow(.95,scope.zoomSpeed)}function onMouseDown(event){if(scope.enabled!==!1){if(event.preventDefault(),event.button===scope.mouseButtons.ORBIT){if(scope.noRotate===!0)return;state=STATE.ROTATE,rotateStart.set(event.clientX,event.clientY)}else if(event.button===scope.mouseButtons.ZOOM){if(scope.noZoom===!0)return;state=STATE.DOLLY,dollyStart.set(event.clientX,event.clientY)}else if(event.button===scope.mouseButtons.PAN){if(scope.noPan===!0)return;state=STATE.PAN,panStart.set(event.clientX,event.clientY)}state!==STATE.NONE&&(document.addEventListener("mousemove",onMouseMove,!1),document.addEventListener("mouseup",onMouseUp,!1),scope.dispatchEvent(startEvent))}}function onMouseMove(event){if(scope.enabled!==!1){event.preventDefault();var element=scope.domElement===document?scope.domElement.body:scope.domElement;if(state===STATE.ROTATE){if(scope.noRotate===!0)return;rotateEnd.set(event.clientX,event.clientY),rotateDelta.subVectors(rotateEnd,rotateStart),scope.rotateLeft(2*Math.PI*rotateDelta.x/element.clientWidth*scope.rotateSpeed),scope.rotateUp(2*Math.PI*rotateDelta.y/element.clientHeight*scope.rotateSpeed),rotateStart.copy(rotateEnd)}else if(state===STATE.DOLLY){if(scope.noZoom===!0)return;dollyEnd.set(event.clientX,event.clientY),dollyDelta.subVectors(dollyEnd,dollyStart),dollyDelta.y>0?scope.dollyIn():scope.dollyOut(),dollyStart.copy(dollyEnd)}else if(state===STATE.PAN){if(scope.noPan===!0)return;panEnd.set(event.clientX,event.clientY),panDelta.subVectors(panEnd,panStart),scope.pan(panDelta.x,panDelta.y),panStart.copy(panEnd)}state!==STATE.NONE&&scope.update()}}function onMouseUp(){scope.enabled!==!1&&(document.removeEventListener("mousemove",onMouseMove,!1),document.removeEventListener("mouseup",onMouseUp,!1),scope.dispatchEvent(endEvent),state=STATE.NONE)}function onMouseWheel(event){if(scope.enabled!==!1&&scope.noZoom!==!0&&state===STATE.NONE){event.preventDefault(),event.stopPropagation();var delta=0;void 0!==event.wheelDelta?delta=event.wheelDelta:void 0!==event.detail&&(delta=-event.detail),delta>0?scope.dollyOut():scope.dollyIn(),scope.update(),scope.dispatchEvent(startEvent),scope.dispatchEvent(endEvent)}}function onKeyDown(event){if(scope.enabled!==!1&&scope.noKeys!==!0&&scope.noPan!==!0)switch(event.keyCode){case scope.keys.UP:scope.pan(0,scope.keyPanSpeed),scope.update();break;case scope.keys.BOTTOM:scope.pan(0,-scope.keyPanSpeed),scope.update();break;case scope.keys.LEFT:scope.pan(scope.keyPanSpeed,0),scope.update();break;case scope.keys.RIGHT:scope.pan(-scope.keyPanSpeed,0),scope.update()}}function touchstart(event){if(scope.enabled!==!1){switch(event.touches.length){case 1:if(scope.noRotate===!0)return;state=STATE.TOUCH_ROTATE,rotateStart.set(event.touches[0].pageX,event.touches[0].pageY);break;case 2:if(scope.noZoom===!0)return;state=STATE.TOUCH_DOLLY;var dx=event.touches[0].pageX-event.touches[1].pageX,dy=event.touches[0].pageY-event.touches[1].pageY,distance=Math.sqrt(dx*dx+dy*dy);
dollyStart.set(0,distance);break;case 3:if(scope.noPan===!0)return;state=STATE.TOUCH_PAN,panStart.set(event.touches[0].pageX,event.touches[0].pageY);break;default:state=STATE.NONE}state!==STATE.NONE&&scope.dispatchEvent(startEvent)}}function touchmove(event){if(scope.enabled!==!1){event.preventDefault(),event.stopPropagation();var element=scope.domElement===document?scope.domElement.body:scope.domElement;switch(event.touches.length){case 1:if(scope.noRotate===!0)return;if(state!==STATE.TOUCH_ROTATE)return;rotateEnd.set(event.touches[0].pageX,event.touches[0].pageY),rotateDelta.subVectors(rotateEnd,rotateStart),scope.rotateLeft(2*Math.PI*rotateDelta.x/element.clientWidth*scope.rotateSpeed),scope.rotateUp(2*Math.PI*rotateDelta.y/element.clientHeight*scope.rotateSpeed),rotateStart.copy(rotateEnd),scope.update();break;case 2:if(scope.noZoom===!0)return;if(state!==STATE.TOUCH_DOLLY)return;var dx=event.touches[0].pageX-event.touches[1].pageX,dy=event.touches[0].pageY-event.touches[1].pageY,distance=Math.sqrt(dx*dx+dy*dy);dollyEnd.set(0,distance),dollyDelta.subVectors(dollyEnd,dollyStart),dollyDelta.y>0?scope.dollyOut():scope.dollyIn(),dollyStart.copy(dollyEnd),scope.update();break;case 3:if(scope.noPan===!0)return;if(state!==STATE.TOUCH_PAN)return;panEnd.set(event.touches[0].pageX,event.touches[0].pageY),panDelta.subVectors(panEnd,panStart),scope.pan(panDelta.x,panDelta.y),panStart.copy(panEnd),scope.update();break;default:state=STATE.NONE}}}function touchend(){scope.enabled!==!1&&(scope.dispatchEvent(endEvent),state=STATE.NONE)}this.object=object,this.domElement=void 0!==domElement?domElement:document,this.enabled=!0,this.target=new THREE.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:MOUSE.LEFT,ZOOM:MOUSE.MIDDLE,PAN:MOUSE.RIGHT};var theta,phi,scope=this,EPS=1e-6,rotateStart=new THREE.Vector2,rotateEnd=new THREE.Vector2,rotateDelta=new THREE.Vector2,panStart=new THREE.Vector2,panEnd=new THREE.Vector2,panDelta=new THREE.Vector2,panOffset=new THREE.Vector3,offset=new THREE.Vector3,dollyStart=new THREE.Vector2,dollyEnd=new THREE.Vector2,dollyDelta=new THREE.Vector2,phiDelta=0,thetaDelta=0,scale=1,pan=new THREE.Vector3,lastPosition=new THREE.Vector3,lastQuaternion=new THREE.Quaternion,STATE={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},state=STATE.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone();var quat=(new THREE.Quaternion).setFromUnitVectors(object.up,new THREE.Vector3(0,1,0)),quatInverse=quat.clone().inverse(),changeEvent={type:"change"},startEvent={type:"start"},endEvent={type:"end"};this.rotateLeft=function(angle){void 0===angle&&(angle=getAutoRotationAngle()),thetaDelta-=angle},this.rotateUp=function(angle){void 0===angle&&(angle=getAutoRotationAngle()),phiDelta-=angle},this.panLeft=function(distance){var te=this.object.matrix.elements;panOffset.set(te[0],te[1],te[2]),panOffset.multiplyScalar(-distance),pan.add(panOffset)},this.panUp=function(distance){var te=this.object.matrix.elements;panOffset.set(te[4],te[5],te[6]),panOffset.multiplyScalar(distance),pan.add(panOffset)},this.pan=function(deltaX,deltaY){var element=scope.domElement===document?scope.domElement.body:scope.domElement;if(void 0!==scope.object.fov){var position=scope.object.position,offset=position.clone().sub(scope.target),targetDistance=offset.length();targetDistance*=Math.tan(scope.object.fov/2*Math.PI/180),scope.panLeft(2*deltaX*targetDistance/element.clientHeight),scope.panUp(2*deltaY*targetDistance/element.clientHeight)}else void 0!==scope.object.top?(scope.panLeft(deltaX*(scope.object.right-scope.object.left)/element.clientWidth),scope.panUp(deltaY*(scope.object.top-scope.object.bottom)/element.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(dollyScale){void 0===dollyScale&&(dollyScale=getZoomScale()),scale/=dollyScale},this.dollyOut=function(dollyScale){void 0===dollyScale&&(dollyScale=getZoomScale()),scale*=dollyScale},this.update=function(){var position=this.object.position;offset.copy(position).sub(this.target),offset.applyQuaternion(quat),theta=Math.atan2(offset.x,offset.z),phi=Math.atan2(Math.sqrt(offset.x*offset.x+offset.z*offset.z),offset.y),this.autoRotate&&this.rotateLeft(getAutoRotationAngle()),theta+=thetaDelta,phi+=phiDelta,theta=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,theta)),phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,phi)),phi=Math.max(EPS,Math.min(Math.PI-EPS,phi));var radius=offset.length()*scale;radius=Math.max(this.minDistance,Math.min(this.maxDistance,radius)),this.target.add(pan),offset.x=radius*Math.sin(phi)*Math.sin(theta),offset.y=radius*Math.cos(phi),offset.z=radius*Math.sin(phi)*Math.cos(theta),offset.applyQuaternion(quatInverse),position.copy(this.target).add(offset),this.object.lookAt(this.target),thetaDelta=0,phiDelta=0,scale=1,pan.set(0,0,0),(lastPosition.distanceToSquared(this.object.position)>EPS||8*(1-lastQuaternion.dot(this.object.quaternion))>EPS)&&(this.dispatchEvent(changeEvent),lastPosition.copy(this.object.position),lastQuaternion.copy(this.object.quaternion))},this.reset=function(){state=STATE.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.update()},this.getPolarAngle=function(){return phi},this.getAzimuthalAngle=function(){return theta},this.domElement.addEventListener("contextmenu",function(event){event.preventDefault()},!1),this.domElement.addEventListener("mousedown",onMouseDown,!1),this.domElement.addEventListener("mousewheel",onMouseWheel,!1),this.domElement.addEventListener("DOMMouseScroll",onMouseWheel,!1),this.domElement.addEventListener("touchstart",touchstart,!1),this.domElement.addEventListener("touchend",touchend,!1),this.domElement.addEventListener("touchmove",touchmove,!1),window.addEventListener("keydown",onKeyDown,!1),this.update()}var MOUSE=THREE.MOUSE;return MOUSE||(MOUSE={LEFT:0,MIDDLE:1,RIGHT:2}),OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),OrbitControls.prototype.constructor=OrbitControls,OrbitControls}},{}],113:[function(require,module,exports){var self=self||{},THREE={REVISION:"68"};"object"==typeof module&&(module.exports=THREE),THREE.CullFaceNone=0,THREE.CullFaceBack=1,THREE.CullFaceFront=2,THREE.CullFaceFrontBack=3,THREE.FrontFaceDirectionCW=0,THREE.FrontFaceDirectionCCW=1,THREE.BasicShadowMap=0,THREE.PCFShadowMap=1,THREE.PCFSoftShadowMap=2,THREE.FrontSide=0,THREE.BackSide=1,THREE.DoubleSide=2,THREE.NoShading=0,THREE.FlatShading=1,THREE.SmoothShading=2,THREE.NoColors=0,THREE.FaceColors=1,THREE.VertexColors=2,THREE.NoBlending=0,THREE.NormalBlending=1,THREE.AdditiveBlending=2,THREE.SubtractiveBlending=3,THREE.MultiplyBlending=4,THREE.CustomBlending=5,THREE.AddEquation=100,THREE.SubtractEquation=101,THREE.ReverseSubtractEquation=102,THREE.ZeroFactor=200,THREE.OneFactor=201,THREE.SrcColorFactor=202,THREE.OneMinusSrcColorFactor=203,THREE.SrcAlphaFactor=204,THREE.OneMinusSrcAlphaFactor=205,THREE.DstAlphaFactor=206,THREE.OneMinusDstAlphaFactor=207,THREE.DstColorFactor=208,THREE.OneMinusDstColorFactor=209,THREE.SrcAlphaSaturateFactor=210,THREE.MultiplyOperation=0,THREE.MixOperation=1,THREE.AddOperation=2,THREE.UVMapping=function(){},THREE.CubeReflectionMapping=function(){},THREE.CubeRefractionMapping=function(){},THREE.SphericalReflectionMapping=function(){},THREE.SphericalRefractionMapping=function(){},THREE.RepeatWrapping=1e3,THREE.ClampToEdgeWrapping=1001,THREE.MirroredRepeatWrapping=1002,THREE.NearestFilter=1003,THREE.NearestMipMapNearestFilter=1004,THREE.NearestMipMapLinearFilter=1005,THREE.LinearFilter=1006,THREE.LinearMipMapNearestFilter=1007,THREE.LinearMipMapLinearFilter=1008,THREE.UnsignedByteType=1009,THREE.ByteType=1010,THREE.ShortType=1011,THREE.UnsignedShortType=1012,THREE.IntType=1013,THREE.UnsignedIntType=1014,THREE.FloatType=1015,THREE.UnsignedShort4444Type=1016,THREE.UnsignedShort5551Type=1017,THREE.UnsignedShort565Type=1018,THREE.AlphaFormat=1019,THREE.RGBFormat=1020,THREE.RGBAFormat=1021,THREE.LuminanceFormat=1022,THREE.LuminanceAlphaFormat=1023,THREE.RGB_S3TC_DXT1_Format=2001,THREE.RGBA_S3TC_DXT1_Format=2002,THREE.RGBA_S3TC_DXT3_Format=2003,THREE.RGBA_S3TC_DXT5_Format=2004,THREE.Color=function(color){return 3===arguments.length?this.setRGB(arguments[0],arguments[1],arguments[2]):this.set(color)},THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(value){return value instanceof THREE.Color?this.copy(value):"number"==typeof value?this.setHex(value):"string"==typeof value&&this.setStyle(value),this},setHex:function(hex){return hex=Math.floor(hex),this.r=(hex>>16&255)/255,this.g=(hex>>8&255)/255,this.b=(255&hex)/255,this},setRGB:function(r,g,b){return this.r=r,this.g=g,this.b=b,this},setHSL:function(h,s,l){if(0===s)this.r=this.g=this.b=l;else{var hue2rgb=function(p,q,t){return 0>t&&(t+=1),t>1&&(t-=1),1/6>t?p+6*(q-p)*t:.5>t?q:2/3>t?p+6*(q-p)*(2/3-t):p},p=.5>=l?l*(1+s):l+s-l*s,q=2*l-p;this.r=hue2rgb(q,p,h+1/3),this.g=hue2rgb(q,p,h),this.b=hue2rgb(q,p,h-1/3)}return this},setStyle:function(style){if(/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.test(style)){var color=/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.exec(style);return this.r=Math.min(255,parseInt(color[1],10))/255,this.g=Math.min(255,parseInt(color[2],10))/255,this.b=Math.min(255,parseInt(color[3],10))/255,this}if(/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.test(style)){var color=/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.exec(style);return this.r=Math.min(100,parseInt(color[1],10))/100,this.g=Math.min(100,parseInt(color[2],10))/100,this.b=Math.min(100,parseInt(color[3],10))/100,this}if(/^\#([0-9a-f]{6})$/i.test(style)){var color=/^\#([0-9a-f]{6})$/i.exec(style);return this.setHex(parseInt(color[1],16)),this}if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(style)){var color=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(style);return this.setHex(parseInt(color[1]+color[1]+color[2]+color[2]+color[3]+color[3],16)),this}return/^(\w+)$/i.test(style)?(this.setHex(THREE.ColorKeywords[style]),this):void 0},copy:function(color){return this.r=color.r,this.g=color.g,this.b=color.b,this},copyGammaToLinear:function(color){return this.r=color.r*color.r,this.g=color.g*color.g,this.b=color.b*color.b,this},copyLinearToGamma:function(color){return this.r=Math.sqrt(color.r),this.g=Math.sqrt(color.g),this.b=Math.sqrt(color.b),this},convertGammaToLinear:function(){var r=this.r,g=this.g,b=this.b;return this.r=r*r,this.g=g*g,this.b=b*b,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(optionalTarget){var hue,saturation,hsl=optionalTarget||{h:0,s:0,l:0},r=this.r,g=this.g,b=this.b,max=Math.max(r,g,b),min=Math.min(r,g,b),lightness=(min+max)/2;if(min===max)hue=0,saturation=0;else{var delta=max-min;switch(saturation=.5>=lightness?delta/(max+min):delta/(2-max-min),max){case r:hue=(g-b)/delta+(b>g?6:0);break;case g:hue=(b-r)/delta+2;break;case b:hue=(r-g)/delta+4}hue/=6}return hsl.h=hue,hsl.s=saturation,hsl.l=lightness,hsl},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(h,s,l){var hsl=this.getHSL();return hsl.h+=h,hsl.s+=s,hsl.l+=l,this.setHSL(hsl.h,hsl.s,hsl.l),this},add:function(color){return this.r+=color.r,this.g+=color.g,this.b+=color.b,this},addColors:function(color1,color2){return this.r=color1.r+color2.r,this.g=color1.g+color2.g,this.b=color1.b+color2.b,this},addScalar:function(s){return this.r+=s,this.g+=s,this.b+=s,this},multiply:function(color){return this.r*=color.r,this.g*=color.g,this.b*=color.b,this},multiplyScalar:function(s){return this.r*=s,this.g*=s,this.b*=s,this},lerp:function(color,alpha){return this.r+=(color.r-this.r)*alpha,this.g+=(color.g-this.g)*alpha,this.b+=(color.b-this.b)*alpha,this},equals:function(c){return c.r===this.r&&c.g===this.g&&c.b===this.b},fromArray:function(array){return this.r=array[0],this.g=array[1],this.b=array[2],this},toArray:function(){return[this.r,this.g,this.b]},clone:function(){return(new THREE.Color).setRGB(this.r,this.g,this.b)}},THREE.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},THREE.Quaternion=function(x,y,z,w){this._x=x||0,this._y=y||0,this._z=z||0,this._w=void 0!==w?w:1},THREE.Quaternion.prototype={constructor:THREE.Quaternion,_x:0,_y:0,_z:0,_w:0,get x(){return this._x},set x(value){this._x=value,this.onChangeCallback()},get y(){return this._y},set y(value){this._y=value,this.onChangeCallback()},get z(){return this._z},set z(value){this._z=value,this.onChangeCallback()},get w(){return this._w},set w(value){this._w=value,this.onChangeCallback()},set:function(x,y,z,w){return this._x=x,this._y=y,this._z=z,this._w=w,this.onChangeCallback(),this},copy:function(quaternion){return this._x=quaternion.x,this._y=quaternion.y,this._z=quaternion.z,this._w=quaternion.w,this.onChangeCallback(),this},setFromEuler:function(euler,update){if(euler instanceof THREE.Euler==!1)throw new Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var c1=Math.cos(euler._x/2),c2=Math.cos(euler._y/2),c3=Math.cos(euler._z/2),s1=Math.sin(euler._x/2),s2=Math.sin(euler._y/2),s3=Math.sin(euler._z/2);return"XYZ"===euler.order?(this._x=s1*c2*c3+c1*s2*s3,this._y=c1*s2*c3-s1*c2*s3,this._z=c1*c2*s3+s1*s2*c3,this._w=c1*c2*c3-s1*s2*s3):"YXZ"===euler.order?(this._x=s1*c2*c3+c1*s2*s3,this._y=c1*s2*c3-s1*c2*s3,this._z=c1*c2*s3-s1*s2*c3,this._w=c1*c2*c3+s1*s2*s3):"ZXY"===euler.order?(this._x=s1*c2*c3-c1*s2*s3,this._y=c1*s2*c3+s1*c2*s3,this._z=c1*c2*s3+s1*s2*c3,this._w=c1*c2*c3-s1*s2*s3):"ZYX"===euler.order?(this._x=s1*c2*c3-c1*s2*s3,this._y=c1*s2*c3+s1*c2*s3,this._z=c1*c2*s3-s1*s2*c3,this._w=c1*c2*c3+s1*s2*s3):"YZX"===euler.order?(this._x=s1*c2*c3+c1*s2*s3,this._y=c1*s2*c3+s1*c2*s3,this._z=c1*c2*s3-s1*s2*c3,this._w=c1*c2*c3-s1*s2*s3):"XZY"===euler.order&&(this._x=s1*c2*c3-c1*s2*s3,this._y=c1*s2*c3-s1*c2*s3,this._z=c1*c2*s3+s1*s2*c3,this._w=c1*c2*c3+s1*s2*s3),update!==!1&&this.onChangeCallback(),this},setFromAxisAngle:function(axis,angle){var halfAngle=angle/2,s=Math.sin(halfAngle);return this._x=axis.x*s,this._y=axis.y*s,this._z=axis.z*s,this._w=Math.cos(halfAngle),this.onChangeCallback(),this},setFromRotationMatrix:function(m){var s,te=m.elements,m11=te[0],m12=te[4],m13=te[8],m21=te[1],m22=te[5],m23=te[9],m31=te[2],m32=te[6],m33=te[10],trace=m11+m22+m33;return trace>0?(s=.5/Math.sqrt(trace+1),this._w=.25/s,this._x=(m32-m23)*s,this._y=(m13-m31)*s,this._z=(m21-m12)*s):m11>m22&&m11>m33?(s=2*Math.sqrt(1+m11-m22-m33),this._w=(m32-m23)/s,this._x=.25*s,this._y=(m12+m21)/s,this._z=(m13+m31)/s):m22>m33?(s=2*Math.sqrt(1+m22-m11-m33),this._w=(m13-m31)/s,this._x=(m12+m21)/s,this._y=.25*s,this._z=(m23+m32)/s):(s=2*Math.sqrt(1+m33-m11-m22),this._w=(m21-m12)/s,this._x=(m13+m31)/s,this._y=(m23+m32)/s,this._z=.25*s),this.onChangeCallback(),this},setFromUnitVectors:function(){var v1,r,EPS=1e-6;return function(vFrom,vTo){return void 0===v1&&(v1=new THREE.Vector3),r=vFrom.dot(vTo)+1,EPS>r?(r=0,Math.abs(vFrom.x)>Math.abs(vFrom.z)?v1.set(-vFrom.y,vFrom.x,0):v1.set(0,-vFrom.z,vFrom.y)):v1.crossVectors(vFrom,vTo),this._x=v1.x,this._y=v1.y,this._z=v1.z,this._w=r,this.normalize(),this}}(),inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(v){return this._x*v._x+this._y*v._y+this._z*v._z+this._w*v._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var l=this.length();return 0===l?(this._x=0,this._y=0,this._z=0,this._w=1):(l=1/l,this._x=this._x*l,this._y=this._y*l,this._z=this._z*l,this._w=this._w*l),this.onChangeCallback(),this},multiply:function(q,p){return void 0!==p?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(q,p)):this.multiplyQuaternions(this,q)},multiplyQuaternions:function(a,b){var qax=a._x,qay=a._y,qaz=a._z,qaw=a._w,qbx=b._x,qby=b._y,qbz=b._z,qbw=b._w;return this._x=qax*qbw+qaw*qbx+qay*qbz-qaz*qby,this._y=qay*qbw+qaw*qby+qaz*qbx-qax*qbz,this._z=qaz*qbw+qaw*qbz+qax*qby-qay*qbx,this._w=qaw*qbw-qax*qbx-qay*qby-qaz*qbz,this.onChangeCallback(),this},multiplyVector3:function(vector){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),vector.applyQuaternion(this)},slerp:function(qb,t){var x=this._x,y=this._y,z=this._z,w=this._w,cosHalfTheta=w*qb._w+x*qb._x+y*qb._y+z*qb._z;if(0>cosHalfTheta?(this._w=-qb._w,this._x=-qb._x,this._y=-qb._y,this._z=-qb._z,cosHalfTheta=-cosHalfTheta):this.copy(qb),cosHalfTheta>=1)return this._w=w,this._x=x,this._y=y,this._z=z,this;var halfTheta=Math.acos(cosHalfTheta),sinHalfTheta=Math.sqrt(1-cosHalfTheta*cosHalfTheta);if(Math.abs(sinHalfTheta)<.001)return this._w=.5*(w+this._w),this._x=.5*(x+this._x),this._y=.5*(y+this._y),this._z=.5*(z+this._z),this;var ratioA=Math.sin((1-t)*halfTheta)/sinHalfTheta,ratioB=Math.sin(t*halfTheta)/sinHalfTheta;return this._w=w*ratioA+this._w*ratioB,this._x=x*ratioA+this._x*ratioB,this._y=y*ratioA+this._y*ratioB,this._z=z*ratioA+this._z*ratioB,this.onChangeCallback(),this},equals:function(quaternion){return quaternion._x===this._x&&quaternion._y===this._y&&quaternion._z===this._z&&quaternion._w===this._w},fromArray:function(array){return this._x=array[0],this._y=array[1],this._z=array[2],this._w=array[3],this.onChangeCallback(),this},toArray:function(){return[this._x,this._y,this._z,this._w]},onChange:function(callback){return this.onChangeCallback=callback,this},onChangeCallback:function(){},clone:function(){return new THREE.Quaternion(this._x,this._y,this._z,this._w)}},THREE.Quaternion.slerp=function(qa,qb,qm,t){return qm.copy(qa).slerp(qb,t)},THREE.Vector2=function(x,y){this.x=x||0,this.y=y||0},THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(x,y){return this.x=x,this.y=y,this},setX:function(x){return this.x=x,this},setY:function(y){return this.y=y,this},setComponent:function(index,value){switch(index){case 0:this.x=value;break;case 1:this.y=value;break;default:throw new Error("index is out of range: "+index)}},getComponent:function(index){switch(index){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+index)}},copy:function(v){return this.x=v.x,this.y=v.y,this},add:function(v,w){return void 0!==w?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(v,w)):(this.x+=v.x,this.y+=v.y,this)},addVectors:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this},addScalar:function(s){return this.x+=s,this.y+=s,this},sub:function(v,w){return void 0!==w?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(v,w)):(this.x-=v.x,this.y-=v.y,this)},subVectors:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this},multiply:function(v){return this.x*=v.x,this.y*=v.y,this},multiplyScalar:function(s){return this.x*=s,this.y*=s,this},divide:function(v){return this.x/=v.x,this.y/=v.y,this},divideScalar:function(scalar){if(0!==scalar){var invScalar=1/scalar;this.x*=invScalar,this.y*=invScalar}else this.x=0,this.y=0;return this},min:function(v){return this.x>v.x&&(this.x=v.x),this.y>v.y&&(this.y=v.y),this},max:function(v){return this.x<v.x&&(this.x=v.x),this.y<v.y&&(this.y=v.y),this},clamp:function(min,max){return this.x<min.x?this.x=min.x:this.x>max.x&&(this.x=max.x),this.y<min.y?this.y=min.y:this.y>max.y&&(this.y=max.y),this},clampScalar:function(){var min,max;return function(minVal,maxVal){return void 0===min&&(min=new THREE.Vector2,max=new THREE.Vector2),min.set(minVal,minVal),max.set(maxVal,maxVal),this.clamp(min,max)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(v){return this.x*v.x+this.y*v.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(v){return Math.sqrt(this.distanceToSquared(v))},distanceToSquared:function(v){var dx=this.x-v.x,dy=this.y-v.y;return dx*dx+dy*dy},setLength:function(l){var oldLength=this.length();return 0!==oldLength&&l!==oldLength&&this.multiplyScalar(l/oldLength),this},lerp:function(v,alpha){return this.x+=(v.x-this.x)*alpha,this.y+=(v.y-this.y)*alpha,this},equals:function(v){return v.x===this.x&&v.y===this.y},fromArray:function(array){return this.x=array[0],this.y=array[1],this},toArray:function(){return[this.x,this.y]},clone:function(){return new THREE.Vector2(this.x,this.y)}},THREE.Vector3=function(x,y,z){this.x=x||0,this.y=y||0,this.z=z||0},THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(x,y,z){return this.x=x,this.y=y,this.z=z,this},setX:function(x){return this.x=x,this},setY:function(y){return this.y=y,this},setZ:function(z){return this.z=z,this},setComponent:function(index,value){switch(index){case 0:this.x=value;break;case 1:this.y=value;break;case 2:this.z=value;break;default:throw new Error("index is out of range: "+index)}},getComponent:function(index){switch(index){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+index)}},copy:function(v){return this.x=v.x,this.y=v.y,this.z=v.z,this},add:function(v,w){return void 0!==w?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(v,w)):(this.x+=v.x,this.y+=v.y,this.z+=v.z,this)},addScalar:function(s){return this.x+=s,this.y+=s,this.z+=s,this},addVectors:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this},sub:function(v,w){return void 0!==w?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(v,w)):(this.x-=v.x,this.y-=v.y,this.z-=v.z,this)},subVectors:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this},multiply:function(v,w){return void 0!==w?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(v,w)):(this.x*=v.x,this.y*=v.y,this.z*=v.z,this)},multiplyScalar:function(scalar){return this.x*=scalar,this.y*=scalar,this.z*=scalar,this},multiplyVectors:function(a,b){return this.x=a.x*b.x,this.y=a.y*b.y,this.z=a.z*b.z,this},applyEuler:function(){var quaternion;return function(euler){return euler instanceof THREE.Euler==!1&&console.error("THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order."),void 0===quaternion&&(quaternion=new THREE.Quaternion),this.applyQuaternion(quaternion.setFromEuler(euler)),this}}(),applyAxisAngle:function(){var quaternion;return function(axis,angle){return void 0===quaternion&&(quaternion=new THREE.Quaternion),this.applyQuaternion(quaternion.setFromAxisAngle(axis,angle)),this}}(),applyMatrix3:function(m){var x=this.x,y=this.y,z=this.z,e=m.elements;return this.x=e[0]*x+e[3]*y+e[6]*z,this.y=e[1]*x+e[4]*y+e[7]*z,this.z=e[2]*x+e[5]*y+e[8]*z,this},applyMatrix4:function(m){var x=this.x,y=this.y,z=this.z,e=m.elements;return this.x=e[0]*x+e[4]*y+e[8]*z+e[12],this.y=e[1]*x+e[5]*y+e[9]*z+e[13],this.z=e[2]*x+e[6]*y+e[10]*z+e[14],this},applyProjection:function(m){var x=this.x,y=this.y,z=this.z,e=m.elements,d=1/(e[3]*x+e[7]*y+e[11]*z+e[15]);return this.x=(e[0]*x+e[4]*y+e[8]*z+e[12])*d,this.y=(e[1]*x+e[5]*y+e[9]*z+e[13])*d,this.z=(e[2]*x+e[6]*y+e[10]*z+e[14])*d,this},applyQuaternion:function(q){var x=this.x,y=this.y,z=this.z,qx=q.x,qy=q.y,qz=q.z,qw=q.w,ix=qw*x+qy*z-qz*y,iy=qw*y+qz*x-qx*z,iz=qw*z+qx*y-qy*x,iw=-qx*x-qy*y-qz*z;return this.x=ix*qw+iw*-qx+iy*-qz-iz*-qy,this.y=iy*qw+iw*-qy+iz*-qx-ix*-qz,this.z=iz*qw+iw*-qz+ix*-qy-iy*-qx,this},transformDirection:function(m){var x=this.x,y=this.y,z=this.z,e=m.elements;return this.x=e[0]*x+e[4]*y+e[8]*z,this.y=e[1]*x+e[5]*y+e[9]*z,this.z=e[2]*x+e[6]*y+e[10]*z,this.normalize(),this},divide:function(v){return this.x/=v.x,this.y/=v.y,this.z/=v.z,this},divideScalar:function(scalar){if(0!==scalar){var invScalar=1/scalar;this.x*=invScalar,this.y*=invScalar,this.z*=invScalar}else this.x=0,this.y=0,this.z=0;return this},min:function(v){return this.x>v.x&&(this.x=v.x),this.y>v.y&&(this.y=v.y),this.z>v.z&&(this.z=v.z),this},max:function(v){return this.x<v.x&&(this.x=v.x),this.y<v.y&&(this.y=v.y),this.z<v.z&&(this.z=v.z),this},clamp:function(min,max){return this.x<min.x?this.x=min.x:this.x>max.x&&(this.x=max.x),this.y<min.y?this.y=min.y:this.y>max.y&&(this.y=max.y),this.z<min.z?this.z=min.z:this.z>max.z&&(this.z=max.z),this},clampScalar:function(){var min,max;return function(minVal,maxVal){return void 0===min&&(min=new THREE.Vector3,max=new THREE.Vector3),min.set(minVal,minVal,minVal),max.set(maxVal,maxVal,maxVal),this.clamp(min,max)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(v){return this.x*v.x+this.y*v.y+this.z*v.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(l){var oldLength=this.length();return 0!==oldLength&&l!==oldLength&&this.multiplyScalar(l/oldLength),this},lerp:function(v,alpha){return this.x+=(v.x-this.x)*alpha,this.y+=(v.y-this.y)*alpha,this.z+=(v.z-this.z)*alpha,this},cross:function(v,w){if(void 0!==w)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(v,w);var x=this.x,y=this.y,z=this.z;return this.x=y*v.z-z*v.y,this.y=z*v.x-x*v.z,this.z=x*v.y-y*v.x,this},crossVectors:function(a,b){var ax=a.x,ay=a.y,az=a.z,bx=b.x,by=b.y,bz=b.z;return this.x=ay*bz-az*by,this.y=az*bx-ax*bz,this.z=ax*by-ay*bx,this},projectOnVector:function(){var v1,dot;return function(vector){return void 0===v1&&(v1=new THREE.Vector3),v1.copy(vector).normalize(),dot=this.dot(v1),this.copy(v1).multiplyScalar(dot)}}(),projectOnPlane:function(){var v1;return function(planeNormal){return void 0===v1&&(v1=new THREE.Vector3),v1.copy(this).projectOnVector(planeNormal),this.sub(v1)}}(),reflect:function(){var v1;return function(normal){return void 0===v1&&(v1=new THREE.Vector3),this.sub(v1.copy(normal).multiplyScalar(2*this.dot(normal)))}}(),angleTo:function(v){var theta=this.dot(v)/(this.length()*v.length());return Math.acos(THREE.Math.clamp(theta,-1,1))},distanceTo:function(v){return Math.sqrt(this.distanceToSquared(v))},distanceToSquared:function(v){var dx=this.x-v.x,dy=this.y-v.y,dz=this.z-v.z;return dx*dx+dy*dy+dz*dz},setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(m){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(m)},getScaleFromMatrix:function(m){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(m)},getColumnFromMatrix:function(index,matrix){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(index,matrix)},setFromMatrixPosition:function(m){return this.x=m.elements[12],this.y=m.elements[13],this.z=m.elements[14],this},setFromMatrixScale:function(m){var sx=this.set(m.elements[0],m.elements[1],m.elements[2]).length(),sy=this.set(m.elements[4],m.elements[5],m.elements[6]).length(),sz=this.set(m.elements[8],m.elements[9],m.elements[10]).length();
return this.x=sx,this.y=sy,this.z=sz,this},setFromMatrixColumn:function(index,matrix){var offset=4*index,me=matrix.elements;return this.x=me[offset],this.y=me[offset+1],this.z=me[offset+2],this},equals:function(v){return v.x===this.x&&v.y===this.y&&v.z===this.z},fromArray:function(array){return this.x=array[0],this.y=array[1],this.z=array[2],this},toArray:function(){return[this.x,this.y,this.z]},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}},THREE.Vector4=function(x,y,z,w){this.x=x||0,this.y=y||0,this.z=z||0,this.w=void 0!==w?w:1},THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(x,y,z,w){return this.x=x,this.y=y,this.z=z,this.w=w,this},setX:function(x){return this.x=x,this},setY:function(y){return this.y=y,this},setZ:function(z){return this.z=z,this},setW:function(w){return this.w=w,this},setComponent:function(index,value){switch(index){case 0:this.x=value;break;case 1:this.y=value;break;case 2:this.z=value;break;case 3:this.w=value;break;default:throw new Error("index is out of range: "+index)}},getComponent:function(index){switch(index){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+index)}},copy:function(v){return this.x=v.x,this.y=v.y,this.z=v.z,this.w=void 0!==v.w?v.w:1,this},add:function(v,w){return void 0!==w?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(v,w)):(this.x+=v.x,this.y+=v.y,this.z+=v.z,this.w+=v.w,this)},addScalar:function(s){return this.x+=s,this.y+=s,this.z+=s,this.w+=s,this},addVectors:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this.w=a.w+b.w,this},sub:function(v,w){return void 0!==w?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(v,w)):(this.x-=v.x,this.y-=v.y,this.z-=v.z,this.w-=v.w,this)},subVectors:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this.w=a.w-b.w,this},multiplyScalar:function(scalar){return this.x*=scalar,this.y*=scalar,this.z*=scalar,this.w*=scalar,this},applyMatrix4:function(m){var x=this.x,y=this.y,z=this.z,w=this.w,e=m.elements;return this.x=e[0]*x+e[4]*y+e[8]*z+e[12]*w,this.y=e[1]*x+e[5]*y+e[9]*z+e[13]*w,this.z=e[2]*x+e[6]*y+e[10]*z+e[14]*w,this.w=e[3]*x+e[7]*y+e[11]*z+e[15]*w,this},divideScalar:function(scalar){if(0!==scalar){var invScalar=1/scalar;this.x*=invScalar,this.y*=invScalar,this.z*=invScalar,this.w*=invScalar}else this.x=0,this.y=0,this.z=0,this.w=1;return this},setAxisAngleFromQuaternion:function(q){this.w=2*Math.acos(q.w);var s=Math.sqrt(1-q.w*q.w);return 1e-4>s?(this.x=1,this.y=0,this.z=0):(this.x=q.x/s,this.y=q.y/s,this.z=q.z/s),this},setAxisAngleFromRotationMatrix:function(m){var angle,x,y,z,epsilon=.01,epsilon2=.1,te=m.elements,m11=te[0],m12=te[4],m13=te[8],m21=te[1],m22=te[5],m23=te[9],m31=te[2],m32=te[6],m33=te[10];if(Math.abs(m12-m21)<epsilon&&Math.abs(m13-m31)<epsilon&&Math.abs(m23-m32)<epsilon){if(Math.abs(m12+m21)<epsilon2&&Math.abs(m13+m31)<epsilon2&&Math.abs(m23+m32)<epsilon2&&Math.abs(m11+m22+m33-3)<epsilon2)return this.set(1,0,0,0),this;angle=Math.PI;var xx=(m11+1)/2,yy=(m22+1)/2,zz=(m33+1)/2,xy=(m12+m21)/4,xz=(m13+m31)/4,yz=(m23+m32)/4;return xx>yy&&xx>zz?epsilon>xx?(x=0,y=.707106781,z=.707106781):(x=Math.sqrt(xx),y=xy/x,z=xz/x):yy>zz?epsilon>yy?(x=.707106781,y=0,z=.707106781):(y=Math.sqrt(yy),x=xy/y,z=yz/y):epsilon>zz?(x=.707106781,y=.707106781,z=0):(z=Math.sqrt(zz),x=xz/z,y=yz/z),this.set(x,y,z,angle),this}var s=Math.sqrt((m32-m23)*(m32-m23)+(m13-m31)*(m13-m31)+(m21-m12)*(m21-m12));return Math.abs(s)<.001&&(s=1),this.x=(m32-m23)/s,this.y=(m13-m31)/s,this.z=(m21-m12)/s,this.w=Math.acos((m11+m22+m33-1)/2),this},min:function(v){return this.x>v.x&&(this.x=v.x),this.y>v.y&&(this.y=v.y),this.z>v.z&&(this.z=v.z),this.w>v.w&&(this.w=v.w),this},max:function(v){return this.x<v.x&&(this.x=v.x),this.y<v.y&&(this.y=v.y),this.z<v.z&&(this.z=v.z),this.w<v.w&&(this.w=v.w),this},clamp:function(min,max){return this.x<min.x?this.x=min.x:this.x>max.x&&(this.x=max.x),this.y<min.y?this.y=min.y:this.y>max.y&&(this.y=max.y),this.z<min.z?this.z=min.z:this.z>max.z&&(this.z=max.z),this.w<min.w?this.w=min.w:this.w>max.w&&(this.w=max.w),this},clampScalar:function(){var min,max;return function(minVal,maxVal){return void 0===min&&(min=new THREE.Vector4,max=new THREE.Vector4),min.set(minVal,minVal,minVal,minVal),max.set(maxVal,maxVal,maxVal,maxVal),this.clamp(min,max)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(v){return this.x*v.x+this.y*v.y+this.z*v.z+this.w*v.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(l){var oldLength=this.length();return 0!==oldLength&&l!==oldLength&&this.multiplyScalar(l/oldLength),this},lerp:function(v,alpha){return this.x+=(v.x-this.x)*alpha,this.y+=(v.y-this.y)*alpha,this.z+=(v.z-this.z)*alpha,this.w+=(v.w-this.w)*alpha,this},equals:function(v){return v.x===this.x&&v.y===this.y&&v.z===this.z&&v.w===this.w},fromArray:function(array){return this.x=array[0],this.y=array[1],this.z=array[2],this.w=array[3],this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)}},THREE.Euler=function(x,y,z,order){this._x=x||0,this._y=y||0,this._z=z||0,this._order=order||THREE.Euler.DefaultOrder},THREE.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],THREE.Euler.DefaultOrder="XYZ",THREE.Euler.prototype={constructor:THREE.Euler,_x:0,_y:0,_z:0,_order:THREE.Euler.DefaultOrder,get x(){return this._x},set x(value){this._x=value,this.onChangeCallback()},get y(){return this._y},set y(value){this._y=value,this.onChangeCallback()},get z(){return this._z},set z(value){this._z=value,this.onChangeCallback()},get order(){return this._order},set order(value){this._order=value,this.onChangeCallback()},set:function(x,y,z,order){return this._x=x,this._y=y,this._z=z,this._order=order||this._order,this.onChangeCallback(),this},copy:function(euler){return this._x=euler._x,this._y=euler._y,this._z=euler._z,this._order=euler._order,this.onChangeCallback(),this},setFromRotationMatrix:function(m,order){var clamp=THREE.Math.clamp,te=m.elements,m11=te[0],m12=te[4],m13=te[8],m21=te[1],m22=te[5],m23=te[9],m31=te[2],m32=te[6],m33=te[10];return order=order||this._order,"XYZ"===order?(this._y=Math.asin(clamp(m13,-1,1)),Math.abs(m13)<.99999?(this._x=Math.atan2(-m23,m33),this._z=Math.atan2(-m12,m11)):(this._x=Math.atan2(m32,m22),this._z=0)):"YXZ"===order?(this._x=Math.asin(-clamp(m23,-1,1)),Math.abs(m23)<.99999?(this._y=Math.atan2(m13,m33),this._z=Math.atan2(m21,m22)):(this._y=Math.atan2(-m31,m11),this._z=0)):"ZXY"===order?(this._x=Math.asin(clamp(m32,-1,1)),Math.abs(m32)<.99999?(this._y=Math.atan2(-m31,m33),this._z=Math.atan2(-m12,m22)):(this._y=0,this._z=Math.atan2(m21,m11))):"ZYX"===order?(this._y=Math.asin(-clamp(m31,-1,1)),Math.abs(m31)<.99999?(this._x=Math.atan2(m32,m33),this._z=Math.atan2(m21,m11)):(this._x=0,this._z=Math.atan2(-m12,m22))):"YZX"===order?(this._z=Math.asin(clamp(m21,-1,1)),Math.abs(m21)<.99999?(this._x=Math.atan2(-m23,m22),this._y=Math.atan2(-m31,m11)):(this._x=0,this._y=Math.atan2(m13,m33))):"XZY"===order?(this._z=Math.asin(-clamp(m12,-1,1)),Math.abs(m12)<.99999?(this._x=Math.atan2(m32,m22),this._y=Math.atan2(m13,m11)):(this._x=Math.atan2(-m23,m33),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+order),this._order=order,this.onChangeCallback(),this},setFromQuaternion:function(q,order,update){var clamp=THREE.Math.clamp,sqx=q.x*q.x,sqy=q.y*q.y,sqz=q.z*q.z,sqw=q.w*q.w;return order=order||this._order,"XYZ"===order?(this._x=Math.atan2(2*(q.x*q.w-q.y*q.z),sqw-sqx-sqy+sqz),this._y=Math.asin(clamp(2*(q.x*q.z+q.y*q.w),-1,1)),this._z=Math.atan2(2*(q.z*q.w-q.x*q.y),sqw+sqx-sqy-sqz)):"YXZ"===order?(this._x=Math.asin(clamp(2*(q.x*q.w-q.y*q.z),-1,1)),this._y=Math.atan2(2*(q.x*q.z+q.y*q.w),sqw-sqx-sqy+sqz),this._z=Math.atan2(2*(q.x*q.y+q.z*q.w),sqw-sqx+sqy-sqz)):"ZXY"===order?(this._x=Math.asin(clamp(2*(q.x*q.w+q.y*q.z),-1,1)),this._y=Math.atan2(2*(q.y*q.w-q.z*q.x),sqw-sqx-sqy+sqz),this._z=Math.atan2(2*(q.z*q.w-q.x*q.y),sqw-sqx+sqy-sqz)):"ZYX"===order?(this._x=Math.atan2(2*(q.x*q.w+q.z*q.y),sqw-sqx-sqy+sqz),this._y=Math.asin(clamp(2*(q.y*q.w-q.x*q.z),-1,1)),this._z=Math.atan2(2*(q.x*q.y+q.z*q.w),sqw+sqx-sqy-sqz)):"YZX"===order?(this._x=Math.atan2(2*(q.x*q.w-q.z*q.y),sqw-sqx+sqy-sqz),this._y=Math.atan2(2*(q.y*q.w-q.x*q.z),sqw+sqx-sqy-sqz),this._z=Math.asin(clamp(2*(q.x*q.y+q.z*q.w),-1,1))):"XZY"===order?(this._x=Math.atan2(2*(q.x*q.w+q.y*q.z),sqw-sqx+sqy-sqz),this._y=Math.atan2(2*(q.x*q.z+q.y*q.w),sqw+sqx-sqy-sqz),this._z=Math.asin(clamp(2*(q.z*q.w-q.x*q.y),-1,1))):console.warn("THREE.Euler: .setFromQuaternion() given unsupported order: "+order),this._order=order,update!==!1&&this.onChangeCallback(),this},reorder:function(){var q=new THREE.Quaternion;return function(newOrder){q.setFromEuler(this),this.setFromQuaternion(q,newOrder)}}(),equals:function(euler){return euler._x===this._x&&euler._y===this._y&&euler._z===this._z&&euler._order===this._order},fromArray:function(array){return this._x=array[0],this._y=array[1],this._z=array[2],void 0!==array[3]&&(this._order=array[3]),this.onChangeCallback(),this},toArray:function(){return[this._x,this._y,this._z,this._order]},onChange:function(callback){return this.onChangeCallback=callback,this},onChangeCallback:function(){},clone:function(){return new THREE.Euler(this._x,this._y,this._z,this._order)}},THREE.Line3=function(start,end){this.start=void 0!==start?start:new THREE.Vector3,this.end=void 0!==end?end:new THREE.Vector3},THREE.Line3.prototype={constructor:THREE.Line3,set:function(start,end){return this.start.copy(start),this.end.copy(end),this},copy:function(line){return this.start.copy(line.start),this.end.copy(line.end),this},center:function(optionalTarget){var result=optionalTarget||new THREE.Vector3;return result.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(optionalTarget){var result=optionalTarget||new THREE.Vector3;return result.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,optionalTarget){var result=optionalTarget||new THREE.Vector3;return this.delta(result).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(){var startP=new THREE.Vector3,startEnd=new THREE.Vector3;return function(point,clampToLine){startP.subVectors(point,this.start),startEnd.subVectors(this.end,this.start);var startEnd2=startEnd.dot(startEnd),startEnd_startP=startEnd.dot(startP),t=startEnd_startP/startEnd2;return clampToLine&&(t=THREE.Math.clamp(t,0,1)),t}}(),closestPointToPoint:function(point,clampToLine,optionalTarget){var t=this.closestPointToPointParameter(point,clampToLine),result=optionalTarget||new THREE.Vector3;return this.delta(result).multiplyScalar(t).add(this.start)},applyMatrix4:function(matrix){return this.start.applyMatrix4(matrix),this.end.applyMatrix4(matrix),this},equals:function(line){return line.start.equals(this.start)&&line.end.equals(this.end)},clone:function(){return(new THREE.Line3).copy(this)}},THREE.Box2=function(min,max){this.min=void 0!==min?min:new THREE.Vector2(1/0,1/0),this.max=void 0!==max?max:new THREE.Vector2(-1/0,-1/0)},THREE.Box2.prototype={constructor:THREE.Box2,set:function(min,max){return this.min.copy(min),this.max.copy(max),this},setFromPoints:function(points){this.makeEmpty();for(var i=0,il=points.length;il>i;i++)this.expandByPoint(points[i]);return this},setFromCenterAndSize:function(){var v1=new THREE.Vector2;return function(center,size){var halfSize=v1.copy(size).multiplyScalar(.5);return this.min.copy(center).sub(halfSize),this.max.copy(center).add(halfSize),this}}(),copy:function(box){return this.min.copy(box.min),this.max.copy(box.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(optionalTarget){var result=optionalTarget||new THREE.Vector2;return result.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(optionalTarget){var result=optionalTarget||new THREE.Vector2;return result.subVectors(this.max,this.min)},expandByPoint:function(point){return this.min.min(point),this.max.max(point),this},expandByVector:function(vector){return this.min.sub(vector),this.max.add(vector),this},expandByScalar:function(scalar){return this.min.addScalar(-scalar),this.max.addScalar(scalar),this},containsPoint:function(point){return point.x<this.min.x||point.x>this.max.x||point.y<this.min.y||point.y>this.max.y?!1:!0},containsBox:function(box){return this.min.x<=box.min.x&&box.max.x<=this.max.x&&this.min.y<=box.min.y&&box.max.y<=this.max.y?!0:!1},getParameter:function(point,optionalTarget){var result=optionalTarget||new THREE.Vector2;return result.set((point.x-this.min.x)/(this.max.x-this.min.x),(point.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(box){return box.max.x<this.min.x||box.min.x>this.max.x||box.max.y<this.min.y||box.min.y>this.max.y?!1:!0},clampPoint:function(point,optionalTarget){var result=optionalTarget||new THREE.Vector2;return result.copy(point).clamp(this.min,this.max)},distanceToPoint:function(){var v1=new THREE.Vector2;return function(point){var clampedPoint=v1.copy(point).clamp(this.min,this.max);return clampedPoint.sub(point).length()}}(),intersect:function(box){return this.min.max(box.min),this.max.min(box.max),this},union:function(box){return this.min.min(box.min),this.max.max(box.max),this},translate:function(offset){return this.min.add(offset),this.max.add(offset),this},equals:function(box){return box.min.equals(this.min)&&box.max.equals(this.max)},clone:function(){return(new THREE.Box2).copy(this)}},THREE.Box3=function(min,max){this.min=void 0!==min?min:new THREE.Vector3(1/0,1/0,1/0),this.max=void 0!==max?max:new THREE.Vector3(-1/0,-1/0,-1/0)},THREE.Box3.prototype={constructor:THREE.Box3,set:function(min,max){return this.min.copy(min),this.max.copy(max),this},setFromPoints:function(points){this.makeEmpty();for(var i=0,il=points.length;il>i;i++)this.expandByPoint(points[i]);return this},setFromCenterAndSize:function(){var v1=new THREE.Vector3;return function(center,size){var halfSize=v1.copy(size).multiplyScalar(.5);return this.min.copy(center).sub(halfSize),this.max.copy(center).add(halfSize),this}}(),setFromObject:function(){var v1=new THREE.Vector3;return function(object){var scope=this;return object.updateMatrixWorld(!0),this.makeEmpty(),object.traverse(function(node){if(void 0!==node.geometry&&void 0!==node.geometry.vertices)for(var vertices=node.geometry.vertices,i=0,il=vertices.length;il>i;i++)v1.copy(vertices[i]),v1.applyMatrix4(node.matrixWorld),scope.expandByPoint(v1)}),this}}(),copy:function(box){return this.min.copy(box.min),this.max.copy(box.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(optionalTarget){var result=optionalTarget||new THREE.Vector3;return result.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(optionalTarget){var result=optionalTarget||new THREE.Vector3;return result.subVectors(this.max,this.min)},expandByPoint:function(point){return this.min.min(point),this.max.max(point),this},expandByVector:function(vector){return this.min.sub(vector),this.max.add(vector),this},expandByScalar:function(scalar){return this.min.addScalar(-scalar),this.max.addScalar(scalar),this},containsPoint:function(point){return point.x<this.min.x||point.x>this.max.x||point.y<this.min.y||point.y>this.max.y||point.z<this.min.z||point.z>this.max.z?!1:!0},containsBox:function(box){return this.min.x<=box.min.x&&box.max.x<=this.max.x&&this.min.y<=box.min.y&&box.max.y<=this.max.y&&this.min.z<=box.min.z&&box.max.z<=this.max.z?!0:!1},getParameter:function(point,optionalTarget){var result=optionalTarget||new THREE.Vector3;return result.set((point.x-this.min.x)/(this.max.x-this.min.x),(point.y-this.min.y)/(this.max.y-this.min.y),(point.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(box){return box.max.x<this.min.x||box.min.x>this.max.x||box.max.y<this.min.y||box.min.y>this.max.y||box.max.z<this.min.z||box.min.z>this.max.z?!1:!0},clampPoint:function(point,optionalTarget){var result=optionalTarget||new THREE.Vector3;return result.copy(point).clamp(this.min,this.max)},distanceToPoint:function(){var v1=new THREE.Vector3;return function(point){var clampedPoint=v1.copy(point).clamp(this.min,this.max);return clampedPoint.sub(point).length()}}(),getBoundingSphere:function(){var v1=new THREE.Vector3;return function(optionalTarget){var result=optionalTarget||new THREE.Sphere;return result.center=this.center(),result.radius=.5*this.size(v1).length(),result}}(),intersect:function(box){return this.min.max(box.min),this.max.min(box.max),this},union:function(box){return this.min.min(box.min),this.max.max(box.max),this},applyMatrix4:function(){var points=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(matrix){return points[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(matrix),points[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(matrix),points[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(matrix),points[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(matrix),points[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(matrix),points[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(matrix),points[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(matrix),points[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(matrix),this.makeEmpty(),this.setFromPoints(points),this}}(),translate:function(offset){return this.min.add(offset),this.max.add(offset),this},equals:function(box){return box.min.equals(this.min)&&box.max.equals(this.max)},clone:function(){return(new THREE.Box3).copy(this)}},THREE.Matrix3=function(n11,n12,n13,n21,n22,n23,n31,n32,n33){this.elements=new Float32Array(9);var te=this.elements;te[0]=void 0!==n11?n11:1,te[3]=n12||0,te[6]=n13||0,te[1]=n21||0,te[4]=void 0!==n22?n22:1,te[7]=n23||0,te[2]=n31||0,te[5]=n32||0,te[8]=void 0!==n33?n33:1},THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(n11,n12,n13,n21,n22,n23,n31,n32,n33){var te=this.elements;return te[0]=n11,te[3]=n12,te[6]=n13,te[1]=n21,te[4]=n22,te[7]=n23,te[2]=n31,te[5]=n32,te[8]=n33,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},copy:function(m){var me=m.elements;return this.set(me[0],me[3],me[6],me[1],me[4],me[7],me[2],me[5],me[8]),this},multiplyVector3:function(vector){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),vector.applyMatrix3(this)},multiplyVector3Array:function(a){return console.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(a)},applyToVector3Array:function(){var v1=new THREE.Vector3;return function(array,offset,length){void 0===offset&&(offset=0),void 0===length&&(length=array.length);for(var i=0,j=offset;length>i;i+=3,j+=3)v1.x=array[j],v1.y=array[j+1],v1.z=array[j+2],v1.applyMatrix3(this),array[j]=v1.x,array[j+1]=v1.y,array[j+2]=v1.z;return array}}(),multiplyScalar:function(s){var te=this.elements;return te[0]*=s,te[3]*=s,te[6]*=s,te[1]*=s,te[4]*=s,te[7]*=s,te[2]*=s,te[5]*=s,te[8]*=s,this},determinant:function(){var te=this.elements,a=te[0],b=te[1],c=te[2],d=te[3],e=te[4],f=te[5],g=te[6],h=te[7],i=te[8];return a*e*i-a*f*h-b*d*i+b*f*g+c*d*h-c*e*g},getInverse:function(matrix,throwOnInvertible){var me=matrix.elements,te=this.elements;te[0]=me[10]*me[5]-me[6]*me[9],te[1]=-me[10]*me[1]+me[2]*me[9],te[2]=me[6]*me[1]-me[2]*me[5],te[3]=-me[10]*me[4]+me[6]*me[8],te[4]=me[10]*me[0]-me[2]*me[8],te[5]=-me[6]*me[0]+me[2]*me[4],te[6]=me[9]*me[4]-me[5]*me[8],te[7]=-me[9]*me[0]+me[1]*me[8],te[8]=me[5]*me[0]-me[1]*me[4];var det=me[0]*te[0]+me[1]*te[3]+me[2]*te[6];if(0===det){var msg="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(throwOnInvertible)throw new Error(msg);return console.warn(msg),this.identity(),this}return this.multiplyScalar(1/det),this},transpose:function(){var tmp,m=this.elements;return tmp=m[1],m[1]=m[3],m[3]=tmp,tmp=m[2],m[2]=m[6],m[6]=tmp,tmp=m[5],m[5]=m[7],m[7]=tmp,this},flattenToArrayOffset:function(array,offset){var te=this.elements;return array[offset]=te[0],array[offset+1]=te[1],array[offset+2]=te[2],array[offset+3]=te[3],array[offset+4]=te[4],array[offset+5]=te[5],array[offset+6]=te[6],array[offset+7]=te[7],array[offset+8]=te[8],array},getNormalMatrix:function(m){return this.getInverse(m).transpose(),this},transposeIntoArray:function(r){var m=this.elements;return r[0]=m[0],r[1]=m[3],r[2]=m[6],r[3]=m[1],r[4]=m[4],r[5]=m[7],r[6]=m[2],r[7]=m[5],r[8]=m[8],this},fromArray:function(array){return this.elements.set(array),this},toArray:function(){var te=this.elements;return[te[0],te[1],te[2],te[3],te[4],te[5],te[6],te[7],te[8]]},clone:function(){var te=this.elements;return new THREE.Matrix3(te[0],te[3],te[6],te[1],te[4],te[7],te[2],te[5],te[8])}},THREE.Matrix4=function(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44){this.elements=new Float32Array(16);var te=this.elements;te[0]=void 0!==n11?n11:1,te[4]=n12||0,te[8]=n13||0,te[12]=n14||0,te[1]=n21||0,te[5]=void 0!==n22?n22:1,te[9]=n23||0,te[13]=n24||0,te[2]=n31||0,te[6]=n32||0,te[10]=void 0!==n33?n33:1,te[14]=n34||0,te[3]=n41||0,te[7]=n42||0,te[11]=n43||0,te[15]=void 0!==n44?n44:1},THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44){var te=this.elements;return te[0]=n11,te[4]=n12,te[8]=n13,te[12]=n14,te[1]=n21,te[5]=n22,te[9]=n23,te[13]=n24,te[2]=n31,te[6]=n32,te[10]=n33,te[14]=n34,te[3]=n41,te[7]=n42,te[11]=n43,te[15]=n44,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(m){return this.elements.set(m.elements),this},extractPosition:function(m){return console.warn("THREEMatrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(m)},copyPosition:function(m){var te=this.elements,me=m.elements;return te[12]=me[12],te[13]=me[13],te[14]=me[14],this},extractRotation:function(){var v1=new THREE.Vector3;return function(m){var te=this.elements,me=m.elements,scaleX=1/v1.set(me[0],me[1],me[2]).length(),scaleY=1/v1.set(me[4],me[5],me[6]).length(),scaleZ=1/v1.set(me[8],me[9],me[10]).length();return te[0]=me[0]*scaleX,te[1]=me[1]*scaleX,te[2]=me[2]*scaleX,te[4]=me[4]*scaleY,te[5]=me[5]*scaleY,te[6]=me[6]*scaleY,te[8]=me[8]*scaleZ,te[9]=me[9]*scaleZ,te[10]=me[10]*scaleZ,this}}(),makeRotationFromEuler:function(euler){euler instanceof THREE.Euler==!1&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var te=this.elements,x=euler.x,y=euler.y,z=euler.z,a=Math.cos(x),b=Math.sin(x),c=Math.cos(y),d=Math.sin(y),e=Math.cos(z),f=Math.sin(z);if("XYZ"===euler.order){var ae=a*e,af=a*f,be=b*e,bf=b*f;te[0]=c*e,te[4]=-c*f,te[8]=d,te[1]=af+be*d,te[5]=ae-bf*d,te[9]=-b*c,te[2]=bf-ae*d,te[6]=be+af*d,te[10]=a*c}else if("YXZ"===euler.order){var ce=c*e,cf=c*f,de=d*e,df=d*f;te[0]=ce+df*b,te[4]=de*b-cf,te[8]=a*d,te[1]=a*f,te[5]=a*e,te[9]=-b,te[2]=cf*b-de,te[6]=df+ce*b,te[10]=a*c}else if("ZXY"===euler.order){var ce=c*e,cf=c*f,de=d*e,df=d*f;te[0]=ce-df*b,te[4]=-a*f,te[8]=de+cf*b,te[1]=cf+de*b,te[5]=a*e,te[9]=df-ce*b,te[2]=-a*d,te[6]=b,te[10]=a*c}else if("ZYX"===euler.order){var ae=a*e,af=a*f,be=b*e,bf=b*f;te[0]=c*e,te[4]=be*d-af,te[8]=ae*d+bf,te[1]=c*f,te[5]=bf*d+ae,te[9]=af*d-be,te[2]=-d,te[6]=b*c,te[10]=a*c}else if("YZX"===euler.order){var ac=a*c,ad=a*d,bc=b*c,bd=b*d;te[0]=c*e,te[4]=bd-ac*f,te[8]=bc*f+ad,te[1]=f,te[5]=a*e,te[9]=-b*e,te[2]=-d*e,te[6]=ad*f+bc,te[10]=ac-bd*f}else if("XZY"===euler.order){var ac=a*c,ad=a*d,bc=b*c,bd=b*d;te[0]=c*e,te[4]=-f,te[8]=d*e,te[1]=ac*f+bd,te[5]=a*e,te[9]=ad*f-bc,te[2]=bc*f-ad,te[6]=b*e,te[10]=bd*f+ac}return te[3]=0,te[7]=0,te[11]=0,te[12]=0,te[13]=0,te[14]=0,te[15]=1,this},setRotationFromQuaternion:function(q){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(q)},makeRotationFromQuaternion:function(q){var te=this.elements,x=q.x,y=q.y,z=q.z,w=q.w,x2=x+x,y2=y+y,z2=z+z,xx=x*x2,xy=x*y2,xz=x*z2,yy=y*y2,yz=y*z2,zz=z*z2,wx=w*x2,wy=w*y2,wz=w*z2;return te[0]=1-(yy+zz),te[4]=xy-wz,te[8]=xz+wy,te[1]=xy+wz,te[5]=1-(xx+zz),te[9]=yz-wx,te[2]=xz-wy,te[6]=yz+wx,te[10]=1-(xx+yy),te[3]=0,te[7]=0,te[11]=0,te[12]=0,te[13]=0,te[14]=0,te[15]=1,this},lookAt:function(){var x=new THREE.Vector3,y=new THREE.Vector3,z=new THREE.Vector3;return function(eye,target,up){var te=this.elements;return z.subVectors(eye,target).normalize(),0===z.length()&&(z.z=1),x.crossVectors(up,z).normalize(),0===x.length()&&(z.x+=1e-4,x.crossVectors(up,z).normalize()),y.crossVectors(z,x),te[0]=x.x,te[4]=y.x,te[8]=z.x,te[1]=x.y,te[5]=y.y,te[9]=z.y,te[2]=x.z,te[6]=y.z,te[10]=z.z,this}}(),multiply:function(m,n){return void 0!==n?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(m,n)):this.multiplyMatrices(this,m)},multiplyMatrices:function(a,b){var ae=a.elements,be=b.elements,te=this.elements,a11=ae[0],a12=ae[4],a13=ae[8],a14=ae[12],a21=ae[1],a22=ae[5],a23=ae[9],a24=ae[13],a31=ae[2],a32=ae[6],a33=ae[10],a34=ae[14],a41=ae[3],a42=ae[7],a43=ae[11],a44=ae[15],b11=be[0],b12=be[4],b13=be[8],b14=be[12],b21=be[1],b22=be[5],b23=be[9],b24=be[13],b31=be[2],b32=be[6],b33=be[10],b34=be[14],b41=be[3],b42=be[7],b43=be[11],b44=be[15];return te[0]=a11*b11+a12*b21+a13*b31+a14*b41,te[4]=a11*b12+a12*b22+a13*b32+a14*b42,te[8]=a11*b13+a12*b23+a13*b33+a14*b43,te[12]=a11*b14+a12*b24+a13*b34+a14*b44,te[1]=a21*b11+a22*b21+a23*b31+a24*b41,te[5]=a21*b12+a22*b22+a23*b32+a24*b42,te[9]=a21*b13+a22*b23+a23*b33+a24*b43,te[13]=a21*b14+a22*b24+a23*b34+a24*b44,te[2]=a31*b11+a32*b21+a33*b31+a34*b41,te[6]=a31*b12+a32*b22+a33*b32+a34*b42,te[10]=a31*b13+a32*b23+a33*b33+a34*b43,te[14]=a31*b14+a32*b24+a33*b34+a34*b44,te[3]=a41*b11+a42*b21+a43*b31+a44*b41,te[7]=a41*b12+a42*b22+a43*b32+a44*b42,te[11]=a41*b13+a42*b23+a43*b33+a44*b43,te[15]=a41*b14+a42*b24+a43*b34+a44*b44,this},multiplyToArray:function(a,b,r){var te=this.elements;return this.multiplyMatrices(a,b),r[0]=te[0],r[1]=te[1],r[2]=te[2],r[3]=te[3],r[4]=te[4],r[5]=te[5],r[6]=te[6],r[7]=te[7],r[8]=te[8],r[9]=te[9],r[10]=te[10],r[11]=te[11],r[12]=te[12],r[13]=te[13],r[14]=te[14],r[15]=te[15],this},multiplyScalar:function(s){var te=this.elements;return te[0]*=s,te[4]*=s,te[8]*=s,te[12]*=s,te[1]*=s,te[5]*=s,te[9]*=s,te[13]*=s,te[2]*=s,te[6]*=s,te[10]*=s,te[14]*=s,te[3]*=s,te[7]*=s,te[11]*=s,te[15]*=s,this},multiplyVector3:function(vector){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),vector.applyProjection(this)},multiplyVector4:function(vector){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),vector.applyMatrix4(this)},multiplyVector3Array:function(a){return console.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(a)},applyToVector3Array:function(){var v1=new THREE.Vector3;return function(array,offset,length){void 0===offset&&(offset=0),void 0===length&&(length=array.length);for(var i=0,j=offset;length>i;i+=3,j+=3)v1.x=array[j],v1.y=array[j+1],v1.z=array[j+2],v1.applyMatrix4(this),array[j]=v1.x,array[j+1]=v1.y,array[j+2]=v1.z;return array}}(),rotateAxis:function(v){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),v.transformDirection(this)},crossVector:function(vector){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),vector.applyMatrix4(this)},determinant:function(){var te=this.elements,n11=te[0],n12=te[4],n13=te[8],n14=te[12],n21=te[1],n22=te[5],n23=te[9],n24=te[13],n31=te[2],n32=te[6],n33=te[10],n34=te[14],n41=te[3],n42=te[7],n43=te[11],n44=te[15];return n41*(+n14*n23*n32-n13*n24*n32-n14*n22*n33+n12*n24*n33+n13*n22*n34-n12*n23*n34)+n42*(+n11*n23*n34-n11*n24*n33+n14*n21*n33-n13*n21*n34+n13*n24*n31-n14*n23*n31)+n43*(+n11*n24*n32-n11*n22*n34-n14*n21*n32+n12*n21*n34+n14*n22*n31-n12*n24*n31)+n44*(-n13*n22*n31-n11*n23*n32+n11*n22*n33+n13*n21*n32-n12*n21*n33+n12*n23*n31)},transpose:function(){var tmp,te=this.elements;return tmp=te[1],te[1]=te[4],te[4]=tmp,tmp=te[2],te[2]=te[8],te[8]=tmp,tmp=te[6],te[6]=te[9],te[9]=tmp,tmp=te[3],te[3]=te[12],te[12]=tmp,tmp=te[7],te[7]=te[13],te[13]=tmp,tmp=te[11],te[11]=te[14],te[14]=tmp,this},flattenToArrayOffset:function(array,offset){var te=this.elements;return array[offset]=te[0],array[offset+1]=te[1],array[offset+2]=te[2],array[offset+3]=te[3],array[offset+4]=te[4],array[offset+5]=te[5],array[offset+6]=te[6],array[offset+7]=te[7],array[offset+8]=te[8],array[offset+9]=te[9],array[offset+10]=te[10],array[offset+11]=te[11],array[offset+12]=te[12],array[offset+13]=te[13],array[offset+14]=te[14],array[offset+15]=te[15],array},getPosition:function(){var v1=new THREE.Vector3;return function(){console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var te=this.elements;return v1.set(te[12],te[13],te[14])}}(),setPosition:function(v){var te=this.elements;return te[12]=v.x,te[13]=v.y,te[14]=v.z,this},getInverse:function(m,throwOnInvertible){var te=this.elements,me=m.elements,n11=me[0],n12=me[4],n13=me[8],n14=me[12],n21=me[1],n22=me[5],n23=me[9],n24=me[13],n31=me[2],n32=me[6],n33=me[10],n34=me[14],n41=me[3],n42=me[7],n43=me[11],n44=me[15];te[0]=n23*n34*n42-n24*n33*n42+n24*n32*n43-n22*n34*n43-n23*n32*n44+n22*n33*n44,te[4]=n14*n33*n42-n13*n34*n42-n14*n32*n43+n12*n34*n43+n13*n32*n44-n12*n33*n44,te[8]=n13*n24*n42-n14*n23*n42+n14*n22*n43-n12*n24*n43-n13*n22*n44+n12*n23*n44,te[12]=n14*n23*n32-n13*n24*n32-n14*n22*n33+n12*n24*n33+n13*n22*n34-n12*n23*n34,te[1]=n24*n33*n41-n23*n34*n41-n24*n31*n43+n21*n34*n43+n23*n31*n44-n21*n33*n44,te[5]=n13*n34*n41-n14*n33*n41+n14*n31*n43-n11*n34*n43-n13*n31*n44+n11*n33*n44,te[9]=n14*n23*n41-n13*n24*n41-n14*n21*n43+n11*n24*n43+n13*n21*n44-n11*n23*n44,te[13]=n13*n24*n31-n14*n23*n31+n14*n21*n33-n11*n24*n33-n13*n21*n34+n11*n23*n34,te[2]=n22*n34*n41-n24*n32*n41+n24*n31*n42-n21*n34*n42-n22*n31*n44+n21*n32*n44,te[6]=n14*n32*n41-n12*n34*n41-n14*n31*n42+n11*n34*n42+n12*n31*n44-n11*n32*n44,te[10]=n12*n24*n41-n14*n22*n41+n14*n21*n42-n11*n24*n42-n12*n21*n44+n11*n22*n44,te[14]=n14*n22*n31-n12*n24*n31-n14*n21*n32+n11*n24*n32+n12*n21*n34-n11*n22*n34,te[3]=n23*n32*n41-n22*n33*n41-n23*n31*n42+n21*n33*n42+n22*n31*n43-n21*n32*n43,te[7]=n12*n33*n41-n13*n32*n41+n13*n31*n42-n11*n33*n42-n12*n31*n43+n11*n32*n43,te[11]=n13*n22*n41-n12*n23*n41-n13*n21*n42+n11*n23*n42+n12*n21*n43-n11*n22*n43,te[15]=n12*n23*n31-n13*n22*n31+n13*n21*n32-n11*n23*n32-n12*n21*n33+n11*n22*n33;
var det=n11*te[0]+n21*te[4]+n31*te[8]+n41*te[12];if(0==det){var msg="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(throwOnInvertible)throw new Error(msg);return console.warn(msg),this.identity(),this}return this.multiplyScalar(1/det),this},translate:function(){console.warn("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.warn("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.warn("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.warn("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.warn("THREE.Matrix4: .rotateByAxis() has been removed.")},scale:function(v){var te=this.elements,x=v.x,y=v.y,z=v.z;return te[0]*=x,te[4]*=y,te[8]*=z,te[1]*=x,te[5]*=y,te[9]*=z,te[2]*=x,te[6]*=y,te[10]*=z,te[3]*=x,te[7]*=y,te[11]*=z,this},getMaxScaleOnAxis:function(){var te=this.elements,scaleXSq=te[0]*te[0]+te[1]*te[1]+te[2]*te[2],scaleYSq=te[4]*te[4]+te[5]*te[5]+te[6]*te[6],scaleZSq=te[8]*te[8]+te[9]*te[9]+te[10]*te[10];return Math.sqrt(Math.max(scaleXSq,Math.max(scaleYSq,scaleZSq)))},makeTranslation:function(x,y,z){return this.set(1,0,0,x,0,1,0,y,0,0,1,z,0,0,0,1),this},makeRotationX:function(theta){var c=Math.cos(theta),s=Math.sin(theta);return this.set(1,0,0,0,0,c,-s,0,0,s,c,0,0,0,0,1),this},makeRotationY:function(theta){var c=Math.cos(theta),s=Math.sin(theta);return this.set(c,0,s,0,0,1,0,0,-s,0,c,0,0,0,0,1),this},makeRotationZ:function(theta){var c=Math.cos(theta),s=Math.sin(theta);return this.set(c,-s,0,0,s,c,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(axis,angle){var c=Math.cos(angle),s=Math.sin(angle),t=1-c,x=axis.x,y=axis.y,z=axis.z,tx=t*x,ty=t*y;return this.set(tx*x+c,tx*y-s*z,tx*z+s*y,0,tx*y+s*z,ty*y+c,ty*z-s*x,0,tx*z-s*y,ty*z+s*x,t*z*z+c,0,0,0,0,1),this},makeScale:function(x,y,z){return this.set(x,0,0,0,0,y,0,0,0,0,z,0,0,0,0,1),this},compose:function(position,quaternion,scale){return this.makeRotationFromQuaternion(quaternion),this.scale(scale),this.setPosition(position),this},decompose:function(){var vector=new THREE.Vector3,matrix=new THREE.Matrix4;return function(position,quaternion,scale){var te=this.elements,sx=vector.set(te[0],te[1],te[2]).length(),sy=vector.set(te[4],te[5],te[6]).length(),sz=vector.set(te[8],te[9],te[10]).length(),det=this.determinant();0>det&&(sx=-sx),position.x=te[12],position.y=te[13],position.z=te[14],matrix.elements.set(this.elements);var invSX=1/sx,invSY=1/sy,invSZ=1/sz;return matrix.elements[0]*=invSX,matrix.elements[1]*=invSX,matrix.elements[2]*=invSX,matrix.elements[4]*=invSY,matrix.elements[5]*=invSY,matrix.elements[6]*=invSY,matrix.elements[8]*=invSZ,matrix.elements[9]*=invSZ,matrix.elements[10]*=invSZ,quaternion.setFromRotationMatrix(matrix),scale.x=sx,scale.y=sy,scale.z=sz,this}}(),makeFrustum:function(left,right,bottom,top,near,far){var te=this.elements,x=2*near/(right-left),y=2*near/(top-bottom),a=(right+left)/(right-left),b=(top+bottom)/(top-bottom),c=-(far+near)/(far-near),d=-2*far*near/(far-near);return te[0]=x,te[4]=0,te[8]=a,te[12]=0,te[1]=0,te[5]=y,te[9]=b,te[13]=0,te[2]=0,te[6]=0,te[10]=c,te[14]=d,te[3]=0,te[7]=0,te[11]=-1,te[15]=0,this},makePerspective:function(fov,aspect,near,far){var ymax=near*Math.tan(THREE.Math.degToRad(.5*fov)),ymin=-ymax,xmin=ymin*aspect,xmax=ymax*aspect;return this.makeFrustum(xmin,xmax,ymin,ymax,near,far)},makeOrthographic:function(left,right,top,bottom,near,far){var te=this.elements,w=right-left,h=top-bottom,p=far-near,x=(right+left)/w,y=(top+bottom)/h,z=(far+near)/p;return te[0]=2/w,te[4]=0,te[8]=0,te[12]=-x,te[1]=0,te[5]=2/h,te[9]=0,te[13]=-y,te[2]=0,te[6]=0,te[10]=-2/p,te[14]=-z,te[3]=0,te[7]=0,te[11]=0,te[15]=1,this},fromArray:function(array){return this.elements.set(array),this},toArray:function(){var te=this.elements;return[te[0],te[1],te[2],te[3],te[4],te[5],te[6],te[7],te[8],te[9],te[10],te[11],te[12],te[13],te[14],te[15]]},clone:function(){var te=this.elements;return new THREE.Matrix4(te[0],te[4],te[8],te[12],te[1],te[5],te[9],te[13],te[2],te[6],te[10],te[14],te[3],te[7],te[11],te[15])}},THREE.Ray=function(origin,direction){this.origin=void 0!==origin?origin:new THREE.Vector3,this.direction=void 0!==direction?direction:new THREE.Vector3},THREE.Ray.prototype={constructor:THREE.Ray,set:function(origin,direction){return this.origin.copy(origin),this.direction.copy(direction),this},copy:function(ray){return this.origin.copy(ray.origin),this.direction.copy(ray.direction),this},at:function(t,optionalTarget){var result=optionalTarget||new THREE.Vector3;return result.copy(this.direction).multiplyScalar(t).add(this.origin)},recast:function(){var v1=new THREE.Vector3;return function(t){return this.origin.copy(this.at(t,v1)),this}}(),closestPointToPoint:function(point,optionalTarget){var result=optionalTarget||new THREE.Vector3;result.subVectors(point,this.origin);var directionDistance=result.dot(this.direction);return 0>directionDistance?result.copy(this.origin):result.copy(this.direction).multiplyScalar(directionDistance).add(this.origin)},distanceToPoint:function(){var v1=new THREE.Vector3;return function(point){var directionDistance=v1.subVectors(point,this.origin).dot(this.direction);return 0>directionDistance?this.origin.distanceTo(point):(v1.copy(this.direction).multiplyScalar(directionDistance).add(this.origin),v1.distanceTo(point))}}(),distanceSqToSegment:function(v0,v1,optionalPointOnRay,optionalPointOnSegment){var s0,s1,sqrDist,extDet,segCenter=v0.clone().add(v1).multiplyScalar(.5),segDir=v1.clone().sub(v0).normalize(),segExtent=.5*v0.distanceTo(v1),diff=this.origin.clone().sub(segCenter),a01=-this.direction.dot(segDir),b0=diff.dot(this.direction),b1=-diff.dot(segDir),c=diff.lengthSq(),det=Math.abs(1-a01*a01);if(det>=0)if(s0=a01*b1-b0,s1=a01*b0-b1,extDet=segExtent*det,s0>=0)if(s1>=-extDet)if(extDet>=s1){var invDet=1/det;s0*=invDet,s1*=invDet,sqrDist=s0*(s0+a01*s1+2*b0)+s1*(a01*s0+s1+2*b1)+c}else s1=segExtent,s0=Math.max(0,-(a01*s1+b0)),sqrDist=-s0*s0+s1*(s1+2*b1)+c;else s1=-segExtent,s0=Math.max(0,-(a01*s1+b0)),sqrDist=-s0*s0+s1*(s1+2*b1)+c;else-extDet>=s1?(s0=Math.max(0,-(-a01*segExtent+b0)),s1=s0>0?-segExtent:Math.min(Math.max(-segExtent,-b1),segExtent),sqrDist=-s0*s0+s1*(s1+2*b1)+c):extDet>=s1?(s0=0,s1=Math.min(Math.max(-segExtent,-b1),segExtent),sqrDist=s1*(s1+2*b1)+c):(s0=Math.max(0,-(a01*segExtent+b0)),s1=s0>0?segExtent:Math.min(Math.max(-segExtent,-b1),segExtent),sqrDist=-s0*s0+s1*(s1+2*b1)+c);else s1=a01>0?-segExtent:segExtent,s0=Math.max(0,-(a01*s1+b0)),sqrDist=-s0*s0+s1*(s1+2*b1)+c;return optionalPointOnRay&&optionalPointOnRay.copy(this.direction.clone().multiplyScalar(s0).add(this.origin)),optionalPointOnSegment&&optionalPointOnSegment.copy(segDir.clone().multiplyScalar(s1).add(segCenter)),sqrDist},isIntersectionSphere:function(sphere){return this.distanceToPoint(sphere.center)<=sphere.radius},intersectSphere:function(){var v1=new THREE.Vector3;return function(sphere,optionalTarget){v1.subVectors(sphere.center,this.origin);var tca=v1.dot(this.direction),d2=v1.dot(v1)-tca*tca,radius2=sphere.radius*sphere.radius;if(d2>radius2)return null;var thc=Math.sqrt(radius2-d2),t0=tca-thc,t1=tca+thc;return 0>t0&&0>t1?null:0>t0?this.at(t1,optionalTarget):this.at(t0,optionalTarget)}}(),isIntersectionPlane:function(plane){var distToPoint=plane.distanceToPoint(this.origin);if(0===distToPoint)return!0;var denominator=plane.normal.dot(this.direction);return 0>denominator*distToPoint?!0:!1},distanceToPlane:function(plane){var denominator=plane.normal.dot(this.direction);if(0==denominator)return 0==plane.distanceToPoint(this.origin)?0:null;var t=-(this.origin.dot(plane.normal)+plane.constant)/denominator;return t>=0?t:null},intersectPlane:function(plane,optionalTarget){var t=this.distanceToPlane(plane);return null===t?null:this.at(t,optionalTarget)},isIntersectionBox:function(){var v=new THREE.Vector3;return function(box){return null!==this.intersectBox(box,v)}}(),intersectBox:function(box,optionalTarget){var tmin,tmax,tymin,tymax,tzmin,tzmax,invdirx=1/this.direction.x,invdiry=1/this.direction.y,invdirz=1/this.direction.z,origin=this.origin;return invdirx>=0?(tmin=(box.min.x-origin.x)*invdirx,tmax=(box.max.x-origin.x)*invdirx):(tmin=(box.max.x-origin.x)*invdirx,tmax=(box.min.x-origin.x)*invdirx),invdiry>=0?(tymin=(box.min.y-origin.y)*invdiry,tymax=(box.max.y-origin.y)*invdiry):(tymin=(box.max.y-origin.y)*invdiry,tymax=(box.min.y-origin.y)*invdiry),tmin>tymax||tymin>tmax?null:((tymin>tmin||tmin!==tmin)&&(tmin=tymin),(tmax>tymax||tmax!==tmax)&&(tmax=tymax),invdirz>=0?(tzmin=(box.min.z-origin.z)*invdirz,tzmax=(box.max.z-origin.z)*invdirz):(tzmin=(box.max.z-origin.z)*invdirz,tzmax=(box.min.z-origin.z)*invdirz),tmin>tzmax||tzmin>tmax?null:((tzmin>tmin||tmin!==tmin)&&(tmin=tzmin),(tmax>tzmax||tmax!==tmax)&&(tmax=tzmax),0>tmax?null:this.at(tmin>=0?tmin:tmax,optionalTarget)))},intersectTriangle:function(){var diff=new THREE.Vector3,edge1=new THREE.Vector3,edge2=new THREE.Vector3,normal=new THREE.Vector3;return function(a,b,c,backfaceCulling,optionalTarget){edge1.subVectors(b,a),edge2.subVectors(c,a),normal.crossVectors(edge1,edge2);var sign,DdN=this.direction.dot(normal);if(DdN>0){if(backfaceCulling)return null;sign=1}else{if(!(0>DdN))return null;sign=-1,DdN=-DdN}diff.subVectors(this.origin,a);var DdQxE2=sign*this.direction.dot(edge2.crossVectors(diff,edge2));if(0>DdQxE2)return null;var DdE1xQ=sign*this.direction.dot(edge1.cross(diff));if(0>DdE1xQ)return null;if(DdQxE2+DdE1xQ>DdN)return null;var QdN=-sign*diff.dot(normal);return 0>QdN?null:this.at(QdN/DdN,optionalTarget)}}(),applyMatrix4:function(matrix4){return this.direction.add(this.origin).applyMatrix4(matrix4),this.origin.applyMatrix4(matrix4),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(ray){return ray.origin.equals(this.origin)&&ray.direction.equals(this.direction)},clone:function(){return(new THREE.Ray).copy(this)}},THREE.Sphere=function(center,radius){this.center=void 0!==center?center:new THREE.Vector3,this.radius=void 0!==radius?radius:0},THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(center,radius){return this.center.copy(center),this.radius=radius,this},setFromPoints:function(){var box=new THREE.Box3;return function(points,optionalCenter){var center=this.center;void 0!==optionalCenter?center.copy(optionalCenter):box.setFromPoints(points).center(center);for(var maxRadiusSq=0,i=0,il=points.length;il>i;i++)maxRadiusSq=Math.max(maxRadiusSq,center.distanceToSquared(points[i]));return this.radius=Math.sqrt(maxRadiusSq),this}}(),copy:function(sphere){return this.center.copy(sphere.center),this.radius=sphere.radius,this},empty:function(){return this.radius<=0},containsPoint:function(point){return point.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(point){return point.distanceTo(this.center)-this.radius},intersectsSphere:function(sphere){var radiusSum=this.radius+sphere.radius;return sphere.center.distanceToSquared(this.center)<=radiusSum*radiusSum},clampPoint:function(point,optionalTarget){var deltaLengthSq=this.center.distanceToSquared(point),result=optionalTarget||new THREE.Vector3;return result.copy(point),deltaLengthSq>this.radius*this.radius&&(result.sub(this.center).normalize(),result.multiplyScalar(this.radius).add(this.center)),result},getBoundingBox:function(optionalTarget){var box=optionalTarget||new THREE.Box3;return box.set(this.center,this.center),box.expandByScalar(this.radius),box},applyMatrix4:function(matrix){return this.center.applyMatrix4(matrix),this.radius=this.radius*matrix.getMaxScaleOnAxis(),this},translate:function(offset){return this.center.add(offset),this},equals:function(sphere){return sphere.center.equals(this.center)&&sphere.radius===this.radius},clone:function(){return(new THREE.Sphere).copy(this)}},THREE.Frustum=function(p0,p1,p2,p3,p4,p5){this.planes=[void 0!==p0?p0:new THREE.Plane,void 0!==p1?p1:new THREE.Plane,void 0!==p2?p2:new THREE.Plane,void 0!==p3?p3:new THREE.Plane,void 0!==p4?p4:new THREE.Plane,void 0!==p5?p5:new THREE.Plane]},THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(p0,p1,p2,p3,p4,p5){var planes=this.planes;return planes[0].copy(p0),planes[1].copy(p1),planes[2].copy(p2),planes[3].copy(p3),planes[4].copy(p4),planes[5].copy(p5),this},copy:function(frustum){for(var planes=this.planes,i=0;6>i;i++)planes[i].copy(frustum.planes[i]);return this},setFromMatrix:function(m){var planes=this.planes,me=m.elements,me0=me[0],me1=me[1],me2=me[2],me3=me[3],me4=me[4],me5=me[5],me6=me[6],me7=me[7],me8=me[8],me9=me[9],me10=me[10],me11=me[11],me12=me[12],me13=me[13],me14=me[14],me15=me[15];return planes[0].setComponents(me3-me0,me7-me4,me11-me8,me15-me12).normalize(),planes[1].setComponents(me3+me0,me7+me4,me11+me8,me15+me12).normalize(),planes[2].setComponents(me3+me1,me7+me5,me11+me9,me15+me13).normalize(),planes[3].setComponents(me3-me1,me7-me5,me11-me9,me15-me13).normalize(),planes[4].setComponents(me3-me2,me7-me6,me11-me10,me15-me14).normalize(),planes[5].setComponents(me3+me2,me7+me6,me11+me10,me15+me14).normalize(),this},intersectsObject:function(){var sphere=new THREE.Sphere;return function(object){var geometry=object.geometry;return null===geometry.boundingSphere&&geometry.computeBoundingSphere(),sphere.copy(geometry.boundingSphere),sphere.applyMatrix4(object.matrixWorld),this.intersectsSphere(sphere)}}(),intersectsSphere:function(sphere){for(var planes=this.planes,center=sphere.center,negRadius=-sphere.radius,i=0;6>i;i++){var distance=planes[i].distanceToPoint(center);if(negRadius>distance)return!1}return!0},intersectsBox:function(){var p1=new THREE.Vector3,p2=new THREE.Vector3;return function(box){for(var planes=this.planes,i=0;6>i;i++){var plane=planes[i];p1.x=plane.normal.x>0?box.min.x:box.max.x,p2.x=plane.normal.x>0?box.max.x:box.min.x,p1.y=plane.normal.y>0?box.min.y:box.max.y,p2.y=plane.normal.y>0?box.max.y:box.min.y,p1.z=plane.normal.z>0?box.min.z:box.max.z,p2.z=plane.normal.z>0?box.max.z:box.min.z;var d1=plane.distanceToPoint(p1),d2=plane.distanceToPoint(p2);if(0>d1&&0>d2)return!1}return!0}}(),containsPoint:function(point){for(var planes=this.planes,i=0;6>i;i++)if(planes[i].distanceToPoint(point)<0)return!1;return!0},clone:function(){return(new THREE.Frustum).copy(this)}},THREE.Plane=function(normal,constant){this.normal=void 0!==normal?normal:new THREE.Vector3(1,0,0),this.constant=void 0!==constant?constant:0},THREE.Plane.prototype={constructor:THREE.Plane,set:function(normal,constant){return this.normal.copy(normal),this.constant=constant,this},setComponents:function(x,y,z,w){return this.normal.set(x,y,z),this.constant=w,this},setFromNormalAndCoplanarPoint:function(normal,point){return this.normal.copy(normal),this.constant=-point.dot(this.normal),this},setFromCoplanarPoints:function(){var v1=new THREE.Vector3,v2=new THREE.Vector3;return function(a,b,c){var normal=v1.subVectors(c,b).cross(v2.subVectors(a,b)).normalize();return this.setFromNormalAndCoplanarPoint(normal,a),this}}(),copy:function(plane){return this.normal.copy(plane.normal),this.constant=plane.constant,this},normalize:function(){var inverseNormalLength=1/this.normal.length();return this.normal.multiplyScalar(inverseNormalLength),this.constant*=inverseNormalLength,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(point){return this.normal.dot(point)+this.constant},distanceToSphere:function(sphere){return this.distanceToPoint(sphere.center)-sphere.radius},projectPoint:function(point,optionalTarget){return this.orthoPoint(point,optionalTarget).sub(point).negate()},orthoPoint:function(point,optionalTarget){var perpendicularMagnitude=this.distanceToPoint(point),result=optionalTarget||new THREE.Vector3;return result.copy(this.normal).multiplyScalar(perpendicularMagnitude)},isIntersectionLine:function(line){var startSign=this.distanceToPoint(line.start),endSign=this.distanceToPoint(line.end);return 0>startSign&&endSign>0||0>endSign&&startSign>0},intersectLine:function(){var v1=new THREE.Vector3;return function(line,optionalTarget){var result=optionalTarget||new THREE.Vector3,direction=line.delta(v1),denominator=this.normal.dot(direction);if(0==denominator)return 0==this.distanceToPoint(line.start)?result.copy(line.start):void 0;var t=-(line.start.dot(this.normal)+this.constant)/denominator;return 0>t||t>1?void 0:result.copy(direction).multiplyScalar(t).add(line.start)}}(),coplanarPoint:function(optionalTarget){var result=optionalTarget||new THREE.Vector3;return result.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var v1=new THREE.Vector3,v2=new THREE.Vector3,m1=new THREE.Matrix3;return function(matrix,optionalNormalMatrix){var normalMatrix=optionalNormalMatrix||m1.getNormalMatrix(matrix),newNormal=v1.copy(this.normal).applyMatrix3(normalMatrix),newCoplanarPoint=this.coplanarPoint(v2);return newCoplanarPoint.applyMatrix4(matrix),this.setFromNormalAndCoplanarPoint(newNormal,newCoplanarPoint),this}}(),translate:function(offset){return this.constant=this.constant-offset.dot(this.normal),this},equals:function(plane){return plane.normal.equals(this.normal)&&plane.constant==this.constant},clone:function(){return(new THREE.Plane).copy(this)}},THREE.Math={generateUUID:function(){var r,chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),uuid=new Array(36),rnd=0;return function(){for(var i=0;36>i;i++)8==i||13==i||18==i||23==i?uuid[i]="-":14==i?uuid[i]="4":(2>=rnd&&(rnd=33554432+16777216*Math.random()|0),r=15&rnd,rnd>>=4,uuid[i]=chars[19==i?3&r|8:r]);return uuid.join("")}}(),clamp:function(x,a,b){return a>x?a:x>b?b:x},clampBottom:function(x,a){return a>x?a:x},mapLinear:function(x,a1,a2,b1,b2){return b1+(x-a1)*(b2-b1)/(a2-a1)},smoothstep:function(x,min,max){return min>=x?0:x>=max?1:(x=(x-min)/(max-min),x*x*(3-2*x))},smootherstep:function(x,min,max){return min>=x?0:x>=max?1:(x=(x-min)/(max-min),x*x*x*(x*(6*x-15)+10))},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(low,high){return low+Math.floor(Math.random()*(high-low+1))},randFloat:function(low,high){return low+Math.random()*(high-low)},randFloatSpread:function(range){return range*(.5-Math.random())},sign:function(x){return 0>x?-1:x>0?1:0},degToRad:function(){var degreeToRadiansFactor=Math.PI/180;return function(degrees){return degrees*degreeToRadiansFactor}}(),radToDeg:function(){var radianToDegreesFactor=180/Math.PI;return function(radians){return radians*radianToDegreesFactor}}(),isPowerOfTwo:function(value){return 0===(value&value-1)&&0!==value}},THREE.Spline=function(points){function interpolate(p0,p1,p2,p3,t,t2,t3){var v0=.5*(p2-p0),v1=.5*(p3-p1);return(2*(p1-p2)+v0+v1)*t3+(-3*(p1-p2)-2*v0-v1)*t2+v0*t+p1}this.points=points;var point,intPoint,weight,w2,w3,pa,pb,pc,pd,c=[],v3={x:0,y:0,z:0};this.initFromArray=function(a){this.points=[];for(var i=0;i<a.length;i++)this.points[i]={x:a[i][0],y:a[i][1],z:a[i][2]}},this.getPoint=function(k){return point=(this.points.length-1)*k,intPoint=Math.floor(point),weight=point-intPoint,c[0]=0===intPoint?intPoint:intPoint-1,c[1]=intPoint,c[2]=intPoint>this.points.length-2?this.points.length-1:intPoint+1,c[3]=intPoint>this.points.length-3?this.points.length-1:intPoint+2,pa=this.points[c[0]],pb=this.points[c[1]],pc=this.points[c[2]],pd=this.points[c[3]],w2=weight*weight,w3=weight*w2,v3.x=interpolate(pa.x,pb.x,pc.x,pd.x,weight,w2,w3),v3.y=interpolate(pa.y,pb.y,pc.y,pd.y,weight,w2,w3),v3.z=interpolate(pa.z,pb.z,pc.z,pd.z,weight,w2,w3),v3},this.getControlPointsArray=function(){var i,p,l=this.points.length,coords=[];for(i=0;l>i;i++)p=this.points[i],coords[i]=[p.x,p.y,p.z];return coords},this.getLength=function(nSubDivisions){var i,index,nSamples,position,point=0,intPoint=0,oldIntPoint=0,oldPosition=new THREE.Vector3,tmpVec=new THREE.Vector3,chunkLengths=[],totalLength=0;for(chunkLengths[0]=0,nSubDivisions||(nSubDivisions=100),nSamples=this.points.length*nSubDivisions,oldPosition.copy(this.points[0]),i=1;nSamples>i;i++)index=i/nSamples,position=this.getPoint(index),tmpVec.copy(position),totalLength+=tmpVec.distanceTo(oldPosition),oldPosition.copy(position),point=(this.points.length-1)*index,intPoint=Math.floor(point),intPoint!=oldIntPoint&&(chunkLengths[intPoint]=totalLength,oldIntPoint=intPoint);return chunkLengths[chunkLengths.length]=totalLength,{chunks:chunkLengths,total:totalLength}},this.reparametrizeByArcLength=function(samplingCoef){var i,j,index,indexCurrent,indexNext,realDistance,sampling,position,newpoints=[],tmpVec=new THREE.Vector3,sl=this.getLength();for(newpoints.push(tmpVec.copy(this.points[0]).clone()),i=1;i<this.points.length;i++){for(realDistance=sl.chunks[i]-sl.chunks[i-1],sampling=Math.ceil(samplingCoef*realDistance/sl.total),indexCurrent=(i-1)/(this.points.length-1),indexNext=i/(this.points.length-1),j=1;sampling-1>j;j++)index=indexCurrent+j*(1/sampling)*(indexNext-indexCurrent),position=this.getPoint(index),newpoints.push(tmpVec.copy(position).clone());newpoints.push(tmpVec.copy(this.points[i]).clone())}this.points=newpoints}},THREE.Triangle=function(a,b,c){this.a=void 0!==a?a:new THREE.Vector3,this.b=void 0!==b?b:new THREE.Vector3,this.c=void 0!==c?c:new THREE.Vector3},THREE.Triangle.normal=function(){var v0=new THREE.Vector3;return function(a,b,c,optionalTarget){var result=optionalTarget||new THREE.Vector3;result.subVectors(c,b),v0.subVectors(a,b),result.cross(v0);var resultLengthSq=result.lengthSq();return resultLengthSq>0?result.multiplyScalar(1/Math.sqrt(resultLengthSq)):result.set(0,0,0)}}(),THREE.Triangle.barycoordFromPoint=function(){var v0=new THREE.Vector3,v1=new THREE.Vector3,v2=new THREE.Vector3;return function(point,a,b,c,optionalTarget){v0.subVectors(c,a),v1.subVectors(b,a),v2.subVectors(point,a);var dot00=v0.dot(v0),dot01=v0.dot(v1),dot02=v0.dot(v2),dot11=v1.dot(v1),dot12=v1.dot(v2),denom=dot00*dot11-dot01*dot01,result=optionalTarget||new THREE.Vector3;if(0==denom)return result.set(-2,-1,-1);var invDenom=1/denom,u=(dot11*dot02-dot01*dot12)*invDenom,v=(dot00*dot12-dot01*dot02)*invDenom;return result.set(1-u-v,v,u)}}(),THREE.Triangle.containsPoint=function(){var v1=new THREE.Vector3;return function(point,a,b,c){var result=THREE.Triangle.barycoordFromPoint(point,a,b,c,v1);return result.x>=0&&result.y>=0&&result.x+result.y<=1}}(),THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(a,b,c){return this.a.copy(a),this.b.copy(b),this.c.copy(c),this},setFromPointsAndIndices:function(points,i0,i1,i2){return this.a.copy(points[i0]),this.b.copy(points[i1]),this.c.copy(points[i2]),this},copy:function(triangle){return this.a.copy(triangle.a),this.b.copy(triangle.b),this.c.copy(triangle.c),this},area:function(){var v0=new THREE.Vector3,v1=new THREE.Vector3;return function(){return v0.subVectors(this.c,this.b),v1.subVectors(this.a,this.b),.5*v0.cross(v1).length()}}(),midpoint:function(optionalTarget){var result=optionalTarget||new THREE.Vector3;return result.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(optionalTarget){return THREE.Triangle.normal(this.a,this.b,this.c,optionalTarget)},plane:function(optionalTarget){var result=optionalTarget||new THREE.Plane;return result.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(point,optionalTarget){return THREE.Triangle.barycoordFromPoint(point,this.a,this.b,this.c,optionalTarget)},containsPoint:function(point){return THREE.Triangle.containsPoint(point,this.a,this.b,this.c)},equals:function(triangle){return triangle.a.equals(this.a)&&triangle.b.equals(this.b)&&triangle.c.equals(this.c)},clone:function(){return(new THREE.Triangle).copy(this)}},THREE.Clock=function(autoStart){this.autoStart=void 0!==autoStart?autoStart:!0,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1},THREE.Clock.prototype={constructor:THREE.Clock,start:function(){this.startTime=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now(),this.oldTime=this.startTime,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var diff=0;if(this.autoStart&&!this.running&&this.start(),this.running){var newTime=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now();diff=.001*(newTime-this.oldTime),this.oldTime=newTime,this.elapsedTime+=diff}return diff}},THREE.EventDispatcher=function(){},THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,apply:function(object){object.addEventListener=THREE.EventDispatcher.prototype.addEventListener,object.hasEventListener=THREE.EventDispatcher.prototype.hasEventListener,object.removeEventListener=THREE.EventDispatcher.prototype.removeEventListener,object.dispatchEvent=THREE.EventDispatcher.prototype.dispatchEvent},addEventListener:function(type,listener){void 0===this._listeners&&(this._listeners={});var listeners=this._listeners;void 0===listeners[type]&&(listeners[type]=[]),-1===listeners[type].indexOf(listener)&&listeners[type].push(listener)},hasEventListener:function(type,listener){if(void 0===this._listeners)return!1;var listeners=this._listeners;return void 0!==listeners[type]&&-1!==listeners[type].indexOf(listener)?!0:!1},removeEventListener:function(type,listener){if(void 0!==this._listeners){var listeners=this._listeners,listenerArray=listeners[type];if(void 0!==listenerArray){var index=listenerArray.indexOf(listener);-1!==index&&listenerArray.splice(index,1)}}},dispatchEvent:function(event){if(void 0!==this._listeners){var listeners=this._listeners,listenerArray=listeners[event.type];if(void 0!==listenerArray){event.target=this;for(var array=[],length=listenerArray.length,i=0;length>i;i++)array[i]=listenerArray[i];for(var i=0;length>i;i++)array[i].call(this,event)}}}},function(THREE){THREE.Raycaster=function(origin,direction,near,far){this.ray=new THREE.Ray(origin,direction),this.near=near||0,this.far=far||1/0,this.params={Sprite:{},Mesh:{},PointCloud:{threshold:1},LOD:{},Line:{}}};var descSort=function(a,b){return a.distance-b.distance},intersectObject=function(object,raycaster,intersects,recursive){if(object.raycast(raycaster,intersects),recursive===!0)for(var children=object.children,i=0,l=children.length;l>i;i++)intersectObject(children[i],raycaster,intersects,!0)};THREE.Raycaster.prototype={constructor:THREE.Raycaster,precision:1e-4,linePrecision:1,set:function(origin,direction){this.ray.set(origin,direction)},intersectObject:function(object,recursive){var intersects=[];return intersectObject(object,this,intersects,recursive),intersects.sort(descSort),intersects},intersectObjects:function(objects,recursive){for(var intersects=[],i=0,l=objects.length;l>i;i++)intersectObject(objects[i],this,intersects,recursive);return intersects.sort(descSort),intersects}}}(THREE),THREE.Object3D=function(){this.id=THREE.Object3DIdCount++,this.uuid=THREE.Math.generateUUID(),this.name="",this.parent=void 0,this.children=[],this.up=THREE.Object3D.DefaultUp.clone();var position=new THREE.Vector3,rotation=new THREE.Euler,quaternion=new THREE.Quaternion,scale=new THREE.Vector3(1,1,1);rotation.onChange(function(){quaternion.setFromEuler(rotation,!1)}),quaternion.onChange(function(){rotation.setFromQuaternion(quaternion,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:position},rotation:{enumerable:!0,value:rotation},quaternion:{enumerable:!0,value:quaternion},scale:{enumerable:!0,value:scale}}),this.renderDepth=null,this.rotationAutoUpdate=!0,this.matrix=new THREE.Matrix4,this.matrixWorld=new THREE.Matrix4,this.matrixAutoUpdate=!0,this.matrixWorldNeedsUpdate=!1,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.userData={}},THREE.Object3D.DefaultUp=new THREE.Vector3(0,1,0),THREE.Object3D.prototype={constructor:THREE.Object3D,get eulerOrder(){return console.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order."),this.rotation.order},set eulerOrder(value){console.warn("THREE.Object3D: .eulerOrder has been moved to .rotation.order."),this.rotation.order=value},get useQuaternion(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set useQuaternion(value){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},applyMatrix:function(matrix){this.matrix.multiplyMatrices(matrix,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(axis,angle){this.quaternion.setFromAxisAngle(axis,angle)},setRotationFromEuler:function(euler){this.quaternion.setFromEuler(euler,!0)},setRotationFromMatrix:function(m){this.quaternion.setFromRotationMatrix(m)},setRotationFromQuaternion:function(q){this.quaternion.copy(q)},rotateOnAxis:function(){var q1=new THREE.Quaternion;return function(axis,angle){return q1.setFromAxisAngle(axis,angle),this.quaternion.multiply(q1),this}}(),rotateX:function(){var v1=new THREE.Vector3(1,0,0);return function(angle){return this.rotateOnAxis(v1,angle)}}(),rotateY:function(){var v1=new THREE.Vector3(0,1,0);return function(angle){return this.rotateOnAxis(v1,angle)}}(),rotateZ:function(){var v1=new THREE.Vector3(0,0,1);return function(angle){return this.rotateOnAxis(v1,angle)}}(),translateOnAxis:function(){var v1=new THREE.Vector3;return function(axis,distance){return v1.copy(axis).applyQuaternion(this.quaternion),this.position.add(v1.multiplyScalar(distance)),this}}(),translate:function(distance,axis){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(axis,distance)},translateX:function(){var v1=new THREE.Vector3(1,0,0);return function(distance){return this.translateOnAxis(v1,distance)}}(),translateY:function(){var v1=new THREE.Vector3(0,1,0);return function(distance){return this.translateOnAxis(v1,distance)}}(),translateZ:function(){var v1=new THREE.Vector3(0,0,1);return function(distance){return this.translateOnAxis(v1,distance)}}(),localToWorld:function(vector){return vector.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var m1=new THREE.Matrix4;return function(vector){return vector.applyMatrix4(m1.getInverse(this.matrixWorld))}}(),lookAt:function(){var m1=new THREE.Matrix4;return function(vector){m1.lookAt(vector,this.position,this.up),this.quaternion.setFromRotationMatrix(m1)}}(),add:function(object){if(arguments.length>1){for(var i=0;i<arguments.length;i++)this.add(arguments[i]);return this}if(object===this)return console.error("THREE.Object3D.add:",object,"can't be added as a child of itself."),this;if(object instanceof THREE.Object3D){void 0!==object.parent&&object.parent.remove(object),object.parent=this,object.dispatchEvent({type:"added"}),this.children.push(object);for(var scene=this;void 0!==scene.parent;)scene=scene.parent;void 0!==scene&&scene instanceof THREE.Scene&&scene.__addObject(object)}else console.error("THREE.Object3D.add:",object,"is not an instance of THREE.Object3D.");return this},remove:function(object){if(arguments.length>1)for(var i=0;i<arguments.length;i++)this.remove(arguments[i]);var index=this.children.indexOf(object);if(-1!==index){object.parent=void 0,object.dispatchEvent({type:"removed"}),this.children.splice(index,1);for(var scene=this;void 0!==scene.parent;)scene=scene.parent;void 0!==scene&&scene instanceof THREE.Scene&&scene.__removeObject(object)}},raycast:function(){},traverse:function(callback){callback(this);for(var i=0,l=this.children.length;l>i;i++)this.children[i].traverse(callback)},traverseVisible:function(callback){if(this.visible!==!1){callback(this);for(var i=0,l=this.children.length;l>i;i++)this.children[i].traverseVisible(callback)}},getObjectById:function(id,recursive){for(var i=0,l=this.children.length;l>i;i++){var child=this.children[i];if(child.id===id)return child;if(recursive===!0&&(child=child.getObjectById(id,recursive),void 0!==child))return child}return void 0},getObjectByName:function(name,recursive){for(var i=0,l=this.children.length;l>i;i++){var child=this.children[i];
if(child.name===name)return child;if(recursive===!0&&(child=child.getObjectByName(name,recursive),void 0!==child))return child}return void 0},getChildByName:function(name,recursive){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(name,recursive)},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(force){this.matrixAutoUpdate===!0&&this.updateMatrix(),(this.matrixWorldNeedsUpdate===!0||force===!0)&&(void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,force=!0);for(var i=0,l=this.children.length;l>i;i++)this.children[i].updateMatrixWorld(force)},clone:function(object,recursive){if(void 0===object&&(object=new THREE.Object3D),void 0===recursive&&(recursive=!0),object.name=this.name,object.up.copy(this.up),object.position.copy(this.position),object.quaternion.copy(this.quaternion),object.scale.copy(this.scale),object.renderDepth=this.renderDepth,object.rotationAutoUpdate=this.rotationAutoUpdate,object.matrix.copy(this.matrix),object.matrixWorld.copy(this.matrixWorld),object.matrixAutoUpdate=this.matrixAutoUpdate,object.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,object.visible=this.visible,object.castShadow=this.castShadow,object.receiveShadow=this.receiveShadow,object.frustumCulled=this.frustumCulled,object.userData=JSON.parse(JSON.stringify(this.userData)),recursive===!0)for(var i=0;i<this.children.length;i++){var child=this.children[i];object.add(child.clone())}return object}},THREE.EventDispatcher.prototype.apply(THREE.Object3D.prototype),THREE.Object3DIdCount=0,THREE.Projector=function(){function getNextObjectInPool(){if(_objectCount===_objectPoolLength){var object=new THREE.RenderableObject;return _objectPool.push(object),_objectPoolLength++,_objectCount++,object}return _objectPool[_objectCount++]}function getNextVertexInPool(){if(_vertexCount===_vertexPoolLength){var vertex=new THREE.RenderableVertex;return _vertexPool.push(vertex),_vertexPoolLength++,_vertexCount++,vertex}return _vertexPool[_vertexCount++]}function getNextFaceInPool(){if(_faceCount===_facePoolLength){var face=new THREE.RenderableFace;return _facePool.push(face),_facePoolLength++,_faceCount++,face}return _facePool[_faceCount++]}function getNextLineInPool(){if(_lineCount===_linePoolLength){var line=new THREE.RenderableLine;return _linePool.push(line),_linePoolLength++,_lineCount++,line}return _linePool[_lineCount++]}function getNextSpriteInPool(){if(_spriteCount===_spritePoolLength){var sprite=new THREE.RenderableSprite;return _spritePool.push(sprite),_spritePoolLength++,_spriteCount++,sprite}return _spritePool[_spriteCount++]}function painterSort(a,b){return a.z!==b.z?b.z-a.z:a.id!==b.id?a.id-b.id:0}function clipLine(s1,s2){var alpha1=0,alpha2=1,bc1near=s1.z+s1.w,bc2near=s2.z+s2.w,bc1far=-s1.z+s1.w,bc2far=-s2.z+s2.w;return bc1near>=0&&bc2near>=0&&bc1far>=0&&bc2far>=0?!0:0>bc1near&&0>bc2near||0>bc1far&&0>bc2far?!1:(0>bc1near?alpha1=Math.max(alpha1,bc1near/(bc1near-bc2near)):0>bc2near&&(alpha2=Math.min(alpha2,bc1near/(bc1near-bc2near))),0>bc1far?alpha1=Math.max(alpha1,bc1far/(bc1far-bc2far)):0>bc2far&&(alpha2=Math.min(alpha2,bc1far/(bc1far-bc2far))),alpha1>alpha2?!1:(s1.lerp(s2,alpha1),s2.lerp(s1,1-alpha2),!0))}var _object,_objectCount,_vertex,_vertexCount,_face,_faceCount,_line,_lineCount,_sprite,_spriteCount,_modelMatrix,_objectPool=[],_objectPoolLength=0,_vertexPool=[],_vertexPoolLength=0,_facePool=[],_facePoolLength=0,_linePool=[],_linePoolLength=0,_spritePool=[],_spritePoolLength=0,_renderData={objects:[],lights:[],elements:[]},_vA=new THREE.Vector3,_vB=new THREE.Vector3,_vC=new THREE.Vector3,_vector3=new THREE.Vector3,_vector4=new THREE.Vector4,_clipBox=new THREE.Box3(new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,1,1)),_boundingBox=new THREE.Box3,_points3=new Array(3),_viewMatrix=(new Array(4),new THREE.Matrix4),_viewProjectionMatrix=new THREE.Matrix4,_modelViewProjectionMatrix=new THREE.Matrix4,_normalMatrix=new THREE.Matrix3,_frustum=new THREE.Frustum,_clippedVertex1PositionScreen=new THREE.Vector4,_clippedVertex2PositionScreen=new THREE.Vector4;this.projectVector=function(vector,camera){return camera.matrixWorldInverse.getInverse(camera.matrixWorld),_viewProjectionMatrix.multiplyMatrices(camera.projectionMatrix,camera.matrixWorldInverse),vector.applyProjection(_viewProjectionMatrix)},this.unprojectVector=function(){var projectionMatrixInverse=new THREE.Matrix4;return function(vector,camera){return projectionMatrixInverse.getInverse(camera.projectionMatrix),_viewProjectionMatrix.multiplyMatrices(camera.matrixWorld,projectionMatrixInverse),vector.applyProjection(_viewProjectionMatrix)}}(),this.pickingRay=function(vector,camera){vector.z=-1;var end=new THREE.Vector3(vector.x,vector.y,1);return this.unprojectVector(vector,camera),this.unprojectVector(end,camera),end.sub(vector).normalize(),new THREE.Raycaster(vector,end)};var RenderList=function(){var normals=[],uvs=[],object=null,material=null,normalMatrix=new THREE.Matrix3,setObject=function(value){object=value,material=object.material,normalMatrix.getNormalMatrix(object.matrixWorld),normals.length=0,uvs.length=0},projectVertex=function(vertex){var position=vertex.position,positionWorld=vertex.positionWorld,positionScreen=vertex.positionScreen;positionWorld.copy(position).applyMatrix4(_modelMatrix),positionScreen.copy(positionWorld).applyMatrix4(_viewProjectionMatrix);var invW=1/positionScreen.w;positionScreen.x*=invW,positionScreen.y*=invW,positionScreen.z*=invW,vertex.visible=positionScreen.x>=-1&&positionScreen.x<=1&&positionScreen.y>=-1&&positionScreen.y<=1&&positionScreen.z>=-1&&positionScreen.z<=1},pushVertex=function(x,y,z){_vertex=getNextVertexInPool(),_vertex.position.set(x,y,z),projectVertex(_vertex)},pushNormal=function(x,y,z){normals.push(x,y,z)},pushUv=function(x,y){uvs.push(x,y)},checkTriangleVisibility=function(v1,v2,v3){return v1.visible===!0||v2.visible===!0||v3.visible===!0?!0:(_points3[0]=v1.positionScreen,_points3[1]=v2.positionScreen,_points3[2]=v3.positionScreen,_clipBox.isIntersectionBox(_boundingBox.setFromPoints(_points3)))},checkBackfaceCulling=function(v1,v2,v3){return(v3.positionScreen.x-v1.positionScreen.x)*(v2.positionScreen.y-v1.positionScreen.y)-(v3.positionScreen.y-v1.positionScreen.y)*(v2.positionScreen.x-v1.positionScreen.x)<0},pushLine=function(a,b){var v1=_vertexPool[a],v2=_vertexPool[b];_line=getNextLineInPool(),_line.id=object.id,_line.v1.copy(v1),_line.v2.copy(v2),_line.z=(v1.positionScreen.z+v2.positionScreen.z)/2,_line.material=object.material,_renderData.elements.push(_line)},pushTriangle=function(a,b,c){var v1=_vertexPool[a],v2=_vertexPool[b],v3=_vertexPool[c];if(checkTriangleVisibility(v1,v2,v3)!==!1&&(material.side===THREE.DoubleSide||checkBackfaceCulling(v1,v2,v3)===!0)){_face=getNextFaceInPool(),_face.id=object.id,_face.v1.copy(v1),_face.v2.copy(v2),_face.v3.copy(v3),_face.z=(v1.positionScreen.z+v2.positionScreen.z+v3.positionScreen.z)/3;for(var i=0;3>i;i++){var offset=3*arguments[i],normal=_face.vertexNormalsModel[i];normal.set(normals[offset],normals[offset+1],normals[offset+2]),normal.applyMatrix3(normalMatrix).normalize();var offset2=2*arguments[i],uv=_face.uvs[i];uv.set(uvs[offset2],uvs[offset2+1])}_face.vertexNormalsLength=3,_face.material=object.material,_renderData.elements.push(_face)}};return{setObject:setObject,projectVertex:projectVertex,checkTriangleVisibility:checkTriangleVisibility,checkBackfaceCulling:checkBackfaceCulling,pushVertex:pushVertex,pushNormal:pushNormal,pushUv:pushUv,pushLine:pushLine,pushTriangle:pushTriangle}},renderList=new RenderList;this.projectScene=function(scene,camera,sortObjects,sortElements){_faceCount=0,_lineCount=0,_spriteCount=0,_renderData.elements.length=0,scene.autoUpdate===!0&&scene.updateMatrixWorld(),void 0===camera.parent&&camera.updateMatrixWorld(),_viewMatrix.copy(camera.matrixWorldInverse.getInverse(camera.matrixWorld)),_viewProjectionMatrix.multiplyMatrices(camera.projectionMatrix,_viewMatrix),_frustum.setFromMatrix(_viewProjectionMatrix),_objectCount=0,_renderData.objects.length=0,_renderData.lights.length=0,scene.traverseVisible(function(object){object instanceof THREE.Light?_renderData.lights.push(object):(object instanceof THREE.Mesh||object instanceof THREE.Line||object instanceof THREE.Sprite)&&(object.frustumCulled===!1||_frustum.intersectsObject(object)===!0)&&(_object=getNextObjectInPool(),_object.id=object.id,_object.object=object,null!==object.renderDepth?_object.z=object.renderDepth:(_vector3.setFromMatrixPosition(object.matrixWorld),_vector3.applyProjection(_viewProjectionMatrix),_object.z=_vector3.z),_renderData.objects.push(_object))}),sortObjects===!0&&_renderData.objects.sort(painterSort);for(var o=0,ol=_renderData.objects.length;ol>o;o++){var object=_renderData.objects[o].object,geometry=object.geometry;if(renderList.setObject(object),_modelMatrix=object.matrixWorld,_vertexCount=0,object instanceof THREE.Mesh){if(geometry instanceof THREE.BufferGeometry){var attributes=geometry.attributes,offsets=geometry.offsets;if(void 0===attributes.position)continue;for(var positions=attributes.position.array,i=0,l=positions.length;l>i;i+=3)renderList.pushVertex(positions[i],positions[i+1],positions[i+2]);if(void 0!==attributes.normal)for(var normals=attributes.normal.array,i=0,l=normals.length;l>i;i+=3)renderList.pushNormal(normals[i],normals[i+1],normals[i+2]);if(void 0!==attributes.uv)for(var uvs=attributes.uv.array,i=0,l=uvs.length;l>i;i+=2)renderList.pushUv(uvs[i],uvs[i+1]);if(void 0!==attributes.index){var indices=attributes.index.array;if(offsets.length>0)for(var o=0;o<offsets.length;o++)for(var offset=offsets[o],index=offset.index,i=offset.start,l=offset.start+offset.count;l>i;i+=3)renderList.pushTriangle(indices[i]+index,indices[i+1]+index,indices[i+2]+index);else for(var i=0,l=indices.length;l>i;i+=3)renderList.pushTriangle(indices[i],indices[i+1],indices[i+2])}else for(var i=0,l=positions.length/3;l>i;i+=3)renderList.pushTriangle(i,i+1,i+2)}else if(geometry instanceof THREE.Geometry){var vertices=geometry.vertices,faces=geometry.faces,faceVertexUvs=geometry.faceVertexUvs[0];_normalMatrix.getNormalMatrix(_modelMatrix);for(var isFaceMaterial=object.material instanceof THREE.MeshFaceMaterial,objectMaterials=isFaceMaterial===!0?object.material:null,v=0,vl=vertices.length;vl>v;v++){var vertex=vertices[v];renderList.pushVertex(vertex.x,vertex.y,vertex.z)}for(var f=0,fl=faces.length;fl>f;f++){var face=faces[f],material=isFaceMaterial===!0?objectMaterials.materials[face.materialIndex]:object.material;if(void 0!==material){var side=material.side,v1=_vertexPool[face.a],v2=_vertexPool[face.b],v3=_vertexPool[face.c];if(material.morphTargets===!0){var morphTargets=geometry.morphTargets,morphInfluences=object.morphTargetInfluences,v1p=v1.position,v2p=v2.position,v3p=v3.position;_vA.set(0,0,0),_vB.set(0,0,0),_vC.set(0,0,0);for(var t=0,tl=morphTargets.length;tl>t;t++){var influence=morphInfluences[t];if(0!==influence){var targets=morphTargets[t].vertices;_vA.x+=(targets[face.a].x-v1p.x)*influence,_vA.y+=(targets[face.a].y-v1p.y)*influence,_vA.z+=(targets[face.a].z-v1p.z)*influence,_vB.x+=(targets[face.b].x-v2p.x)*influence,_vB.y+=(targets[face.b].y-v2p.y)*influence,_vB.z+=(targets[face.b].z-v2p.z)*influence,_vC.x+=(targets[face.c].x-v3p.x)*influence,_vC.y+=(targets[face.c].y-v3p.y)*influence,_vC.z+=(targets[face.c].z-v3p.z)*influence}}v1.position.add(_vA),v2.position.add(_vB),v3.position.add(_vC),renderList.projectVertex(v1),renderList.projectVertex(v2),renderList.projectVertex(v3)}if(renderList.checkTriangleVisibility(v1,v2,v3)!==!1){var visible=renderList.checkBackfaceCulling(v1,v2,v3);if(side!==THREE.DoubleSide){if(side===THREE.FrontSide&&visible===!1)continue;if(side===THREE.BackSide&&visible===!0)continue}_face=getNextFaceInPool(),_face.id=object.id,_face.v1.copy(v1),_face.v2.copy(v2),_face.v3.copy(v3),_face.normalModel.copy(face.normal),visible!==!1||side!==THREE.BackSide&&side!==THREE.DoubleSide||_face.normalModel.negate(),_face.normalModel.applyMatrix3(_normalMatrix).normalize();for(var faceVertexNormals=face.vertexNormals,n=0,nl=Math.min(faceVertexNormals.length,3);nl>n;n++){var normalModel=_face.vertexNormalsModel[n];normalModel.copy(faceVertexNormals[n]),visible!==!1||side!==THREE.BackSide&&side!==THREE.DoubleSide||normalModel.negate(),normalModel.applyMatrix3(_normalMatrix).normalize()}_face.vertexNormalsLength=faceVertexNormals.length;var vertexUvs=faceVertexUvs[f];if(void 0!==vertexUvs)for(var u=0;3>u;u++)_face.uvs[u].copy(vertexUvs[u]);_face.color=face.color,_face.material=material,_face.z=(v1.positionScreen.z+v2.positionScreen.z+v3.positionScreen.z)/3,_renderData.elements.push(_face)}}}}}else if(object instanceof THREE.Line){if(geometry instanceof THREE.BufferGeometry){var attributes=geometry.attributes;if(void 0!==attributes.position){for(var positions=attributes.position.array,i=0,l=positions.length;l>i;i+=3)renderList.pushVertex(positions[i],positions[i+1],positions[i+2]);if(void 0!==attributes.index)for(var indices=attributes.index.array,i=0,l=indices.length;l>i;i+=2)renderList.pushLine(indices[i],indices[i+1]);else for(var step=object.type===THREE.LinePieces?2:1,i=0,l=positions.length/3-1;l>i;i+=step)renderList.pushLine(i,i+1)}}else if(geometry instanceof THREE.Geometry){_modelViewProjectionMatrix.multiplyMatrices(_viewProjectionMatrix,_modelMatrix);var vertices=object.geometry.vertices;if(0===vertices.length)continue;v1=getNextVertexInPool(),v1.positionScreen.copy(vertices[0]).applyMatrix4(_modelViewProjectionMatrix);for(var step=object.type===THREE.LinePieces?2:1,v=1,vl=vertices.length;vl>v;v++)v1=getNextVertexInPool(),v1.positionScreen.copy(vertices[v]).applyMatrix4(_modelViewProjectionMatrix),(v+1)%step>0||(v2=_vertexPool[_vertexCount-2],_clippedVertex1PositionScreen.copy(v1.positionScreen),_clippedVertex2PositionScreen.copy(v2.positionScreen),clipLine(_clippedVertex1PositionScreen,_clippedVertex2PositionScreen)===!0&&(_clippedVertex1PositionScreen.multiplyScalar(1/_clippedVertex1PositionScreen.w),_clippedVertex2PositionScreen.multiplyScalar(1/_clippedVertex2PositionScreen.w),_line=getNextLineInPool(),_line.id=object.id,_line.v1.positionScreen.copy(_clippedVertex1PositionScreen),_line.v2.positionScreen.copy(_clippedVertex2PositionScreen),_line.z=Math.max(_clippedVertex1PositionScreen.z,_clippedVertex2PositionScreen.z),_line.material=object.material,object.material.vertexColors===THREE.VertexColors&&(_line.vertexColors[0].copy(object.geometry.colors[v]),_line.vertexColors[1].copy(object.geometry.colors[v-1])),_renderData.elements.push(_line)))}}else if(object instanceof THREE.Sprite){_vector4.set(_modelMatrix.elements[12],_modelMatrix.elements[13],_modelMatrix.elements[14],1),_vector4.applyMatrix4(_viewProjectionMatrix);var invW=1/_vector4.w;_vector4.z*=invW,_vector4.z>=-1&&_vector4.z<=1&&(_sprite=getNextSpriteInPool(),_sprite.id=object.id,_sprite.x=_vector4.x*invW,_sprite.y=_vector4.y*invW,_sprite.z=_vector4.z,_sprite.object=object,_sprite.rotation=object.rotation,_sprite.scale.x=object.scale.x*Math.abs(_sprite.x-(_vector4.x+camera.projectionMatrix.elements[0])/(_vector4.w+camera.projectionMatrix.elements[12])),_sprite.scale.y=object.scale.y*Math.abs(_sprite.y-(_vector4.y+camera.projectionMatrix.elements[5])/(_vector4.w+camera.projectionMatrix.elements[13])),_sprite.material=object.material,_renderData.elements.push(_sprite))}}return sortElements===!0&&_renderData.elements.sort(painterSort),_renderData}},THREE.Face3=function(a,b,c,normal,color,materialIndex){this.a=a,this.b=b,this.c=c,this.normal=normal instanceof THREE.Vector3?normal:new THREE.Vector3,this.vertexNormals=normal instanceof Array?normal:[],this.color=color instanceof THREE.Color?color:new THREE.Color,this.vertexColors=color instanceof Array?color:[],this.vertexTangents=[],this.materialIndex=void 0!==materialIndex?materialIndex:0},THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){var face=new THREE.Face3(this.a,this.b,this.c);face.normal.copy(this.normal),face.color.copy(this.color),face.materialIndex=this.materialIndex;for(var i=0,il=this.vertexNormals.length;il>i;i++)face.vertexNormals[i]=this.vertexNormals[i].clone();for(var i=0,il=this.vertexColors.length;il>i;i++)face.vertexColors[i]=this.vertexColors[i].clone();for(var i=0,il=this.vertexTangents.length;il>i;i++)face.vertexTangents[i]=this.vertexTangents[i].clone();return face}},THREE.Face4=function(a,b,c,d,normal,color,materialIndex){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new THREE.Face3(a,b,c,normal,color,materialIndex)},THREE.BufferAttribute=function(array,itemSize){this.array=array,this.itemSize=itemSize},THREE.BufferAttribute.prototype={constructor:THREE.BufferAttribute,get length(){return this.array.length},set:function(value){return this.array.set(value),this},setX:function(index,x){return this.array[index*this.itemSize]=x,this},setY:function(index,y){return this.array[index*this.itemSize+1]=y,this},setZ:function(index,z){return this.array[index*this.itemSize+2]=z,this},setXY:function(index,x,y){return index*=this.itemSize,this.array[index]=x,this.array[index+1]=y,this},setXYZ:function(index,x,y,z){return index*=this.itemSize,this.array[index]=x,this.array[index+1]=y,this.array[index+2]=z,this},setXYZW:function(index,x,y,z,w){return index*=this.itemSize,this.array[index]=x,this.array[index+1]=y,this.array[index+2]=z,this.array[index+3]=w,this}},THREE.Int8Attribute=function(data,itemSize){return console.warn("THREE.Int8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new THREE.BufferAttribute(data,itemSize)},THREE.Uint8Attribute=function(data,itemSize){return console.warn("THREE.Uint8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new THREE.BufferAttribute(data,itemSize)},THREE.Uint8ClampedAttribute=function(data,itemSize){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new THREE.BufferAttribute(data,itemSize)},THREE.Int16Attribute=function(data,itemSize){return console.warn("THREE.Int16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new THREE.BufferAttribute(data,itemSize)},THREE.Uint16Attribute=function(data,itemSize){return console.warn("THREE.Uint16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new THREE.BufferAttribute(data,itemSize)},THREE.Int32Attribute=function(data,itemSize){return console.warn("THREE.Int32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new THREE.BufferAttribute(data,itemSize)},THREE.Uint32Attribute=function(data,itemSize){return console.warn("THREE.Uint32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new THREE.BufferAttribute(data,itemSize)},THREE.Float32Attribute=function(data,itemSize){return console.warn("THREE.Float32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new THREE.BufferAttribute(data,itemSize)},THREE.Float64Attribute=function(data,itemSize){return console.warn("THREE.Float64Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead."),new THREE.BufferAttribute(data,itemSize)},THREE.BufferGeometry=function(){this.id=THREE.GeometryIdCount++,this.uuid=THREE.Math.generateUUID(),this.name="",this.attributes={},this.drawcalls=[],this.offsets=this.drawcalls,this.boundingBox=null,this.boundingSphere=null},THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,addAttribute:function(name,attribute){return attribute instanceof THREE.BufferAttribute==!1?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void(this.attributes[name]={array:arguments[1],itemSize:arguments[2]})):void(this.attributes[name]=attribute)},getAttribute:function(name){return this.attributes[name]},addDrawCall:function(start,count,indexOffset){this.drawcalls.push({start:start,count:count,index:void 0!==indexOffset?indexOffset:0})},applyMatrix:function(matrix){var position=this.attributes.position;void 0!==position&&(matrix.applyToVector3Array(position.array),position.needsUpdate=!0);var normal=this.attributes.normal;if(void 0!==normal){var normalMatrix=(new THREE.Matrix3).getNormalMatrix(matrix);normalMatrix.applyToVector3Array(normal.array),normal.needsUpdate=!0}},fromGeometry:function(geometry,settings){settings=settings||{vertexColors:THREE.NoColors};var vertices=geometry.vertices,faces=geometry.faces,faceVertexUvs=geometry.faceVertexUvs,vertexColors=settings.vertexColors,hasFaceVertexUv=faceVertexUvs[0].length>0,hasFaceVertexNormals=3==faces[0].vertexNormals.length,positions=new Float32Array(3*faces.length*3);this.addAttribute("position",new THREE.BufferAttribute(positions,3));var normals=new Float32Array(3*faces.length*3);if(this.addAttribute("normal",new THREE.BufferAttribute(normals,3)),vertexColors!==THREE.NoColors){var colors=new Float32Array(3*faces.length*3);this.addAttribute("color",new THREE.BufferAttribute(colors,3))}if(hasFaceVertexUv===!0){var uvs=new Float32Array(3*faces.length*2);this.addAttribute("uvs",new THREE.BufferAttribute(uvs,2))}for(var i=0,i2=0,i3=0;i<faces.length;i++,i2+=6,i3+=9){var face=faces[i],a=vertices[face.a],b=vertices[face.b],c=vertices[face.c];if(positions[i3]=a.x,positions[i3+1]=a.y,positions[i3+2]=a.z,positions[i3+3]=b.x,positions[i3+4]=b.y,positions[i3+5]=b.z,positions[i3+6]=c.x,positions[i3+7]=c.y,positions[i3+8]=c.z,hasFaceVertexNormals===!0){var na=face.vertexNormals[0],nb=face.vertexNormals[1],nc=face.vertexNormals[2];normals[i3]=na.x,normals[i3+1]=na.y,normals[i3+2]=na.z,normals[i3+3]=nb.x,normals[i3+4]=nb.y,normals[i3+5]=nb.z,normals[i3+6]=nc.x,normals[i3+7]=nc.y,normals[i3+8]=nc.z}else{var n=face.normal;normals[i3]=n.x,normals[i3+1]=n.y,normals[i3+2]=n.z,normals[i3+3]=n.x,normals[i3+4]=n.y,normals[i3+5]=n.z,normals[i3+6]=n.x,normals[i3+7]=n.y,normals[i3+8]=n.z}if(vertexColors===THREE.FaceColors){var fc=face.color;colors[i3]=fc.r,colors[i3+1]=fc.g,colors[i3+2]=fc.b,colors[i3+3]=fc.r,colors[i3+4]=fc.g,colors[i3+5]=fc.b,colors[i3+6]=fc.r,colors[i3+7]=fc.g,colors[i3+8]=fc.b}else if(vertexColors===THREE.VertexColors){var vca=face.vertexColors[0],vcb=face.vertexColors[1],vcc=face.vertexColors[2];colors[i3]=vca.r,colors[i3+1]=vca.g,colors[i3+2]=vca.b,colors[i3+3]=vcb.r,colors[i3+4]=vcb.g,colors[i3+5]=vcb.b,colors[i3+6]=vcc.r,colors[i3+7]=vcc.g,colors[i3+8]=vcc.b}if(hasFaceVertexUv===!0){var uva=faceVertexUvs[0][i][0],uvb=faceVertexUvs[0][i][1],uvc=faceVertexUvs[0][i][2];uvs[i2]=uva.x,uvs[i2+1]=uva.y,uvs[i2+2]=uvb.x,uvs[i2+3]=uvb.y,uvs[i2+4]=uvc.x,uvs[i2+5]=uvc.y}}return this.computeBoundingSphere(),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var positions=this.attributes.position.array;if(positions){var bb=this.boundingBox;positions.length>=3&&(bb.min.x=bb.max.x=positions[0],bb.min.y=bb.max.y=positions[1],bb.min.z=bb.max.z=positions[2]);for(var i=3,il=positions.length;il>i;i+=3){var x=positions[i],y=positions[i+1],z=positions[i+2];x<bb.min.x?bb.min.x=x:x>bb.max.x&&(bb.max.x=x),y<bb.min.y?bb.min.y=y:y>bb.max.y&&(bb.max.y=y),z<bb.min.z?bb.min.z=z:z>bb.max.z&&(bb.max.z=z)}}(void 0===positions||0===positions.length)&&(this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.')},computeBoundingSphere:function(){var box=new THREE.Box3,vector=new THREE.Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var positions=this.attributes.position.array;if(positions){box.makeEmpty();for(var center=this.boundingSphere.center,i=0,il=positions.length;il>i;i+=3)vector.set(positions[i],positions[i+1],positions[i+2]),box.expandByPoint(vector);box.center(center);for(var maxRadiusSq=0,i=0,il=positions.length;il>i;i+=3)vector.set(positions[i],positions[i+1],positions[i+2]),maxRadiusSq=Math.max(maxRadiusSq,center.distanceToSquared(vector));this.boundingSphere.radius=Math.sqrt(maxRadiusSq),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){if(this.attributes.position){var i,il,j,jl,nVertexElements=this.attributes.position.array.length;if(void 0===this.attributes.normal)this.attributes.normal={itemSize:3,array:new Float32Array(nVertexElements)};else for(i=0,il=this.attributes.normal.array.length;il>i;i++)this.attributes.normal.array[i]=0;var vA,vB,vC,x,y,z,positions=this.attributes.position.array,normals=this.attributes.normal.array,pA=new THREE.Vector3,pB=new THREE.Vector3,pC=new THREE.Vector3,cb=new THREE.Vector3,ab=new THREE.Vector3;if(this.attributes.index){var indices=this.attributes.index.array,offsets=this.offsets.length>0?this.offsets:[{start:0,count:indices.length,index:0}];for(j=0,jl=offsets.length;jl>j;++j){var start=offsets[j].start,count=offsets[j].count,index=offsets[j].index;for(i=start,il=start+count;il>i;i+=3)vA=index+indices[i],vB=index+indices[i+1],vC=index+indices[i+2],x=positions[3*vA],y=positions[3*vA+1],z=positions[3*vA+2],pA.set(x,y,z),x=positions[3*vB],y=positions[3*vB+1],z=positions[3*vB+2],pB.set(x,y,z),x=positions[3*vC],y=positions[3*vC+1],z=positions[3*vC+2],pC.set(x,y,z),cb.subVectors(pC,pB),ab.subVectors(pA,pB),cb.cross(ab),normals[3*vA]+=cb.x,normals[3*vA+1]+=cb.y,normals[3*vA+2]+=cb.z,normals[3*vB]+=cb.x,normals[3*vB+1]+=cb.y,normals[3*vB+2]+=cb.z,normals[3*vC]+=cb.x,normals[3*vC+1]+=cb.y,normals[3*vC+2]+=cb.z}}else for(i=0,il=positions.length;il>i;i+=9)x=positions[i],y=positions[i+1],z=positions[i+2],pA.set(x,y,z),x=positions[i+3],y=positions[i+4],z=positions[i+5],pB.set(x,y,z),x=positions[i+6],y=positions[i+7],z=positions[i+8],pC.set(x,y,z),cb.subVectors(pC,pB),ab.subVectors(pA,pB),cb.cross(ab),normals[i]=cb.x,normals[i+1]=cb.y,normals[i+2]=cb.z,normals[i+3]=cb.x,normals[i+4]=cb.y,normals[i+5]=cb.z,normals[i+6]=cb.x,normals[i+7]=cb.y,normals[i+8]=cb.z;this.normalizeNormals(),this.normalsNeedUpdate=!0}},computeTangents:function(){function handleTriangle(a,b,c){xA=positions[3*a],yA=positions[3*a+1],zA=positions[3*a+2],xB=positions[3*b],yB=positions[3*b+1],zB=positions[3*b+2],xC=positions[3*c],yC=positions[3*c+1],zC=positions[3*c+2],uA=uvs[2*a],vA=uvs[2*a+1],uB=uvs[2*b],vB=uvs[2*b+1],uC=uvs[2*c],vC=uvs[2*c+1],x1=xB-xA,x2=xC-xA,y1=yB-yA,y2=yC-yA,z1=zB-zA,z2=zC-zA,s1=uB-uA,s2=uC-uA,t1=vB-vA,t2=vC-vA,r=1/(s1*t2-s2*t1),sdir.set((t2*x1-t1*x2)*r,(t2*y1-t1*y2)*r,(t2*z1-t1*z2)*r),tdir.set((s1*x2-s2*x1)*r,(s1*y2-s2*y1)*r,(s1*z2-s2*z1)*r),tan1[a].add(sdir),tan1[b].add(sdir),tan1[c].add(sdir),tan2[a].add(tdir),tan2[b].add(tdir),tan2[c].add(tdir)}function handleVertex(v){n.x=normals[3*v],n.y=normals[3*v+1],n.z=normals[3*v+2],n2.copy(n),t=tan1[v],tmp.copy(t),tmp.sub(n.multiplyScalar(n.dot(t))).normalize(),tmp2.crossVectors(n2,t),test=tmp2.dot(tan2[v]),w=0>test?-1:1,tangents[4*v]=tmp.x,tangents[4*v+1]=tmp.y,tangents[4*v+2]=tmp.z,tangents[4*v+3]=w}if(void 0===this.attributes.index||void 0===this.attributes.position||void 0===this.attributes.normal||void 0===this.attributes.uv)return void console.warn("Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");var indices=this.attributes.index.array,positions=this.attributes.position.array,normals=this.attributes.normal.array,uvs=this.attributes.uv.array,nVertices=positions.length/3;if(void 0===this.attributes.tangent){var nTangentElements=4*nVertices;this.attributes.tangent={itemSize:4,array:new Float32Array(nTangentElements)}}for(var tangents=this.attributes.tangent.array,tan1=[],tan2=[],k=0;nVertices>k;k++)tan1[k]=new THREE.Vector3,tan2[k]=new THREE.Vector3;var xA,yA,zA,xB,yB,zB,xC,yC,zC,uA,vA,uB,vB,uC,vC,x1,x2,y1,y2,z1,z2,s1,s2,t1,t2,r,i,il,j,jl,iA,iB,iC,sdir=new THREE.Vector3,tdir=new THREE.Vector3,offsets=this.offsets;for(j=0,jl=offsets.length;jl>j;++j){var start=offsets[j].start,count=offsets[j].count,index=offsets[j].index;for(i=start,il=start+count;il>i;i+=3)iA=index+indices[i],iB=index+indices[i+1],iC=index+indices[i+2],handleTriangle(iA,iB,iC)}var w,t,test,tmp=new THREE.Vector3,tmp2=new THREE.Vector3,n=new THREE.Vector3,n2=new THREE.Vector3;for(j=0,jl=offsets.length;jl>j;++j){var start=offsets[j].start,count=offsets[j].count,index=offsets[j].index;for(i=start,il=start+count;il>i;i+=3)iA=index+indices[i],iB=index+indices[i+1],iC=index+indices[i+2],handleVertex(iA),handleVertex(iB),handleVertex(iC)}},computeOffsets:function(indexBufferSize){var size=indexBufferSize;void 0===indexBufferSize&&(size=65535);for(var indices=(Date.now(),this.attributes.index.array),vertices=this.attributes.position.array,facesCount=(vertices.length/3,indices.length/3),sortedIndices=new Uint16Array(indices.length),indexPtr=0,vertexPtr=0,offsets=[{start:0,count:0,index:0}],offset=offsets[0],duplicatedVertices=0,newVerticeMaps=0,faceVertices=new Int32Array(6),vertexMap=new Int32Array(vertices.length),revVertexMap=new Int32Array(vertices.length),j=0;j<vertices.length;j++)vertexMap[j]=-1,revVertexMap[j]=-1;for(var findex=0;facesCount>findex;findex++){newVerticeMaps=0;for(var vo=0;3>vo;vo++){var vid=indices[3*findex+vo];-1==vertexMap[vid]?(faceVertices[2*vo]=vid,faceVertices[2*vo+1]=-1,newVerticeMaps++):vertexMap[vid]<offset.index?(faceVertices[2*vo]=vid,faceVertices[2*vo+1]=-1,duplicatedVertices++):(faceVertices[2*vo]=vid,faceVertices[2*vo+1]=vertexMap[vid])}var faceMax=vertexPtr+newVerticeMaps;if(faceMax>offset.index+size){var new_offset={start:indexPtr,count:0,index:vertexPtr};offsets.push(new_offset),offset=new_offset;for(var v=0;6>v;v+=2){var new_vid=faceVertices[v+1];new_vid>-1&&new_vid<offset.index&&(faceVertices[v+1]=-1)}}for(var v=0;6>v;v+=2){var vid=faceVertices[v],new_vid=faceVertices[v+1];-1===new_vid&&(new_vid=vertexPtr++),vertexMap[vid]=new_vid,revVertexMap[new_vid]=vid,sortedIndices[indexPtr++]=new_vid-offset.index,offset.count++}}return this.reorderBuffers(sortedIndices,revVertexMap,vertexPtr),this.offsets=offsets,offsets},merge:function(){console.log("BufferGeometry.merge(): TODO")},normalizeNormals:function(){for(var x,y,z,n,normals=this.attributes.normal.array,i=0,il=normals.length;il>i;i+=3)x=normals[i],y=normals[i+1],z=normals[i+2],n=1/Math.sqrt(x*x+y*y+z*z),normals[i]*=n,normals[i+1]*=n,normals[i+2]*=n},reorderBuffers:function(indexBuffer,indexMap,vertexCount){var sortedAttributes={},types=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];for(var attr in this.attributes)if("index"!=attr)for(var sourceArray=this.attributes[attr].array,i=0,il=types.length;il>i;i++){var type=types[i];if(sourceArray instanceof type){sortedAttributes[attr]=new type(this.attributes[attr].itemSize*vertexCount);break}}for(var new_vid=0;vertexCount>new_vid;new_vid++){var vid=indexMap[new_vid];for(var attr in this.attributes)if("index"!=attr)for(var attrArray=this.attributes[attr].array,attrSize=this.attributes[attr].itemSize,sortedAttr=sortedAttributes[attr],k=0;attrSize>k;k++)sortedAttr[new_vid*attrSize+k]=attrArray[vid*attrSize+k]}this.attributes.index.array=indexBuffer;for(var attr in this.attributes)"index"!=attr&&(this.attributes[attr].array=sortedAttributes[attr],this.attributes[attr].numItems=this.attributes[attr].itemSize*vertexCount)},clone:function(){var geometry=new THREE.BufferGeometry,types=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];for(var attr in this.attributes){for(var sourceAttr=this.attributes[attr],sourceArray=sourceAttr.array,attribute={itemSize:sourceAttr.itemSize,array:null},i=0,il=types.length;il>i;i++){var type=types[i];
if(sourceArray instanceof type){attribute.array=new type(sourceArray);break}}geometry.attributes[attr]=attribute}for(var i=0,il=this.offsets.length;il>i;i++){var offset=this.offsets[i];geometry.offsets.push({start:offset.start,index:offset.index,count:offset.count})}return geometry},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.BufferGeometry.prototype),THREE.Geometry=function(){this.id=THREE.GeometryIdCount++,this.uuid=THREE.Math.generateUUID(),this.name="",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphColors=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.hasTangents=!1,this.dynamic=!0,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.tangentsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.buffersNeedUpdate=!1,this.groupsNeedUpdate=!1},THREE.Geometry.prototype={constructor:THREE.Geometry,applyMatrix:function(matrix){for(var normalMatrix=(new THREE.Matrix3).getNormalMatrix(matrix),i=0,il=this.vertices.length;il>i;i++){var vertex=this.vertices[i];vertex.applyMatrix4(matrix)}for(var i=0,il=this.faces.length;il>i;i++){var face=this.faces[i];face.normal.applyMatrix3(normalMatrix).normalize();for(var j=0,jl=face.vertexNormals.length;jl>j;j++)face.vertexNormals[j].applyMatrix3(normalMatrix).normalize()}this.boundingBox instanceof THREE.Box3&&this.computeBoundingBox(),this.boundingSphere instanceof THREE.Sphere&&this.computeBoundingSphere()},center:function(){this.computeBoundingBox();var offset=new THREE.Vector3;return offset.addVectors(this.boundingBox.min,this.boundingBox.max),offset.multiplyScalar(-.5),this.applyMatrix((new THREE.Matrix4).makeTranslation(offset.x,offset.y,offset.z)),this.computeBoundingBox(),offset},computeFaceNormals:function(){for(var cb=new THREE.Vector3,ab=new THREE.Vector3,f=0,fl=this.faces.length;fl>f;f++){var face=this.faces[f],vA=this.vertices[face.a],vB=this.vertices[face.b],vC=this.vertices[face.c];cb.subVectors(vC,vB),ab.subVectors(vA,vB),cb.cross(ab),cb.normalize(),face.normal.copy(cb)}},computeVertexNormals:function(areaWeighted){var v,vl,f,fl,face,vertices;for(vertices=new Array(this.vertices.length),v=0,vl=this.vertices.length;vl>v;v++)vertices[v]=new THREE.Vector3;if(areaWeighted){{var vA,vB,vC,cb=new THREE.Vector3,ab=new THREE.Vector3;new THREE.Vector3,new THREE.Vector3,new THREE.Vector3}for(f=0,fl=this.faces.length;fl>f;f++)face=this.faces[f],vA=this.vertices[face.a],vB=this.vertices[face.b],vC=this.vertices[face.c],cb.subVectors(vC,vB),ab.subVectors(vA,vB),cb.cross(ab),vertices[face.a].add(cb),vertices[face.b].add(cb),vertices[face.c].add(cb)}else for(f=0,fl=this.faces.length;fl>f;f++)face=this.faces[f],vertices[face.a].add(face.normal),vertices[face.b].add(face.normal),vertices[face.c].add(face.normal);for(v=0,vl=this.vertices.length;vl>v;v++)vertices[v].normalize();for(f=0,fl=this.faces.length;fl>f;f++)face=this.faces[f],face.vertexNormals[0]=vertices[face.a].clone(),face.vertexNormals[1]=vertices[face.b].clone(),face.vertexNormals[2]=vertices[face.c].clone()},computeMorphNormals:function(){var i,il,f,fl,face;for(f=0,fl=this.faces.length;fl>f;f++)for(face=this.faces[f],face.__originalFaceNormal?face.__originalFaceNormal.copy(face.normal):face.__originalFaceNormal=face.normal.clone(),face.__originalVertexNormals||(face.__originalVertexNormals=[]),i=0,il=face.vertexNormals.length;il>i;i++)face.__originalVertexNormals[i]?face.__originalVertexNormals[i].copy(face.vertexNormals[i]):face.__originalVertexNormals[i]=face.vertexNormals[i].clone();var tmpGeo=new THREE.Geometry;for(tmpGeo.faces=this.faces,i=0,il=this.morphTargets.length;il>i;i++){if(!this.morphNormals[i]){this.morphNormals[i]={},this.morphNormals[i].faceNormals=[],this.morphNormals[i].vertexNormals=[];var faceNormal,vertexNormals,dstNormalsFace=this.morphNormals[i].faceNormals,dstNormalsVertex=this.morphNormals[i].vertexNormals;for(f=0,fl=this.faces.length;fl>f;f++)faceNormal=new THREE.Vector3,vertexNormals={a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3},dstNormalsFace.push(faceNormal),dstNormalsVertex.push(vertexNormals)}var morphNormals=this.morphNormals[i];tmpGeo.vertices=this.morphTargets[i].vertices,tmpGeo.computeFaceNormals(),tmpGeo.computeVertexNormals();var faceNormal,vertexNormals;for(f=0,fl=this.faces.length;fl>f;f++)face=this.faces[f],faceNormal=morphNormals.faceNormals[f],vertexNormals=morphNormals.vertexNormals[f],faceNormal.copy(face.normal),vertexNormals.a.copy(face.vertexNormals[0]),vertexNormals.b.copy(face.vertexNormals[1]),vertexNormals.c.copy(face.vertexNormals[2])}for(f=0,fl=this.faces.length;fl>f;f++)face=this.faces[f],face.normal=face.__originalFaceNormal,face.vertexNormals=face.__originalVertexNormals},computeTangents:function(){function handleTriangle(context,a,b,c,ua,ub,uc){vA=context.vertices[a],vB=context.vertices[b],vC=context.vertices[c],uvA=uv[ua],uvB=uv[ub],uvC=uv[uc],x1=vB.x-vA.x,x2=vC.x-vA.x,y1=vB.y-vA.y,y2=vC.y-vA.y,z1=vB.z-vA.z,z2=vC.z-vA.z,s1=uvB.x-uvA.x,s2=uvC.x-uvA.x,t1=uvB.y-uvA.y,t2=uvC.y-uvA.y,r=1/(s1*t2-s2*t1),sdir.set((t2*x1-t1*x2)*r,(t2*y1-t1*y2)*r,(t2*z1-t1*z2)*r),tdir.set((s1*x2-s2*x1)*r,(s1*y2-s2*y1)*r,(s1*z2-s2*z1)*r),tan1[a].add(sdir),tan1[b].add(sdir),tan1[c].add(sdir),tan2[a].add(tdir),tan2[b].add(tdir),tan2[c].add(tdir)}var f,fl,v,vl,i,vertexIndex,face,uv,vA,vB,vC,uvA,uvB,uvC,x1,x2,y1,y2,z1,z2,s1,s2,t1,t2,r,t,test,w,tan1=[],tan2=[],sdir=new THREE.Vector3,tdir=new THREE.Vector3,tmp=new THREE.Vector3,tmp2=new THREE.Vector3,n=new THREE.Vector3;for(v=0,vl=this.vertices.length;vl>v;v++)tan1[v]=new THREE.Vector3,tan2[v]=new THREE.Vector3;for(f=0,fl=this.faces.length;fl>f;f++)face=this.faces[f],uv=this.faceVertexUvs[0][f],handleTriangle(this,face.a,face.b,face.c,0,1,2);var faceIndex=["a","b","c","d"];for(f=0,fl=this.faces.length;fl>f;f++)for(face=this.faces[f],i=0;i<Math.min(face.vertexNormals.length,3);i++)n.copy(face.vertexNormals[i]),vertexIndex=face[faceIndex[i]],t=tan1[vertexIndex],tmp.copy(t),tmp.sub(n.multiplyScalar(n.dot(t))).normalize(),tmp2.crossVectors(face.vertexNormals[i],t),test=tmp2.dot(tan2[vertexIndex]),w=0>test?-1:1,face.vertexTangents[i]=new THREE.Vector4(tmp.x,tmp.y,tmp.z,w);this.hasTangents=!0},computeLineDistances:function(){for(var d=0,vertices=this.vertices,i=0,il=vertices.length;il>i;i++)i>0&&(d+=vertices[i].distanceTo(vertices[i-1])),this.lineDistances[i]=d},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere),this.boundingSphere.setFromPoints(this.vertices)},merge:function(geometry,matrix,materialIndexOffset){if(geometry instanceof THREE.Geometry==!1)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",geometry);var normalMatrix,vertexOffset=this.vertices.length,vertices1=(this.faceVertexUvs[0].length,this.vertices),vertices2=geometry.vertices,faces1=this.faces,faces2=geometry.faces,uvs1=this.faceVertexUvs[0],uvs2=geometry.faceVertexUvs[0];void 0===materialIndexOffset&&(materialIndexOffset=0),void 0!==matrix&&(normalMatrix=(new THREE.Matrix3).getNormalMatrix(matrix));for(var i=0,il=vertices2.length;il>i;i++){var vertex=vertices2[i],vertexCopy=vertex.clone();void 0!==matrix&&vertexCopy.applyMatrix4(matrix),vertices1.push(vertexCopy)}for(i=0,il=faces2.length;il>i;i++){var faceCopy,normal,color,face=faces2[i],faceVertexNormals=face.vertexNormals,faceVertexColors=face.vertexColors;faceCopy=new THREE.Face3(face.a+vertexOffset,face.b+vertexOffset,face.c+vertexOffset),faceCopy.normal.copy(face.normal),void 0!==normalMatrix&&faceCopy.normal.applyMatrix3(normalMatrix).normalize();for(var j=0,jl=faceVertexNormals.length;jl>j;j++)normal=faceVertexNormals[j].clone(),void 0!==normalMatrix&&normal.applyMatrix3(normalMatrix).normalize(),faceCopy.vertexNormals.push(normal);faceCopy.color.copy(face.color);for(var j=0,jl=faceVertexColors.length;jl>j;j++)color=faceVertexColors[j],faceCopy.vertexColors.push(color.clone());faceCopy.materialIndex=face.materialIndex+materialIndexOffset,faces1.push(faceCopy)}for(i=0,il=uvs2.length;il>i;i++){var uv=uvs2[i],uvCopy=[];if(void 0!==uv){for(var j=0,jl=uv.length;jl>j;j++)uvCopy.push(new THREE.Vector2(uv[j].x,uv[j].y));uvs1.push(uvCopy)}}},mergeVertices:function(){var v,key,i,il,face,indices,j,jl,verticesMap={},unique=[],changes=[],precisionPoints=4,precision=Math.pow(10,precisionPoints);for(i=0,il=this.vertices.length;il>i;i++)v=this.vertices[i],key=Math.round(v.x*precision)+"_"+Math.round(v.y*precision)+"_"+Math.round(v.z*precision),void 0===verticesMap[key]?(verticesMap[key]=i,unique.push(this.vertices[i]),changes[i]=unique.length-1):changes[i]=changes[verticesMap[key]];var faceIndicesToRemove=[];for(i=0,il=this.faces.length;il>i;i++){face=this.faces[i],face.a=changes[face.a],face.b=changes[face.b],face.c=changes[face.c],indices=[face.a,face.b,face.c];for(var dupIndex=-1,n=0;3>n;n++)if(indices[n]==indices[(n+1)%3]){dupIndex=n,faceIndicesToRemove.push(i);break}}for(i=faceIndicesToRemove.length-1;i>=0;i--){var idx=faceIndicesToRemove[i];for(this.faces.splice(idx,1),j=0,jl=this.faceVertexUvs.length;jl>j;j++)this.faceVertexUvs[j].splice(idx,1)}var diff=this.vertices.length-unique.length;return this.vertices=unique,diff},makeGroups:function(){var geometryGroupCounter=0;return function(usesFaceMaterial,maxVerticesInGroup){var f,fl,face,materialIndex,groupHash,geometryGroup,hash_map={},numMorphTargets=this.morphTargets.length,numMorphNormals=this.morphNormals.length;for(this.geometryGroups={},this.geometryGroupsList=[],f=0,fl=this.faces.length;fl>f;f++)face=this.faces[f],materialIndex=usesFaceMaterial?face.materialIndex:0,materialIndex in hash_map||(hash_map[materialIndex]={hash:materialIndex,counter:0}),groupHash=hash_map[materialIndex].hash+"_"+hash_map[materialIndex].counter,groupHash in this.geometryGroups||(geometryGroup={id:geometryGroupCounter++,faces3:[],materialIndex:materialIndex,vertices:0,numMorphTargets:numMorphTargets,numMorphNormals:numMorphNormals},this.geometryGroups[groupHash]=geometryGroup,this.geometryGroupsList.push(geometryGroup)),this.geometryGroups[groupHash].vertices+3>maxVerticesInGroup&&(hash_map[materialIndex].counter+=1,groupHash=hash_map[materialIndex].hash+"_"+hash_map[materialIndex].counter,groupHash in this.geometryGroups||(geometryGroup={id:geometryGroupCounter++,faces3:[],materialIndex:materialIndex,vertices:0,numMorphTargets:numMorphTargets,numMorphNormals:numMorphNormals},this.geometryGroups[groupHash]=geometryGroup,this.geometryGroupsList.push(geometryGroup))),this.geometryGroups[groupHash].faces3.push(f),this.geometryGroups[groupHash].vertices+=3}}(),clone:function(){for(var geometry=new THREE.Geometry,vertices=this.vertices,i=0,il=vertices.length;il>i;i++)geometry.vertices.push(vertices[i].clone());for(var faces=this.faces,i=0,il=faces.length;il>i;i++)geometry.faces.push(faces[i].clone());for(var uvs=this.faceVertexUvs[0],i=0,il=uvs.length;il>i;i++){for(var uv=uvs[i],uvCopy=[],j=0,jl=uv.length;jl>j;j++)uvCopy.push(new THREE.Vector2(uv[j].x,uv[j].y));geometry.faceVertexUvs[0].push(uvCopy)}return geometry},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.Geometry.prototype),THREE.GeometryIdCount=0,THREE.Camera=function(){THREE.Object3D.call(this),this.matrixWorldInverse=new THREE.Matrix4,this.projectionMatrix=new THREE.Matrix4},THREE.Camera.prototype=Object.create(THREE.Object3D.prototype),THREE.Camera.prototype.lookAt=function(){var m1=new THREE.Matrix4;return function(vector){m1.lookAt(this.position,vector,this.up),this.quaternion.setFromRotationMatrix(m1)}}(),THREE.Camera.prototype.clone=function(camera){return void 0===camera&&(camera=new THREE.Camera),THREE.Object3D.prototype.clone.call(this,camera),camera.matrixWorldInverse.copy(this.matrixWorldInverse),camera.projectionMatrix.copy(this.projectionMatrix),camera},THREE.CubeCamera=function(near,far,cubeResolution){THREE.Object3D.call(this);var fov=90,aspect=1,cameraPX=new THREE.PerspectiveCamera(fov,aspect,near,far);cameraPX.up.set(0,-1,0),cameraPX.lookAt(new THREE.Vector3(1,0,0)),this.add(cameraPX);var cameraNX=new THREE.PerspectiveCamera(fov,aspect,near,far);cameraNX.up.set(0,-1,0),cameraNX.lookAt(new THREE.Vector3(-1,0,0)),this.add(cameraNX);var cameraPY=new THREE.PerspectiveCamera(fov,aspect,near,far);cameraPY.up.set(0,0,1),cameraPY.lookAt(new THREE.Vector3(0,1,0)),this.add(cameraPY);var cameraNY=new THREE.PerspectiveCamera(fov,aspect,near,far);cameraNY.up.set(0,0,-1),cameraNY.lookAt(new THREE.Vector3(0,-1,0)),this.add(cameraNY);var cameraPZ=new THREE.PerspectiveCamera(fov,aspect,near,far);cameraPZ.up.set(0,-1,0),cameraPZ.lookAt(new THREE.Vector3(0,0,1)),this.add(cameraPZ);var cameraNZ=new THREE.PerspectiveCamera(fov,aspect,near,far);cameraNZ.up.set(0,-1,0),cameraNZ.lookAt(new THREE.Vector3(0,0,-1)),this.add(cameraNZ),this.renderTarget=new THREE.WebGLRenderTargetCube(cubeResolution,cubeResolution,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter}),this.updateCubeMap=function(renderer,scene){var renderTarget=this.renderTarget,generateMipmaps=renderTarget.generateMipmaps;renderTarget.generateMipmaps=!1,renderTarget.activeCubeFace=0,renderer.render(scene,cameraPX,renderTarget),renderTarget.activeCubeFace=1,renderer.render(scene,cameraNX,renderTarget),renderTarget.activeCubeFace=2,renderer.render(scene,cameraPY,renderTarget),renderTarget.activeCubeFace=3,renderer.render(scene,cameraNY,renderTarget),renderTarget.activeCubeFace=4,renderer.render(scene,cameraPZ,renderTarget),renderTarget.generateMipmaps=generateMipmaps,renderTarget.activeCubeFace=5,renderer.render(scene,cameraNZ,renderTarget)}},THREE.CubeCamera.prototype=Object.create(THREE.Object3D.prototype),THREE.OrthographicCamera=function(left,right,top,bottom,near,far){THREE.Camera.call(this),this.left=left,this.right=right,this.top=top,this.bottom=bottom,this.near=void 0!==near?near:.1,this.far=void 0!==far?far:2e3,this.updateProjectionMatrix()},THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype),THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far)},THREE.OrthographicCamera.prototype.clone=function(){var camera=new THREE.OrthographicCamera;return THREE.Camera.prototype.clone.call(this,camera),camera.left=this.left,camera.right=this.right,camera.top=this.top,camera.bottom=this.bottom,camera.near=this.near,camera.far=this.far,camera},THREE.PerspectiveCamera=function(fov,aspect,near,far){THREE.Camera.call(this),this.fov=void 0!==fov?fov:50,this.aspect=void 0!==aspect?aspect:1,this.near=void 0!==near?near:.1,this.far=void 0!==far?far:2e3,this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype),THREE.PerspectiveCamera.prototype.setLens=function(focalLength,frameHeight){void 0===frameHeight&&(frameHeight=24),this.fov=2*THREE.Math.radToDeg(Math.atan(frameHeight/(2*focalLength))),this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.setViewOffset=function(fullWidth,fullHeight,x,y,width,height){this.fullWidth=fullWidth,this.fullHeight=fullHeight,this.x=x,this.y=y,this.width=width,this.height=height,this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){if(this.fullWidth){var aspect=this.fullWidth/this.fullHeight,top=Math.tan(THREE.Math.degToRad(.5*this.fov))*this.near,bottom=-top,left=aspect*bottom,right=aspect*top,width=Math.abs(right-left),height=Math.abs(top-bottom);this.projectionMatrix.makeFrustum(left+this.x*width/this.fullWidth,left+(this.x+this.width)*width/this.fullWidth,top-(this.y+this.height)*height/this.fullHeight,top-this.y*height/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)},THREE.PerspectiveCamera.prototype.clone=function(){var camera=new THREE.PerspectiveCamera;return THREE.Camera.prototype.clone.call(this,camera),camera.fov=this.fov,camera.aspect=this.aspect,camera.near=this.near,camera.far=this.far,camera},THREE.Light=function(color){THREE.Object3D.call(this),this.color=new THREE.Color(color)},THREE.Light.prototype=Object.create(THREE.Object3D.prototype),THREE.Light.prototype.clone=function(light){return void 0===light&&(light=new THREE.Light),THREE.Object3D.prototype.clone.call(this,light),light.color.copy(this.color),light},THREE.AmbientLight=function(color){THREE.Light.call(this,color)},THREE.AmbientLight.prototype=Object.create(THREE.Light.prototype),THREE.AmbientLight.prototype.clone=function(){var light=new THREE.AmbientLight;return THREE.Light.prototype.clone.call(this,light),light},THREE.AreaLight=function(color,intensity){THREE.Light.call(this,color),this.normal=new THREE.Vector3(0,-1,0),this.right=new THREE.Vector3(1,0,0),this.intensity=void 0!==intensity?intensity:1,this.width=1,this.height=1,this.constantAttenuation=1.5,this.linearAttenuation=.5,this.quadraticAttenuation=.1},THREE.AreaLight.prototype=Object.create(THREE.Light.prototype),THREE.DirectionalLight=function(color,intensity){THREE.Light.call(this,color),this.position.set(0,1,0),this.target=new THREE.Object3D,this.intensity=void 0!==intensity?intensity:1,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraLeft=-500,this.shadowCameraRight=500,this.shadowCameraTop=500,this.shadowCameraBottom=-500,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowCascade=!1,this.shadowCascadeOffset=new THREE.Vector3(0,0,-1e3),this.shadowCascadeCount=2,this.shadowCascadeBias=[0,0,0],this.shadowCascadeWidth=[512,512,512],this.shadowCascadeHeight=[512,512,512],this.shadowCascadeNearZ=[-1,.99,.998],this.shadowCascadeFarZ=[.99,.998,1],this.shadowCascadeArray=[],this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},THREE.DirectionalLight.prototype=Object.create(THREE.Light.prototype),THREE.DirectionalLight.prototype.clone=function(){var light=new THREE.DirectionalLight;return THREE.Light.prototype.clone.call(this,light),light.target=this.target.clone(),light.intensity=this.intensity,light.castShadow=this.castShadow,light.onlyShadow=this.onlyShadow,light.shadowCameraNear=this.shadowCameraNear,light.shadowCameraFar=this.shadowCameraFar,light.shadowCameraLeft=this.shadowCameraLeft,light.shadowCameraRight=this.shadowCameraRight,light.shadowCameraTop=this.shadowCameraTop,light.shadowCameraBottom=this.shadowCameraBottom,light.shadowCameraVisible=this.shadowCameraVisible,light.shadowBias=this.shadowBias,light.shadowDarkness=this.shadowDarkness,light.shadowMapWidth=this.shadowMapWidth,light.shadowMapHeight=this.shadowMapHeight,light.shadowCascade=this.shadowCascade,light.shadowCascadeOffset.copy(this.shadowCascadeOffset),light.shadowCascadeCount=this.shadowCascadeCount,light.shadowCascadeBias=this.shadowCascadeBias.slice(0),light.shadowCascadeWidth=this.shadowCascadeWidth.slice(0),light.shadowCascadeHeight=this.shadowCascadeHeight.slice(0),light.shadowCascadeNearZ=this.shadowCascadeNearZ.slice(0),light.shadowCascadeFarZ=this.shadowCascadeFarZ.slice(0),light},THREE.HemisphereLight=function(skyColor,groundColor,intensity){THREE.Light.call(this,skyColor),this.position.set(0,100,0),this.groundColor=new THREE.Color(groundColor),this.intensity=void 0!==intensity?intensity:1},THREE.HemisphereLight.prototype=Object.create(THREE.Light.prototype),THREE.HemisphereLight.prototype.clone=function(){var light=new THREE.HemisphereLight;return THREE.Light.prototype.clone.call(this,light),light.groundColor.copy(this.groundColor),light.intensity=this.intensity,light},THREE.PointLight=function(color,intensity,distance){THREE.Light.call(this,color),this.intensity=void 0!==intensity?intensity:1,this.distance=void 0!==distance?distance:0},THREE.PointLight.prototype=Object.create(THREE.Light.prototype),THREE.PointLight.prototype.clone=function(){var light=new THREE.PointLight;return THREE.Light.prototype.clone.call(this,light),light.intensity=this.intensity,light.distance=this.distance,light},THREE.SpotLight=function(color,intensity,distance,angle,exponent){THREE.Light.call(this,color),this.position.set(0,1,0),this.target=new THREE.Object3D,this.intensity=void 0!==intensity?intensity:1,this.distance=void 0!==distance?distance:0,this.angle=void 0!==angle?angle:Math.PI/3,this.exponent=void 0!==exponent?exponent:10,this.castShadow=!1,this.onlyShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraFov=50,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapWidth=512,this.shadowMapHeight=512,this.shadowMap=null,this.shadowMapSize=null,this.shadowCamera=null,this.shadowMatrix=null},THREE.SpotLight.prototype=Object.create(THREE.Light.prototype),THREE.SpotLight.prototype.clone=function(){var light=new THREE.SpotLight;return THREE.Light.prototype.clone.call(this,light),light.target=this.target.clone(),light.intensity=this.intensity,light.distance=this.distance,light.angle=this.angle,light.exponent=this.exponent,light.castShadow=this.castShadow,light.onlyShadow=this.onlyShadow,light.shadowCameraNear=this.shadowCameraNear,light.shadowCameraFar=this.shadowCameraFar,light.shadowCameraFov=this.shadowCameraFov,light.shadowCameraVisible=this.shadowCameraVisible,light.shadowBias=this.shadowBias,light.shadowDarkness=this.shadowDarkness,light.shadowMapWidth=this.shadowMapWidth,light.shadowMapHeight=this.shadowMapHeight,light},THREE.Cache=function(){this.files={}},THREE.Cache.prototype={constructor:THREE.Cache,add:function(key,file){this.files[key]=file},get:function(key){return this.files[key]},remove:function(key){delete this.files[key]},clear:function(){this.files={}}},THREE.Loader=function(showStatus){this.showStatus=showStatus,this.statusDomElement=showStatus?THREE.Loader.prototype.addStatusElement():null,this.imageLoader=new THREE.ImageLoader,this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}},THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:void 0,addStatusElement:function(){var e=document.createElement("div");return e.style.position="absolute",e.style.right="0px",e.style.top="0px",e.style.fontSize="0.8em",e.style.textAlign="left",e.style.background="rgba(0,0,0,0.25)",e.style.color="#fff",e.style.width="120px",e.style.padding="0.5em 0.5em 0.5em 0.5em",e.style.zIndex=1e3,e.innerHTML="Loading ...",e},updateProgress:function(progress){var message="Loaded ";message+=progress.total?(100*progress.loaded/progress.total).toFixed(0)+"%":(progress.loaded/1024).toFixed(2)+" KB",this.statusDomElement.innerHTML=message},extractUrlBase:function(url){var parts=url.split("/");return 1===parts.length?"./":(parts.pop(),parts.join("/")+"/")},initMaterials:function(materials,texturePath){for(var array=[],i=0;i<materials.length;++i)array[i]=this.createMaterial(materials[i],texturePath);return array},needsTangents:function(materials){for(var i=0,il=materials.length;il>i;i++){var m=materials[i];if(m instanceof THREE.ShaderMaterial)return!0}return!1},createMaterial:function(m,texturePath){function nearest_pow2(n){var l=Math.log(n)/Math.LN2;return Math.pow(2,Math.round(l))}function create_texture(where,name,sourceFile,repeat,offset,wrap,anisotropy){var texture,fullPath=texturePath+sourceFile,loader=THREE.Loader.Handlers.get(fullPath);if(null!==loader?texture=loader.load(fullPath):(texture=new THREE.Texture,loader=scope.imageLoader,loader.crossOrigin=scope.crossOrigin,loader.load(fullPath,function(image){if(THREE.Math.isPowerOfTwo(image.width)===!1||THREE.Math.isPowerOfTwo(image.height)===!1){var width=nearest_pow2(image.width),height=nearest_pow2(image.height),canvas=document.createElement("canvas");canvas.width=width,canvas.height=height;var context=canvas.getContext("2d");context.drawImage(image,0,0,width,height),texture.image=canvas}else texture.image=image;texture.needsUpdate=!0})),texture.sourceFile=sourceFile,repeat&&(texture.repeat.set(repeat[0],repeat[1]),1!==repeat[0]&&(texture.wrapS=THREE.RepeatWrapping),1!==repeat[1]&&(texture.wrapT=THREE.RepeatWrapping)),offset&&texture.offset.set(offset[0],offset[1]),wrap){var wrapMap={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping};void 0!==wrapMap[wrap[0]]&&(texture.wrapS=wrapMap[wrap[0]]),void 0!==wrapMap[wrap[1]]&&(texture.wrapT=wrapMap[wrap[1]])}anisotropy&&(texture.anisotropy=anisotropy),where[name]=texture}function rgb2hex(rgb){return(255*rgb[0]<<16)+(255*rgb[1]<<8)+255*rgb[2]}var scope=this,mtype="MeshLambertMaterial",mpars={color:15658734,opacity:1,map:null,lightMap:null,normalMap:null,bumpMap:null,wireframe:!1};if(m.shading){var shading=m.shading.toLowerCase();"phong"===shading?mtype="MeshPhongMaterial":"basic"===shading&&(mtype="MeshBasicMaterial")}if(void 0!==m.blending&&void 0!==THREE[m.blending]&&(mpars.blending=THREE[m.blending]),(void 0!==m.transparent||m.opacity<1)&&(mpars.transparent=m.transparent),void 0!==m.depthTest&&(mpars.depthTest=m.depthTest),void 0!==m.depthWrite&&(mpars.depthWrite=m.depthWrite),void 0!==m.visible&&(mpars.visible=m.visible),void 0!==m.flipSided&&(mpars.side=THREE.BackSide),void 0!==m.doubleSided&&(mpars.side=THREE.DoubleSide),void 0!==m.wireframe&&(mpars.wireframe=m.wireframe),void 0!==m.vertexColors&&("face"===m.vertexColors?mpars.vertexColors=THREE.FaceColors:m.vertexColors&&(mpars.vertexColors=THREE.VertexColors)),m.colorDiffuse?mpars.color=rgb2hex(m.colorDiffuse):m.DbgColor&&(mpars.color=m.DbgColor),m.colorSpecular&&(mpars.specular=rgb2hex(m.colorSpecular)),m.colorAmbient&&(mpars.ambient=rgb2hex(m.colorAmbient)),m.colorEmissive&&(mpars.emissive=rgb2hex(m.colorEmissive)),m.transparency&&(mpars.opacity=m.transparency),m.specularCoef&&(mpars.shininess=m.specularCoef),m.mapDiffuse&&texturePath&&create_texture(mpars,"map",m.mapDiffuse,m.mapDiffuseRepeat,m.mapDiffuseOffset,m.mapDiffuseWrap,m.mapDiffuseAnisotropy),m.mapLight&&texturePath&&create_texture(mpars,"lightMap",m.mapLight,m.mapLightRepeat,m.mapLightOffset,m.mapLightWrap,m.mapLightAnisotropy),m.mapBump&&texturePath&&create_texture(mpars,"bumpMap",m.mapBump,m.mapBumpRepeat,m.mapBumpOffset,m.mapBumpWrap,m.mapBumpAnisotropy),m.mapNormal&&texturePath&&create_texture(mpars,"normalMap",m.mapNormal,m.mapNormalRepeat,m.mapNormalOffset,m.mapNormalWrap,m.mapNormalAnisotropy),m.mapSpecular&&texturePath&&create_texture(mpars,"specularMap",m.mapSpecular,m.mapSpecularRepeat,m.mapSpecularOffset,m.mapSpecularWrap,m.mapSpecularAnisotropy),m.mapAlpha&&texturePath&&create_texture(mpars,"alphaMap",m.mapAlpha,m.mapAlphaRepeat,m.mapAlphaOffset,m.mapAlphaWrap,m.mapAlphaAnisotropy),m.mapBumpScale&&(mpars.bumpScale=m.mapBumpScale),m.mapNormal){var shader=THREE.ShaderLib.normalmap,uniforms=THREE.UniformsUtils.clone(shader.uniforms);uniforms.tNormal.value=mpars.normalMap,m.mapNormalFactor&&uniforms.uNormalScale.value.set(m.mapNormalFactor,m.mapNormalFactor),mpars.map&&(uniforms.tDiffuse.value=mpars.map,uniforms.enableDiffuse.value=!0),mpars.specularMap&&(uniforms.tSpecular.value=mpars.specularMap,uniforms.enableSpecular.value=!0),mpars.lightMap&&(uniforms.tAO.value=mpars.lightMap,uniforms.enableAO.value=!0),uniforms.diffuse.value.setHex(mpars.color),uniforms.specular.value.setHex(mpars.specular),uniforms.ambient.value.setHex(mpars.ambient),uniforms.shininess.value=mpars.shininess,void 0!==mpars.opacity&&(uniforms.opacity.value=mpars.opacity);var parameters={fragmentShader:shader.fragmentShader,vertexShader:shader.vertexShader,uniforms:uniforms,lights:!0,fog:!0},material=new THREE.ShaderMaterial(parameters);mpars.transparent&&(material.transparent=!0)}else var material=new THREE[mtype](mpars);return void 0!==m.DbgName&&(material.name=m.DbgName),material}},THREE.Loader.Handlers={handlers:[],add:function(regex,loader){this.handlers.push(regex,loader)},get:function(file){for(var i=0,l=this.handlers.length;l>i;i+=2){var regex=this.handlers[i],loader=this.handlers[i+1];if(regex.test(file))return loader}return null}},THREE.XHRLoader=function(manager){this.cache=new THREE.Cache,this.manager=void 0!==manager?manager:THREE.DefaultLoadingManager},THREE.XHRLoader.prototype={constructor:THREE.XHRLoader,load:function(url,onLoad,onProgress,onError){var scope=this,cached=scope.cache.get(url);if(void 0!==cached)return void(onLoad&&onLoad(cached));var request=new XMLHttpRequest;request.open("GET",url,!0),request.addEventListener("load",function(){scope.cache.add(url,this.response),onLoad&&onLoad(this.response),scope.manager.itemEnd(url)},!1),void 0!==onProgress&&request.addEventListener("progress",function(event){onProgress(event)},!1),void 0!==onError&&request.addEventListener("error",function(event){onError(event)},!1),void 0!==this.crossOrigin&&(request.crossOrigin=this.crossOrigin),void 0!==this.responseType&&(request.responseType=this.responseType),request.send(null),scope.manager.itemStart(url)},setResponseType:function(value){this.responseType=value},setCrossOrigin:function(value){this.crossOrigin=value}},THREE.ImageLoader=function(manager){this.cache=new THREE.Cache,this.manager=void 0!==manager?manager:THREE.DefaultLoadingManager},THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,load:function(url,onLoad,onProgress,onError){var scope=this,cached=scope.cache.get(url);if(void 0!==cached)return void onLoad(cached);var image=document.createElement("img");return void 0!==onLoad&&image.addEventListener("load",function(){scope.cache.add(url,this),onLoad(this),scope.manager.itemEnd(url)},!1),void 0!==onProgress&&image.addEventListener("progress",function(event){onProgress(event)},!1),void 0!==onError&&image.addEventListener("error",function(event){onError(event)},!1),void 0!==this.crossOrigin&&(image.crossOrigin=this.crossOrigin),image.src=url,scope.manager.itemStart(url),image},setCrossOrigin:function(value){this.crossOrigin=value}},THREE.JSONLoader=function(showStatus){THREE.Loader.call(this,showStatus),this.withCredentials=!1},THREE.JSONLoader.prototype=Object.create(THREE.Loader.prototype),THREE.JSONLoader.prototype.load=function(url,callback,texturePath){texturePath=texturePath&&"string"==typeof texturePath?texturePath:this.extractUrlBase(url),this.onLoadStart(),this.loadAjaxJSON(this,url,callback,texturePath)},THREE.JSONLoader.prototype.loadAjaxJSON=function(context,url,callback,texturePath,callbackProgress){var xhr=new XMLHttpRequest,length=0;xhr.onreadystatechange=function(){if(xhr.readyState===xhr.DONE)if(200===xhr.status||0===xhr.status){if(xhr.responseText){var json=JSON.parse(xhr.responseText);if(void 0!==json.metadata&&"scene"===json.metadata.type)return void console.error('THREE.JSONLoader: "'+url+'" seems to be a Scene. Use THREE.SceneLoader instead.');var result=context.parse(json,texturePath);callback(result.geometry,result.materials)}else console.error('THREE.JSONLoader: "'+url+'" seems to be unreachable or the file is empty.');context.onLoadComplete()}else console.error("THREE.JSONLoader: Couldn't load \""+url+'" ('+xhr.status+")");else xhr.readyState===xhr.LOADING?callbackProgress&&(0===length&&(length=xhr.getResponseHeader("Content-Length")),callbackProgress({total:length,loaded:xhr.responseText.length})):xhr.readyState===xhr.HEADERS_RECEIVED&&void 0!==callbackProgress&&(length=xhr.getResponseHeader("Content-Length"))},xhr.open("GET",url,!0),xhr.withCredentials=this.withCredentials,xhr.send(null)},THREE.JSONLoader.prototype.parse=function(json,texturePath){function parseModel(scale){function isBitSet(value,position){return value&1<<position}var i,j,fi,offset,zLength,colorIndex,normalIndex,uvIndex,materialIndex,type,isQuad,hasMaterial,hasFaceVertexUv,hasFaceNormal,hasFaceVertexNormal,hasFaceColor,hasFaceVertexColor,vertex,face,faceA,faceB,hex,normal,uvLayer,uv,u,v,faces=json.faces,vertices=json.vertices,normals=json.normals,colors=json.colors,nUvLayers=0;
if(void 0!==json.uvs){for(i=0;i<json.uvs.length;i++)json.uvs[i].length&&nUvLayers++;for(i=0;nUvLayers>i;i++)geometry.faceVertexUvs[i]=[]}for(offset=0,zLength=vertices.length;zLength>offset;)vertex=new THREE.Vector3,vertex.x=vertices[offset++]*scale,vertex.y=vertices[offset++]*scale,vertex.z=vertices[offset++]*scale,geometry.vertices.push(vertex);for(offset=0,zLength=faces.length;zLength>offset;)if(type=faces[offset++],isQuad=isBitSet(type,0),hasMaterial=isBitSet(type,1),hasFaceVertexUv=isBitSet(type,3),hasFaceNormal=isBitSet(type,4),hasFaceVertexNormal=isBitSet(type,5),hasFaceColor=isBitSet(type,6),hasFaceVertexColor=isBitSet(type,7),isQuad){if(faceA=new THREE.Face3,faceA.a=faces[offset],faceA.b=faces[offset+1],faceA.c=faces[offset+3],faceB=new THREE.Face3,faceB.a=faces[offset+1],faceB.b=faces[offset+2],faceB.c=faces[offset+3],offset+=4,hasMaterial&&(materialIndex=faces[offset++],faceA.materialIndex=materialIndex,faceB.materialIndex=materialIndex),fi=geometry.faces.length,hasFaceVertexUv)for(i=0;nUvLayers>i;i++)for(uvLayer=json.uvs[i],geometry.faceVertexUvs[i][fi]=[],geometry.faceVertexUvs[i][fi+1]=[],j=0;4>j;j++)uvIndex=faces[offset++],u=uvLayer[2*uvIndex],v=uvLayer[2*uvIndex+1],uv=new THREE.Vector2(u,v),2!==j&&geometry.faceVertexUvs[i][fi].push(uv),0!==j&&geometry.faceVertexUvs[i][fi+1].push(uv);if(hasFaceNormal&&(normalIndex=3*faces[offset++],faceA.normal.set(normals[normalIndex++],normals[normalIndex++],normals[normalIndex]),faceB.normal.copy(faceA.normal)),hasFaceVertexNormal)for(i=0;4>i;i++)normalIndex=3*faces[offset++],normal=new THREE.Vector3(normals[normalIndex++],normals[normalIndex++],normals[normalIndex]),2!==i&&faceA.vertexNormals.push(normal),0!==i&&faceB.vertexNormals.push(normal);if(hasFaceColor&&(colorIndex=faces[offset++],hex=colors[colorIndex],faceA.color.setHex(hex),faceB.color.setHex(hex)),hasFaceVertexColor)for(i=0;4>i;i++)colorIndex=faces[offset++],hex=colors[colorIndex],2!==i&&faceA.vertexColors.push(new THREE.Color(hex)),0!==i&&faceB.vertexColors.push(new THREE.Color(hex));geometry.faces.push(faceA),geometry.faces.push(faceB)}else{if(face=new THREE.Face3,face.a=faces[offset++],face.b=faces[offset++],face.c=faces[offset++],hasMaterial&&(materialIndex=faces[offset++],face.materialIndex=materialIndex),fi=geometry.faces.length,hasFaceVertexUv)for(i=0;nUvLayers>i;i++)for(uvLayer=json.uvs[i],geometry.faceVertexUvs[i][fi]=[],j=0;3>j;j++)uvIndex=faces[offset++],u=uvLayer[2*uvIndex],v=uvLayer[2*uvIndex+1],uv=new THREE.Vector2(u,v),geometry.faceVertexUvs[i][fi].push(uv);if(hasFaceNormal&&(normalIndex=3*faces[offset++],face.normal.set(normals[normalIndex++],normals[normalIndex++],normals[normalIndex])),hasFaceVertexNormal)for(i=0;3>i;i++)normalIndex=3*faces[offset++],normal=new THREE.Vector3(normals[normalIndex++],normals[normalIndex++],normals[normalIndex]),face.vertexNormals.push(normal);if(hasFaceColor&&(colorIndex=faces[offset++],face.color.setHex(colors[colorIndex])),hasFaceVertexColor)for(i=0;3>i;i++)colorIndex=faces[offset++],face.vertexColors.push(new THREE.Color(colors[colorIndex]));geometry.faces.push(face)}}function parseSkin(){var influencesPerVertex=void 0!==json.influencesPerVertex?json.influencesPerVertex:2;if(json.skinWeights)for(var i=0,l=json.skinWeights.length;l>i;i+=influencesPerVertex){var x=json.skinWeights[i],y=influencesPerVertex>1?json.skinWeights[i+1]:0,z=influencesPerVertex>2?json.skinWeights[i+2]:0,w=influencesPerVertex>3?json.skinWeights[i+3]:0;geometry.skinWeights.push(new THREE.Vector4(x,y,z,w))}if(json.skinIndices)for(var i=0,l=json.skinIndices.length;l>i;i+=influencesPerVertex){var a=json.skinIndices[i],b=influencesPerVertex>1?json.skinIndices[i+1]:0,c=influencesPerVertex>2?json.skinIndices[i+2]:0,d=influencesPerVertex>3?json.skinIndices[i+3]:0;geometry.skinIndices.push(new THREE.Vector4(a,b,c,d))}geometry.bones=json.bones,geometry.bones&&geometry.bones.length>0&&(geometry.skinWeights.length!==geometry.skinIndices.length||geometry.skinIndices.length!==geometry.vertices.length)&&console.warn("When skinning, number of vertices ("+geometry.vertices.length+"), skinIndices ("+geometry.skinIndices.length+"), and skinWeights ("+geometry.skinWeights.length+") should match."),geometry.animation=json.animation,geometry.animations=json.animations}function parseMorphing(scale){if(void 0!==json.morphTargets){var i,l,v,vl,dstVertices,srcVertices;for(i=0,l=json.morphTargets.length;l>i;i++)for(geometry.morphTargets[i]={},geometry.morphTargets[i].name=json.morphTargets[i].name,geometry.morphTargets[i].vertices=[],dstVertices=geometry.morphTargets[i].vertices,srcVertices=json.morphTargets[i].vertices,v=0,vl=srcVertices.length;vl>v;v+=3){var vertex=new THREE.Vector3;vertex.x=srcVertices[v]*scale,vertex.y=srcVertices[v+1]*scale,vertex.z=srcVertices[v+2]*scale,dstVertices.push(vertex)}}if(void 0!==json.morphColors){var i,l,c,cl,dstColors,srcColors,color;for(i=0,l=json.morphColors.length;l>i;i++)for(geometry.morphColors[i]={},geometry.morphColors[i].name=json.morphColors[i].name,geometry.morphColors[i].colors=[],dstColors=geometry.morphColors[i].colors,srcColors=json.morphColors[i].colors,c=0,cl=srcColors.length;cl>c;c+=3)color=new THREE.Color(16755200),color.setRGB(srcColors[c],srcColors[c+1],srcColors[c+2]),dstColors.push(color)}}var geometry=new THREE.Geometry,scale=void 0!==json.scale?1/json.scale:1;if(parseModel(scale),parseSkin(),parseMorphing(scale),geometry.computeFaceNormals(),geometry.computeBoundingSphere(),void 0===json.materials||0===json.materials.length)return{geometry:geometry};var materials=this.initMaterials(json.materials,texturePath);return this.needsTangents(materials)&&geometry.computeTangents(),{geometry:geometry,materials:materials}},THREE.LoadingManager=function(onLoad,onProgress,onError){var scope=this,loaded=0,total=0;this.onLoad=onLoad,this.onProgress=onProgress,this.onError=onError,this.itemStart=function(){total++},this.itemEnd=function(url){loaded++,void 0!==scope.onProgress&&scope.onProgress(url,loaded,total),loaded===total&&void 0!==scope.onLoad&&scope.onLoad()}},THREE.DefaultLoadingManager=new THREE.LoadingManager,THREE.BufferGeometryLoader=function(manager){this.manager=void 0!==manager?manager:THREE.DefaultLoadingManager},THREE.BufferGeometryLoader.prototype={constructor:THREE.BufferGeometryLoader,load:function(url,onLoad,onProgress,onError){var scope=this,loader=new THREE.XHRLoader;loader.setCrossOrigin(this.crossOrigin),loader.load(url,function(text){onLoad(scope.parse(JSON.parse(text)))},onProgress,onError)},setCrossOrigin:function(value){this.crossOrigin=value},parse:function(json){var geometry=new THREE.BufferGeometry,attributes=json.attributes;for(var key in attributes){var attribute=attributes[key];geometry.attributes[key]={itemSize:attribute.itemSize,array:new self[attribute.type](attribute.array)}}var offsets=json.offsets;void 0!==offsets&&(geometry.offsets=JSON.parse(JSON.stringify(offsets)));var boundingSphere=json.boundingSphere;return void 0!==boundingSphere&&(geometry.boundingSphere=new THREE.Sphere((new THREE.Vector3).fromArray(void 0!==boundingSphere.center?boundingSphere.center:[0,0,0]),boundingSphere.radius)),geometry}},THREE.MaterialLoader=function(manager){this.manager=void 0!==manager?manager:THREE.DefaultLoadingManager},THREE.MaterialLoader.prototype={constructor:THREE.MaterialLoader,load:function(url,onLoad,onProgress,onError){var scope=this,loader=new THREE.XHRLoader;loader.setCrossOrigin(this.crossOrigin),loader.load(url,function(text){onLoad(scope.parse(JSON.parse(text)))},onProgress,onError)},setCrossOrigin:function(value){this.crossOrigin=value},parse:function(json){var material=new THREE[json.type];if(void 0!==json.color&&material.color.setHex(json.color),void 0!==json.ambient&&material.ambient.setHex(json.ambient),void 0!==json.emissive&&material.emissive.setHex(json.emissive),void 0!==json.specular&&material.specular.setHex(json.specular),void 0!==json.shininess&&(material.shininess=json.shininess),void 0!==json.uniforms&&(material.uniforms=json.uniforms),void 0!==json.vertexShader&&(material.vertexShader=json.vertexShader),void 0!==json.fragmentShader&&(material.fragmentShader=json.fragmentShader),void 0!==json.vertexColors&&(material.vertexColors=json.vertexColors),void 0!==json.blending&&(material.blending=json.blending),void 0!==json.side&&(material.side=json.side),void 0!==json.opacity&&(material.opacity=json.opacity),void 0!==json.transparent&&(material.transparent=json.transparent),void 0!==json.wireframe&&(material.wireframe=json.wireframe),void 0!==json.materials)for(var i=0,l=json.materials.length;l>i;i++)material.materials.push(this.parse(json.materials[i]));return material}},THREE.ObjectLoader=function(manager){this.manager=void 0!==manager?manager:THREE.DefaultLoadingManager},THREE.ObjectLoader.prototype={constructor:THREE.ObjectLoader,load:function(url,onLoad,onProgress,onError){var scope=this,loader=new THREE.XHRLoader(scope.manager);loader.setCrossOrigin(this.crossOrigin),loader.load(url,function(text){onLoad(scope.parse(JSON.parse(text)))},onProgress,onError)},setCrossOrigin:function(value){this.crossOrigin=value},parse:function(json){var geometries=this.parseGeometries(json.geometries),materials=this.parseMaterials(json.materials),object=this.parseObject(json.object,geometries,materials);return object},parseGeometries:function(json){var geometries={};if(void 0!==json)for(var geometryLoader=new THREE.JSONLoader,bufferGeometryLoader=new THREE.BufferGeometryLoader,i=0,l=json.length;l>i;i++){var geometry,data=json[i];switch(data.type){case"PlaneGeometry":geometry=new THREE.PlaneGeometry(data.width,data.height,data.widthSegments,data.heightSegments);break;case"BoxGeometry":case"CubeGeometry":geometry=new THREE.BoxGeometry(data.width,data.height,data.depth,data.widthSegments,data.heightSegments,data.depthSegments);break;case"CircleGeometry":geometry=new THREE.CircleGeometry(data.radius,data.segments);break;case"CylinderGeometry":geometry=new THREE.CylinderGeometry(data.radiusTop,data.radiusBottom,data.height,data.radialSegments,data.heightSegments,data.openEnded);break;case"SphereGeometry":geometry=new THREE.SphereGeometry(data.radius,data.widthSegments,data.heightSegments,data.phiStart,data.phiLength,data.thetaStart,data.thetaLength);break;case"IcosahedronGeometry":geometry=new THREE.IcosahedronGeometry(data.radius,data.detail);break;case"TorusGeometry":geometry=new THREE.TorusGeometry(data.radius,data.tube,data.radialSegments,data.tubularSegments,data.arc);break;case"TorusKnotGeometry":geometry=new THREE.TorusKnotGeometry(data.radius,data.tube,data.radialSegments,data.tubularSegments,data.p,data.q,data.heightScale);break;case"BufferGeometry":geometry=bufferGeometryLoader.parse(data.data);break;case"Geometry":geometry=geometryLoader.parse(data.data).geometry}geometry.uuid=data.uuid,void 0!==data.name&&(geometry.name=data.name),geometries[data.uuid]=geometry}return geometries},parseMaterials:function(json){var materials={};if(void 0!==json)for(var loader=new THREE.MaterialLoader,i=0,l=json.length;l>i;i++){var data=json[i],material=loader.parse(data);material.uuid=data.uuid,void 0!==data.name&&(material.name=data.name),materials[data.uuid]=material}return materials},parseObject:function(){var matrix=new THREE.Matrix4;return function(data,geometries,materials){var object;switch(data.type){case"Scene":object=new THREE.Scene;break;case"PerspectiveCamera":object=new THREE.PerspectiveCamera(data.fov,data.aspect,data.near,data.far);break;case"OrthographicCamera":object=new THREE.OrthographicCamera(data.left,data.right,data.top,data.bottom,data.near,data.far);break;case"AmbientLight":object=new THREE.AmbientLight(data.color);break;case"DirectionalLight":object=new THREE.DirectionalLight(data.color,data.intensity);break;case"PointLight":object=new THREE.PointLight(data.color,data.intensity,data.distance);break;case"SpotLight":object=new THREE.SpotLight(data.color,data.intensity,data.distance,data.angle,data.exponent);break;case"HemisphereLight":object=new THREE.HemisphereLight(data.color,data.groundColor,data.intensity);break;case"Mesh":var geometry=geometries[data.geometry],material=materials[data.material];void 0===geometry&&console.error("THREE.ObjectLoader: Undefined geometry "+data.geometry),void 0===material&&console.error("THREE.ObjectLoader: Undefined material "+data.material),object=new THREE.Mesh(geometry,material);break;case"Sprite":var material=materials[data.material];void 0===material&&console.error("THREE.ObjectLoader: Undefined material "+data.material),object=new THREE.Sprite(material);break;default:object=new THREE.Object3D}if(object.uuid=data.uuid,void 0!==data.name&&(object.name=data.name),void 0!==data.matrix?(matrix.fromArray(data.matrix),matrix.decompose(object.position,object.quaternion,object.scale)):(void 0!==data.position&&object.position.fromArray(data.position),void 0!==data.rotation&&object.rotation.fromArray(data.rotation),void 0!==data.scale&&object.scale.fromArray(data.scale)),void 0!==data.visible&&(object.visible=data.visible),void 0!==data.userData&&(object.userData=data.userData),void 0!==data.children)for(var child in data.children)object.add(this.parseObject(data.children[child],geometries,materials));return object}}()},THREE.TextureLoader=function(manager){this.manager=void 0!==manager?manager:THREE.DefaultLoadingManager},THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,load:function(url,onLoad,onProgress,onError){var scope=this,loader=new THREE.ImageLoader(scope.manager);loader.setCrossOrigin(this.crossOrigin),loader.load(url,function(image){var texture=new THREE.Texture(image);texture.needsUpdate=!0,void 0!==onLoad&&onLoad(texture)},onProgress,onError)},setCrossOrigin:function(value){this.crossOrigin=value}},THREE.Material=function(){this.id=THREE.MaterialIdCount++,this.uuid=THREE.Math.generateUUID(),this.name="",this.side=THREE.FrontSide,this.opacity=1,this.transparent=!1,this.blending=THREE.NormalBlending,this.blendSrc=THREE.SrcAlphaFactor,this.blendDst=THREE.OneMinusSrcAlphaFactor,this.blendEquation=THREE.AddEquation,this.depthTest=!0,this.depthWrite=!0,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.overdraw=0,this.visible=!0,this.needsUpdate=!0},THREE.Material.prototype={constructor:THREE.Material,setValues:function(values){if(void 0!==values)for(var key in values){var newValue=values[key];if(void 0!==newValue){if(key in this){var currentValue=this[key];currentValue instanceof THREE.Color?currentValue.set(newValue):currentValue instanceof THREE.Vector3&&newValue instanceof THREE.Vector3?currentValue.copy(newValue):this[key]="overdraw"==key?Number(newValue):newValue}}else console.warn("THREE.Material: '"+key+"' parameter is undefined.")}},clone:function(material){return void 0===material&&(material=new THREE.Material),material.name=this.name,material.side=this.side,material.opacity=this.opacity,material.transparent=this.transparent,material.blending=this.blending,material.blendSrc=this.blendSrc,material.blendDst=this.blendDst,material.blendEquation=this.blendEquation,material.depthTest=this.depthTest,material.depthWrite=this.depthWrite,material.polygonOffset=this.polygonOffset,material.polygonOffsetFactor=this.polygonOffsetFactor,material.polygonOffsetUnits=this.polygonOffsetUnits,material.alphaTest=this.alphaTest,material.overdraw=this.overdraw,material.visible=this.visible,material},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.Material.prototype),THREE.MaterialIdCount=0,THREE.LineBasicMaterial=function(parameters){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.vertexColors=THREE.NoColors,this.fog=!0,this.setValues(parameters)},THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.LineBasicMaterial.prototype.clone=function(){var material=new THREE.LineBasicMaterial;return THREE.Material.prototype.clone.call(this,material),material.color.copy(this.color),material.linewidth=this.linewidth,material.linecap=this.linecap,material.linejoin=this.linejoin,material.vertexColors=this.vertexColors,material.fog=this.fog,material},THREE.LineDashedMaterial=function(parameters){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.vertexColors=!1,this.fog=!0,this.setValues(parameters)},THREE.LineDashedMaterial.prototype=Object.create(THREE.Material.prototype),THREE.LineDashedMaterial.prototype.clone=function(){var material=new THREE.LineDashedMaterial;return THREE.Material.prototype.clone.call(this,material),material.color.copy(this.color),material.linewidth=this.linewidth,material.scale=this.scale,material.dashSize=this.dashSize,material.gapSize=this.gapSize,material.vertexColors=this.vertexColors,material.fog=this.fog,material},THREE.MeshBasicMaterial=function(parameters){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.map=null,this.lightMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.setValues(parameters)},THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshBasicMaterial.prototype.clone=function(){var material=new THREE.MeshBasicMaterial;return THREE.Material.prototype.clone.call(this,material),material.color.copy(this.color),material.map=this.map,material.lightMap=this.lightMap,material.specularMap=this.specularMap,material.alphaMap=this.alphaMap,material.envMap=this.envMap,material.combine=this.combine,material.reflectivity=this.reflectivity,material.refractionRatio=this.refractionRatio,material.fog=this.fog,material.shading=this.shading,material.wireframe=this.wireframe,material.wireframeLinewidth=this.wireframeLinewidth,material.wireframeLinecap=this.wireframeLinecap,material.wireframeLinejoin=this.wireframeLinejoin,material.vertexColors=this.vertexColors,material.skinning=this.skinning,material.morphTargets=this.morphTargets,material},THREE.MeshLambertMaterial=function(parameters){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.ambient=new THREE.Color(16777215),this.emissive=new THREE.Color(0),this.wrapAround=!1,this.wrapRGB=new THREE.Vector3(1,1,1),this.map=null,this.lightMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(parameters)},THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshLambertMaterial.prototype.clone=function(){var material=new THREE.MeshLambertMaterial;return THREE.Material.prototype.clone.call(this,material),material.color.copy(this.color),material.ambient.copy(this.ambient),material.emissive.copy(this.emissive),material.wrapAround=this.wrapAround,material.wrapRGB.copy(this.wrapRGB),material.map=this.map,material.lightMap=this.lightMap,material.specularMap=this.specularMap,material.alphaMap=this.alphaMap,material.envMap=this.envMap,material.combine=this.combine,material.reflectivity=this.reflectivity,material.refractionRatio=this.refractionRatio,material.fog=this.fog,material.shading=this.shading,material.wireframe=this.wireframe,material.wireframeLinewidth=this.wireframeLinewidth,material.wireframeLinecap=this.wireframeLinecap,material.wireframeLinejoin=this.wireframeLinejoin,material.vertexColors=this.vertexColors,material.skinning=this.skinning,material.morphTargets=this.morphTargets,material.morphNormals=this.morphNormals,material},THREE.MeshPhongMaterial=function(parameters){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.ambient=new THREE.Color(16777215),this.emissive=new THREE.Color(0),this.specular=new THREE.Color(1118481),this.shininess=30,this.metal=!1,this.wrapAround=!1,this.wrapRGB=new THREE.Vector3(1,1,1),this.map=null,this.lightMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new THREE.Vector2(1,1),this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(parameters)},THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshPhongMaterial.prototype.clone=function(){var material=new THREE.MeshPhongMaterial;return THREE.Material.prototype.clone.call(this,material),material.color.copy(this.color),material.ambient.copy(this.ambient),material.emissive.copy(this.emissive),material.specular.copy(this.specular),material.shininess=this.shininess,material.metal=this.metal,material.wrapAround=this.wrapAround,material.wrapRGB.copy(this.wrapRGB),material.map=this.map,material.lightMap=this.lightMap,material.bumpMap=this.bumpMap,material.bumpScale=this.bumpScale,material.normalMap=this.normalMap,material.normalScale.copy(this.normalScale),material.specularMap=this.specularMap,material.alphaMap=this.alphaMap,material.envMap=this.envMap,material.combine=this.combine,material.reflectivity=this.reflectivity,material.refractionRatio=this.refractionRatio,material.fog=this.fog,material.shading=this.shading,material.wireframe=this.wireframe,material.wireframeLinewidth=this.wireframeLinewidth,material.wireframeLinecap=this.wireframeLinecap,material.wireframeLinejoin=this.wireframeLinejoin,material.vertexColors=this.vertexColors,material.skinning=this.skinning,material.morphTargets=this.morphTargets,material.morphNormals=this.morphNormals,material},THREE.MeshDepthMaterial=function(parameters){THREE.Material.call(this),this.morphTargets=!1,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(parameters)},THREE.MeshDepthMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshDepthMaterial.prototype.clone=function(){var material=new THREE.MeshDepthMaterial;return THREE.Material.prototype.clone.call(this,material),material.wireframe=this.wireframe,material.wireframeLinewidth=this.wireframeLinewidth,material},THREE.MeshNormalMaterial=function(parameters){THREE.Material.call(this,parameters),this.shading=THREE.FlatShading,this.wireframe=!1,this.wireframeLinewidth=1,this.morphTargets=!1,this.setValues(parameters)},THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshNormalMaterial.prototype.clone=function(){var material=new THREE.MeshNormalMaterial;return THREE.Material.prototype.clone.call(this,material),material.shading=this.shading,material.wireframe=this.wireframe,material.wireframeLinewidth=this.wireframeLinewidth,material},THREE.MeshFaceMaterial=function(materials){this.materials=materials instanceof Array?materials:[]},THREE.MeshFaceMaterial.prototype.clone=function(){for(var material=new THREE.MeshFaceMaterial,i=0;i<this.materials.length;i++)material.materials.push(this.materials[i].clone());return material},THREE.PointCloudMaterial=function(parameters){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.vertexColors=THREE.NoColors,this.fog=!0,this.setValues(parameters)},THREE.PointCloudMaterial.prototype=Object.create(THREE.Material.prototype),THREE.PointCloudMaterial.prototype.clone=function(){var material=new THREE.PointCloudMaterial;return THREE.Material.prototype.clone.call(this,material),material.color.copy(this.color),material.map=this.map,material.size=this.size,material.sizeAttenuation=this.sizeAttenuation,material.vertexColors=this.vertexColors,material.fog=this.fog,material},THREE.ParticleBasicMaterial=function(parameters){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointCloudMaterial."),new THREE.PointCloudMaterial(parameters)},THREE.ParticleSystemMaterial=function(parameters){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointCloudMaterial."),new THREE.PointCloudMaterial(parameters)},THREE.ShaderMaterial=function(parameters){THREE.Material.call(this),this.defines={},this.uniforms={},this.attributes=null,this.vertexShader="void main() {\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.shading=THREE.SmoothShading,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.vertexColors=THREE.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.setValues(parameters)},THREE.ShaderMaterial.prototype=Object.create(THREE.Material.prototype),THREE.ShaderMaterial.prototype.clone=function(){var material=new THREE.ShaderMaterial;return THREE.Material.prototype.clone.call(this,material),material.fragmentShader=this.fragmentShader,material.vertexShader=this.vertexShader,material.uniforms=THREE.UniformsUtils.clone(this.uniforms),material.attributes=this.attributes,material.defines=this.defines,material.shading=this.shading,material.wireframe=this.wireframe,material.wireframeLinewidth=this.wireframeLinewidth,material.fog=this.fog,material.lights=this.lights,material.vertexColors=this.vertexColors,material.skinning=this.skinning,material.morphTargets=this.morphTargets,material.morphNormals=this.morphNormals,material},THREE.RawShaderMaterial=function(parameters){THREE.ShaderMaterial.call(this,parameters)},THREE.RawShaderMaterial.prototype=Object.create(THREE.ShaderMaterial.prototype),THREE.RawShaderMaterial.prototype.clone=function(){var material=new THREE.RawShaderMaterial;return THREE.ShaderMaterial.prototype.clone.call(this,material),material},THREE.SpriteMaterial=function(parameters){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.map=null,this.rotation=0,this.fog=!1,this.setValues(parameters)},THREE.SpriteMaterial.prototype=Object.create(THREE.Material.prototype),THREE.SpriteMaterial.prototype.clone=function(){var material=new THREE.SpriteMaterial;return THREE.Material.prototype.clone.call(this,material),material.color.copy(this.color),material.map=this.map,material.rotation=this.rotation,material.fog=this.fog,material},THREE.SpriteCanvasMaterial=function(parameters){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.program=function(){},this.setValues(parameters)},THREE.SpriteCanvasMaterial.prototype=Object.create(THREE.Material.prototype),THREE.SpriteCanvasMaterial.prototype.clone=function(){var material=new THREE.SpriteCanvasMaterial;return THREE.Material.prototype.clone.call(this,material),material.color.copy(this.color),material.program=this.program,material},THREE.ParticleCanvasMaterial=THREE.SpriteCanvasMaterial,THREE.Texture=function(image,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy){this.id=THREE.TextureIdCount++,this.uuid=THREE.Math.generateUUID(),this.name="",this.image=void 0!==image?image:THREE.Texture.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==mapping?mapping:THREE.Texture.DEFAULT_MAPPING,this.wrapS=void 0!==wrapS?wrapS:THREE.ClampToEdgeWrapping,this.wrapT=void 0!==wrapT?wrapT:THREE.ClampToEdgeWrapping,this.magFilter=void 0!==magFilter?magFilter:THREE.LinearFilter,this.minFilter=void 0!==minFilter?minFilter:THREE.LinearMipMapLinearFilter,this.anisotropy=void 0!==anisotropy?anisotropy:1,this.format=void 0!==format?format:THREE.RGBAFormat,this.type=void 0!==type?type:THREE.UnsignedByteType,this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this._needsUpdate=!1,this.onUpdate=null},THREE.Texture.DEFAULT_IMAGE=void 0,THREE.Texture.DEFAULT_MAPPING=new THREE.UVMapping,THREE.Texture.prototype={constructor:THREE.Texture,get needsUpdate(){return this._needsUpdate},set needsUpdate(value){value===!0&&this.update(),this._needsUpdate=value},clone:function(texture){return void 0===texture&&(texture=new THREE.Texture),texture.image=this.image,texture.mipmaps=this.mipmaps.slice(0),texture.mapping=this.mapping,texture.wrapS=this.wrapS,texture.wrapT=this.wrapT,texture.magFilter=this.magFilter,texture.minFilter=this.minFilter,texture.anisotropy=this.anisotropy,texture.format=this.format,texture.type=this.type,texture.offset.copy(this.offset),texture.repeat.copy(this.repeat),texture.generateMipmaps=this.generateMipmaps,texture.premultiplyAlpha=this.premultiplyAlpha,texture.flipY=this.flipY,texture.unpackAlignment=this.unpackAlignment,texture},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.Texture.prototype),THREE.TextureIdCount=0,THREE.CubeTexture=function(images,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy){THREE.Texture.call(this,images,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy),this.images=images},THREE.CubeTexture.prototype=Object.create(THREE.Texture.prototype),THREE.CubeTexture.clone=function(texture){return void 0===texture&&(texture=new THREE.CubeTexture),THREE.Texture.prototype.clone.call(this,texture),texture.images=this.images,texture},THREE.CompressedTexture=function(mipmaps,width,height,format,type,mapping,wrapS,wrapT,magFilter,minFilter,anisotropy){THREE.Texture.call(this,null,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy),this.image={width:width,height:height},this.mipmaps=mipmaps,this.generateMipmaps=!1},THREE.CompressedTexture.prototype=Object.create(THREE.Texture.prototype),THREE.CompressedTexture.prototype.clone=function(){var texture=new THREE.CompressedTexture;return THREE.Texture.prototype.clone.call(this,texture),texture},THREE.DataTexture=function(data,width,height,format,type,mapping,wrapS,wrapT,magFilter,minFilter,anisotropy){THREE.Texture.call(this,null,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy),this.image={data:data,width:width,height:height}},THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype),THREE.DataTexture.prototype.clone=function(){var texture=new THREE.DataTexture;return THREE.Texture.prototype.clone.call(this,texture),texture},THREE.PointCloud=function(geometry,material){THREE.Object3D.call(this),this.geometry=void 0!==geometry?geometry:new THREE.Geometry,this.material=void 0!==material?material:new THREE.PointCloudMaterial({color:16777215*Math.random()}),this.sortParticles=!1},THREE.PointCloud.prototype=Object.create(THREE.Object3D.prototype),THREE.PointCloud.prototype.raycast=function(){var inverseMatrix=new THREE.Matrix4,ray=new THREE.Ray;return function(raycaster,intersects){var object=this,geometry=object.geometry,threshold=raycaster.params.PointCloud.threshold;if(inverseMatrix.getInverse(this.matrixWorld),ray.copy(raycaster.ray).applyMatrix4(inverseMatrix),null===geometry.boundingBox||ray.isIntersectionBox(geometry.boundingBox)!==!1){var localThreshold=threshold/((this.scale.x+this.scale.y+this.scale.z)/3),position=new THREE.Vector3,testPoint=function(point,index){var rayPointDistance=ray.distanceToPoint(point);if(localThreshold>rayPointDistance){var intersectPoint=ray.closestPointToPoint(point);intersectPoint.applyMatrix4(object.matrixWorld);var distance=raycaster.ray.origin.distanceTo(intersectPoint);intersects.push({distance:distance,distanceToRay:rayPointDistance,point:intersectPoint.clone(),index:index,face:null,object:object})
}};if(geometry instanceof THREE.BufferGeometry){var attributes=geometry.attributes,positions=attributes.position.array;if(void 0!==attributes.index){var indices=attributes.index.array,offsets=geometry.offsets;if(0===offsets.length){var offset={start:0,count:indices.length,index:0};offsets=[offset]}for(var oi=0,ol=offsets.length;ol>oi;++oi)for(var start=offsets[oi].start,count=offsets[oi].count,index=offsets[oi].index,i=start,il=start+count;il>i;i++){var a=index+indices[i];position.set(positions[3*a],positions[3*a+1],positions[3*a+2]),testPoint(position,a)}}else for(var pointCount=positions.length/3,i=0;pointCount>i;i++)position.set(positions[3*i],positions[3*i+1],positions[3*i+2]),testPoint(position,i)}else for(var vertices=this.geometry.vertices,i=0;i<vertices.length;i++)testPoint(vertices[i],i)}}}(),THREE.PointCloud.prototype.clone=function(object){return void 0===object&&(object=new THREE.PointCloud(this.geometry,this.material)),object.sortParticles=this.sortParticles,THREE.Object3D.prototype.clone.call(this,object),object},THREE.ParticleSystem=function(geometry,material){return console.warn("THREE.ParticleSystem has been renamed to THREE.PointCloud."),new THREE.PointCloud(geometry,material)},THREE.Line=function(geometry,material,type){THREE.Object3D.call(this),this.geometry=void 0!==geometry?geometry:new THREE.Geometry,this.material=void 0!==material?material:new THREE.LineBasicMaterial({color:16777215*Math.random()}),this.type=void 0!==type?type:THREE.LineStrip},THREE.LineStrip=0,THREE.LinePieces=1,THREE.Line.prototype=Object.create(THREE.Object3D.prototype),THREE.Line.prototype.raycast=function(){var inverseMatrix=new THREE.Matrix4,ray=new THREE.Ray,sphere=new THREE.Sphere;return function(raycaster,intersects){var precision=raycaster.linePrecision,precisionSq=precision*precision,geometry=this.geometry;if(null===geometry.boundingSphere&&geometry.computeBoundingSphere(),sphere.copy(geometry.boundingSphere),sphere.applyMatrix4(this.matrixWorld),raycaster.ray.isIntersectionSphere(sphere)!==!1&&(inverseMatrix.getInverse(this.matrixWorld),ray.copy(raycaster.ray).applyMatrix4(inverseMatrix),geometry instanceof THREE.Geometry))for(var vertices=geometry.vertices,nbVertices=vertices.length,interSegment=new THREE.Vector3,interRay=new THREE.Vector3,step=this.type===THREE.LineStrip?1:2,i=0;nbVertices-1>i;i+=step){var distSq=ray.distanceSqToSegment(vertices[i],vertices[i+1],interRay,interSegment);if(!(distSq>precisionSq)){var distance=ray.origin.distanceTo(interRay);distance<raycaster.near||distance>raycaster.far||intersects.push({distance:distance,point:interSegment.clone().applyMatrix4(this.matrixWorld),face:null,faceIndex:null,object:this})}}}}(),THREE.Line.prototype.clone=function(object){return void 0===object&&(object=new THREE.Line(this.geometry,this.material,this.type)),THREE.Object3D.prototype.clone.call(this,object),object},THREE.Mesh=function(geometry,material){THREE.Object3D.call(this),this.geometry=void 0!==geometry?geometry:new THREE.Geometry,this.material=void 0!==material?material:new THREE.MeshBasicMaterial({color:16777215*Math.random()}),this.updateMorphTargets()},THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype),THREE.Mesh.prototype.updateMorphTargets=function(){if(void 0!==this.geometry.morphTargets&&this.geometry.morphTargets.length>0){this.morphTargetBase=-1,this.morphTargetForcedOrder=[],this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var m=0,ml=this.geometry.morphTargets.length;ml>m;m++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[m].name]=m}},THREE.Mesh.prototype.getMorphTargetIndexByName=function(name){return void 0!==this.morphTargetDictionary[name]?this.morphTargetDictionary[name]:(console.log("THREE.Mesh.getMorphTargetIndexByName: morph target "+name+" does not exist. Returning 0."),0)},THREE.Mesh.prototype.raycast=function(){var inverseMatrix=new THREE.Matrix4,ray=new THREE.Ray,sphere=new THREE.Sphere,vA=new THREE.Vector3,vB=new THREE.Vector3,vC=new THREE.Vector3;return function(raycaster,intersects){var geometry=this.geometry;if(null===geometry.boundingSphere&&geometry.computeBoundingSphere(),sphere.copy(geometry.boundingSphere),sphere.applyMatrix4(this.matrixWorld),raycaster.ray.isIntersectionSphere(sphere)!==!1&&(inverseMatrix.getInverse(this.matrixWorld),ray.copy(raycaster.ray).applyMatrix4(inverseMatrix),null===geometry.boundingBox||ray.isIntersectionBox(geometry.boundingBox)!==!1))if(geometry instanceof THREE.BufferGeometry){var material=this.material;if(void 0===material)return;var a,b,c,attributes=geometry.attributes,precision=raycaster.precision;if(void 0!==attributes.index){var indices=attributes.index.array,positions=attributes.position.array,offsets=geometry.offsets;0===offsets.length&&(offsets=[{start:0,count:indices.length,index:0}]);for(var oi=0,ol=offsets.length;ol>oi;++oi)for(var start=offsets[oi].start,count=offsets[oi].count,index=offsets[oi].index,i=start,il=start+count;il>i;i+=3){if(a=index+indices[i],b=index+indices[i+1],c=index+indices[i+2],vA.set(positions[3*a],positions[3*a+1],positions[3*a+2]),vB.set(positions[3*b],positions[3*b+1],positions[3*b+2]),vC.set(positions[3*c],positions[3*c+1],positions[3*c+2]),material.side===THREE.BackSide)var intersectionPoint=ray.intersectTriangle(vC,vB,vA,!0);else var intersectionPoint=ray.intersectTriangle(vA,vB,vC,material.side!==THREE.DoubleSide);if(null!==intersectionPoint){intersectionPoint.applyMatrix4(this.matrixWorld);var distance=raycaster.ray.origin.distanceTo(intersectionPoint);precision>distance||distance<raycaster.near||distance>raycaster.far||intersects.push({distance:distance,point:intersectionPoint,indices:[a,b,c],face:null,faceIndex:null,object:this})}}}else for(var positions=attributes.position.array,i=0,j=0,il=positions.length;il>i;i+=3,j+=9){if(a=i,b=i+1,c=i+2,vA.set(positions[j],positions[j+1],positions[j+2]),vB.set(positions[j+3],positions[j+4],positions[j+5]),vC.set(positions[j+6],positions[j+7],positions[j+8]),material.side===THREE.BackSide)var intersectionPoint=ray.intersectTriangle(vC,vB,vA,!0);else var intersectionPoint=ray.intersectTriangle(vA,vB,vC,material.side!==THREE.DoubleSide);if(null!==intersectionPoint){intersectionPoint.applyMatrix4(this.matrixWorld);var distance=raycaster.ray.origin.distanceTo(intersectionPoint);precision>distance||distance<raycaster.near||distance>raycaster.far||intersects.push({distance:distance,point:intersectionPoint,indices:[a,b,c],face:null,faceIndex:null,object:this})}}}else if(geometry instanceof THREE.Geometry)for(var a,b,c,isFaceMaterial=this.material instanceof THREE.MeshFaceMaterial,objectMaterials=isFaceMaterial===!0?this.material.materials:null,precision=raycaster.precision,vertices=geometry.vertices,f=0,fl=geometry.faces.length;fl>f;f++){var face=geometry.faces[f],material=isFaceMaterial===!0?objectMaterials[face.materialIndex]:this.material;if(void 0!==material){if(a=vertices[face.a],b=vertices[face.b],c=vertices[face.c],material.morphTargets===!0){var morphTargets=geometry.morphTargets,morphInfluences=this.morphTargetInfluences;vA.set(0,0,0),vB.set(0,0,0),vC.set(0,0,0);for(var t=0,tl=morphTargets.length;tl>t;t++){var influence=morphInfluences[t];if(0!==influence){var targets=morphTargets[t].vertices;vA.x+=(targets[face.a].x-a.x)*influence,vA.y+=(targets[face.a].y-a.y)*influence,vA.z+=(targets[face.a].z-a.z)*influence,vB.x+=(targets[face.b].x-b.x)*influence,vB.y+=(targets[face.b].y-b.y)*influence,vB.z+=(targets[face.b].z-b.z)*influence,vC.x+=(targets[face.c].x-c.x)*influence,vC.y+=(targets[face.c].y-c.y)*influence,vC.z+=(targets[face.c].z-c.z)*influence}}vA.add(a),vB.add(b),vC.add(c),a=vA,b=vB,c=vC}if(material.side===THREE.BackSide)var intersectionPoint=ray.intersectTriangle(c,b,a,!0);else var intersectionPoint=ray.intersectTriangle(a,b,c,material.side!==THREE.DoubleSide);if(null!==intersectionPoint){intersectionPoint.applyMatrix4(this.matrixWorld);var distance=raycaster.ray.origin.distanceTo(intersectionPoint);precision>distance||distance<raycaster.near||distance>raycaster.far||intersects.push({distance:distance,point:intersectionPoint,face:face,faceIndex:f,object:this})}}}}}(),THREE.Mesh.prototype.clone=function(object,recursive){return void 0===object&&(object=new THREE.Mesh(this.geometry,this.material)),THREE.Object3D.prototype.clone.call(this,object,recursive),object},THREE.Bone=function(belongsToSkin){THREE.Object3D.call(this),this.skin=belongsToSkin,this.accumulatedRotWeight=0,this.accumulatedPosWeight=0,this.accumulatedSclWeight=0},THREE.Bone.prototype=Object.create(THREE.Object3D.prototype),THREE.Bone.prototype.updateMatrixWorld=function(force){THREE.Object3D.prototype.updateMatrixWorld.call(this,force),this.accumulatedRotWeight=0,this.accumulatedPosWeight=0,this.accumulatedSclWeight=0},THREE.Skeleton=function(bones,boneInverses,useVertexTexture){if(this.useVertexTexture=void 0!==useVertexTexture?useVertexTexture:!0,this.identityMatrix=new THREE.Matrix4,bones=bones||[],this.bones=bones.slice(0),this.useVertexTexture){var size;size=this.bones.length>256?64:this.bones.length>64?32:this.bones.length>16?16:8,this.boneTextureWidth=size,this.boneTextureHeight=size,this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new THREE.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,THREE.RGBAFormat,THREE.FloatType),this.boneTexture.minFilter=THREE.NearestFilter,this.boneTexture.magFilter=THREE.NearestFilter,this.boneTexture.generateMipmaps=!1,this.boneTexture.flipY=!1}else this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===boneInverses)this.calculateInverses();else if(this.bones.length===boneInverses.length)this.boneInverses=boneInverses.slice(0);else{console.warn("THREE.Skeleton bonInverses is the wrong length."),this.boneInverses=[];for(var b=0,bl=this.bones.length;bl>b;b++)this.boneInverses.push(new THREE.Matrix4)}},THREE.Skeleton.prototype.calculateInverses=function(){this.boneInverses=[];for(var b=0,bl=this.bones.length;bl>b;b++){var inverse=new THREE.Matrix4;this.bones[b]&&inverse.getInverse(this.bones[b].matrixWorld),this.boneInverses.push(inverse)}},THREE.Skeleton.prototype.pose=function(){for(var bone,b=0,bl=this.bones.length;bl>b;b++)bone=this.bones[b],bone&&bone.matrixWorld.getInverse(this.boneInverses[b]);for(var b=0,bl=this.bones.length;bl>b;b++)bone=this.bones[b],bone&&(bone.parent?(bone.matrix.getInverse(bone.parent.matrixWorld),bone.matrix.multiply(bone.matrixWorld)):bone.matrix.copy(bone.matrixWorld),bone.matrix.decompose(bone.position,bone.quaternion,bone.scale))},THREE.Skeleton.prototype.update=function(){for(var offsetMatrix=new THREE.Matrix4,b=0,bl=this.bones.length;bl>b;b++){var matrix=this.bones[b]?this.bones[b].matrixWorld:this.identityMatrix;offsetMatrix.multiplyMatrices(matrix,this.boneInverses[b]),offsetMatrix.flattenToArrayOffset(this.boneMatrices,16*b)}this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)},THREE.SkinnedMesh=function(geometry,material,useVertexTexture){THREE.Mesh.call(this,geometry,material),this.bindMode="attached",this.bindMatrix=new THREE.Matrix4,this.bindMatrixInverse=new THREE.Matrix4;var bones=[];if(this.geometry&&void 0!==this.geometry.bones){for(var bone,gbone,p,q,s,b=0,bl=this.geometry.bones.length;bl>b;++b)gbone=this.geometry.bones[b],p=gbone.pos,q=gbone.rotq,s=gbone.scl,bone=new THREE.Bone(this),bones.push(bone),bone.name=gbone.name,bone.position.set(p[0],p[1],p[2]),bone.quaternion.set(q[0],q[1],q[2],q[3]),void 0!==s?bone.scale.set(s[0],s[1],s[2]):bone.scale.set(1,1,1);for(var b=0,bl=this.geometry.bones.length;bl>b;++b)gbone=this.geometry.bones[b],-1!==gbone.parent?bones[gbone.parent].add(bones[b]):this.add(bones[b])}this.normalizeSkinWeights(),this.updateMatrixWorld(!0),this.bind(new THREE.Skeleton(bones,void 0,useVertexTexture))},THREE.SkinnedMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.SkinnedMesh.prototype.bind=function(skeleton,bindMatrix){this.skeleton=skeleton,void 0===bindMatrix&&(this.updateMatrixWorld(!0),bindMatrix=this.matrixWorld),this.bindMatrix.copy(bindMatrix),this.bindMatrixInverse.getInverse(bindMatrix)},THREE.SkinnedMesh.prototype.pose=function(){this.skeleton.pose()},THREE.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof THREE.Geometry)for(var i=0;i<this.geometry.skinIndices.length;i++){var sw=this.geometry.skinWeights[i],scale=1/sw.lengthManhattan();1/0!==scale?sw.multiplyScalar(scale):sw.set(1)}},THREE.SkinnedMesh.prototype.updateMatrixWorld=function(){THREE.Mesh.prototype.updateMatrixWorld.call(this,!0),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh unreckognized bindMode: "+this.bindMode)},THREE.SkinnedMesh.prototype.clone=function(object){return void 0===object&&(object=new THREE.SkinnedMesh(this.geometry,this.material,this.useVertexTexture)),THREE.Mesh.prototype.clone.call(this,object),object},THREE.MorphAnimMesh=function(geometry,material){THREE.Mesh.call(this,geometry,material),this.duration=1e3,this.mirroredLoop=!1,this.time=0,this.lastKeyframe=0,this.currentKeyframe=0,this.direction=1,this.directionBackwards=!1,this.setFrameRange(0,this.geometry.morphTargets.length-1)},THREE.MorphAnimMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.MorphAnimMesh.prototype.setFrameRange=function(start,end){this.startKeyframe=start,this.endKeyframe=end,this.length=this.endKeyframe-this.startKeyframe+1},THREE.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1,this.directionBackwards=!1},THREE.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1,this.directionBackwards=!0},THREE.MorphAnimMesh.prototype.parseAnimations=function(){var geometry=this.geometry;geometry.animations||(geometry.animations={});for(var firstAnimation,animations=geometry.animations,pattern=/([a-z]+)_?(\d+)/,i=0,il=geometry.morphTargets.length;il>i;i++){var morph=geometry.morphTargets[i],parts=morph.name.match(pattern);if(parts&&parts.length>1){{var label=parts[1];parts[2]}animations[label]||(animations[label]={start:1/0,end:-1/0});var animation=animations[label];i<animation.start&&(animation.start=i),i>animation.end&&(animation.end=i),firstAnimation||(firstAnimation=label)}}geometry.firstAnimation=firstAnimation},THREE.MorphAnimMesh.prototype.setAnimationLabel=function(label,start,end){this.geometry.animations||(this.geometry.animations={}),this.geometry.animations[label]={start:start,end:end}},THREE.MorphAnimMesh.prototype.playAnimation=function(label,fps){var animation=this.geometry.animations[label];animation?(this.setFrameRange(animation.start,animation.end),this.duration=1e3*((animation.end-animation.start)/fps),this.time=0):console.warn("animation["+label+"] undefined")},THREE.MorphAnimMesh.prototype.updateAnimation=function(delta){var frameTime=this.duration/this.length;this.time+=this.direction*delta,this.mirroredLoop?(this.time>this.duration||this.time<0)&&(this.direction*=-1,this.time>this.duration&&(this.time=this.duration,this.directionBackwards=!0),this.time<0&&(this.time=0,this.directionBackwards=!1)):(this.time=this.time%this.duration,this.time<0&&(this.time+=this.duration));var keyframe=this.startKeyframe+THREE.Math.clamp(Math.floor(this.time/frameTime),0,this.length-1);keyframe!==this.currentKeyframe&&(this.morphTargetInfluences[this.lastKeyframe]=0,this.morphTargetInfluences[this.currentKeyframe]=1,this.morphTargetInfluences[keyframe]=0,this.lastKeyframe=this.currentKeyframe,this.currentKeyframe=keyframe);var mix=this.time%frameTime/frameTime;this.directionBackwards&&(mix=1-mix),this.morphTargetInfluences[this.currentKeyframe]=mix,this.morphTargetInfluences[this.lastKeyframe]=1-mix},THREE.MorphAnimMesh.prototype.interpolateTargets=function(a,b,t){for(var influences=this.morphTargetInfluences,i=0,l=influences.length;l>i;i++)influences[i]=0;a>-1&&(influences[a]=1-t),b>-1&&(influences[b]=t)},THREE.MorphAnimMesh.prototype.clone=function(object){return void 0===object&&(object=new THREE.MorphAnimMesh(this.geometry,this.material)),object.duration=this.duration,object.mirroredLoop=this.mirroredLoop,object.time=this.time,object.lastKeyframe=this.lastKeyframe,object.currentKeyframe=this.currentKeyframe,object.direction=this.direction,object.directionBackwards=this.directionBackwards,THREE.Mesh.prototype.clone.call(this,object),object},THREE.LOD=function(){THREE.Object3D.call(this),this.objects=[]},THREE.LOD.prototype=Object.create(THREE.Object3D.prototype),THREE.LOD.prototype.addLevel=function(object,distance){void 0===distance&&(distance=0),distance=Math.abs(distance);for(var l=0;l<this.objects.length&&!(distance<this.objects[l].distance);l++);this.objects.splice(l,0,{distance:distance,object:object}),this.add(object)},THREE.LOD.prototype.getObjectForDistance=function(distance){for(var i=1,l=this.objects.length;l>i&&!(distance<this.objects[i].distance);i++);return this.objects[i-1].object},THREE.LOD.prototype.raycast=function(){var matrixPosition=new THREE.Vector3;return function(raycaster,intersects){matrixPosition.setFromMatrixPosition(this.matrixWorld);var distance=raycaster.ray.origin.distanceTo(matrixPosition);this.getObjectForDistance(distance).raycast(raycaster,intersects)}}(),THREE.LOD.prototype.update=function(){var v1=new THREE.Vector3,v2=new THREE.Vector3;return function(camera){if(this.objects.length>1){v1.setFromMatrixPosition(camera.matrixWorld),v2.setFromMatrixPosition(this.matrixWorld);var distance=v1.distanceTo(v2);this.objects[0].object.visible=!0;for(var i=1,l=this.objects.length;l>i&&distance>=this.objects[i].distance;i++)this.objects[i-1].object.visible=!1,this.objects[i].object.visible=!0;for(;l>i;i++)this.objects[i].object.visible=!1}}}(),THREE.LOD.prototype.clone=function(object){void 0===object&&(object=new THREE.LOD),THREE.Object3D.prototype.clone.call(this,object);for(var i=0,l=this.objects.length;l>i;i++){var x=this.objects[i].object.clone();x.visible=0===i,object.addLevel(x,this.objects[i].distance)}return object},THREE.Sprite=function(){var vertices=new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0]),geometry=new THREE.BufferGeometry;return geometry.addAttribute("position",new THREE.BufferAttribute(vertices,3)),function(material){THREE.Object3D.call(this),this.geometry=geometry,this.material=void 0!==material?material:new THREE.SpriteMaterial}}(),THREE.Sprite.prototype=Object.create(THREE.Object3D.prototype),THREE.Sprite.prototype.raycast=function(){var matrixPosition=new THREE.Vector3;return function(raycaster,intersects){matrixPosition.setFromMatrixPosition(this.matrixWorld);var distance=raycaster.ray.distanceToPoint(matrixPosition);distance>this.scale.x||intersects.push({distance:distance,point:this.position,face:null,object:this})}}(),THREE.Sprite.prototype.updateMatrix=function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},THREE.Sprite.prototype.clone=function(object){return void 0===object&&(object=new THREE.Sprite(this.material)),THREE.Object3D.prototype.clone.call(this,object),object},THREE.Particle=THREE.Sprite,THREE.Scene=function(){THREE.Object3D.call(this),this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,this.matrixAutoUpdate=!1,this.__lights=[],this.__objectsAdded=[],this.__objectsRemoved=[]},THREE.Scene.prototype=Object.create(THREE.Object3D.prototype),THREE.Scene.prototype.__addObject=function(object){if(object instanceof THREE.Light)-1===this.__lights.indexOf(object)&&this.__lights.push(object),object.target&&void 0===object.target.parent&&this.add(object.target);else if(!(object instanceof THREE.Camera||object instanceof THREE.Bone)){this.__objectsAdded.push(object);var i=this.__objectsRemoved.indexOf(object);-1!==i&&this.__objectsRemoved.splice(i,1)}this.dispatchEvent({type:"objectAdded",object:object}),object.dispatchEvent({type:"addedToScene",scene:this});for(var c=0;c<object.children.length;c++)this.__addObject(object.children[c])},THREE.Scene.prototype.__removeObject=function(object){if(object instanceof THREE.Light){var i=this.__lights.indexOf(object);if(-1!==i&&this.__lights.splice(i,1),object.shadowCascadeArray)for(var x=0;x<object.shadowCascadeArray.length;x++)this.__removeObject(object.shadowCascadeArray[x])}else if(!(object instanceof THREE.Camera)){this.__objectsRemoved.push(object);var i=this.__objectsAdded.indexOf(object);-1!==i&&this.__objectsAdded.splice(i,1)}this.dispatchEvent({type:"objectRemoved",object:object}),object.dispatchEvent({type:"removedFromScene",scene:this});for(var c=0;c<object.children.length;c++)this.__removeObject(object.children[c])},THREE.Scene.prototype.clone=function(object){return void 0===object&&(object=new THREE.Scene),THREE.Object3D.prototype.clone.call(this,object),null!==this.fog&&(object.fog=this.fog.clone()),null!==this.overrideMaterial&&(object.overrideMaterial=this.overrideMaterial.clone()),object.autoUpdate=this.autoUpdate,object.matrixAutoUpdate=this.matrixAutoUpdate,object},THREE.Fog=function(color,near,far){this.name="",this.color=new THREE.Color(color),this.near=void 0!==near?near:1,this.far=void 0!==far?far:1e3},THREE.Fog.prototype.clone=function(){return new THREE.Fog(this.color.getHex(),this.near,this.far)},THREE.FogExp2=function(color,density){this.name="",this.color=new THREE.Color(color),this.density=void 0!==density?density:25e-5},THREE.FogExp2.prototype.clone=function(){return new THREE.FogExp2(this.color.getHex(),this.density)},THREE.CanvasRenderer=function(parameters){function calculateLights(){_ambientLight.setRGB(0,0,0),_directionalLights.setRGB(0,0,0),_pointLights.setRGB(0,0,0);for(var l=0,ll=_lights.length;ll>l;l++){var light=_lights[l],lightColor=light.color;light instanceof THREE.AmbientLight?_ambientLight.add(lightColor):light instanceof THREE.DirectionalLight?_directionalLights.add(lightColor):light instanceof THREE.PointLight&&_pointLights.add(lightColor)}}function calculateLight(position,normal,color){for(var l=0,ll=_lights.length;ll>l;l++){var light=_lights[l];if(_lightColor.copy(light.color),light instanceof THREE.DirectionalLight){var lightPosition=_vector3.setFromMatrixPosition(light.matrixWorld).normalize(),amount=normal.dot(lightPosition);if(0>=amount)continue;amount*=light.intensity,color.add(_lightColor.multiplyScalar(amount))}else if(light instanceof THREE.PointLight){var lightPosition=_vector3.setFromMatrixPosition(light.matrixWorld),amount=normal.dot(_vector3.subVectors(lightPosition,position).normalize());if(0>=amount)continue;if(amount*=0==light.distance?1:1-Math.min(position.distanceTo(lightPosition)/light.distance,1),0==amount)continue;amount*=light.intensity,color.add(_lightColor.multiplyScalar(amount))}}}function renderSprite(v1,element,material){setOpacity(material.opacity),setBlending(material.blending);var scaleX=element.scale.x*_canvasWidthHalf,scaleY=element.scale.y*_canvasHeightHalf,dist=.5*Math.sqrt(scaleX*scaleX+scaleY*scaleY);if(_elemBox.min.set(v1.x-dist,v1.y-dist),_elemBox.max.set(v1.x+dist,v1.y+dist),material instanceof THREE.SpriteMaterial){var texture=material.map;if(null!==texture&&void 0!==texture.image){texture.hasEventListener("update",onTextureUpdate)===!1&&(texture.image.width>0&&textureToPattern(texture),texture.addEventListener("update",onTextureUpdate));var pattern=_patterns[texture.id];setFillStyle(void 0!==pattern?pattern:"rgba( 0, 0, 0, 1 )");var bitmap=texture.image,ox=bitmap.width*texture.offset.x,oy=bitmap.height*texture.offset.y,sx=bitmap.width*texture.repeat.x,sy=bitmap.height*texture.repeat.y,cx=scaleX/sx,cy=scaleY/sy;_context.save(),_context.translate(v1.x,v1.y),0!==material.rotation&&_context.rotate(material.rotation),_context.translate(-scaleX/2,-scaleY/2),_context.scale(cx,cy),_context.translate(-ox,-oy),_context.fillRect(ox,oy,sx,sy),_context.restore()}else setFillStyle(material.color.getStyle()),_context.save(),_context.translate(v1.x,v1.y),0!==material.rotation&&_context.rotate(material.rotation),_context.scale(scaleX,-scaleY),_context.fillRect(-.5,-.5,1,1),_context.restore()}else material instanceof THREE.SpriteCanvasMaterial&&(setStrokeStyle(material.color.getStyle()),setFillStyle(material.color.getStyle()),_context.save(),_context.translate(v1.x,v1.y),0!==material.rotation&&_context.rotate(material.rotation),_context.scale(scaleX,scaleY),material.program(_context),_context.restore())}function renderLine(v1,v2,element,material){if(setOpacity(material.opacity),setBlending(material.blending),_context.beginPath(),_context.moveTo(v1.positionScreen.x,v1.positionScreen.y),_context.lineTo(v2.positionScreen.x,v2.positionScreen.y),material instanceof THREE.LineBasicMaterial){if(setLineWidth(material.linewidth),setLineCap(material.linecap),setLineJoin(material.linejoin),material.vertexColors!==THREE.VertexColors)setStrokeStyle(material.color.getStyle());else{var colorStyle1=element.vertexColors[0].getStyle(),colorStyle2=element.vertexColors[1].getStyle();if(colorStyle1===colorStyle2)setStrokeStyle(colorStyle1);else{try{var grad=_context.createLinearGradient(v1.positionScreen.x,v1.positionScreen.y,v2.positionScreen.x,v2.positionScreen.y);grad.addColorStop(0,colorStyle1),grad.addColorStop(1,colorStyle2)}catch(exception){grad=colorStyle1}setStrokeStyle(grad)}}_context.stroke(),_elemBox.expandByScalar(2*material.linewidth)}else material instanceof THREE.LineDashedMaterial&&(setLineWidth(material.linewidth),setLineCap(material.linecap),setLineJoin(material.linejoin),setStrokeStyle(material.color.getStyle()),setLineDash([material.dashSize,material.gapSize]),_context.stroke(),_elemBox.expandByScalar(2*material.linewidth),setLineDash([]))}function renderFace3(v1,v2,v3,uv1,uv2,uv3,element,material){_this.info.render.vertices+=3,_this.info.render.faces++,setOpacity(material.opacity),setBlending(material.blending),_v1x=v1.positionScreen.x,_v1y=v1.positionScreen.y,_v2x=v2.positionScreen.x,_v2y=v2.positionScreen.y,_v3x=v3.positionScreen.x,_v3y=v3.positionScreen.y,drawTriangle(_v1x,_v1y,_v2x,_v2y,_v3x,_v3y),(material instanceof THREE.MeshLambertMaterial||material instanceof THREE.MeshPhongMaterial)&&null===material.map?(_diffuseColor.copy(material.color),_emissiveColor.copy(material.emissive),material.vertexColors===THREE.FaceColors&&_diffuseColor.multiply(element.color),_color.copy(_ambientLight),_centroid.copy(v1.positionWorld).add(v2.positionWorld).add(v3.positionWorld).divideScalar(3),calculateLight(_centroid,element.normalModel,_color),_color.multiply(_diffuseColor).add(_emissiveColor),material.wireframe===!0?strokePath(_color,material.wireframeLinewidth,material.wireframeLinecap,material.wireframeLinejoin):fillPath(_color)):material instanceof THREE.MeshBasicMaterial||material instanceof THREE.MeshLambertMaterial||material instanceof THREE.MeshPhongMaterial?null!==material.map?material.map.mapping instanceof THREE.UVMapping&&(_uvs=element.uvs,patternPath(_v1x,_v1y,_v2x,_v2y,_v3x,_v3y,_uvs[uv1].x,_uvs[uv1].y,_uvs[uv2].x,_uvs[uv2].y,_uvs[uv3].x,_uvs[uv3].y,material.map)):null!==material.envMap?material.envMap.mapping instanceof THREE.SphericalReflectionMapping?(_normal.copy(element.vertexNormalsModel[uv1]).applyMatrix3(_normalViewMatrix),_uv1x=.5*_normal.x+.5,_uv1y=.5*_normal.y+.5,_normal.copy(element.vertexNormalsModel[uv2]).applyMatrix3(_normalViewMatrix),_uv2x=.5*_normal.x+.5,_uv2y=.5*_normal.y+.5,_normal.copy(element.vertexNormalsModel[uv3]).applyMatrix3(_normalViewMatrix),_uv3x=.5*_normal.x+.5,_uv3y=.5*_normal.y+.5,patternPath(_v1x,_v1y,_v2x,_v2y,_v3x,_v3y,_uv1x,_uv1y,_uv2x,_uv2y,_uv3x,_uv3y,material.envMap)):material.envMap.mapping instanceof THREE.SphericalRefractionMapping&&(_normal.copy(element.vertexNormalsModel[uv1]).applyMatrix3(_normalViewMatrix),_uv1x=-.5*_normal.x+.5,_uv1y=-.5*_normal.y+.5,_normal.copy(element.vertexNormalsModel[uv2]).applyMatrix3(_normalViewMatrix),_uv2x=-.5*_normal.x+.5,_uv2y=-.5*_normal.y+.5,_normal.copy(element.vertexNormalsModel[uv3]).applyMatrix3(_normalViewMatrix),_uv3x=-.5*_normal.x+.5,_uv3y=-.5*_normal.y+.5,patternPath(_v1x,_v1y,_v2x,_v2y,_v3x,_v3y,_uv1x,_uv1y,_uv2x,_uv2y,_uv3x,_uv3y,material.envMap)):(_color.copy(material.color),material.vertexColors===THREE.FaceColors&&_color.multiply(element.color),material.wireframe===!0?strokePath(_color,material.wireframeLinewidth,material.wireframeLinecap,material.wireframeLinejoin):fillPath(_color)):material instanceof THREE.MeshDepthMaterial?(_color.r=_color.g=_color.b=1-smoothstep(v1.positionScreen.z*v1.positionScreen.w,_camera.near,_camera.far),material.wireframe===!0?strokePath(_color,material.wireframeLinewidth,material.wireframeLinecap,material.wireframeLinejoin):fillPath(_color)):material instanceof THREE.MeshNormalMaterial?(_normal.copy(element.normalModel).applyMatrix3(_normalViewMatrix),_color.setRGB(_normal.x,_normal.y,_normal.z).multiplyScalar(.5).addScalar(.5),material.wireframe===!0?strokePath(_color,material.wireframeLinewidth,material.wireframeLinecap,material.wireframeLinejoin):fillPath(_color)):(_color.setRGB(1,1,1),material.wireframe===!0?strokePath(_color,material.wireframeLinewidth,material.wireframeLinecap,material.wireframeLinejoin):fillPath(_color))}function drawTriangle(x0,y0,x1,y1,x2,y2){_context.beginPath(),_context.moveTo(x0,y0),_context.lineTo(x1,y1),_context.lineTo(x2,y2),_context.closePath()}function strokePath(color,linewidth,linecap,linejoin){setLineWidth(linewidth),setLineCap(linecap),setLineJoin(linejoin),setStrokeStyle(color.getStyle()),_context.stroke(),_elemBox.expandByScalar(2*linewidth)}function fillPath(color){setFillStyle(color.getStyle()),_context.fill()}function onTextureUpdate(event){textureToPattern(event.target)}function textureToPattern(texture){if(!(texture instanceof THREE.CompressedTexture)){var repeatX=texture.wrapS===THREE.RepeatWrapping,repeatY=texture.wrapT===THREE.RepeatWrapping,image=texture.image,canvas=document.createElement("canvas");canvas.width=image.width,canvas.height=image.height;var context=canvas.getContext("2d");context.setTransform(1,0,0,-1,0,image.height),context.drawImage(image,0,0),_patterns[texture.id]=_context.createPattern(canvas,repeatX===!0&&repeatY===!0?"repeat":repeatX===!0&&repeatY===!1?"repeat-x":repeatX===!1&&repeatY===!0?"repeat-y":"no-repeat")}}function patternPath(x0,y0,x1,y1,x2,y2,u0,v0,u1,v1,u2,v2,texture){if(!(texture instanceof THREE.DataTexture)){texture.hasEventListener("update",onTextureUpdate)===!1&&(void 0!==texture.image&&texture.image.width>0&&textureToPattern(texture),texture.addEventListener("update",onTextureUpdate));var pattern=_patterns[texture.id];if(void 0===pattern)return setFillStyle("rgba(0,0,0,1)"),void _context.fill();setFillStyle(pattern);var a,b,c,d,e,f,det,idet,offsetX=texture.offset.x/texture.repeat.x,offsetY=texture.offset.y/texture.repeat.y,width=texture.image.width*texture.repeat.x,height=texture.image.height*texture.repeat.y;u0=(u0+offsetX)*width,v0=(v0+offsetY)*height,u1=(u1+offsetX)*width,v1=(v1+offsetY)*height,u2=(u2+offsetX)*width,v2=(v2+offsetY)*height,x1-=x0,y1-=y0,x2-=x0,y2-=y0,u1-=u0,v1-=v0,u2-=u0,v2-=v0,det=u1*v2-u2*v1,0!==det&&(idet=1/det,a=(v2*x1-v1*x2)*idet,b=(v2*y1-v1*y2)*idet,c=(u1*x2-u2*x1)*idet,d=(u1*y2-u2*y1)*idet,e=x0-a*u0-c*v0,f=y0-b*u0-d*v0,_context.save(),_context.transform(a,b,c,d,e,f),_context.fill(),_context.restore())}}function expand(v1,v2,pixels){var idet,x=v2.x-v1.x,y=v2.y-v1.y,det=x*x+y*y;0!==det&&(idet=pixels/Math.sqrt(det),x*=idet,y*=idet,v2.x+=x,v2.y+=y,v1.x-=x,v1.y-=y)}function setOpacity(value){_contextGlobalAlpha!==value&&(_context.globalAlpha=value,_contextGlobalAlpha=value)}function setBlending(value){_contextGlobalCompositeOperation!==value&&(value===THREE.NormalBlending?_context.globalCompositeOperation="source-over":value===THREE.AdditiveBlending?_context.globalCompositeOperation="lighter":value===THREE.SubtractiveBlending&&(_context.globalCompositeOperation="darker"),_contextGlobalCompositeOperation=value)}function setLineWidth(value){_contextLineWidth!==value&&(_context.lineWidth=value,_contextLineWidth=value)}function setLineCap(value){_contextLineCap!==value&&(_context.lineCap=value,_contextLineCap=value)
}function setLineJoin(value){_contextLineJoin!==value&&(_context.lineJoin=value,_contextLineJoin=value)}function setStrokeStyle(value){_contextStrokeStyle!==value&&(_context.strokeStyle=value,_contextStrokeStyle=value)}function setFillStyle(value){_contextFillStyle!==value&&(_context.fillStyle=value,_contextFillStyle=value)}function setLineDash(value){_contextLineDash.length!==value.length&&(_context.setLineDash(value),_contextLineDash=value)}console.log("THREE.CanvasRenderer",THREE.REVISION);var smoothstep=THREE.Math.smoothstep;parameters=parameters||{};var _renderData,_elements,_lights,_camera,_v1,_v2,_v3,_v1x,_v1y,_v2x,_v2y,_v3x,_v3y,_uvs,_uv1x,_uv1y,_uv2x,_uv2y,_uv3x,_uv3y,_this=this,_projector=new THREE.Projector,_canvas=void 0!==parameters.canvas?parameters.canvas:document.createElement("canvas"),_canvasWidth=_canvas.width,_canvasHeight=_canvas.height,_canvasWidthHalf=Math.floor(_canvasWidth/2),_canvasHeightHalf=Math.floor(_canvasHeight/2),_viewportX=0,_viewportY=0,_viewportWidth=_canvasWidth,_viewportHeight=_canvasHeight,_context=_canvas.getContext("2d",{alpha:parameters.alpha===!0}),_clearColor=new THREE.Color(0),_clearAlpha=0,_contextGlobalAlpha=1,_contextGlobalCompositeOperation=0,_contextStrokeStyle=null,_contextFillStyle=null,_contextLineWidth=null,_contextLineCap=null,_contextLineJoin=null,_contextLineDash=[],_color=(new THREE.RenderableVertex,new THREE.RenderableVertex,new THREE.Color),_diffuseColor=(new THREE.Color,new THREE.Color,new THREE.Color,new THREE.Color,new THREE.Color),_emissiveColor=new THREE.Color,_lightColor=new THREE.Color,_patterns={},_clipBox=new THREE.Box2,_clearBox=new THREE.Box2,_elemBox=new THREE.Box2,_ambientLight=new THREE.Color,_directionalLights=new THREE.Color,_pointLights=new THREE.Color,_vector3=new THREE.Vector3,_centroid=new THREE.Vector3,_normal=new THREE.Vector3,_normalViewMatrix=new THREE.Matrix3;void 0===_context.setLineDash&&(_context.setLineDash=function(){}),this.domElement=_canvas,this.devicePixelRatio=void 0!==parameters.devicePixelRatio?parameters.devicePixelRatio:void 0!==self.devicePixelRatio?self.devicePixelRatio:1,this.autoClear=!0,this.sortObjects=!0,this.sortElements=!0,this.info={render:{vertices:0,faces:0}},this.supportsVertexTextures=function(){},this.setFaceCulling=function(){},this.setSize=function(width,height,updateStyle){_canvasWidth=width*this.devicePixelRatio,_canvasHeight=height*this.devicePixelRatio,_canvas.width=_canvasWidth,_canvas.height=_canvasHeight,_canvasWidthHalf=Math.floor(_canvasWidth/2),_canvasHeightHalf=Math.floor(_canvasHeight/2),updateStyle!==!1&&(_canvas.style.width=width+"px",_canvas.style.height=height+"px"),_clipBox.min.set(-_canvasWidthHalf,-_canvasHeightHalf),_clipBox.max.set(_canvasWidthHalf,_canvasHeightHalf),_clearBox.min.set(-_canvasWidthHalf,-_canvasHeightHalf),_clearBox.max.set(_canvasWidthHalf,_canvasHeightHalf),_contextGlobalAlpha=1,_contextGlobalCompositeOperation=0,_contextStrokeStyle=null,_contextFillStyle=null,_contextLineWidth=null,_contextLineCap=null,_contextLineJoin=null,this.setViewport(0,0,width,height)},this.setViewport=function(x,y,width,height){_viewportX=x*this.devicePixelRatio,_viewportY=y*this.devicePixelRatio,_viewportWidth=width*this.devicePixelRatio,_viewportHeight=height*this.devicePixelRatio},this.setScissor=function(){},this.enableScissorTest=function(){},this.setClearColor=function(color,alpha){_clearColor.set(color),_clearAlpha=void 0!==alpha?alpha:1,_clearBox.min.set(-_canvasWidthHalf,-_canvasHeightHalf),_clearBox.max.set(_canvasWidthHalf,_canvasHeightHalf)},this.setClearColorHex=function(hex,alpha){console.warn("THREE.CanvasRenderer: .setClearColorHex() is being removed. Use .setClearColor() instead."),this.setClearColor(hex,alpha)},this.getClearColor=function(){return _clearColor},this.getClearAlpha=function(){return _clearAlpha},this.getMaxAnisotropy=function(){return 0},this.clear=function(){_clearBox.empty()===!1&&(_clearBox.intersect(_clipBox),_clearBox.expandByScalar(2),_clearBox.min.x=_clearBox.min.x+_canvasWidthHalf,_clearBox.min.y=-_clearBox.min.y+_canvasHeightHalf,_clearBox.max.x=_clearBox.max.x+_canvasWidthHalf,_clearBox.max.y=-_clearBox.max.y+_canvasHeightHalf,1>_clearAlpha&&_context.clearRect(0|_clearBox.min.x,0|_clearBox.min.y,_clearBox.max.x-_clearBox.min.x|0,_clearBox.max.y-_clearBox.min.y|0),_clearAlpha>0&&(setBlending(THREE.NormalBlending),setOpacity(1),setFillStyle("rgba("+Math.floor(255*_clearColor.r)+","+Math.floor(255*_clearColor.g)+","+Math.floor(255*_clearColor.b)+","+_clearAlpha+")"),_context.fillRect(0|_clearBox.min.x,0|_clearBox.min.y,_clearBox.max.x-_clearBox.min.x|0,_clearBox.max.y-_clearBox.min.y|0)),_clearBox.makeEmpty())},this.clearColor=function(){},this.clearDepth=function(){},this.clearStencil=function(){},this.render=function(scene,camera){if(camera instanceof THREE.Camera==!1)return void console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.");this.autoClear===!0&&this.clear(),_this.info.render.vertices=0,_this.info.render.faces=0,_context.setTransform(_viewportWidth/_canvasWidth,0,0,-_viewportHeight/_canvasHeight,_viewportX,_canvasHeight-_viewportY),_context.translate(_canvasWidthHalf,_canvasHeightHalf),_renderData=_projector.projectScene(scene,camera,this.sortObjects,this.sortElements),_elements=_renderData.elements,_lights=_renderData.lights,_camera=camera,_normalViewMatrix.getNormalMatrix(camera.matrixWorldInverse),calculateLights();for(var e=0,el=_elements.length;el>e;e++){var element=_elements[e],material=element.material;if(void 0!==material&&0!==material.opacity){if(_elemBox.makeEmpty(),element instanceof THREE.RenderableSprite)_v1=element,_v1.x*=_canvasWidthHalf,_v1.y*=_canvasHeightHalf,renderSprite(_v1,element,material);else if(element instanceof THREE.RenderableLine)_v1=element.v1,_v2=element.v2,_v1.positionScreen.x*=_canvasWidthHalf,_v1.positionScreen.y*=_canvasHeightHalf,_v2.positionScreen.x*=_canvasWidthHalf,_v2.positionScreen.y*=_canvasHeightHalf,_elemBox.setFromPoints([_v1.positionScreen,_v2.positionScreen]),_clipBox.isIntersectionBox(_elemBox)===!0&&renderLine(_v1,_v2,element,material);else if(element instanceof THREE.RenderableFace){if(_v1=element.v1,_v2=element.v2,_v3=element.v3,_v1.positionScreen.z<-1||_v1.positionScreen.z>1)continue;if(_v2.positionScreen.z<-1||_v2.positionScreen.z>1)continue;if(_v3.positionScreen.z<-1||_v3.positionScreen.z>1)continue;_v1.positionScreen.x*=_canvasWidthHalf,_v1.positionScreen.y*=_canvasHeightHalf,_v2.positionScreen.x*=_canvasWidthHalf,_v2.positionScreen.y*=_canvasHeightHalf,_v3.positionScreen.x*=_canvasWidthHalf,_v3.positionScreen.y*=_canvasHeightHalf,material.overdraw>0&&(expand(_v1.positionScreen,_v2.positionScreen,material.overdraw),expand(_v2.positionScreen,_v3.positionScreen,material.overdraw),expand(_v3.positionScreen,_v1.positionScreen,material.overdraw)),_elemBox.setFromPoints([_v1.positionScreen,_v2.positionScreen,_v3.positionScreen]),_clipBox.isIntersectionBox(_elemBox)===!0&&renderFace3(_v1,_v2,_v3,0,1,2,element,material)}_clearBox.union(_elemBox)}}_context.setTransform(1,0,0,1,0,0)}},THREE.ShaderChunk={},THREE.ShaderChunk.alphatest_fragment="#ifdef ALPHATEST\n\n	if ( gl_FragColor.a < ALPHATEST ) discard;\n\n#endif\n",THREE.ShaderChunk.lights_lambert_vertex="vLightFront = vec3( 0.0 );\n\n#ifdef DOUBLE_SIDED\n\n	vLightBack = vec3( 0.0 );\n\n#endif\n\ntransformedNormal = normalize( transformedNormal );\n\n#if MAX_DIR_LIGHTS > 0\n\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n	vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\n	vec3 dirVector = normalize( lDirection.xyz );\n\n	float dotProduct = dot( transformedNormal, dirVector );\n	vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n	#ifdef DOUBLE_SIDED\n\n		vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n		#ifdef WRAP_AROUND\n\n			vec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n		#endif\n\n	#endif\n\n	#ifdef WRAP_AROUND\n\n		vec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n		directionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\n\n		#ifdef DOUBLE_SIDED\n\n			directionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\n\n		#endif\n\n	#endif\n\n	vLightFront += directionalLightColor[ i ] * directionalLightWeighting;\n\n	#ifdef DOUBLE_SIDED\n\n		vLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\n\n	#endif\n\n}\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n		vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n		vec3 lVector = lPosition.xyz - mvPosition.xyz;\n\n		float lDistance = 1.0;\n		if ( pointLightDistance[ i ] > 0.0 )\n			lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\n\n		lVector = normalize( lVector );\n		float dotProduct = dot( transformedNormal, lVector );\n\n		vec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n		#ifdef DOUBLE_SIDED\n\n			vec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n			#ifdef WRAP_AROUND\n\n				vec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n			#endif\n\n		#endif\n\n		#ifdef WRAP_AROUND\n\n			vec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n			pointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\n\n			#ifdef DOUBLE_SIDED\n\n				pointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\n\n			#endif\n\n		#endif\n\n		vLightFront += pointLightColor[ i ] * pointLightWeighting * lDistance;\n\n		#ifdef DOUBLE_SIDED\n\n			vLightBack += pointLightColor[ i ] * pointLightWeightingBack * lDistance;\n\n		#endif\n\n	}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n		vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n		vec3 lVector = lPosition.xyz - mvPosition.xyz;\n\n		float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );\n\n		if ( spotEffect > spotLightAngleCos[ i ] ) {\n\n			spotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\n			float lDistance = 1.0;\n			if ( spotLightDistance[ i ] > 0.0 )\n				lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\n\n			lVector = normalize( lVector );\n\n			float dotProduct = dot( transformedNormal, lVector );\n			vec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n			#ifdef DOUBLE_SIDED\n\n				vec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n				#ifdef WRAP_AROUND\n\n					vec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n				#endif\n\n			#endif\n\n			#ifdef WRAP_AROUND\n\n				vec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n				spotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\n\n				#ifdef DOUBLE_SIDED\n\n					spotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\n\n				#endif\n\n			#endif\n\n			vLightFront += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;\n\n			#ifdef DOUBLE_SIDED\n\n				vLightBack += spotLightColor[ i ] * spotLightWeightingBack * lDistance * spotEffect;\n\n			#endif\n\n		}\n\n	}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n		vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\n		vec3 lVector = normalize( lDirection.xyz );\n\n		float dotProduct = dot( transformedNormal, lVector );\n\n		float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n		float hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;\n\n		vLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n		#ifdef DOUBLE_SIDED\n\n			vLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\n\n		#endif\n\n	}\n\n#endif\n\nvLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;\n\n#ifdef DOUBLE_SIDED\n\n	vLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;\n\n#endif",THREE.ShaderChunk.map_particle_pars_fragment="#ifdef USE_MAP\n\n	uniform sampler2D map;\n\n#endif",THREE.ShaderChunk.default_vertex="vec4 mvPosition;\n\n#ifdef USE_SKINNING\n\n	mvPosition = modelViewMatrix * skinned;\n\n#endif\n\n#if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )\n\n	mvPosition = modelViewMatrix * vec4( morphed, 1.0 );\n\n#endif\n\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHTARGETS )\n\n	mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\n#endif\n\ngl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.map_pars_fragment="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n	varying vec2 vUv;\n\n#endif\n\n#ifdef USE_MAP\n\n	uniform sampler2D map;\n\n#endif",THREE.ShaderChunk.skinnormal_vertex="#ifdef USE_SKINNING\n\n	mat4 skinMatrix = mat4( 0.0 );\n	skinMatrix += skinWeight.x * boneMatX;\n	skinMatrix += skinWeight.y * boneMatY;\n	skinMatrix += skinWeight.z * boneMatZ;\n	skinMatrix += skinWeight.w * boneMatW;\n	skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\n	#ifdef USE_MORPHNORMALS\n\n	vec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\n\n	#else\n\n	vec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\n\n	#endif\n\n#endif\n",THREE.ShaderChunk.logdepthbuf_pars_vertex="#ifdef USE_LOGDEPTHBUF\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		varying float vFragDepth;\n\n	#endif\n\n	uniform float logDepthBufFC;\n\n#endif",THREE.ShaderChunk.lightmap_pars_vertex="#ifdef USE_LIGHTMAP\n\n	varying vec2 vUv2;\n\n#endif",THREE.ShaderChunk.lights_phong_fragment="vec3 normal = normalize( vNormal );\nvec3 viewPosition = normalize( vViewPosition );\n\n#ifdef DOUBLE_SIDED\n\n	normal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\n#endif\n\n#ifdef USE_NORMALMAP\n\n	normal = perturbNormal2Arb( -vViewPosition, normal );\n\n#elif defined( USE_BUMPMAP )\n\n	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	vec3 pointDiffuse = vec3( 0.0 );\n	vec3 pointSpecular = vec3( 0.0 );\n\n	for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n		vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n		vec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n		float lDistance = 1.0;\n		if ( pointLightDistance[ i ] > 0.0 )\n			lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\n\n		lVector = normalize( lVector );\n\n				// diffuse\n\n		float dotProduct = dot( normal, lVector );\n\n		#ifdef WRAP_AROUND\n\n			float pointDiffuseWeightFull = max( dotProduct, 0.0 );\n			float pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n			vec3 pointDiffuseWeight = mix( vec3( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n\n		#else\n\n			float pointDiffuseWeight = max( dotProduct, 0.0 );\n\n		#endif\n\n		pointDiffuse += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;\n\n				// specular\n\n		vec3 pointHalfVector = normalize( lVector + viewPosition );\n		float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\n		float pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\n\n		float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n		vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, pointHalfVector ), 0.0 ), 5.0 );\n		pointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;\n\n	}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	vec3 spotDiffuse = vec3( 0.0 );\n	vec3 spotSpecular = vec3( 0.0 );\n\n	for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n		vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n		vec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n		float lDistance = 1.0;\n		if ( spotLightDistance[ i ] > 0.0 )\n			lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\n\n		lVector = normalize( lVector );\n\n		float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\n\n		if ( spotEffect > spotLightAngleCos[ i ] ) {\n\n			spotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\n					// diffuse\n\n			float dotProduct = dot( normal, lVector );\n\n			#ifdef WRAP_AROUND\n\n				float spotDiffuseWeightFull = max( dotProduct, 0.0 );\n				float spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n				vec3 spotDiffuseWeight = mix( vec3( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n\n			#else\n\n				float spotDiffuseWeight = max( dotProduct, 0.0 );\n\n			#endif\n\n			spotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;\n\n					// specular\n\n			vec3 spotHalfVector = normalize( lVector + viewPosition );\n			float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\n			float spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\n\n			float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n			vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, spotHalfVector ), 0.0 ), 5.0 );\n			spotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\n\n		}\n\n	}\n\n#endif\n\n#if MAX_DIR_LIGHTS > 0\n\n	vec3 dirDiffuse = vec3( 0.0 );\n	vec3 dirSpecular = vec3( 0.0 );\n\n	for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n		vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\n		vec3 dirVector = normalize( lDirection.xyz );\n\n				// diffuse\n\n		float dotProduct = dot( normal, dirVector );\n\n		#ifdef WRAP_AROUND\n\n			float dirDiffuseWeightFull = max( dotProduct, 0.0 );\n			float dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n			vec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n\n		#else\n\n			float dirDiffuseWeight = max( dotProduct, 0.0 );\n\n		#endif\n\n		dirDiffuse += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;\n\n		// specular\n\n		vec3 dirHalfVector = normalize( dirVector + viewPosition );\n		float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\n		float dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\n\n		/*\n		// fresnel term from skin shader\n		const float F0 = 0.128;\n\n		float base = 1.0 - dot( viewPosition, dirHalfVector );\n		float exponential = pow( base, 5.0 );\n\n		float fresnel = exponential + F0 * ( 1.0 - exponential );\n		*/\n\n		/*\n		// fresnel term from fresnel shader\n		const float mFresnelBias = 0.08;\n		const float mFresnelScale = 0.3;\n		const float mFresnelPower = 5.0;\n\n		float fresnel = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( -viewPosition ), normal ), mFresnelPower );\n		*/\n\n		float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n		// 		dirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization * fresnel;\n\n		vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( dirVector, dirHalfVector ), 0.0 ), 5.0 );\n		dirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n\n\n	}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	vec3 hemiDiffuse = vec3( 0.0 );\n	vec3 hemiSpecular = vec3( 0.0 );\n\n	for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n		vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\n		vec3 lVector = normalize( lDirection.xyz );\n\n		// diffuse\n\n		float dotProduct = dot( normal, lVector );\n		float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\n		vec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n		hemiDiffuse += diffuse * hemiColor;\n\n		// specular (sky light)\n\n		vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\n		float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\n		float hemiSpecularWeightSky = specularStrength * max( pow( max( hemiDotNormalHalfSky, 0.0 ), shininess ), 0.0 );\n\n		// specular (ground light)\n\n		vec3 lVectorGround = -lVector;\n\n		vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\n		float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\n		float hemiSpecularWeightGround = specularStrength * max( pow( max( hemiDotNormalHalfGround, 0.0 ), shininess ), 0.0 );\n\n		float dotProductGround = dot( normal, lVectorGround );\n\n		float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n		vec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, hemiHalfVectorSky ), 0.0 ), 5.0 );\n		vec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 0.0 ), 5.0 );\n		hemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n\n	}\n\n#endif\n\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n\n#if MAX_DIR_LIGHTS > 0\n\n	totalDiffuse += dirDiffuse;\n	totalSpecular += dirSpecular;\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	totalDiffuse += hemiDiffuse;\n	totalSpecular += hemiSpecular;\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	totalDiffuse += pointDiffuse;\n	totalSpecular += pointSpecular;\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	totalDiffuse += spotDiffuse;\n	totalSpecular += spotSpecular;\n\n#endif\n\n#ifdef METAL\n\n	gl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );\n\n#else\n\n	gl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n\n#endif",THREE.ShaderChunk.fog_pars_fragment="#ifdef USE_FOG\n\n	uniform vec3 fogColor;\n\n	#ifdef FOG_EXP2\n\n		uniform float fogDensity;\n\n	#else\n\n		uniform float fogNear;\n		uniform float fogFar;\n	#endif\n\n#endif",THREE.ShaderChunk.morphnormal_vertex="#ifdef USE_MORPHNORMALS\n\n	vec3 morphedNormal = vec3( 0.0 );\n\n	morphedNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n	morphedNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n	morphedNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n	morphedNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n\n	morphedNormal += normal;\n\n#endif",THREE.ShaderChunk.envmap_pars_fragment="#ifdef USE_ENVMAP\n\n	uniform float reflectivity;\n	uniform samplerCube envMap;\n	uniform float flipEnvMap;\n	uniform int combine;\n\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\n		uniform bool useRefract;\n		uniform float refractionRatio;\n\n	#else\n\n		varying vec3 vReflect;\n\n	#endif\n\n#endif",THREE.ShaderChunk.logdepthbuf_fragment="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\n	gl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n\n#endif",THREE.ShaderChunk.normalmap_pars_fragment="#ifdef USE_NORMALMAP\n\n	uniform sampler2D normalMap;\n	uniform vec2 normalScale;\n\n			// Per-Pixel Tangent Space Normal Mapping\n			// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\n\n	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\n		vec3 q0 = dFdx( eye_pos.xyz );\n		vec3 q1 = dFdy( eye_pos.xyz );\n		vec2 st0 = dFdx( vUv.st );\n		vec2 st1 = dFdy( vUv.st );\n\n		vec3 S = normalize( q0 * st1.t - q1 * st0.t );\n		vec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n		vec3 N = normalize( surf_norm );\n\n		vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n		mapN.xy = normalScale * mapN.xy;\n		mat3 tsn = mat3( S, T, N );\n		return normalize( tsn * mapN );\n\n	}\n\n#endif\n",THREE.ShaderChunk.lights_phong_pars_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n	varying vec3 vWorldPosition;\n\n#endif\n",THREE.ShaderChunk.lightmap_pars_fragment="#ifdef USE_LIGHTMAP\n\n	varying vec2 vUv2;\n	uniform sampler2D lightMap;\n\n#endif",THREE.ShaderChunk.shadowmap_vertex="#ifdef USE_SHADOWMAP\n\n	for( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n		vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n\n	}\n\n#endif",THREE.ShaderChunk.lights_phong_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n	vWorldPosition = worldPosition.xyz;\n\n#endif",THREE.ShaderChunk.map_fragment="#ifdef USE_MAP\n\n	vec4 texelColor = texture2D( map, vUv );\n\n	#ifdef GAMMA_INPUT\n\n		texelColor.xyz *= texelColor.xyz;\n\n	#endif\n\n	gl_FragColor = gl_FragColor * texelColor;\n\n#endif",THREE.ShaderChunk.lightmap_vertex="#ifdef USE_LIGHTMAP\n\n	vUv2 = uv2;\n\n#endif",THREE.ShaderChunk.map_particle_fragment="#ifdef USE_MAP\n\n	gl_FragColor = gl_FragColor * texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) );\n\n#endif",THREE.ShaderChunk.color_pars_fragment="#ifdef USE_COLOR\n\n	varying vec3 vColor;\n\n#endif\n",THREE.ShaderChunk.color_vertex="#ifdef USE_COLOR\n\n	#ifdef GAMMA_INPUT\n\n		vColor = color * color;\n\n	#else\n\n		vColor = color;\n\n	#endif\n\n#endif",THREE.ShaderChunk.skinning_vertex="#ifdef USE_SKINNING\n\n	#ifdef USE_MORPHTARGETS\n\n	vec4 skinVertex = bindMatrix * vec4( morphed, 1.0 );\n\n	#else\n\n	vec4 skinVertex = bindMatrix * vec4( position, 1.0 );\n\n	#endif\n\n	vec4 skinned = vec4( 0.0 );\n	skinned += boneMatX * skinVertex * skinWeight.x;\n	skinned += boneMatY * skinVertex * skinWeight.y;\n	skinned += boneMatZ * skinVertex * skinWeight.z;\n	skinned += boneMatW * skinVertex * skinWeight.w;\n	skinned  = bindMatrixInverse * skinned;\n\n#endif\n",THREE.ShaderChunk.envmap_pars_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\n\n	varying vec3 vReflect;\n\n	uniform float refractionRatio;\n	uniform bool useRefract;\n\n#endif\n",THREE.ShaderChunk.linear_to_gamma_fragment="#ifdef GAMMA_OUTPUT\n\n	gl_FragColor.xyz = sqrt( gl_FragColor.xyz );\n\n#endif",THREE.ShaderChunk.color_pars_vertex="#ifdef USE_COLOR\n\n	varying vec3 vColor;\n\n#endif",THREE.ShaderChunk.lights_lambert_pars_vertex="uniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 emissive;\n\nuniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n	uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n	uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n	uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n	uniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#ifdef WRAP_AROUND\n\n	uniform vec3 wrapRGB;\n\n#endif\n",THREE.ShaderChunk.map_pars_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n	varying vec2 vUv;\n	uniform vec4 offsetRepeat;\n\n#endif\n",THREE.ShaderChunk.envmap_fragment="#ifdef USE_ENVMAP\n\n	vec3 reflectVec;\n\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\n		vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\n		// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\n		// Transforming Normal Vectors with the Inverse Transformation\n\n		vec3 worldNormal = normalize( vec3( vec4( normal, 0.0 ) * viewMatrix ) );\n\n		if ( useRefract ) {\n\n			reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\n		} else { \n\n			reflectVec = reflect( cameraToVertex, worldNormal );\n\n		}\n\n	#else\n\n		reflectVec = vReflect;\n\n	#endif\n\n	#ifdef DOUBLE_SIDED\n\n		float flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n		vec4 cubeColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n	#else\n\n		vec4 cubeColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n	#endif\n\n	#ifdef GAMMA_INPUT\n\n		cubeColor.xyz *= cubeColor.xyz;\n\n	#endif\n\n	if ( combine == 1 ) {\n\n		gl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularStrength * reflectivity );\n\n	} else if ( combine == 2 ) {\n\n		gl_FragColor.xyz += cubeColor.xyz * specularStrength * reflectivity;\n\n	} else {\n\n		gl_FragColor.xyz = mix( gl_FragColor.xyz, gl_FragColor.xyz * cubeColor.xyz, specularStrength * reflectivity );\n\n	}\n\n#endif",THREE.ShaderChunk.specularmap_pars_fragment="#ifdef USE_SPECULARMAP\n\n	uniform sampler2D specularMap;\n\n#endif",THREE.ShaderChunk.logdepthbuf_vertex="#ifdef USE_LOGDEPTHBUF\n\n	gl_Position.z = log2(max(1e-6, gl_Position.w + 1.0)) * logDepthBufFC;\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		vFragDepth = 1.0 + gl_Position.w;\n\n#else\n\n		gl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\n	#endif\n\n#endif",THREE.ShaderChunk.morphtarget_pars_vertex="#ifdef USE_MORPHTARGETS\n\n	#ifndef USE_MORPHNORMALS\n\n	uniform float morphTargetInfluences[ 8 ];\n\n	#else\n\n	uniform float morphTargetInfluences[ 4 ];\n\n	#endif\n\n#endif",THREE.ShaderChunk.specularmap_fragment="float specularStrength;\n\n#ifdef USE_SPECULARMAP\n\n	vec4 texelSpecular = texture2D( specularMap, vUv );\n	specularStrength = texelSpecular.r;\n\n#else\n\n	specularStrength = 1.0;\n\n#endif",THREE.ShaderChunk.fog_fragment="#ifdef USE_FOG\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		float depth = gl_FragDepthEXT / gl_FragCoord.w;\n\n	#else\n\n		float depth = gl_FragCoord.z / gl_FragCoord.w;\n\n	#endif\n\n	#ifdef FOG_EXP2\n\n		const float LOG2 = 1.442695;\n		float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\n		fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n\n	#else\n\n		float fogFactor = smoothstep( fogNear, fogFar, depth );\n\n	#endif\n	\n	gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n\n#endif",THREE.ShaderChunk.bumpmap_pars_fragment="#ifdef USE_BUMPMAP\n\n	uniform sampler2D bumpMap;\n	uniform float bumpScale;\n\n			// Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen\n			//	http://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html\n\n			// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\n\n	vec2 dHdxy_fwd() {\n\n		vec2 dSTdx = dFdx( vUv );\n		vec2 dSTdy = dFdy( vUv );\n\n		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n		return vec2( dBx, dBy );\n\n	}\n\n	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\n		vec3 vSigmaX = dFdx( surf_pos );\n		vec3 vSigmaY = dFdy( surf_pos );\n		vec3 vN = surf_norm;		// normalized\n\n		vec3 R1 = cross( vSigmaY, vN );\n		vec3 R2 = cross( vN, vSigmaX );\n\n		float fDet = dot( vSigmaX, R1 );\n\n		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n		return normalize( abs( fDet ) * surf_norm - vGrad );\n\n	}\n\n#endif",THREE.ShaderChunk.defaultnormal_vertex="vec3 objectNormal;\n\n#ifdef USE_SKINNING\n\n	objectNormal = skinnedNormal.xyz;\n\n#endif\n\n#if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )\n\n	objectNormal = morphedNormal;\n\n#endif\n\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )\n\n	objectNormal = normal;\n\n#endif\n\n#ifdef FLIP_SIDED\n\n	objectNormal = -objectNormal;\n\n#endif\n\nvec3 transformedNormal = normalMatrix * objectNormal;",THREE.ShaderChunk.lights_phong_pars_fragment="uniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n	uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n	uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n	uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n	uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n	uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\n	uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n	uniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n	uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n	uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n	uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n\n	uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n	varying vec3 vWorldPosition;\n\n#endif\n\n#ifdef WRAP_AROUND\n\n	uniform vec3 wrapRGB;\n\n#endif\n\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",THREE.ShaderChunk.skinbase_vertex="#ifdef USE_SKINNING\n\n	mat4 boneMatX = getBoneMatrix( skinIndex.x );\n	mat4 boneMatY = getBoneMatrix( skinIndex.y );\n	mat4 boneMatZ = getBoneMatrix( skinIndex.z );\n	mat4 boneMatW = getBoneMatrix( skinIndex.w );\n\n#endif",THREE.ShaderChunk.map_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n	vUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n\n#endif",THREE.ShaderChunk.lightmap_fragment="#ifdef USE_LIGHTMAP\n\n	gl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );\n\n#endif",THREE.ShaderChunk.shadowmap_pars_vertex="#ifdef USE_SHADOWMAP\n\n	varying vec4 vShadowCoord[ MAX_SHADOWS ];\n	uniform mat4 shadowMatrix[ MAX_SHADOWS ];\n\n#endif",THREE.ShaderChunk.color_fragment="#ifdef USE_COLOR\n\n	gl_FragColor = gl_FragColor * vec4( vColor, 1.0 );\n\n#endif",THREE.ShaderChunk.morphtarget_vertex="#ifdef USE_MORPHTARGETS\n\n	vec3 morphed = vec3( 0.0 );\n	morphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n	morphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n	morphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n	morphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\n	#ifndef USE_MORPHNORMALS\n\n	morphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n	morphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n	morphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n	morphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\n	#endif\n\n	morphed += position;\n\n#endif",THREE.ShaderChunk.envmap_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\n\n	vec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;\n	worldNormal = normalize( worldNormal );\n\n	vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\n	if ( useRefract ) {\n\n		vReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\n	} else {\n\n		vReflect = reflect( cameraToVertex, worldNormal );\n\n	}\n\n#endif",THREE.ShaderChunk.shadowmap_fragment="#ifdef USE_SHADOWMAP\n\n	#ifdef SHADOWMAP_DEBUG\n\n		vec3 frustumColors[3];\n		frustumColors[0] = vec3( 1.0, 0.5, 0.0 );\n		frustumColors[1] = vec3( 0.0, 1.0, 0.8 );\n		frustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n\n	#endif\n\n	#ifdef SHADOWMAP_CASCADE\n\n		int inFrustumCount = 0;\n\n	#endif\n\n	float fDepth;\n	vec3 shadowColor = vec3( 1.0 );\n\n	for( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n		vec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\n\n				// if ( something && something ) breaks ATI OpenGL shader compiler\n				// if ( all( something, something ) ) using this instead\n\n		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n		bool inFrustum = all( inFrustumVec );\n\n				// don't shadow pixels outside of light frustum\n				// use just first frustum (for cascades)\n				// don't shadow pixels behind far plane of light frustum\n\n		#ifdef SHADOWMAP_CASCADE\n\n			inFrustumCount += int( inFrustum );\n			bvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n\n		#else\n\n			bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n		#endif\n\n		bool frustumTest = all( frustumTestVec );\n\n		if ( frustumTest ) {\n\n			shadowCoord.z += shadowBias[ i ];\n\n			#if defined( SHADOWMAP_TYPE_PCF )\n\n						// Percentage-close filtering\n						// (9 pixel kernel)\n						// http://fabiensanglard.net/shadowmappingPCF/\n\n				float shadow = 0.0;\n\n		/*\n						// nested loops breaks shader compiler / validator on some ATI cards when using OpenGL\n						// must enroll loop manually\n\n				for ( float y = -1.25; y <= 1.25; y += 1.25 )\n					for ( float x = -1.25; x <= 1.25; x += 1.25 ) {\n\n						vec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\n\n								// doesn't seem to produce any noticeable visual difference compared to simple texture2D lookup\n								//vec4 rgbaDepth = texture2DProj( shadowMap[ i ], vec4( vShadowCoord[ i ].w * ( vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy ), 0.05, vShadowCoord[ i ].w ) );\n\n						float fDepth = unpackDepth( rgbaDepth );\n\n						if ( fDepth < shadowCoord.z )\n							shadow += 1.0;\n\n				}\n\n				shadow /= 9.0;\n\n		*/\n\n				const float shadowDelta = 1.0 / 9.0;\n\n				float xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n				float yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n				float dx0 = -1.25 * xPixelOffset;\n				float dy0 = -1.25 * yPixelOffset;\n				float dx1 = 1.25 * xPixelOffset;\n				float dy1 = 1.25 * yPixelOffset;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n				if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n				shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n			#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n						// Percentage-close filtering\n						// (9 pixel kernel)\n						// http://fabiensanglard.net/shadowmappingPCF/\n\n				float shadow = 0.0;\n\n				float xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n				float yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n				float dx0 = -1.0 * xPixelOffset;\n				float dy0 = -1.0 * yPixelOffset;\n				float dx1 = 1.0 * xPixelOffset;\n				float dy1 = 1.0 * yPixelOffset;\n\n				mat3 shadowKernel;\n				mat3 depthKernel;\n\n				depthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n				depthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n				depthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n				depthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n				depthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n				depthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n				depthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n				depthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n				depthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n\n				vec3 shadowZ = vec3( shadowCoord.z );\n				shadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\n				shadowKernel[0] *= vec3(0.25);\n\n				shadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\n				shadowKernel[1] *= vec3(0.25);\n\n				shadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\n				shadowKernel[2] *= vec3(0.25);\n\n				vec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\n\n				shadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\n				shadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\n\n				vec4 shadowValues;\n				shadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\n				shadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\n				shadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\n				shadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\n\n				shadow = dot( shadowValues, vec4( 1.0 ) );\n\n				shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n			#else\n\n				vec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\n				float fDepth = unpackDepth( rgbaDepth );\n\n				if ( fDepth < shadowCoord.z )\n\n		// spot with multiple shadows is darker\n\n					shadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n\n		// spot with multiple shadows has the same color as single shadow spot\n\n		// 					shadowColor = min( shadowColor, vec3( shadowDarkness[ i ] ) );\n\n			#endif\n\n		}\n\n\n		#ifdef SHADOWMAP_DEBUG\n\n			#ifdef SHADOWMAP_CASCADE\n\n				if ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];\n\n			#else\n\n				if ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];\n\n			#endif\n\n		#endif\n\n	}\n\n	#ifdef GAMMA_OUTPUT\n\n		shadowColor *= shadowColor;\n\n	#endif\n\n	gl_FragColor.xyz = gl_FragColor.xyz * shadowColor;\n\n#endif\n",THREE.ShaderChunk.worldpos_vertex="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\n	#ifdef USE_SKINNING\n\n		vec4 worldPosition = modelMatrix * skinned;\n\n	#endif\n\n	#if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\n\n		vec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\n\n	#endif\n\n	#if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\n\n		vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n\n	#endif\n\n#endif",THREE.ShaderChunk.shadowmap_pars_fragment="#ifdef USE_SHADOWMAP\n\n	uniform sampler2D shadowMap[ MAX_SHADOWS ];\n	uniform vec2 shadowMapSize[ MAX_SHADOWS ];\n\n	uniform float shadowDarkness[ MAX_SHADOWS ];\n	uniform float shadowBias[ MAX_SHADOWS ];\n\n	varying vec4 vShadowCoord[ MAX_SHADOWS ];\n\n	float unpackDepth( const in vec4 rgba_depth ) {\n\n		const vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n		float depth = dot( rgba_depth, bit_shift );\n		return depth;\n\n	}\n\n#endif",THREE.ShaderChunk.skinning_pars_vertex="#ifdef USE_SKINNING\n\n	uniform mat4 bindMatrix;\n	uniform mat4 bindMatrixInverse;\n\n	#ifdef BONE_TEXTURE\n\n		uniform sampler2D boneTexture;\n		uniform int boneTextureWidth;\n		uniform int boneTextureHeight;\n\n		mat4 getBoneMatrix( const in float i ) {\n\n			float j = i * 4.0;\n			float x = mod( j, float( boneTextureWidth ) );\n			float y = floor( j / float( boneTextureWidth ) );\n\n			float dx = 1.0 / float( boneTextureWidth );\n			float dy = 1.0 / float( boneTextureHeight );\n\n			y = dy * ( y + 0.5 );\n\n			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\n			mat4 bone = mat4( v1, v2, v3, v4 );\n\n			return bone;\n\n		}\n\n	#else\n\n		uniform mat4 boneGlobalMatrices[ MAX_BONES ];\n\n		mat4 getBoneMatrix( const in float i ) {\n\n			mat4 bone = boneGlobalMatrices[ int(i) ];\n			return bone;\n\n		}\n\n	#endif\n\n#endif\n",THREE.ShaderChunk.logdepthbuf_pars_fragment="#ifdef USE_LOGDEPTHBUF\n\n	uniform float logDepthBufFC;\n\n	#ifdef USE_LOGDEPTHBUF_EXT\n\n		#extension GL_EXT_frag_depth : enable\n		varying float vFragDepth;\n\n	#endif\n\n#endif",THREE.ShaderChunk.alphamap_fragment="#ifdef USE_ALPHAMAP\n\n	gl_FragColor.a *= texture2D( alphaMap, vUv ).g;\n\n#endif\n",THREE.ShaderChunk.alphamap_pars_fragment="#ifdef USE_ALPHAMAP\n\n	uniform sampler2D alphaMap;\n\n#endif\n",THREE.UniformsUtils={merge:function(uniforms){var u,p,tmp,merged={};
for(u=0;u<uniforms.length;u++){tmp=this.clone(uniforms[u]);for(p in tmp)merged[p]=tmp[p]}return merged},clone:function(uniforms_src){var u,p,parameter_src,uniforms_dst={};for(u in uniforms_src){uniforms_dst[u]={};for(p in uniforms_src[u])parameter_src=uniforms_src[u][p],uniforms_dst[u][p]=parameter_src instanceof THREE.Color||parameter_src instanceof THREE.Vector2||parameter_src instanceof THREE.Vector3||parameter_src instanceof THREE.Vector4||parameter_src instanceof THREE.Matrix4||parameter_src instanceof THREE.Texture?parameter_src.clone():parameter_src instanceof Array?parameter_src.slice():parameter_src}return uniforms_dst}},THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},alphaMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},useRefract:{type:"i",value:0},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98},combine:{type:"i",value:0},morphTargetInfluences:{type:"f",value:0}},bump:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new THREE.Vector2(1,1)}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new THREE.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new THREE.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}},THREE.ShaderLib={basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.shadowmap]),vertexShader:[THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.skinbase_vertex,"	#ifdef USE_ENVMAP",THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"	#endif",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.alphamap_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	gl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphamap_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define LAMBERT","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","#endif",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_lambert_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_lambert_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","#endif",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.alphamap_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	gl_FragColor = vec4( vec3( 1.0 ), opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphamap_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,"	#ifdef DOUBLE_SIDED","		if ( gl_FrontFacing )","			gl_FragColor.xyz *= vLightFront;","		else","			gl_FragColor.xyz *= vLightBack;","	#else","		gl_FragColor.xyz *= vLightFront;","	#endif",THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.bump,THREE.UniformsLib.normalmap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define PHONG","varying vec3 vViewPosition;","varying vec3 vNormal;",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_phong_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"	vNormal = normalize( transformedNormal );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"	vViewPosition = -mvPosition.xyz;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_phong_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;","uniform vec3 ambient;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.alphamap_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.lights_phong_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.bumpmap_pars_fragment,THREE.ShaderChunk.normalmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	gl_FragColor = vec4( vec3( 1.0 ), opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphamap_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lights_phong_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},particle_basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.particle,THREE.UniformsLib.shadowmap]),vertexShader:["uniform float size;","uniform float scale;",THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","	#ifdef USE_SIZEATTENUATION","		gl_PointSize = size * ( scale / length( mvPosition.xyz ) );","	#else","		gl_PointSize = size;","	#endif","	gl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.logdepthbuf_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;","uniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_particle_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	gl_FragColor = vec4( psColor, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_particle_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},dashed:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;","attribute float lineDistance;","varying float vLineDistance;",THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"	vLineDistance = scale * lineDistance;","	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","	gl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;","uniform float dashSize;","uniform float totalSize;","varying float vLineDistance;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	if ( mod( vLineDistance, totalSize ) > dashSize ) {","		discard;","	}","	gl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:[THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float mNear;","uniform float mFar;","uniform float opacity;",THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {",THREE.ShaderChunk.logdepthbuf_fragment,"	#ifdef USE_LOGDEPTHBUF_EXT","		float depth = gl_FragDepthEXT / gl_FragCoord.w;","	#else","		float depth = gl_FragCoord.z / gl_FragCoord.w;","	#endif","	float color = 1.0 - smoothstep( mNear, mFar, depth );","	gl_FragColor = vec4( vec3( color ), opacity );","}"].join("\n")},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {","	vNormal = normalize( normalMatrix * normal );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;","varying vec3 vNormal;",THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	gl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},normalmap:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{enableAO:{type:"i",value:0},enableDiffuse:{type:"i",value:0},enableSpecular:{type:"i",value:0},enableReflection:{type:"i",value:0},enableDisplacement:{type:"i",value:0},tDisplacement:{type:"t",value:null},tDiffuse:{type:"t",value:null},tCube:{type:"t",value:null},tNormal:{type:"t",value:null},tSpecular:{type:"t",value:null},tAO:{type:"t",value:null},uNormalScale:{type:"v2",value:new THREE.Vector2(1,1)},uDisplacementBias:{type:"f",value:0},uDisplacementScale:{type:"f",value:1},diffuse:{type:"c",value:new THREE.Color(16777215)},specular:{type:"c",value:new THREE.Color(1118481)},ambient:{type:"c",value:new THREE.Color(16777215)},shininess:{type:"f",value:30},opacity:{type:"f",value:1},useRefract:{type:"i",value:0},refractionRatio:{type:"f",value:.98},reflectivity:{type:"f",value:.5},uOffset:{type:"v2",value:new THREE.Vector2(0,0)},uRepeat:{type:"v2",value:new THREE.Vector2(1,1)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),fragmentShader:["uniform vec3 ambient;","uniform vec3 diffuse;","uniform vec3 specular;","uniform float shininess;","uniform float opacity;","uniform bool enableDiffuse;","uniform bool enableSpecular;","uniform bool enableAO;","uniform bool enableReflection;","uniform sampler2D tDiffuse;","uniform sampler2D tNormal;","uniform sampler2D tSpecular;","uniform sampler2D tAO;","uniform samplerCube tCube;","uniform vec2 uNormalScale;","uniform bool useRefract;","uniform float refractionRatio;","uniform float reflectivity;","varying vec3 vTangent;","varying vec3 vBinormal;","varying vec3 vNormal;","varying vec2 vUv;","uniform vec3 ambientLightColor;","#if MAX_DIR_LIGHTS > 0","	uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];","	uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];","#endif","#if MAX_HEMI_LIGHTS > 0","	uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];","	uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];","	uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];","#endif","#if MAX_POINT_LIGHTS > 0","	uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];","	uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","	uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","#endif","#if MAX_SPOT_LIGHTS > 0","	uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];","	uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","	uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];","	uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];","	uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];","	uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","#endif","#ifdef WRAP_AROUND","	uniform vec3 wrapRGB;","#endif","varying vec3 vWorldPosition;","varying vec3 vViewPosition;",THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {",THREE.ShaderChunk.logdepthbuf_fragment,"	gl_FragColor = vec4( vec3( 1.0 ), opacity );","	vec3 specularTex = vec3( 1.0 );","	vec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;","	normalTex.xy *= uNormalScale;","	normalTex = normalize( normalTex );","	if( enableDiffuse ) {","		#ifdef GAMMA_INPUT","			vec4 texelColor = texture2D( tDiffuse, vUv );","			texelColor.xyz *= texelColor.xyz;","			gl_FragColor = gl_FragColor * texelColor;","		#else","			gl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );","		#endif","	}","	if( enableAO ) {","		#ifdef GAMMA_INPUT","			vec4 aoColor = texture2D( tAO, vUv );","			aoColor.xyz *= aoColor.xyz;","			gl_FragColor.xyz = gl_FragColor.xyz * aoColor.xyz;","		#else","			gl_FragColor.xyz = gl_FragColor.xyz * texture2D( tAO, vUv ).xyz;","		#endif","	}",THREE.ShaderChunk.alphatest_fragment,"	if( enableSpecular )","		specularTex = texture2D( tSpecular, vUv ).xyz;","	mat3 tsb = mat3( normalize( vTangent ), normalize( vBinormal ), normalize( vNormal ) );","	vec3 finalNormal = tsb * normalTex;","	#ifdef FLIP_SIDED","		finalNormal = -finalNormal;","	#endif","	vec3 normal = normalize( finalNormal );","	vec3 viewPosition = normalize( vViewPosition );","	#if MAX_POINT_LIGHTS > 0","		vec3 pointDiffuse = vec3( 0.0 );","		vec3 pointSpecular = vec3( 0.0 );","		for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","			vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","			vec3 pointVector = lPosition.xyz + vViewPosition.xyz;","			float pointDistance = 1.0;","			if ( pointLightDistance[ i ] > 0.0 )","				pointDistance = 1.0 - min( ( length( pointVector ) / pointLightDistance[ i ] ), 1.0 );","			pointVector = normalize( pointVector );","			#ifdef WRAP_AROUND","				float pointDiffuseWeightFull = max( dot( normal, pointVector ), 0.0 );","				float pointDiffuseWeightHalf = max( 0.5 * dot( normal, pointVector ) + 0.5, 0.0 );","				vec3 pointDiffuseWeight = mix( vec3( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );","			#else","				float pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );","			#endif","			pointDiffuse += pointDistance * pointLightColor[ i ] * diffuse * pointDiffuseWeight;","			vec3 pointHalfVector = normalize( pointVector + viewPosition );","			float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );","			float pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, shininess ), 0.0 );","			float specularNormalization = ( shininess + 2.0 ) / 8.0;","			vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( pointVector, pointHalfVector ), 0.0 ), 5.0 );","			pointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * pointDistance * specularNormalization;","		}","	#endif","	#if MAX_SPOT_LIGHTS > 0","		vec3 spotDiffuse = vec3( 0.0 );","		vec3 spotSpecular = vec3( 0.0 );","		for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","			vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","			vec3 spotVector = lPosition.xyz + vViewPosition.xyz;","			float spotDistance = 1.0;","			if ( spotLightDistance[ i ] > 0.0 )","				spotDistance = 1.0 - min( ( length( spotVector ) / spotLightDistance[ i ] ), 1.0 );","			spotVector = normalize( spotVector );","			float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );","			if ( spotEffect > spotLightAngleCos[ i ] ) {","				spotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );","				#ifdef WRAP_AROUND","					float spotDiffuseWeightFull = max( dot( normal, spotVector ), 0.0 );","					float spotDiffuseWeightHalf = max( 0.5 * dot( normal, spotVector ) + 0.5, 0.0 );","					vec3 spotDiffuseWeight = mix( vec3( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );","				#else","					float spotDiffuseWeight = max( dot( normal, spotVector ), 0.0 );","				#endif","				spotDiffuse += spotDistance * spotLightColor[ i ] * diffuse * spotDiffuseWeight * spotEffect;","				vec3 spotHalfVector = normalize( spotVector + viewPosition );","				float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );","				float spotSpecularWeight = specularTex.r * max( pow( spotDotNormalHalf, shininess ), 0.0 );","				float specularNormalization = ( shininess + 2.0 ) / 8.0;","				vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( spotVector, spotHalfVector ), 0.0 ), 5.0 );","				spotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * spotDistance * specularNormalization * spotEffect;","			}","		}","	#endif","	#if MAX_DIR_LIGHTS > 0","		vec3 dirDiffuse = vec3( 0.0 );","		vec3 dirSpecular = vec3( 0.0 );","		for( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {","			vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );","			vec3 dirVector = normalize( lDirection.xyz );","			#ifdef WRAP_AROUND","				float directionalLightWeightingFull = max( dot( normal, dirVector ), 0.0 );","				float directionalLightWeightingHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );","				vec3 dirDiffuseWeight = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );","			#else","				float dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );","			#endif","			dirDiffuse += directionalLightColor[ i ] * diffuse * dirDiffuseWeight;","			vec3 dirHalfVector = normalize( dirVector + viewPosition );","			float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );","			float dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, shininess ), 0.0 );","			float specularNormalization = ( shininess + 2.0 ) / 8.0;","			vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( dirVector, dirHalfVector ), 0.0 ), 5.0 );","			dirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;","		}","	#endif","	#if MAX_HEMI_LIGHTS > 0","		vec3 hemiDiffuse = vec3( 0.0 );","		vec3 hemiSpecular = vec3( 0.0 );","		for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {","			vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );","			vec3 lVector = normalize( lDirection.xyz );","			float dotProduct = dot( normal, lVector );","			float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","			vec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","			hemiDiffuse += diffuse * hemiColor;","			vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );","			float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;","			float hemiSpecularWeightSky = specularTex.r * max( pow( max( hemiDotNormalHalfSky, 0.0 ), shininess ), 0.0 );","			vec3 lVectorGround = -lVector;","			vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );","			float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;","			float hemiSpecularWeightGround = specularTex.r * max( pow( max( hemiDotNormalHalfGround, 0.0 ), shininess ), 0.0 );","			float dotProductGround = dot( normal, lVectorGround );","			float specularNormalization = ( shininess + 2.0 ) / 8.0;","			vec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, hemiHalfVectorSky ), 0.0 ), 5.0 );","			vec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 0.0 ), 5.0 );","			hemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );","		}","	#endif","	vec3 totalDiffuse = vec3( 0.0 );","	vec3 totalSpecular = vec3( 0.0 );","	#if MAX_DIR_LIGHTS > 0","		totalDiffuse += dirDiffuse;","		totalSpecular += dirSpecular;","	#endif","	#if MAX_HEMI_LIGHTS > 0","		totalDiffuse += hemiDiffuse;","		totalSpecular += hemiSpecular;","	#endif","	#if MAX_POINT_LIGHTS > 0","		totalDiffuse += pointDiffuse;","		totalSpecular += pointSpecular;","	#endif","	#if MAX_SPOT_LIGHTS > 0","		totalDiffuse += spotDiffuse;","		totalSpecular += spotSpecular;","	#endif","	#ifdef METAL","		gl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * ambient + totalSpecular );","	#else","		gl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * ambient ) + totalSpecular;","	#endif","	if ( enableReflection ) {","		vec3 vReflect;","		vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );","		if ( useRefract ) {","			vReflect = refract( cameraToVertex, normal, refractionRatio );","		} else {","			vReflect = reflect( cameraToVertex, normal );","		}","		vec4 cubeColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );","		#ifdef GAMMA_INPUT","			cubeColor.xyz *= cubeColor.xyz;","		#endif","		gl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularTex.r * reflectivity );","	}",THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n"),vertexShader:["attribute vec4 tangent;","uniform vec2 uOffset;","uniform vec2 uRepeat;","uniform bool enableDisplacement;","#ifdef VERTEX_TEXTURES","	uniform sampler2D tDisplacement;","	uniform float uDisplacementScale;","	uniform float uDisplacementBias;","#endif","varying vec3 vTangent;","varying vec3 vBinormal;","varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vWorldPosition;","varying vec3 vViewPosition;",THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,"	#ifdef USE_SKINNING","		vNormal = normalize( normalMatrix * skinnedNormal.xyz );","		vec4 skinnedTangent = skinMatrix * vec4( tangent.xyz, 0.0 );","		vTangent = normalize( normalMatrix * skinnedTangent.xyz );","	#else","		vNormal = normalize( normalMatrix * normal );","		vTangent = normalize( normalMatrix * tangent.xyz );","	#endif","	vBinormal = normalize( cross( vNormal, vTangent ) * tangent.w );","	vUv = uv * uRepeat + uOffset;","	vec3 displacedPosition;","	#ifdef VERTEX_TEXTURES","		if ( enableDisplacement ) {","			vec3 dv = texture2D( tDisplacement, uv ).xyz;","			float df = uDisplacementScale * dv.x + uDisplacementBias;","			displacedPosition = position + normalize( normal ) * df;","		} else {","			#ifdef USE_SKINNING","				vec4 skinVertex = bindMatrix * vec4( position, 1.0 );","				vec4 skinned = vec4( 0.0 );","				skinned += boneMatX * skinVertex * skinWeight.x;","				skinned += boneMatY * skinVertex * skinWeight.y;","				skinned += boneMatZ * skinVertex * skinWeight.z;","				skinned += boneMatW * skinVertex * skinWeight.w;","				skinned  = bindMatrixInverse * skinned;","				displacedPosition = skinned.xyz;","			#else","				displacedPosition = position;","			#endif","		}","	#else","		#ifdef USE_SKINNING","			vec4 skinVertex = bindMatrix * vec4( position, 1.0 );","			vec4 skinned = vec4( 0.0 );","			skinned += boneMatX * skinVertex * skinWeight.x;","			skinned += boneMatY * skinVertex * skinWeight.y;","			skinned += boneMatZ * skinVertex * skinWeight.z;","			skinned += boneMatW * skinVertex * skinWeight.w;","			skinned  = bindMatrixInverse * skinned;","			displacedPosition = skinned.xyz;","		#else","			displacedPosition = position;","		#endif","	#endif","	vec4 mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );","	vec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );","	gl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.logdepthbuf_vertex,"	vWorldPosition = worldPosition.xyz;","	vViewPosition = -mvPosition.xyz;","	#ifdef USE_SHADOWMAP","		for( int i = 0; i < MAX_SHADOWS; i ++ ) {","			vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;","		}","	#endif","}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {","	vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","	vWorldPosition = worldPosition.xyz;","	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform samplerCube tCube;","uniform float tFlip;","varying vec3 vWorldPosition;",THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {","	gl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );",THREE.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},depthRGBA:{uniforms:{},vertexShader:[THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:[THREE.ShaderChunk.logdepthbuf_pars_fragment,"vec4 pack_depth( const in float depth ) {","	const vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );","	const vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );","	vec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );","	res -= res.xxyz * bit_mask;","	return res;","}","void main() {",THREE.ShaderChunk.logdepthbuf_fragment,"	#ifdef USE_LOGDEPTHBUF_EXT","		gl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );","	#else","		gl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );","	#endif","}"].join("\n")}},THREE.WebGLRenderer=function(parameters){function createParticleBuffers(geometry){geometry.__webglVertexBuffer=_gl.createBuffer(),geometry.__webglColorBuffer=_gl.createBuffer(),_this.info.memory.geometries++}function createLineBuffers(geometry){geometry.__webglVertexBuffer=_gl.createBuffer(),geometry.__webglColorBuffer=_gl.createBuffer(),geometry.__webglLineDistanceBuffer=_gl.createBuffer(),_this.info.memory.geometries++}function createMeshBuffers(geometryGroup){geometryGroup.__webglVertexBuffer=_gl.createBuffer(),geometryGroup.__webglNormalBuffer=_gl.createBuffer(),geometryGroup.__webglTangentBuffer=_gl.createBuffer(),geometryGroup.__webglColorBuffer=_gl.createBuffer(),geometryGroup.__webglUVBuffer=_gl.createBuffer(),geometryGroup.__webglUV2Buffer=_gl.createBuffer(),geometryGroup.__webglSkinIndicesBuffer=_gl.createBuffer(),geometryGroup.__webglSkinWeightsBuffer=_gl.createBuffer(),geometryGroup.__webglFaceBuffer=_gl.createBuffer(),geometryGroup.__webglLineBuffer=_gl.createBuffer();var m,ml;if(geometryGroup.numMorphTargets)for(geometryGroup.__webglMorphTargetsBuffers=[],m=0,ml=geometryGroup.numMorphTargets;ml>m;m++)geometryGroup.__webglMorphTargetsBuffers.push(_gl.createBuffer());if(geometryGroup.numMorphNormals)for(geometryGroup.__webglMorphNormalsBuffers=[],m=0,ml=geometryGroup.numMorphNormals;ml>m;m++)geometryGroup.__webglMorphNormalsBuffers.push(_gl.createBuffer());_this.info.memory.geometries++}function initCustomAttributes(geometry,object){var nvertices=geometry.vertices.length,material=object.material;if(material.attributes){void 0===geometry.__webglCustomAttributesList&&(geometry.__webglCustomAttributesList=[]);for(var a in material.attributes){var attribute=material.attributes[a];if(!attribute.__webglInitialized||attribute.createUniqueBuffers){attribute.__webglInitialized=!0;var size=1;"v2"===attribute.type?size=2:"v3"===attribute.type?size=3:"v4"===attribute.type?size=4:"c"===attribute.type&&(size=3),attribute.size=size,attribute.array=new Float32Array(nvertices*size),attribute.buffer=_gl.createBuffer(),attribute.buffer.belongsToAttribute=a,attribute.needsUpdate=!0}geometry.__webglCustomAttributesList.push(attribute)}}}function initParticleBuffers(geometry,object){var nvertices=geometry.vertices.length;
geometry.__vertexArray=new Float32Array(3*nvertices),geometry.__colorArray=new Float32Array(3*nvertices),geometry.__sortArray=[],geometry.__webglParticleCount=nvertices,initCustomAttributes(geometry,object)}function initLineBuffers(geometry,object){var nvertices=geometry.vertices.length;geometry.__vertexArray=new Float32Array(3*nvertices),geometry.__colorArray=new Float32Array(3*nvertices),geometry.__lineDistanceArray=new Float32Array(1*nvertices),geometry.__webglLineCount=nvertices,initCustomAttributes(geometry,object)}function initMeshBuffers(geometryGroup,object){var geometry=object.geometry,faces3=geometryGroup.faces3,nvertices=3*faces3.length,ntris=1*faces3.length,nlines=3*faces3.length,material=getBufferMaterial(object,geometryGroup),uvType=bufferGuessUVType(material),normalType=bufferGuessNormalType(material),vertexColorType=bufferGuessVertexColorType(material);geometryGroup.__vertexArray=new Float32Array(3*nvertices),normalType&&(geometryGroup.__normalArray=new Float32Array(3*nvertices)),geometry.hasTangents&&(geometryGroup.__tangentArray=new Float32Array(4*nvertices)),vertexColorType&&(geometryGroup.__colorArray=new Float32Array(3*nvertices)),uvType&&(geometry.faceVertexUvs.length>0&&(geometryGroup.__uvArray=new Float32Array(2*nvertices)),geometry.faceVertexUvs.length>1&&(geometryGroup.__uv2Array=new Float32Array(2*nvertices))),object.geometry.skinWeights.length&&object.geometry.skinIndices.length&&(geometryGroup.__skinIndexArray=new Float32Array(4*nvertices),geometryGroup.__skinWeightArray=new Float32Array(4*nvertices));var UintArray=null!==_glExtensionElementIndexUint&&ntris>21845?Uint32Array:Uint16Array;geometryGroup.__typeArray=UintArray,geometryGroup.__faceArray=new UintArray(3*ntris),geometryGroup.__lineArray=new UintArray(2*nlines);var m,ml;if(geometryGroup.numMorphTargets)for(geometryGroup.__morphTargetsArrays=[],m=0,ml=geometryGroup.numMorphTargets;ml>m;m++)geometryGroup.__morphTargetsArrays.push(new Float32Array(3*nvertices));if(geometryGroup.numMorphNormals)for(geometryGroup.__morphNormalsArrays=[],m=0,ml=geometryGroup.numMorphNormals;ml>m;m++)geometryGroup.__morphNormalsArrays.push(new Float32Array(3*nvertices));if(geometryGroup.__webglFaceCount=3*ntris,geometryGroup.__webglLineCount=2*nlines,material.attributes){void 0===geometryGroup.__webglCustomAttributesList&&(geometryGroup.__webglCustomAttributesList=[]);for(var a in material.attributes){var originalAttribute=material.attributes[a],attribute={};for(var property in originalAttribute)attribute[property]=originalAttribute[property];if(!attribute.__webglInitialized||attribute.createUniqueBuffers){attribute.__webglInitialized=!0;var size=1;"v2"===attribute.type?size=2:"v3"===attribute.type?size=3:"v4"===attribute.type?size=4:"c"===attribute.type&&(size=3),attribute.size=size,attribute.array=new Float32Array(nvertices*size),attribute.buffer=_gl.createBuffer(),attribute.buffer.belongsToAttribute=a,originalAttribute.needsUpdate=!0,attribute.__original=originalAttribute}geometryGroup.__webglCustomAttributesList.push(attribute)}}geometryGroup.__inittedArrays=!0}function getBufferMaterial(object,geometryGroup){return object.material instanceof THREE.MeshFaceMaterial?object.material.materials[geometryGroup.materialIndex]:object.material}function materialNeedsSmoothNormals(material){return material&&void 0!==material.shading&&material.shading===THREE.SmoothShading}function bufferGuessNormalType(material){return material instanceof THREE.MeshBasicMaterial&&!material.envMap||material instanceof THREE.MeshDepthMaterial?!1:materialNeedsSmoothNormals(material)?THREE.SmoothShading:THREE.FlatShading}function bufferGuessVertexColorType(material){return material.vertexColors?material.vertexColors:!1}function bufferGuessUVType(material){return material.map||material.lightMap||material.bumpMap||material.normalMap||material.specularMap||material.alphaMap||material instanceof THREE.ShaderMaterial?!0:!1}function initDirectBuffers(geometry){for(var name in geometry.attributes){var bufferType="index"===name?_gl.ELEMENT_ARRAY_BUFFER:_gl.ARRAY_BUFFER,attribute=geometry.attributes[name];attribute.buffer=_gl.createBuffer(),_gl.bindBuffer(bufferType,attribute.buffer),_gl.bufferData(bufferType,attribute.array,_gl.STATIC_DRAW)}}function setParticleBuffers(geometry,hint,object){var v,c,vertex,offset,index,color,i,il,ca,cal,value,customAttribute,vertices=geometry.vertices,vl=vertices.length,colors=geometry.colors,cl=colors.length,vertexArray=geometry.__vertexArray,colorArray=geometry.__colorArray,sortArray=geometry.__sortArray,dirtyVertices=geometry.verticesNeedUpdate,dirtyColors=(geometry.elementsNeedUpdate,geometry.colorsNeedUpdate),customAttributes=geometry.__webglCustomAttributesList;if(object.sortParticles){for(_projScreenMatrixPS.copy(_projScreenMatrix),_projScreenMatrixPS.multiply(object.matrixWorld),v=0;vl>v;v++)vertex=vertices[v],_vector3.copy(vertex),_vector3.applyProjection(_projScreenMatrixPS),sortArray[v]=[_vector3.z,v];for(sortArray.sort(numericalSort),v=0;vl>v;v++)vertex=vertices[sortArray[v][1]],offset=3*v,vertexArray[offset]=vertex.x,vertexArray[offset+1]=vertex.y,vertexArray[offset+2]=vertex.z;for(c=0;cl>c;c++)offset=3*c,color=colors[sortArray[c][1]],colorArray[offset]=color.r,colorArray[offset+1]=color.g,colorArray[offset+2]=color.b;if(customAttributes)for(i=0,il=customAttributes.length;il>i;i++)if(customAttribute=customAttributes[i],void 0===customAttribute.boundTo||"vertices"===customAttribute.boundTo)if(offset=0,cal=customAttribute.value.length,1===customAttribute.size)for(ca=0;cal>ca;ca++)index=sortArray[ca][1],customAttribute.array[ca]=customAttribute.value[index];else if(2===customAttribute.size)for(ca=0;cal>ca;ca++)index=sortArray[ca][1],value=customAttribute.value[index],customAttribute.array[offset]=value.x,customAttribute.array[offset+1]=value.y,offset+=2;else if(3===customAttribute.size)if("c"===customAttribute.type)for(ca=0;cal>ca;ca++)index=sortArray[ca][1],value=customAttribute.value[index],customAttribute.array[offset]=value.r,customAttribute.array[offset+1]=value.g,customAttribute.array[offset+2]=value.b,offset+=3;else for(ca=0;cal>ca;ca++)index=sortArray[ca][1],value=customAttribute.value[index],customAttribute.array[offset]=value.x,customAttribute.array[offset+1]=value.y,customAttribute.array[offset+2]=value.z,offset+=3;else if(4===customAttribute.size)for(ca=0;cal>ca;ca++)index=sortArray[ca][1],value=customAttribute.value[index],customAttribute.array[offset]=value.x,customAttribute.array[offset+1]=value.y,customAttribute.array[offset+2]=value.z,customAttribute.array[offset+3]=value.w,offset+=4}else{if(dirtyVertices)for(v=0;vl>v;v++)vertex=vertices[v],offset=3*v,vertexArray[offset]=vertex.x,vertexArray[offset+1]=vertex.y,vertexArray[offset+2]=vertex.z;if(dirtyColors)for(c=0;cl>c;c++)color=colors[c],offset=3*c,colorArray[offset]=color.r,colorArray[offset+1]=color.g,colorArray[offset+2]=color.b;if(customAttributes)for(i=0,il=customAttributes.length;il>i;i++)if(customAttribute=customAttributes[i],customAttribute.needsUpdate&&(void 0===customAttribute.boundTo||"vertices"===customAttribute.boundTo))if(cal=customAttribute.value.length,offset=0,1===customAttribute.size)for(ca=0;cal>ca;ca++)customAttribute.array[ca]=customAttribute.value[ca];else if(2===customAttribute.size)for(ca=0;cal>ca;ca++)value=customAttribute.value[ca],customAttribute.array[offset]=value.x,customAttribute.array[offset+1]=value.y,offset+=2;else if(3===customAttribute.size)if("c"===customAttribute.type)for(ca=0;cal>ca;ca++)value=customAttribute.value[ca],customAttribute.array[offset]=value.r,customAttribute.array[offset+1]=value.g,customAttribute.array[offset+2]=value.b,offset+=3;else for(ca=0;cal>ca;ca++)value=customAttribute.value[ca],customAttribute.array[offset]=value.x,customAttribute.array[offset+1]=value.y,customAttribute.array[offset+2]=value.z,offset+=3;else if(4===customAttribute.size)for(ca=0;cal>ca;ca++)value=customAttribute.value[ca],customAttribute.array[offset]=value.x,customAttribute.array[offset+1]=value.y,customAttribute.array[offset+2]=value.z,customAttribute.array[offset+3]=value.w,offset+=4}if((dirtyVertices||object.sortParticles)&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometry.__webglVertexBuffer),_gl.bufferData(_gl.ARRAY_BUFFER,vertexArray,hint)),(dirtyColors||object.sortParticles)&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometry.__webglColorBuffer),_gl.bufferData(_gl.ARRAY_BUFFER,colorArray,hint)),customAttributes)for(i=0,il=customAttributes.length;il>i;i++)customAttribute=customAttributes[i],(customAttribute.needsUpdate||object.sortParticles)&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,customAttribute.buffer),_gl.bufferData(_gl.ARRAY_BUFFER,customAttribute.array,hint))}function setLineBuffers(geometry,hint){var v,c,d,vertex,offset,color,i,il,ca,cal,value,customAttribute,vertices=geometry.vertices,colors=geometry.colors,lineDistances=geometry.lineDistances,vl=vertices.length,cl=colors.length,dl=lineDistances.length,vertexArray=geometry.__vertexArray,colorArray=geometry.__colorArray,lineDistanceArray=geometry.__lineDistanceArray,dirtyVertices=geometry.verticesNeedUpdate,dirtyColors=geometry.colorsNeedUpdate,dirtyLineDistances=geometry.lineDistancesNeedUpdate,customAttributes=geometry.__webglCustomAttributesList;if(dirtyVertices){for(v=0;vl>v;v++)vertex=vertices[v],offset=3*v,vertexArray[offset]=vertex.x,vertexArray[offset+1]=vertex.y,vertexArray[offset+2]=vertex.z;_gl.bindBuffer(_gl.ARRAY_BUFFER,geometry.__webglVertexBuffer),_gl.bufferData(_gl.ARRAY_BUFFER,vertexArray,hint)}if(dirtyColors){for(c=0;cl>c;c++)color=colors[c],offset=3*c,colorArray[offset]=color.r,colorArray[offset+1]=color.g,colorArray[offset+2]=color.b;_gl.bindBuffer(_gl.ARRAY_BUFFER,geometry.__webglColorBuffer),_gl.bufferData(_gl.ARRAY_BUFFER,colorArray,hint)}if(dirtyLineDistances){for(d=0;dl>d;d++)lineDistanceArray[d]=lineDistances[d];_gl.bindBuffer(_gl.ARRAY_BUFFER,geometry.__webglLineDistanceBuffer),_gl.bufferData(_gl.ARRAY_BUFFER,lineDistanceArray,hint)}if(customAttributes)for(i=0,il=customAttributes.length;il>i;i++)if(customAttribute=customAttributes[i],customAttribute.needsUpdate&&(void 0===customAttribute.boundTo||"vertices"===customAttribute.boundTo)){if(offset=0,cal=customAttribute.value.length,1===customAttribute.size)for(ca=0;cal>ca;ca++)customAttribute.array[ca]=customAttribute.value[ca];else if(2===customAttribute.size)for(ca=0;cal>ca;ca++)value=customAttribute.value[ca],customAttribute.array[offset]=value.x,customAttribute.array[offset+1]=value.y,offset+=2;else if(3===customAttribute.size)if("c"===customAttribute.type)for(ca=0;cal>ca;ca++)value=customAttribute.value[ca],customAttribute.array[offset]=value.r,customAttribute.array[offset+1]=value.g,customAttribute.array[offset+2]=value.b,offset+=3;else for(ca=0;cal>ca;ca++)value=customAttribute.value[ca],customAttribute.array[offset]=value.x,customAttribute.array[offset+1]=value.y,customAttribute.array[offset+2]=value.z,offset+=3;else if(4===customAttribute.size)for(ca=0;cal>ca;ca++)value=customAttribute.value[ca],customAttribute.array[offset]=value.x,customAttribute.array[offset+1]=value.y,customAttribute.array[offset+2]=value.z,customAttribute.array[offset+3]=value.w,offset+=4;_gl.bindBuffer(_gl.ARRAY_BUFFER,customAttribute.buffer),_gl.bufferData(_gl.ARRAY_BUFFER,customAttribute.array,hint)}}function setMeshBuffers(geometryGroup,object,hint,dispose,material){if(geometryGroup.__inittedArrays){var f,fl,fi,face,vertexNormals,faceNormal,vertexColors,faceColor,vertexTangents,uv,uv2,v1,v2,v3,t1,t2,t3,n1,n2,n3,c1,c2,c3,sw1,sw2,sw3,si1,si2,si3,i,il,vn,uvi,uv2i,vk,vkl,vka,nka,chf,faceVertexNormals,value,customAttribute,normalType=bufferGuessNormalType(material),vertexColorType=bufferGuessVertexColorType(material),uvType=bufferGuessUVType(material),needsSmoothNormals=normalType===THREE.SmoothShading,vertexIndex=0,offset=0,offset_uv=0,offset_uv2=0,offset_face=0,offset_normal=0,offset_tangent=0,offset_line=0,offset_color=0,offset_skin=0,offset_morphTarget=0,offset_custom=0,offset_customSrc=0,vertexArray=geometryGroup.__vertexArray,uvArray=geometryGroup.__uvArray,uv2Array=geometryGroup.__uv2Array,normalArray=geometryGroup.__normalArray,tangentArray=geometryGroup.__tangentArray,colorArray=geometryGroup.__colorArray,skinIndexArray=geometryGroup.__skinIndexArray,skinWeightArray=geometryGroup.__skinWeightArray,morphTargetsArrays=geometryGroup.__morphTargetsArrays,morphNormalsArrays=geometryGroup.__morphNormalsArrays,customAttributes=geometryGroup.__webglCustomAttributesList,faceArray=geometryGroup.__faceArray,lineArray=geometryGroup.__lineArray,geometry=object.geometry,dirtyVertices=geometry.verticesNeedUpdate,dirtyElements=geometry.elementsNeedUpdate,dirtyUvs=geometry.uvsNeedUpdate,dirtyNormals=geometry.normalsNeedUpdate,dirtyTangents=geometry.tangentsNeedUpdate,dirtyColors=geometry.colorsNeedUpdate,dirtyMorphTargets=geometry.morphTargetsNeedUpdate,vertices=geometry.vertices,chunk_faces3=geometryGroup.faces3,obj_faces=geometry.faces,obj_uvs=geometry.faceVertexUvs[0],obj_uvs2=geometry.faceVertexUvs[1],obj_skinIndices=(geometry.colors,geometry.skinIndices),obj_skinWeights=geometry.skinWeights,morphTargets=geometry.morphTargets,morphNormals=geometry.morphNormals;if(dirtyVertices){for(f=0,fl=chunk_faces3.length;fl>f;f++)face=obj_faces[chunk_faces3[f]],v1=vertices[face.a],v2=vertices[face.b],v3=vertices[face.c],vertexArray[offset]=v1.x,vertexArray[offset+1]=v1.y,vertexArray[offset+2]=v1.z,vertexArray[offset+3]=v2.x,vertexArray[offset+4]=v2.y,vertexArray[offset+5]=v2.z,vertexArray[offset+6]=v3.x,vertexArray[offset+7]=v3.y,vertexArray[offset+8]=v3.z,offset+=9;_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglVertexBuffer),_gl.bufferData(_gl.ARRAY_BUFFER,vertexArray,hint)}if(dirtyMorphTargets)for(vk=0,vkl=morphTargets.length;vkl>vk;vk++){for(offset_morphTarget=0,f=0,fl=chunk_faces3.length;fl>f;f++)chf=chunk_faces3[f],face=obj_faces[chf],v1=morphTargets[vk].vertices[face.a],v2=morphTargets[vk].vertices[face.b],v3=morphTargets[vk].vertices[face.c],vka=morphTargetsArrays[vk],vka[offset_morphTarget]=v1.x,vka[offset_morphTarget+1]=v1.y,vka[offset_morphTarget+2]=v1.z,vka[offset_morphTarget+3]=v2.x,vka[offset_morphTarget+4]=v2.y,vka[offset_morphTarget+5]=v2.z,vka[offset_morphTarget+6]=v3.x,vka[offset_morphTarget+7]=v3.y,vka[offset_morphTarget+8]=v3.z,material.morphNormals&&(needsSmoothNormals?(faceVertexNormals=morphNormals[vk].vertexNormals[chf],n1=faceVertexNormals.a,n2=faceVertexNormals.b,n3=faceVertexNormals.c):(n1=morphNormals[vk].faceNormals[chf],n2=n1,n3=n1),nka=morphNormalsArrays[vk],nka[offset_morphTarget]=n1.x,nka[offset_morphTarget+1]=n1.y,nka[offset_morphTarget+2]=n1.z,nka[offset_morphTarget+3]=n2.x,nka[offset_morphTarget+4]=n2.y,nka[offset_morphTarget+5]=n2.z,nka[offset_morphTarget+6]=n3.x,nka[offset_morphTarget+7]=n3.y,nka[offset_morphTarget+8]=n3.z),offset_morphTarget+=9;_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglMorphTargetsBuffers[vk]),_gl.bufferData(_gl.ARRAY_BUFFER,morphTargetsArrays[vk],hint),material.morphNormals&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglMorphNormalsBuffers[vk]),_gl.bufferData(_gl.ARRAY_BUFFER,morphNormalsArrays[vk],hint))}if(obj_skinWeights.length){for(f=0,fl=chunk_faces3.length;fl>f;f++)face=obj_faces[chunk_faces3[f]],sw1=obj_skinWeights[face.a],sw2=obj_skinWeights[face.b],sw3=obj_skinWeights[face.c],skinWeightArray[offset_skin]=sw1.x,skinWeightArray[offset_skin+1]=sw1.y,skinWeightArray[offset_skin+2]=sw1.z,skinWeightArray[offset_skin+3]=sw1.w,skinWeightArray[offset_skin+4]=sw2.x,skinWeightArray[offset_skin+5]=sw2.y,skinWeightArray[offset_skin+6]=sw2.z,skinWeightArray[offset_skin+7]=sw2.w,skinWeightArray[offset_skin+8]=sw3.x,skinWeightArray[offset_skin+9]=sw3.y,skinWeightArray[offset_skin+10]=sw3.z,skinWeightArray[offset_skin+11]=sw3.w,si1=obj_skinIndices[face.a],si2=obj_skinIndices[face.b],si3=obj_skinIndices[face.c],skinIndexArray[offset_skin]=si1.x,skinIndexArray[offset_skin+1]=si1.y,skinIndexArray[offset_skin+2]=si1.z,skinIndexArray[offset_skin+3]=si1.w,skinIndexArray[offset_skin+4]=si2.x,skinIndexArray[offset_skin+5]=si2.y,skinIndexArray[offset_skin+6]=si2.z,skinIndexArray[offset_skin+7]=si2.w,skinIndexArray[offset_skin+8]=si3.x,skinIndexArray[offset_skin+9]=si3.y,skinIndexArray[offset_skin+10]=si3.z,skinIndexArray[offset_skin+11]=si3.w,offset_skin+=12;offset_skin>0&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglSkinIndicesBuffer),_gl.bufferData(_gl.ARRAY_BUFFER,skinIndexArray,hint),_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglSkinWeightsBuffer),_gl.bufferData(_gl.ARRAY_BUFFER,skinWeightArray,hint))}if(dirtyColors&&vertexColorType){for(f=0,fl=chunk_faces3.length;fl>f;f++)face=obj_faces[chunk_faces3[f]],vertexColors=face.vertexColors,faceColor=face.color,3===vertexColors.length&&vertexColorType===THREE.VertexColors?(c1=vertexColors[0],c2=vertexColors[1],c3=vertexColors[2]):(c1=faceColor,c2=faceColor,c3=faceColor),colorArray[offset_color]=c1.r,colorArray[offset_color+1]=c1.g,colorArray[offset_color+2]=c1.b,colorArray[offset_color+3]=c2.r,colorArray[offset_color+4]=c2.g,colorArray[offset_color+5]=c2.b,colorArray[offset_color+6]=c3.r,colorArray[offset_color+7]=c3.g,colorArray[offset_color+8]=c3.b,offset_color+=9;offset_color>0&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglColorBuffer),_gl.bufferData(_gl.ARRAY_BUFFER,colorArray,hint))}if(dirtyTangents&&geometry.hasTangents){for(f=0,fl=chunk_faces3.length;fl>f;f++)face=obj_faces[chunk_faces3[f]],vertexTangents=face.vertexTangents,t1=vertexTangents[0],t2=vertexTangents[1],t3=vertexTangents[2],tangentArray[offset_tangent]=t1.x,tangentArray[offset_tangent+1]=t1.y,tangentArray[offset_tangent+2]=t1.z,tangentArray[offset_tangent+3]=t1.w,tangentArray[offset_tangent+4]=t2.x,tangentArray[offset_tangent+5]=t2.y,tangentArray[offset_tangent+6]=t2.z,tangentArray[offset_tangent+7]=t2.w,tangentArray[offset_tangent+8]=t3.x,tangentArray[offset_tangent+9]=t3.y,tangentArray[offset_tangent+10]=t3.z,tangentArray[offset_tangent+11]=t3.w,offset_tangent+=12;_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglTangentBuffer),_gl.bufferData(_gl.ARRAY_BUFFER,tangentArray,hint)}if(dirtyNormals&&normalType){for(f=0,fl=chunk_faces3.length;fl>f;f++)if(face=obj_faces[chunk_faces3[f]],vertexNormals=face.vertexNormals,faceNormal=face.normal,3===vertexNormals.length&&needsSmoothNormals)for(i=0;3>i;i++)vn=vertexNormals[i],normalArray[offset_normal]=vn.x,normalArray[offset_normal+1]=vn.y,normalArray[offset_normal+2]=vn.z,offset_normal+=3;else for(i=0;3>i;i++)normalArray[offset_normal]=faceNormal.x,normalArray[offset_normal+1]=faceNormal.y,normalArray[offset_normal+2]=faceNormal.z,offset_normal+=3;_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglNormalBuffer),_gl.bufferData(_gl.ARRAY_BUFFER,normalArray,hint)}if(dirtyUvs&&obj_uvs&&uvType){for(f=0,fl=chunk_faces3.length;fl>f;f++)if(fi=chunk_faces3[f],uv=obj_uvs[fi],void 0!==uv)for(i=0;3>i;i++)uvi=uv[i],uvArray[offset_uv]=uvi.x,uvArray[offset_uv+1]=uvi.y,offset_uv+=2;offset_uv>0&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglUVBuffer),_gl.bufferData(_gl.ARRAY_BUFFER,uvArray,hint))}if(dirtyUvs&&obj_uvs2&&uvType){for(f=0,fl=chunk_faces3.length;fl>f;f++)if(fi=chunk_faces3[f],uv2=obj_uvs2[fi],void 0!==uv2)for(i=0;3>i;i++)uv2i=uv2[i],uv2Array[offset_uv2]=uv2i.x,uv2Array[offset_uv2+1]=uv2i.y,offset_uv2+=2;offset_uv2>0&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglUV2Buffer),_gl.bufferData(_gl.ARRAY_BUFFER,uv2Array,hint))}if(dirtyElements){for(f=0,fl=chunk_faces3.length;fl>f;f++)faceArray[offset_face]=vertexIndex,faceArray[offset_face+1]=vertexIndex+1,faceArray[offset_face+2]=vertexIndex+2,offset_face+=3,lineArray[offset_line]=vertexIndex,lineArray[offset_line+1]=vertexIndex+1,lineArray[offset_line+2]=vertexIndex,lineArray[offset_line+3]=vertexIndex+2,lineArray[offset_line+4]=vertexIndex+1,lineArray[offset_line+5]=vertexIndex+2,offset_line+=6,vertexIndex+=3;_gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER,geometryGroup.__webglFaceBuffer),_gl.bufferData(_gl.ELEMENT_ARRAY_BUFFER,faceArray,hint),_gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER,geometryGroup.__webglLineBuffer),_gl.bufferData(_gl.ELEMENT_ARRAY_BUFFER,lineArray,hint)}if(customAttributes)for(i=0,il=customAttributes.length;il>i;i++)if(customAttribute=customAttributes[i],customAttribute.__original.needsUpdate){if(offset_custom=0,offset_customSrc=0,1===customAttribute.size){if(void 0===customAttribute.boundTo||"vertices"===customAttribute.boundTo)for(f=0,fl=chunk_faces3.length;fl>f;f++)face=obj_faces[chunk_faces3[f]],customAttribute.array[offset_custom]=customAttribute.value[face.a],customAttribute.array[offset_custom+1]=customAttribute.value[face.b],customAttribute.array[offset_custom+2]=customAttribute.value[face.c],offset_custom+=3;else if("faces"===customAttribute.boundTo)for(f=0,fl=chunk_faces3.length;fl>f;f++)value=customAttribute.value[chunk_faces3[f]],customAttribute.array[offset_custom]=value,customAttribute.array[offset_custom+1]=value,customAttribute.array[offset_custom+2]=value,offset_custom+=3}else if(2===customAttribute.size){if(void 0===customAttribute.boundTo||"vertices"===customAttribute.boundTo)for(f=0,fl=chunk_faces3.length;fl>f;f++)face=obj_faces[chunk_faces3[f]],v1=customAttribute.value[face.a],v2=customAttribute.value[face.b],v3=customAttribute.value[face.c],customAttribute.array[offset_custom]=v1.x,customAttribute.array[offset_custom+1]=v1.y,customAttribute.array[offset_custom+2]=v2.x,customAttribute.array[offset_custom+3]=v2.y,customAttribute.array[offset_custom+4]=v3.x,customAttribute.array[offset_custom+5]=v3.y,offset_custom+=6;else if("faces"===customAttribute.boundTo)for(f=0,fl=chunk_faces3.length;fl>f;f++)value=customAttribute.value[chunk_faces3[f]],v1=value,v2=value,v3=value,customAttribute.array[offset_custom]=v1.x,customAttribute.array[offset_custom+1]=v1.y,customAttribute.array[offset_custom+2]=v2.x,customAttribute.array[offset_custom+3]=v2.y,customAttribute.array[offset_custom+4]=v3.x,customAttribute.array[offset_custom+5]=v3.y,offset_custom+=6}else if(3===customAttribute.size){var pp;if(pp="c"===customAttribute.type?["r","g","b"]:["x","y","z"],void 0===customAttribute.boundTo||"vertices"===customAttribute.boundTo)for(f=0,fl=chunk_faces3.length;fl>f;f++)face=obj_faces[chunk_faces3[f]],v1=customAttribute.value[face.a],v2=customAttribute.value[face.b],v3=customAttribute.value[face.c],customAttribute.array[offset_custom]=v1[pp[0]],customAttribute.array[offset_custom+1]=v1[pp[1]],customAttribute.array[offset_custom+2]=v1[pp[2]],customAttribute.array[offset_custom+3]=v2[pp[0]],customAttribute.array[offset_custom+4]=v2[pp[1]],customAttribute.array[offset_custom+5]=v2[pp[2]],customAttribute.array[offset_custom+6]=v3[pp[0]],customAttribute.array[offset_custom+7]=v3[pp[1]],customAttribute.array[offset_custom+8]=v3[pp[2]],offset_custom+=9;else if("faces"===customAttribute.boundTo)for(f=0,fl=chunk_faces3.length;fl>f;f++)value=customAttribute.value[chunk_faces3[f]],v1=value,v2=value,v3=value,customAttribute.array[offset_custom]=v1[pp[0]],customAttribute.array[offset_custom+1]=v1[pp[1]],customAttribute.array[offset_custom+2]=v1[pp[2]],customAttribute.array[offset_custom+3]=v2[pp[0]],customAttribute.array[offset_custom+4]=v2[pp[1]],customAttribute.array[offset_custom+5]=v2[pp[2]],customAttribute.array[offset_custom+6]=v3[pp[0]],customAttribute.array[offset_custom+7]=v3[pp[1]],customAttribute.array[offset_custom+8]=v3[pp[2]],offset_custom+=9;else if("faceVertices"===customAttribute.boundTo)for(f=0,fl=chunk_faces3.length;fl>f;f++)value=customAttribute.value[chunk_faces3[f]],v1=value[0],v2=value[1],v3=value[2],customAttribute.array[offset_custom]=v1[pp[0]],customAttribute.array[offset_custom+1]=v1[pp[1]],customAttribute.array[offset_custom+2]=v1[pp[2]],customAttribute.array[offset_custom+3]=v2[pp[0]],customAttribute.array[offset_custom+4]=v2[pp[1]],customAttribute.array[offset_custom+5]=v2[pp[2]],customAttribute.array[offset_custom+6]=v3[pp[0]],customAttribute.array[offset_custom+7]=v3[pp[1]],customAttribute.array[offset_custom+8]=v3[pp[2]],offset_custom+=9}else if(4===customAttribute.size)if(void 0===customAttribute.boundTo||"vertices"===customAttribute.boundTo)for(f=0,fl=chunk_faces3.length;fl>f;f++)face=obj_faces[chunk_faces3[f]],v1=customAttribute.value[face.a],v2=customAttribute.value[face.b],v3=customAttribute.value[face.c],customAttribute.array[offset_custom]=v1.x,customAttribute.array[offset_custom+1]=v1.y,customAttribute.array[offset_custom+2]=v1.z,customAttribute.array[offset_custom+3]=v1.w,customAttribute.array[offset_custom+4]=v2.x,customAttribute.array[offset_custom+5]=v2.y,customAttribute.array[offset_custom+6]=v2.z,customAttribute.array[offset_custom+7]=v2.w,customAttribute.array[offset_custom+8]=v3.x,customAttribute.array[offset_custom+9]=v3.y,customAttribute.array[offset_custom+10]=v3.z,customAttribute.array[offset_custom+11]=v3.w,offset_custom+=12;else if("faces"===customAttribute.boundTo)for(f=0,fl=chunk_faces3.length;fl>f;f++)value=customAttribute.value[chunk_faces3[f]],v1=value,v2=value,v3=value,customAttribute.array[offset_custom]=v1.x,customAttribute.array[offset_custom+1]=v1.y,customAttribute.array[offset_custom+2]=v1.z,customAttribute.array[offset_custom+3]=v1.w,customAttribute.array[offset_custom+4]=v2.x,customAttribute.array[offset_custom+5]=v2.y,customAttribute.array[offset_custom+6]=v2.z,customAttribute.array[offset_custom+7]=v2.w,customAttribute.array[offset_custom+8]=v3.x,customAttribute.array[offset_custom+9]=v3.y,customAttribute.array[offset_custom+10]=v3.z,customAttribute.array[offset_custom+11]=v3.w,offset_custom+=12;else if("faceVertices"===customAttribute.boundTo)for(f=0,fl=chunk_faces3.length;fl>f;f++)value=customAttribute.value[chunk_faces3[f]],v1=value[0],v2=value[1],v3=value[2],customAttribute.array[offset_custom]=v1.x,customAttribute.array[offset_custom+1]=v1.y,customAttribute.array[offset_custom+2]=v1.z,customAttribute.array[offset_custom+3]=v1.w,customAttribute.array[offset_custom+4]=v2.x,customAttribute.array[offset_custom+5]=v2.y,customAttribute.array[offset_custom+6]=v2.z,customAttribute.array[offset_custom+7]=v2.w,customAttribute.array[offset_custom+8]=v3.x,customAttribute.array[offset_custom+9]=v3.y,customAttribute.array[offset_custom+10]=v3.z,customAttribute.array[offset_custom+11]=v3.w,offset_custom+=12;_gl.bindBuffer(_gl.ARRAY_BUFFER,customAttribute.buffer),_gl.bufferData(_gl.ARRAY_BUFFER,customAttribute.array,hint)}dispose&&(delete geometryGroup.__inittedArrays,delete geometryGroup.__colorArray,delete geometryGroup.__normalArray,delete geometryGroup.__tangentArray,delete geometryGroup.__uvArray,delete geometryGroup.__uv2Array,delete geometryGroup.__faceArray,delete geometryGroup.__vertexArray,delete geometryGroup.__lineArray,delete geometryGroup.__skinIndexArray,delete geometryGroup.__skinWeightArray)}}function setDirectBuffers(geometry,hint){var attributeName,attributeItem,attributes=geometry.attributes;for(attributeName in attributes)attributeItem=attributes[attributeName],attributeItem.needsUpdate&&("index"===attributeName?(_gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER,attributeItem.buffer),_gl.bufferData(_gl.ELEMENT_ARRAY_BUFFER,attributeItem.array,hint)):(_gl.bindBuffer(_gl.ARRAY_BUFFER,attributeItem.buffer),_gl.bufferData(_gl.ARRAY_BUFFER,attributeItem.array,hint)),attributeItem.needsUpdate=!1)}function setupVertexAttributes(material,programAttributes,geometryAttributes,startIndex){for(var attributeName in programAttributes){var attributePointer=programAttributes[attributeName],attributeItem=geometryAttributes[attributeName];if(attributePointer>=0)if(attributeItem){var attributeSize=attributeItem.itemSize;_gl.bindBuffer(_gl.ARRAY_BUFFER,attributeItem.buffer),enableAttribute(attributePointer),_gl.vertexAttribPointer(attributePointer,attributeSize,_gl.FLOAT,!1,0,startIndex*attributeSize*4)}else material.defaultAttributeValues&&(2===material.defaultAttributeValues[attributeName].length?_gl.vertexAttrib2fv(attributePointer,material.defaultAttributeValues[attributeName]):3===material.defaultAttributeValues[attributeName].length&&_gl.vertexAttrib3fv(attributePointer,material.defaultAttributeValues[attributeName]))}disableUnusedAttributes()}function initAttributes(){for(var i=0,l=_newAttributes.length;l>i;i++)_newAttributes[i]=0}function enableAttribute(attribute){_newAttributes[attribute]=1,0===_enabledAttributes[attribute]&&(_gl.enableVertexAttribArray(attribute),_enabledAttributes[attribute]=1)}function disableUnusedAttributes(){for(var i=0,l=_enabledAttributes.length;l>i;i++)_enabledAttributes[i]!==_newAttributes[i]&&(_gl.disableVertexAttribArray(i),_enabledAttributes[i]=0)}function setupMorphTargets(material,geometryGroup,object){var attributes=material.program.attributes;if(-1!==object.morphTargetBase&&attributes.position>=0?(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglMorphTargetsBuffers[object.morphTargetBase]),enableAttribute(attributes.position),_gl.vertexAttribPointer(attributes.position,3,_gl.FLOAT,!1,0,0)):attributes.position>=0&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglVertexBuffer),enableAttribute(attributes.position),_gl.vertexAttribPointer(attributes.position,3,_gl.FLOAT,!1,0,0)),object.morphTargetForcedOrder.length)for(var m=0,order=object.morphTargetForcedOrder,influences=object.morphTargetInfluences;m<material.numSupportedMorphTargets&&m<order.length;)attributes["morphTarget"+m]>=0&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglMorphTargetsBuffers[order[m]]),enableAttribute(attributes["morphTarget"+m]),_gl.vertexAttribPointer(attributes["morphTarget"+m],3,_gl.FLOAT,!1,0,0)),attributes["morphNormal"+m]>=0&&material.morphNormals&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglMorphNormalsBuffers[order[m]]),enableAttribute(attributes["morphNormal"+m]),_gl.vertexAttribPointer(attributes["morphNormal"+m],3,_gl.FLOAT,!1,0,0)),object.__webglMorphTargetInfluences[m]=influences[order[m]],m++;else{var influence,i,activeInfluenceIndices=[],influences=object.morphTargetInfluences,il=influences.length;for(i=0;il>i;i++)influence=influences[i],influence>0&&activeInfluenceIndices.push([influence,i]);activeInfluenceIndices.length>material.numSupportedMorphTargets?(activeInfluenceIndices.sort(numericalSort),activeInfluenceIndices.length=material.numSupportedMorphTargets):activeInfluenceIndices.length>material.numSupportedMorphNormals?activeInfluenceIndices.sort(numericalSort):0===activeInfluenceIndices.length&&activeInfluenceIndices.push([0,0]);for(var influenceIndex,m=0;m<material.numSupportedMorphTargets;)activeInfluenceIndices[m]?(influenceIndex=activeInfluenceIndices[m][1],attributes["morphTarget"+m]>=0&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglMorphTargetsBuffers[influenceIndex]),enableAttribute(attributes["morphTarget"+m]),_gl.vertexAttribPointer(attributes["morphTarget"+m],3,_gl.FLOAT,!1,0,0)),attributes["morphNormal"+m]>=0&&material.morphNormals&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglMorphNormalsBuffers[influenceIndex]),enableAttribute(attributes["morphNormal"+m]),_gl.vertexAttribPointer(attributes["morphNormal"+m],3,_gl.FLOAT,!1,0,0)),object.__webglMorphTargetInfluences[m]=influences[influenceIndex]):object.__webglMorphTargetInfluences[m]=0,m++}null!==material.program.uniforms.morphTargetInfluences&&_gl.uniform1fv(material.program.uniforms.morphTargetInfluences,object.__webglMorphTargetInfluences)}function painterSortStable(a,b){return a.z!==b.z?b.z-a.z:a.id-b.id}function reversePainterSortStable(a,b){return a.z!==b.z?a.z-b.z:a.id-b.id}function numericalSort(a,b){return b[0]-a[0]}function projectObject(scene,object,camera){if(object.visible!==!1){var webglObjects=scene.__webglObjects[object.id];if(webglObjects&&(object.frustumCulled===!1||_frustum.intersectsObject(object)===!0)){updateObject(scene,object);for(var i=0,l=webglObjects.length;l>i;i++){var webglObject=webglObjects[i];unrollBufferMaterial(webglObject),webglObject.render=!0,_this.sortObjects===!0&&(null!==object.renderDepth?webglObject.z=object.renderDepth:(_vector3.setFromMatrixPosition(object.matrixWorld),_vector3.applyProjection(_projScreenMatrix),webglObject.z=_vector3.z))
}}for(var i=0,l=object.children.length;l>i;i++)projectObject(scene,object.children[i],camera)}}function renderPlugins(plugins,scene,camera){if(0!==plugins.length)for(var i=0,il=plugins.length;il>i;i++)_currentProgram=null,_currentCamera=null,_oldBlending=-1,_oldDepthTest=-1,_oldDepthWrite=-1,_oldDoubleSided=-1,_oldFlipSided=-1,_currentGeometryGroupHash=-1,_currentMaterialId=-1,_lightsNeedUpdate=!0,plugins[i].render(scene,camera,_currentWidth,_currentHeight),_currentProgram=null,_currentCamera=null,_oldBlending=-1,_oldDepthTest=-1,_oldDepthWrite=-1,_oldDoubleSided=-1,_oldFlipSided=-1,_currentGeometryGroupHash=-1,_currentMaterialId=-1,_lightsNeedUpdate=!0}function renderObjects(renderList,camera,lights,fog,useBlending,overrideMaterial){for(var webglObject,object,buffer,material,i=renderList.length-1;-1!==i;i--){if(webglObject=renderList[i],object=webglObject.object,buffer=webglObject.buffer,setupMatrices(object,camera),overrideMaterial)material=overrideMaterial;else{if(material=webglObject.material,!material)continue;useBlending&&_this.setBlending(material.blending,material.blendEquation,material.blendSrc,material.blendDst),_this.setDepthTest(material.depthTest),_this.setDepthWrite(material.depthWrite),setPolygonOffset(material.polygonOffset,material.polygonOffsetFactor,material.polygonOffsetUnits)}_this.setMaterialFaces(material),buffer instanceof THREE.BufferGeometry?_this.renderBufferDirect(camera,lights,fog,material,buffer,object):_this.renderBuffer(camera,lights,fog,material,buffer,object)}}function renderObjectsImmediate(renderList,materialType,camera,lights,fog,useBlending,overrideMaterial){for(var webglObject,object,material,i=0,il=renderList.length;il>i;i++)if(webglObject=renderList[i],object=webglObject.object,object.visible){if(overrideMaterial)material=overrideMaterial;else{if(material=webglObject[materialType],!material)continue;useBlending&&_this.setBlending(material.blending,material.blendEquation,material.blendSrc,material.blendDst),_this.setDepthTest(material.depthTest),_this.setDepthWrite(material.depthWrite),setPolygonOffset(material.polygonOffset,material.polygonOffsetFactor,material.polygonOffsetUnits)}_this.renderImmediateObject(camera,lights,fog,material,object)}}function unrollImmediateBufferMaterial(globject){var object=globject.object,material=object.material;material.transparent?(globject.transparent=material,globject.opaque=null):(globject.opaque=material,globject.transparent=null)}function unrollBufferMaterial(globject){var object=globject.object,buffer=globject.buffer,geometry=object.geometry,material=object.material;if(material instanceof THREE.MeshFaceMaterial){var materialIndex=geometry instanceof THREE.BufferGeometry?0:buffer.materialIndex;material=material.materials[materialIndex],material.transparent?(globject.material=material,transparentObjects.push(globject)):(globject.material=material,opaqueObjects.push(globject))}else material&&(material.transparent?(globject.material=material,transparentObjects.push(globject)):(globject.material=material,opaqueObjects.push(globject)))}function addObject(object,scene){var geometry,geometryGroup;if(void 0===object.__webglInit&&(object.__webglInit=!0,object._modelViewMatrix=new THREE.Matrix4,object._normalMatrix=new THREE.Matrix3),geometry=object.geometry,void 0===geometry||void 0===geometry.__webglInit&&(geometry.__webglInit=!0,geometry.addEventListener("dispose",onGeometryDispose),geometry instanceof THREE.BufferGeometry?initDirectBuffers(geometry):object instanceof THREE.Mesh?(void 0!==object.__webglActive&&removeObject(object,scene),initGeometryGroups(scene,object,geometry)):object instanceof THREE.Line?geometry.__webglVertexBuffer||(createLineBuffers(geometry),initLineBuffers(geometry,object),geometry.verticesNeedUpdate=!0,geometry.colorsNeedUpdate=!0,geometry.lineDistancesNeedUpdate=!0):object instanceof THREE.PointCloud&&(geometry.__webglVertexBuffer||(createParticleBuffers(geometry),initParticleBuffers(geometry,object),geometry.verticesNeedUpdate=!0,geometry.colorsNeedUpdate=!0))),void 0===object.__webglActive){if(object instanceof THREE.Mesh){if(geometry=object.geometry,geometry instanceof THREE.BufferGeometry)addBuffer(scene.__webglObjects,geometry,object);else if(geometry instanceof THREE.Geometry)for(var i=0,l=geometry.geometryGroupsList.length;l>i;i++)geometryGroup=geometry.geometryGroupsList[i],addBuffer(scene.__webglObjects,geometryGroup,object)}else object instanceof THREE.Line||object instanceof THREE.PointCloud?(geometry=object.geometry,addBuffer(scene.__webglObjects,geometry,object)):(object instanceof THREE.ImmediateRenderObject||object.immediateRenderCallback)&&addBufferImmediate(scene.__webglObjectsImmediate,object);object.__webglActive=!0}}function initGeometryGroups(scene,object,geometry){var geometryGroup,material,addBuffers=!1;material=object.material,(void 0===geometry.geometryGroups||geometry.groupsNeedUpdate)&&(delete scene.__webglObjects[object.id],geometry.makeGroups(material instanceof THREE.MeshFaceMaterial,_glExtensionElementIndexUint?4294967296:65535),geometry.groupsNeedUpdate=!1);for(var i=0,il=geometry.geometryGroupsList.length;il>i;i++)geometryGroup=geometry.geometryGroupsList[i],geometryGroup.__webglVertexBuffer?addBuffers=!1:(createMeshBuffers(geometryGroup),initMeshBuffers(geometryGroup,object),geometry.verticesNeedUpdate=!0,geometry.morphTargetsNeedUpdate=!0,geometry.elementsNeedUpdate=!0,geometry.uvsNeedUpdate=!0,geometry.normalsNeedUpdate=!0,geometry.tangentsNeedUpdate=!0,geometry.colorsNeedUpdate=!0,addBuffers=!0),(addBuffers||void 0===object.__webglActive)&&addBuffer(scene.__webglObjects,geometryGroup,object);object.__webglActive=!0}function addBuffer(objlist,buffer,object){var id=object.id;objlist[id]=objlist[id]||[],objlist[id].push({id:id,buffer:buffer,object:object,material:null,z:0})}function addBufferImmediate(objlist,object){objlist.push({id:null,object:object,opaque:null,transparent:null,z:0})}function updateObject(scene,object){var geometryGroup,customAttributesDirty,material,geometry=object.geometry;if(geometry instanceof THREE.BufferGeometry)setDirectBuffers(geometry,_gl.DYNAMIC_DRAW);else if(object instanceof THREE.Mesh){(geometry.buffersNeedUpdate||geometry.groupsNeedUpdate)&&(geometry instanceof THREE.BufferGeometry?initDirectBuffers(geometry):object instanceof THREE.Mesh&&initGeometryGroups(scene,object,geometry));for(var i=0,il=geometry.geometryGroupsList.length;il>i;i++)geometryGroup=geometry.geometryGroupsList[i],material=getBufferMaterial(object,geometryGroup),(geometry.buffersNeedUpdate||geometry.groupsNeedUpdate)&&initMeshBuffers(geometryGroup,object),customAttributesDirty=material.attributes&&areCustomAttributesDirty(material),(geometry.verticesNeedUpdate||geometry.morphTargetsNeedUpdate||geometry.elementsNeedUpdate||geometry.uvsNeedUpdate||geometry.normalsNeedUpdate||geometry.colorsNeedUpdate||geometry.tangentsNeedUpdate||customAttributesDirty)&&setMeshBuffers(geometryGroup,object,_gl.DYNAMIC_DRAW,!geometry.dynamic,material);geometry.verticesNeedUpdate=!1,geometry.morphTargetsNeedUpdate=!1,geometry.elementsNeedUpdate=!1,geometry.uvsNeedUpdate=!1,geometry.normalsNeedUpdate=!1,geometry.colorsNeedUpdate=!1,geometry.tangentsNeedUpdate=!1,geometry.buffersNeedUpdate=!1,material.attributes&&clearCustomAttributes(material)}else object instanceof THREE.Line?(material=getBufferMaterial(object,geometry),customAttributesDirty=material.attributes&&areCustomAttributesDirty(material),(geometry.verticesNeedUpdate||geometry.colorsNeedUpdate||geometry.lineDistancesNeedUpdate||customAttributesDirty)&&setLineBuffers(geometry,_gl.DYNAMIC_DRAW),geometry.verticesNeedUpdate=!1,geometry.colorsNeedUpdate=!1,geometry.lineDistancesNeedUpdate=!1,material.attributes&&clearCustomAttributes(material)):object instanceof THREE.PointCloud&&(material=getBufferMaterial(object,geometry),customAttributesDirty=material.attributes&&areCustomAttributesDirty(material),(geometry.verticesNeedUpdate||geometry.colorsNeedUpdate||object.sortParticles||customAttributesDirty)&&setParticleBuffers(geometry,_gl.DYNAMIC_DRAW,object),geometry.verticesNeedUpdate=!1,geometry.colorsNeedUpdate=!1,material.attributes&&clearCustomAttributes(material))}function areCustomAttributesDirty(material){for(var a in material.attributes)if(material.attributes[a].needsUpdate)return!0;return!1}function clearCustomAttributes(material){for(var a in material.attributes)material.attributes[a].needsUpdate=!1}function removeObject(object,scene){object instanceof THREE.Mesh||object instanceof THREE.PointCloud||object instanceof THREE.Line?removeInstancesWebglObjects(scene.__webglObjects,object):(object instanceof THREE.ImmediateRenderObject||object.immediateRenderCallback)&&removeInstances(scene.__webglObjectsImmediate,object),delete object.__webglActive}function removeInstancesWebglObjects(objlist,object){delete objlist[object.id]}function removeInstances(objlist,object){for(var o=objlist.length-1;o>=0;o--)objlist[o].object===object&&objlist.splice(o,1)}function setProgram(camera,lights,fog,material,object){_usedTextureUnits=0,material.needsUpdate&&(material.program&&deallocateMaterial(material),_this.initMaterial(material,lights,fog,object),material.needsUpdate=!1),material.morphTargets&&(object.__webglMorphTargetInfluences||(object.__webglMorphTargetInfluences=new Float32Array(_this.maxMorphTargets)));var refreshProgram=!1,refreshMaterial=!1,refreshLights=!1,program=material.program,p_uniforms=program.uniforms,m_uniforms=material.__webglShader.uniforms;if(program.id!==_currentProgram&&(_gl.useProgram(program.program),_currentProgram=program.id,refreshProgram=!0,refreshMaterial=!0,refreshLights=!0),material.id!==_currentMaterialId&&(-1===_currentMaterialId&&(refreshLights=!0),_currentMaterialId=material.id,refreshMaterial=!0),(refreshProgram||camera!==_currentCamera)&&(_gl.uniformMatrix4fv(p_uniforms.projectionMatrix,!1,camera.projectionMatrix.elements),_logarithmicDepthBuffer&&_gl.uniform1f(p_uniforms.logDepthBufFC,2/(Math.log(camera.far+1)/Math.LN2)),camera!==_currentCamera&&(_currentCamera=camera),(material instanceof THREE.ShaderMaterial||material instanceof THREE.MeshPhongMaterial||material.envMap)&&null!==p_uniforms.cameraPosition&&(_vector3.setFromMatrixPosition(camera.matrixWorld),_gl.uniform3f(p_uniforms.cameraPosition,_vector3.x,_vector3.y,_vector3.z)),(material instanceof THREE.MeshPhongMaterial||material instanceof THREE.MeshLambertMaterial||material instanceof THREE.ShaderMaterial||material.skinning)&&null!==p_uniforms.viewMatrix&&_gl.uniformMatrix4fv(p_uniforms.viewMatrix,!1,camera.matrixWorldInverse.elements)),material.skinning)if(object.bindMatrix&&null!==p_uniforms.bindMatrix&&_gl.uniformMatrix4fv(p_uniforms.bindMatrix,!1,object.bindMatrix.elements),object.bindMatrixInverse&&null!==p_uniforms.bindMatrixInverse&&_gl.uniformMatrix4fv(p_uniforms.bindMatrixInverse,!1,object.bindMatrixInverse.elements),_supportsBoneTextures&&object.skeleton&&object.skeleton.useVertexTexture){if(null!==p_uniforms.boneTexture){var textureUnit=getTextureUnit();_gl.uniform1i(p_uniforms.boneTexture,textureUnit),_this.setTexture(object.skeleton.boneTexture,textureUnit)}null!==p_uniforms.boneTextureWidth&&_gl.uniform1i(p_uniforms.boneTextureWidth,object.skeleton.boneTextureWidth),null!==p_uniforms.boneTextureHeight&&_gl.uniform1i(p_uniforms.boneTextureHeight,object.skeleton.boneTextureHeight)}else object.skeleton&&object.skeleton.boneMatrices&&null!==p_uniforms.boneGlobalMatrices&&_gl.uniformMatrix4fv(p_uniforms.boneGlobalMatrices,!1,object.skeleton.boneMatrices);return refreshMaterial&&(fog&&material.fog&&refreshUniformsFog(m_uniforms,fog),(material instanceof THREE.MeshPhongMaterial||material instanceof THREE.MeshLambertMaterial||material.lights)&&(_lightsNeedUpdate&&(refreshLights=!0,setupLights(lights),_lightsNeedUpdate=!1),refreshLights?(refreshUniformsLights(m_uniforms,_lights),markUniformsLightsNeedsUpdate(m_uniforms,!0)):markUniformsLightsNeedsUpdate(m_uniforms,!1)),(material instanceof THREE.MeshBasicMaterial||material instanceof THREE.MeshLambertMaterial||material instanceof THREE.MeshPhongMaterial)&&refreshUniformsCommon(m_uniforms,material),material instanceof THREE.LineBasicMaterial?refreshUniformsLine(m_uniforms,material):material instanceof THREE.LineDashedMaterial?(refreshUniformsLine(m_uniforms,material),refreshUniformsDash(m_uniforms,material)):material instanceof THREE.PointCloudMaterial?refreshUniformsParticle(m_uniforms,material):material instanceof THREE.MeshPhongMaterial?refreshUniformsPhong(m_uniforms,material):material instanceof THREE.MeshLambertMaterial?refreshUniformsLambert(m_uniforms,material):material instanceof THREE.MeshDepthMaterial?(m_uniforms.mNear.value=camera.near,m_uniforms.mFar.value=camera.far,m_uniforms.opacity.value=material.opacity):material instanceof THREE.MeshNormalMaterial&&(m_uniforms.opacity.value=material.opacity),object.receiveShadow&&!material._shadowPass&&refreshUniformsShadow(m_uniforms,lights),loadUniformsGeneric(material.uniformsList)),loadUniformsMatrices(p_uniforms,object),null!==p_uniforms.modelMatrix&&_gl.uniformMatrix4fv(p_uniforms.modelMatrix,!1,object.matrixWorld.elements),program}function refreshUniformsCommon(uniforms,material){uniforms.opacity.value=material.opacity,_this.gammaInput?uniforms.diffuse.value.copyGammaToLinear(material.color):uniforms.diffuse.value=material.color,uniforms.map.value=material.map,uniforms.lightMap.value=material.lightMap,uniforms.specularMap.value=material.specularMap,uniforms.alphaMap.value=material.alphaMap,material.bumpMap&&(uniforms.bumpMap.value=material.bumpMap,uniforms.bumpScale.value=material.bumpScale),material.normalMap&&(uniforms.normalMap.value=material.normalMap,uniforms.normalScale.value.copy(material.normalScale));var uvScaleMap;if(material.map?uvScaleMap=material.map:material.specularMap?uvScaleMap=material.specularMap:material.normalMap?uvScaleMap=material.normalMap:material.bumpMap?uvScaleMap=material.bumpMap:material.alphaMap&&(uvScaleMap=material.alphaMap),void 0!==uvScaleMap){var offset=uvScaleMap.offset,repeat=uvScaleMap.repeat;uniforms.offsetRepeat.value.set(offset.x,offset.y,repeat.x,repeat.y)}uniforms.envMap.value=material.envMap,uniforms.flipEnvMap.value=material.envMap instanceof THREE.WebGLRenderTargetCube?1:-1,uniforms.reflectivity.value=_this.gammaInput?material.reflectivity:material.reflectivity,uniforms.refractionRatio.value=material.refractionRatio,uniforms.combine.value=material.combine,uniforms.useRefract.value=material.envMap&&material.envMap.mapping instanceof THREE.CubeRefractionMapping}function refreshUniformsLine(uniforms,material){uniforms.diffuse.value=material.color,uniforms.opacity.value=material.opacity}function refreshUniformsDash(uniforms,material){uniforms.dashSize.value=material.dashSize,uniforms.totalSize.value=material.dashSize+material.gapSize,uniforms.scale.value=material.scale}function refreshUniformsParticle(uniforms,material){uniforms.psColor.value=material.color,uniforms.opacity.value=material.opacity,uniforms.size.value=material.size,uniforms.scale.value=_canvas.height/2,uniforms.map.value=material.map}function refreshUniformsFog(uniforms,fog){uniforms.fogColor.value=fog.color,fog instanceof THREE.Fog?(uniforms.fogNear.value=fog.near,uniforms.fogFar.value=fog.far):fog instanceof THREE.FogExp2&&(uniforms.fogDensity.value=fog.density)}function refreshUniformsPhong(uniforms,material){uniforms.shininess.value=material.shininess,_this.gammaInput?(uniforms.ambient.value.copyGammaToLinear(material.ambient),uniforms.emissive.value.copyGammaToLinear(material.emissive),uniforms.specular.value.copyGammaToLinear(material.specular)):(uniforms.ambient.value=material.ambient,uniforms.emissive.value=material.emissive,uniforms.specular.value=material.specular),material.wrapAround&&uniforms.wrapRGB.value.copy(material.wrapRGB)}function refreshUniformsLambert(uniforms,material){_this.gammaInput?(uniforms.ambient.value.copyGammaToLinear(material.ambient),uniforms.emissive.value.copyGammaToLinear(material.emissive)):(uniforms.ambient.value=material.ambient,uniforms.emissive.value=material.emissive),material.wrapAround&&uniforms.wrapRGB.value.copy(material.wrapRGB)}function refreshUniformsLights(uniforms,lights){uniforms.ambientLightColor.value=lights.ambient,uniforms.directionalLightColor.value=lights.directional.colors,uniforms.directionalLightDirection.value=lights.directional.positions,uniforms.pointLightColor.value=lights.point.colors,uniforms.pointLightPosition.value=lights.point.positions,uniforms.pointLightDistance.value=lights.point.distances,uniforms.spotLightColor.value=lights.spot.colors,uniforms.spotLightPosition.value=lights.spot.positions,uniforms.spotLightDistance.value=lights.spot.distances,uniforms.spotLightDirection.value=lights.spot.directions,uniforms.spotLightAngleCos.value=lights.spot.anglesCos,uniforms.spotLightExponent.value=lights.spot.exponents,uniforms.hemisphereLightSkyColor.value=lights.hemi.skyColors,uniforms.hemisphereLightGroundColor.value=lights.hemi.groundColors,uniforms.hemisphereLightDirection.value=lights.hemi.positions}function markUniformsLightsNeedsUpdate(uniforms,boolean){uniforms.ambientLightColor.needsUpdate=boolean,uniforms.directionalLightColor.needsUpdate=boolean,uniforms.directionalLightDirection.needsUpdate=boolean,uniforms.pointLightColor.needsUpdate=boolean,uniforms.pointLightPosition.needsUpdate=boolean,uniforms.pointLightDistance.needsUpdate=boolean,uniforms.spotLightColor.needsUpdate=boolean,uniforms.spotLightPosition.needsUpdate=boolean,uniforms.spotLightDistance.needsUpdate=boolean,uniforms.spotLightDirection.needsUpdate=boolean,uniforms.spotLightAngleCos.needsUpdate=boolean,uniforms.spotLightExponent.needsUpdate=boolean,uniforms.hemisphereLightSkyColor.needsUpdate=boolean,uniforms.hemisphereLightGroundColor.needsUpdate=boolean,uniforms.hemisphereLightDirection.needsUpdate=boolean}function refreshUniformsShadow(uniforms,lights){if(uniforms.shadowMatrix)for(var j=0,i=0,il=lights.length;il>i;i++){var light=lights[i];light.castShadow&&(light instanceof THREE.SpotLight||light instanceof THREE.DirectionalLight&&!light.shadowCascade)&&(uniforms.shadowMap.value[j]=light.shadowMap,uniforms.shadowMapSize.value[j]=light.shadowMapSize,uniforms.shadowMatrix.value[j]=light.shadowMatrix,uniforms.shadowDarkness.value[j]=light.shadowDarkness,uniforms.shadowBias.value[j]=light.shadowBias,j++)}}function loadUniformsMatrices(uniforms,object){_gl.uniformMatrix4fv(uniforms.modelViewMatrix,!1,object._modelViewMatrix.elements),uniforms.normalMatrix&&_gl.uniformMatrix3fv(uniforms.normalMatrix,!1,object._normalMatrix.elements)}function getTextureUnit(){var textureUnit=_usedTextureUnits;return textureUnit>=_maxTextures&&console.warn("WebGLRenderer: trying to use "+textureUnit+" texture units while this GPU supports only "+_maxTextures),_usedTextureUnits+=1,textureUnit}function loadUniformsGeneric(uniforms){for(var texture,textureUnit,offset,j=0,jl=uniforms.length;jl>j;j++){var uniform=uniforms[j][0];if(uniform.needsUpdate!==!1){var type=uniform.type,value=uniform.value,location=uniforms[j][1];switch(type){case"1i":_gl.uniform1i(location,value);break;case"1f":_gl.uniform1f(location,value);break;case"2f":_gl.uniform2f(location,value[0],value[1]);break;case"3f":_gl.uniform3f(location,value[0],value[1],value[2]);break;case"4f":_gl.uniform4f(location,value[0],value[1],value[2],value[3]);break;case"1iv":_gl.uniform1iv(location,value);break;case"3iv":_gl.uniform3iv(location,value);break;case"1fv":_gl.uniform1fv(location,value);break;case"2fv":_gl.uniform2fv(location,value);break;case"3fv":_gl.uniform3fv(location,value);break;case"4fv":_gl.uniform4fv(location,value);break;case"Matrix3fv":_gl.uniformMatrix3fv(location,!1,value);break;case"Matrix4fv":_gl.uniformMatrix4fv(location,!1,value);break;case"i":_gl.uniform1i(location,value);break;case"f":_gl.uniform1f(location,value);break;case"v2":_gl.uniform2f(location,value.x,value.y);break;case"v3":_gl.uniform3f(location,value.x,value.y,value.z);break;case"v4":_gl.uniform4f(location,value.x,value.y,value.z,value.w);break;case"c":_gl.uniform3f(location,value.r,value.g,value.b);break;case"iv1":_gl.uniform1iv(location,value);break;case"iv":_gl.uniform3iv(location,value);break;case"fv1":_gl.uniform1fv(location,value);break;case"fv":_gl.uniform3fv(location,value);break;case"v2v":void 0===uniform._array&&(uniform._array=new Float32Array(2*value.length));for(var i=0,il=value.length;il>i;i++)offset=2*i,uniform._array[offset]=value[i].x,uniform._array[offset+1]=value[i].y;_gl.uniform2fv(location,uniform._array);break;case"v3v":void 0===uniform._array&&(uniform._array=new Float32Array(3*value.length));for(var i=0,il=value.length;il>i;i++)offset=3*i,uniform._array[offset]=value[i].x,uniform._array[offset+1]=value[i].y,uniform._array[offset+2]=value[i].z;_gl.uniform3fv(location,uniform._array);break;case"v4v":void 0===uniform._array&&(uniform._array=new Float32Array(4*value.length));for(var i=0,il=value.length;il>i;i++)offset=4*i,uniform._array[offset]=value[i].x,uniform._array[offset+1]=value[i].y,uniform._array[offset+2]=value[i].z,uniform._array[offset+3]=value[i].w;_gl.uniform4fv(location,uniform._array);break;case"m3":_gl.uniformMatrix3fv(location,!1,value.elements);break;case"m3v":void 0===uniform._array&&(uniform._array=new Float32Array(9*value.length));for(var i=0,il=value.length;il>i;i++)value[i].flattenToArrayOffset(uniform._array,9*i);_gl.uniformMatrix3fv(location,!1,uniform._array);break;case"m4":_gl.uniformMatrix4fv(location,!1,value.elements);break;case"m4v":void 0===uniform._array&&(uniform._array=new Float32Array(16*value.length));for(var i=0,il=value.length;il>i;i++)value[i].flattenToArrayOffset(uniform._array,16*i);_gl.uniformMatrix4fv(location,!1,uniform._array);break;case"t":if(texture=value,textureUnit=getTextureUnit(),_gl.uniform1i(location,textureUnit),!texture)continue;texture instanceof THREE.CubeTexture||texture.image instanceof Array&&6===texture.image.length?setCubeTexture(texture,textureUnit):texture instanceof THREE.WebGLRenderTargetCube?setCubeTextureDynamic(texture,textureUnit):_this.setTexture(texture,textureUnit);break;case"tv":void 0===uniform._array&&(uniform._array=[]);for(var i=0,il=uniform.value.length;il>i;i++)uniform._array[i]=getTextureUnit();_gl.uniform1iv(location,uniform._array);for(var i=0,il=uniform.value.length;il>i;i++)texture=uniform.value[i],textureUnit=uniform._array[i],texture&&_this.setTexture(texture,textureUnit);break;default:console.warn("THREE.WebGLRenderer: Unknown uniform type: "+type)}}}}function setupMatrices(object,camera){object._modelViewMatrix.multiplyMatrices(camera.matrixWorldInverse,object.matrixWorld),object._normalMatrix.getNormalMatrix(object._modelViewMatrix)}function setColorGamma(array,offset,color,intensitySq){array[offset]=color.r*color.r*intensitySq,array[offset+1]=color.g*color.g*intensitySq,array[offset+2]=color.b*color.b*intensitySq}function setColorLinear(array,offset,color,intensity){array[offset]=color.r*intensity,array[offset+1]=color.g*intensity,array[offset+2]=color.b*intensity}function setupLights(lights){var l,ll,light,color,skyColor,groundColor,intensity,intensitySq,distance,r=0,g=0,b=0,zlights=_lights,dirColors=zlights.directional.colors,dirPositions=zlights.directional.positions,pointColors=zlights.point.colors,pointPositions=zlights.point.positions,pointDistances=zlights.point.distances,spotColors=zlights.spot.colors,spotPositions=zlights.spot.positions,spotDistances=zlights.spot.distances,spotDirections=zlights.spot.directions,spotAnglesCos=zlights.spot.anglesCos,spotExponents=zlights.spot.exponents,hemiSkyColors=zlights.hemi.skyColors,hemiGroundColors=zlights.hemi.groundColors,hemiPositions=zlights.hemi.positions,dirLength=0,pointLength=0,spotLength=0,hemiLength=0,dirCount=0,pointCount=0,spotCount=0,hemiCount=0,dirOffset=0,pointOffset=0,spotOffset=0,hemiOffset=0;for(l=0,ll=lights.length;ll>l;l++)if(light=lights[l],!light.onlyShadow)if(color=light.color,intensity=light.intensity,distance=light.distance,light instanceof THREE.AmbientLight){if(!light.visible)continue;_this.gammaInput?(r+=color.r*color.r,g+=color.g*color.g,b+=color.b*color.b):(r+=color.r,g+=color.g,b+=color.b)}else if(light instanceof THREE.DirectionalLight){if(dirCount+=1,!light.visible)continue;_direction.setFromMatrixPosition(light.matrixWorld),_vector3.setFromMatrixPosition(light.target.matrixWorld),_direction.sub(_vector3),_direction.normalize(),dirOffset=3*dirLength,dirPositions[dirOffset]=_direction.x,dirPositions[dirOffset+1]=_direction.y,dirPositions[dirOffset+2]=_direction.z,_this.gammaInput?setColorGamma(dirColors,dirOffset,color,intensity*intensity):setColorLinear(dirColors,dirOffset,color,intensity),dirLength+=1}else if(light instanceof THREE.PointLight){if(pointCount+=1,!light.visible)continue;pointOffset=3*pointLength,_this.gammaInput?setColorGamma(pointColors,pointOffset,color,intensity*intensity):setColorLinear(pointColors,pointOffset,color,intensity),_vector3.setFromMatrixPosition(light.matrixWorld),pointPositions[pointOffset]=_vector3.x,pointPositions[pointOffset+1]=_vector3.y,pointPositions[pointOffset+2]=_vector3.z,pointDistances[pointLength]=distance,pointLength+=1}else if(light instanceof THREE.SpotLight){if(spotCount+=1,!light.visible)continue;spotOffset=3*spotLength,_this.gammaInput?setColorGamma(spotColors,spotOffset,color,intensity*intensity):setColorLinear(spotColors,spotOffset,color,intensity),_vector3.setFromMatrixPosition(light.matrixWorld),spotPositions[spotOffset]=_vector3.x,spotPositions[spotOffset+1]=_vector3.y,spotPositions[spotOffset+2]=_vector3.z,spotDistances[spotLength]=distance,_direction.copy(_vector3),_vector3.setFromMatrixPosition(light.target.matrixWorld),_direction.sub(_vector3),_direction.normalize(),spotDirections[spotOffset]=_direction.x,spotDirections[spotOffset+1]=_direction.y,spotDirections[spotOffset+2]=_direction.z,spotAnglesCos[spotLength]=Math.cos(light.angle),spotExponents[spotLength]=light.exponent,spotLength+=1}else if(light instanceof THREE.HemisphereLight){if(hemiCount+=1,!light.visible)continue;_direction.setFromMatrixPosition(light.matrixWorld),_direction.normalize(),hemiOffset=3*hemiLength,hemiPositions[hemiOffset]=_direction.x,hemiPositions[hemiOffset+1]=_direction.y,hemiPositions[hemiOffset+2]=_direction.z,skyColor=light.color,groundColor=light.groundColor,_this.gammaInput?(intensitySq=intensity*intensity,setColorGamma(hemiSkyColors,hemiOffset,skyColor,intensitySq),setColorGamma(hemiGroundColors,hemiOffset,groundColor,intensitySq)):(setColorLinear(hemiSkyColors,hemiOffset,skyColor,intensity),setColorLinear(hemiGroundColors,hemiOffset,groundColor,intensity)),hemiLength+=1}for(l=3*dirLength,ll=Math.max(dirColors.length,3*dirCount);ll>l;l++)dirColors[l]=0;for(l=3*pointLength,ll=Math.max(pointColors.length,3*pointCount);ll>l;l++)pointColors[l]=0;for(l=3*spotLength,ll=Math.max(spotColors.length,3*spotCount);ll>l;l++)spotColors[l]=0;for(l=3*hemiLength,ll=Math.max(hemiSkyColors.length,3*hemiCount);ll>l;l++)hemiSkyColors[l]=0;for(l=3*hemiLength,ll=Math.max(hemiGroundColors.length,3*hemiCount);ll>l;l++)hemiGroundColors[l]=0;zlights.directional.length=dirLength,zlights.point.length=pointLength,zlights.spot.length=spotLength,zlights.hemi.length=hemiLength,zlights.ambient[0]=r,zlights.ambient[1]=g,zlights.ambient[2]=b}function setLineWidth(width){width!==_oldLineWidth&&(_gl.lineWidth(width),_oldLineWidth=width)}function setPolygonOffset(polygonoffset,factor,units){_oldPolygonOffset!==polygonoffset&&(polygonoffset?_gl.enable(_gl.POLYGON_OFFSET_FILL):_gl.disable(_gl.POLYGON_OFFSET_FILL),_oldPolygonOffset=polygonoffset),!polygonoffset||_oldPolygonOffsetFactor===factor&&_oldPolygonOffsetUnits===units||(_gl.polygonOffset(factor,units),_oldPolygonOffsetFactor=factor,_oldPolygonOffsetUnits=units)}function setTextureParameters(textureType,texture,isImagePowerOfTwo){isImagePowerOfTwo?(_gl.texParameteri(textureType,_gl.TEXTURE_WRAP_S,paramThreeToGL(texture.wrapS)),_gl.texParameteri(textureType,_gl.TEXTURE_WRAP_T,paramThreeToGL(texture.wrapT)),_gl.texParameteri(textureType,_gl.TEXTURE_MAG_FILTER,paramThreeToGL(texture.magFilter)),_gl.texParameteri(textureType,_gl.TEXTURE_MIN_FILTER,paramThreeToGL(texture.minFilter))):(_gl.texParameteri(textureType,_gl.TEXTURE_WRAP_S,_gl.CLAMP_TO_EDGE),_gl.texParameteri(textureType,_gl.TEXTURE_WRAP_T,_gl.CLAMP_TO_EDGE),_gl.texParameteri(textureType,_gl.TEXTURE_MAG_FILTER,filterFallback(texture.magFilter)),_gl.texParameteri(textureType,_gl.TEXTURE_MIN_FILTER,filterFallback(texture.minFilter))),_glExtensionTextureFilterAnisotropic&&texture.type!==THREE.FloatType&&(texture.anisotropy>1||texture.__oldAnisotropy)&&(_gl.texParameterf(textureType,_glExtensionTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(texture.anisotropy,_maxAnisotropy)),texture.__oldAnisotropy=texture.anisotropy)}function clampToMaxSize(image,maxSize){if(image.width<=maxSize&&image.height<=maxSize)return image;var maxDimension=Math.max(image.width,image.height),newWidth=Math.floor(image.width*maxSize/maxDimension),newHeight=Math.floor(image.height*maxSize/maxDimension),canvas=document.createElement("canvas");canvas.width=newWidth,canvas.height=newHeight;var ctx=canvas.getContext("2d");return ctx.drawImage(image,0,0,image.width,image.height,0,0,newWidth,newHeight),canvas}function setCubeTexture(texture,slot){if(6===texture.image.length)if(texture.needsUpdate){texture.image.__webglTextureCube||(texture.addEventListener("dispose",onTextureDispose),texture.image.__webglTextureCube=_gl.createTexture(),_this.info.memory.textures++),_gl.activeTexture(_gl.TEXTURE0+slot),_gl.bindTexture(_gl.TEXTURE_CUBE_MAP,texture.image.__webglTextureCube),_gl.pixelStorei(_gl.UNPACK_FLIP_Y_WEBGL,texture.flipY);for(var isCompressed=texture instanceof THREE.CompressedTexture,cubeImage=[],i=0;6>i;i++)cubeImage[i]=_this.autoScaleCubemaps&&!isCompressed?clampToMaxSize(texture.image[i],_maxCubemapSize):texture.image[i];var image=cubeImage[0],isImagePowerOfTwo=THREE.Math.isPowerOfTwo(image.width)&&THREE.Math.isPowerOfTwo(image.height),glFormat=paramThreeToGL(texture.format),glType=paramThreeToGL(texture.type);setTextureParameters(_gl.TEXTURE_CUBE_MAP,texture,isImagePowerOfTwo);for(var i=0;6>i;i++)if(isCompressed)for(var mipmap,mipmaps=cubeImage[i].mipmaps,j=0,jl=mipmaps.length;jl>j;j++)mipmap=mipmaps[j],texture.format!==THREE.RGBAFormat?_gl.compressedTexImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X+i,j,glFormat,mipmap.width,mipmap.height,0,mipmap.data):_gl.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X+i,j,glFormat,mipmap.width,mipmap.height,0,glFormat,glType,mipmap.data);else _gl.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,glFormat,glFormat,glType,cubeImage[i]);texture.generateMipmaps&&isImagePowerOfTwo&&_gl.generateMipmap(_gl.TEXTURE_CUBE_MAP),texture.needsUpdate=!1,texture.onUpdate&&texture.onUpdate()}else _gl.activeTexture(_gl.TEXTURE0+slot),_gl.bindTexture(_gl.TEXTURE_CUBE_MAP,texture.image.__webglTextureCube)}function setCubeTextureDynamic(texture,slot){_gl.activeTexture(_gl.TEXTURE0+slot),_gl.bindTexture(_gl.TEXTURE_CUBE_MAP,texture.__webglTexture)}function setupFrameBuffer(framebuffer,renderTarget,textureTarget){_gl.bindFramebuffer(_gl.FRAMEBUFFER,framebuffer),_gl.framebufferTexture2D(_gl.FRAMEBUFFER,_gl.COLOR_ATTACHMENT0,textureTarget,renderTarget.__webglTexture,0)}function setupRenderBuffer(renderbuffer,renderTarget){_gl.bindRenderbuffer(_gl.RENDERBUFFER,renderbuffer),renderTarget.depthBuffer&&!renderTarget.stencilBuffer?(_gl.renderbufferStorage(_gl.RENDERBUFFER,_gl.DEPTH_COMPONENT16,renderTarget.width,renderTarget.height),_gl.framebufferRenderbuffer(_gl.FRAMEBUFFER,_gl.DEPTH_ATTACHMENT,_gl.RENDERBUFFER,renderbuffer)):renderTarget.depthBuffer&&renderTarget.stencilBuffer?(_gl.renderbufferStorage(_gl.RENDERBUFFER,_gl.DEPTH_STENCIL,renderTarget.width,renderTarget.height),_gl.framebufferRenderbuffer(_gl.FRAMEBUFFER,_gl.DEPTH_STENCIL_ATTACHMENT,_gl.RENDERBUFFER,renderbuffer)):_gl.renderbufferStorage(_gl.RENDERBUFFER,_gl.RGBA4,renderTarget.width,renderTarget.height)}function updateRenderTargetMipmap(renderTarget){renderTarget instanceof THREE.WebGLRenderTargetCube?(_gl.bindTexture(_gl.TEXTURE_CUBE_MAP,renderTarget.__webglTexture),_gl.generateMipmap(_gl.TEXTURE_CUBE_MAP),_gl.bindTexture(_gl.TEXTURE_CUBE_MAP,null)):(_gl.bindTexture(_gl.TEXTURE_2D,renderTarget.__webglTexture),_gl.generateMipmap(_gl.TEXTURE_2D),_gl.bindTexture(_gl.TEXTURE_2D,null))
}function filterFallback(f){return f===THREE.NearestFilter||f===THREE.NearestMipMapNearestFilter||f===THREE.NearestMipMapLinearFilter?_gl.NEAREST:_gl.LINEAR}function paramThreeToGL(p){if(p===THREE.RepeatWrapping)return _gl.REPEAT;if(p===THREE.ClampToEdgeWrapping)return _gl.CLAMP_TO_EDGE;if(p===THREE.MirroredRepeatWrapping)return _gl.MIRRORED_REPEAT;if(p===THREE.NearestFilter)return _gl.NEAREST;if(p===THREE.NearestMipMapNearestFilter)return _gl.NEAREST_MIPMAP_NEAREST;if(p===THREE.NearestMipMapLinearFilter)return _gl.NEAREST_MIPMAP_LINEAR;if(p===THREE.LinearFilter)return _gl.LINEAR;if(p===THREE.LinearMipMapNearestFilter)return _gl.LINEAR_MIPMAP_NEAREST;if(p===THREE.LinearMipMapLinearFilter)return _gl.LINEAR_MIPMAP_LINEAR;if(p===THREE.UnsignedByteType)return _gl.UNSIGNED_BYTE;if(p===THREE.UnsignedShort4444Type)return _gl.UNSIGNED_SHORT_4_4_4_4;if(p===THREE.UnsignedShort5551Type)return _gl.UNSIGNED_SHORT_5_5_5_1;if(p===THREE.UnsignedShort565Type)return _gl.UNSIGNED_SHORT_5_6_5;if(p===THREE.ByteType)return _gl.BYTE;if(p===THREE.ShortType)return _gl.SHORT;if(p===THREE.UnsignedShortType)return _gl.UNSIGNED_SHORT;if(p===THREE.IntType)return _gl.INT;if(p===THREE.UnsignedIntType)return _gl.UNSIGNED_INT;if(p===THREE.FloatType)return _gl.FLOAT;if(p===THREE.AlphaFormat)return _gl.ALPHA;if(p===THREE.RGBFormat)return _gl.RGB;if(p===THREE.RGBAFormat)return _gl.RGBA;if(p===THREE.LuminanceFormat)return _gl.LUMINANCE;if(p===THREE.LuminanceAlphaFormat)return _gl.LUMINANCE_ALPHA;if(p===THREE.AddEquation)return _gl.FUNC_ADD;if(p===THREE.SubtractEquation)return _gl.FUNC_SUBTRACT;if(p===THREE.ReverseSubtractEquation)return _gl.FUNC_REVERSE_SUBTRACT;if(p===THREE.ZeroFactor)return _gl.ZERO;if(p===THREE.OneFactor)return _gl.ONE;if(p===THREE.SrcColorFactor)return _gl.SRC_COLOR;if(p===THREE.OneMinusSrcColorFactor)return _gl.ONE_MINUS_SRC_COLOR;if(p===THREE.SrcAlphaFactor)return _gl.SRC_ALPHA;if(p===THREE.OneMinusSrcAlphaFactor)return _gl.ONE_MINUS_SRC_ALPHA;if(p===THREE.DstAlphaFactor)return _gl.DST_ALPHA;if(p===THREE.OneMinusDstAlphaFactor)return _gl.ONE_MINUS_DST_ALPHA;if(p===THREE.DstColorFactor)return _gl.DST_COLOR;if(p===THREE.OneMinusDstColorFactor)return _gl.ONE_MINUS_DST_COLOR;if(p===THREE.SrcAlphaSaturateFactor)return _gl.SRC_ALPHA_SATURATE;if(void 0!==_glExtensionCompressedTextureS3TC){if(p===THREE.RGB_S3TC_DXT1_Format)return _glExtensionCompressedTextureS3TC.COMPRESSED_RGB_S3TC_DXT1_EXT;if(p===THREE.RGBA_S3TC_DXT1_Format)return _glExtensionCompressedTextureS3TC.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(p===THREE.RGBA_S3TC_DXT3_Format)return _glExtensionCompressedTextureS3TC.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(p===THREE.RGBA_S3TC_DXT5_Format)return _glExtensionCompressedTextureS3TC.COMPRESSED_RGBA_S3TC_DXT5_EXT}return 0}function allocateBones(object){if(_supportsBoneTextures&&object&&object.skeleton&&object.skeleton.useVertexTexture)return 1024;var nVertexUniforms=_gl.getParameter(_gl.MAX_VERTEX_UNIFORM_VECTORS),nVertexMatrices=Math.floor((nVertexUniforms-20)/4),maxBones=nVertexMatrices;return void 0!==object&&object instanceof THREE.SkinnedMesh&&(maxBones=Math.min(object.skeleton.bones.length,maxBones),maxBones<object.skeleton.bones.length&&console.warn("WebGLRenderer: too many bones - "+object.skeleton.bones.length+", this GPU supports just "+maxBones+" (try OpenGL instead of ANGLE)")),maxBones}function allocateLights(lights){for(var dirLights=0,pointLights=0,spotLights=0,hemiLights=0,l=0,ll=lights.length;ll>l;l++){var light=lights[l];light.onlyShadow||light.visible===!1||(light instanceof THREE.DirectionalLight&&dirLights++,light instanceof THREE.PointLight&&pointLights++,light instanceof THREE.SpotLight&&spotLights++,light instanceof THREE.HemisphereLight&&hemiLights++)}return{directional:dirLights,point:pointLights,spot:spotLights,hemi:hemiLights}}function allocateShadows(lights){for(var maxShadows=0,l=0,ll=lights.length;ll>l;l++){var light=lights[l];light.castShadow&&(light instanceof THREE.SpotLight&&maxShadows++,light instanceof THREE.DirectionalLight&&!light.shadowCascade&&maxShadows++)}return maxShadows}function initGL(){try{var attributes={alpha:_alpha,depth:_depth,stencil:_stencil,antialias:_antialias,premultipliedAlpha:_premultipliedAlpha,preserveDrawingBuffer:_preserveDrawingBuffer};if(_gl=_context||_canvas.getContext("webgl",attributes)||_canvas.getContext("experimental-webgl",attributes),null===_gl)throw"Error creating WebGL context."}catch(error){console.error(error)}_glExtensionTextureFloat=_gl.getExtension("OES_texture_float"),_glExtensionTextureFloatLinear=_gl.getExtension("OES_texture_float_linear"),_glExtensionStandardDerivatives=_gl.getExtension("OES_standard_derivatives"),_glExtensionTextureFilterAnisotropic=_gl.getExtension("EXT_texture_filter_anisotropic")||_gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||_gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),_glExtensionCompressedTextureS3TC=_gl.getExtension("WEBGL_compressed_texture_s3tc")||_gl.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||_gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),_glExtensionElementIndexUint=_gl.getExtension("OES_element_index_uint"),null===_glExtensionTextureFloat&&console.log("THREE.WebGLRenderer: Float textures not supported."),null===_glExtensionStandardDerivatives&&console.log("THREE.WebGLRenderer: Standard derivatives not supported."),null===_glExtensionTextureFilterAnisotropic&&console.log("THREE.WebGLRenderer: Anisotropic texture filtering not supported."),null===_glExtensionCompressedTextureS3TC&&console.log("THREE.WebGLRenderer: S3TC compressed textures not supported."),null===_glExtensionElementIndexUint&&console.log("THREE.WebGLRenderer: elementindex as unsigned integer not supported."),void 0===_gl.getShaderPrecisionFormat&&(_gl.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),_logarithmicDepthBuffer&&(_glExtensionFragDepth=_gl.getExtension("EXT_frag_depth"))}function setDefaultGLState(){_gl.clearColor(0,0,0,1),_gl.clearDepth(1),_gl.clearStencil(0),_gl.enable(_gl.DEPTH_TEST),_gl.depthFunc(_gl.LEQUAL),_gl.frontFace(_gl.CCW),_gl.cullFace(_gl.BACK),_gl.enable(_gl.CULL_FACE),_gl.enable(_gl.BLEND),_gl.blendEquation(_gl.FUNC_ADD),_gl.blendFunc(_gl.SRC_ALPHA,_gl.ONE_MINUS_SRC_ALPHA),_gl.viewport(_viewportX,_viewportY,_viewportWidth,_viewportHeight),_gl.clearColor(_clearColor.r,_clearColor.g,_clearColor.b,_clearAlpha)}console.log("THREE.WebGLRenderer",THREE.REVISION),parameters=parameters||{};var _canvas=void 0!==parameters.canvas?parameters.canvas:document.createElement("canvas"),_context=void 0!==parameters.context?parameters.context:null,_precision=void 0!==parameters.precision?parameters.precision:"highp",_alpha=void 0!==parameters.alpha?parameters.alpha:!1,_depth=void 0!==parameters.depth?parameters.depth:!0,_stencil=void 0!==parameters.stencil?parameters.stencil:!0,_antialias=void 0!==parameters.antialias?parameters.antialias:!1,_premultipliedAlpha=void 0!==parameters.premultipliedAlpha?parameters.premultipliedAlpha:!0,_preserveDrawingBuffer=void 0!==parameters.preserveDrawingBuffer?parameters.preserveDrawingBuffer:!1,_logarithmicDepthBuffer=void 0!==parameters.logarithmicDepthBuffer?parameters.logarithmicDepthBuffer:!1,_clearColor=new THREE.Color(0),_clearAlpha=0,opaqueObjects=[],transparentObjects=[];this.domElement=_canvas,this.context=null,this.devicePixelRatio=void 0!==parameters.devicePixelRatio?parameters.devicePixelRatio:void 0!==self.devicePixelRatio?self.devicePixelRatio:1,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.gammaInput=!1,this.gammaOutput=!1,this.shadowMapEnabled=!1,this.shadowMapAutoUpdate=!0,this.shadowMapType=THREE.PCFShadowMap,this.shadowMapCullFace=THREE.CullFaceFront,this.shadowMapDebug=!1,this.shadowMapCascade=!1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0,this.renderPluginsPre=[],this.renderPluginsPost=[],this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var _gl,_glExtensionTextureFloat,_glExtensionTextureFloatLinear,_glExtensionStandardDerivatives,_glExtensionTextureFilterAnisotropic,_glExtensionCompressedTextureS3TC,_glExtensionElementIndexUint,_glExtensionFragDepth,_this=this,_programs=[],_currentProgram=null,_currentFramebuffer=null,_currentMaterialId=-1,_currentGeometryGroupHash=null,_currentCamera=null,_usedTextureUnits=0,_oldDoubleSided=-1,_oldFlipSided=-1,_oldBlending=-1,_oldBlendEquation=-1,_oldBlendSrc=-1,_oldBlendDst=-1,_oldDepthTest=-1,_oldDepthWrite=-1,_oldPolygonOffset=null,_oldPolygonOffsetFactor=null,_oldPolygonOffsetUnits=null,_oldLineWidth=null,_viewportX=0,_viewportY=0,_viewportWidth=_canvas.width,_viewportHeight=_canvas.height,_currentWidth=0,_currentHeight=0,_newAttributes=new Uint8Array(16),_enabledAttributes=new Uint8Array(16),_frustum=new THREE.Frustum,_projScreenMatrix=new THREE.Matrix4,_projScreenMatrixPS=new THREE.Matrix4,_vector3=new THREE.Vector3,_direction=new THREE.Vector3,_lightsNeedUpdate=!0,_lights={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}};initGL(),setDefaultGLState(),this.context=_gl;var _maxTextures=_gl.getParameter(_gl.MAX_TEXTURE_IMAGE_UNITS),_maxVertexTextures=_gl.getParameter(_gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),_maxCubemapSize=(_gl.getParameter(_gl.MAX_TEXTURE_SIZE),_gl.getParameter(_gl.MAX_CUBE_MAP_TEXTURE_SIZE)),_maxAnisotropy=_glExtensionTextureFilterAnisotropic?_gl.getParameter(_glExtensionTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,_supportsVertexTextures=_maxVertexTextures>0,_supportsBoneTextures=_supportsVertexTextures&&_glExtensionTextureFloat,_vertexShaderPrecisionHighpFloat=(_glExtensionCompressedTextureS3TC?_gl.getParameter(_gl.COMPRESSED_TEXTURE_FORMATS):[],_gl.getShaderPrecisionFormat(_gl.VERTEX_SHADER,_gl.HIGH_FLOAT)),_vertexShaderPrecisionMediumpFloat=_gl.getShaderPrecisionFormat(_gl.VERTEX_SHADER,_gl.MEDIUM_FLOAT),_fragmentShaderPrecisionHighpFloat=(_gl.getShaderPrecisionFormat(_gl.VERTEX_SHADER,_gl.LOW_FLOAT),_gl.getShaderPrecisionFormat(_gl.FRAGMENT_SHADER,_gl.HIGH_FLOAT)),_fragmentShaderPrecisionMediumpFloat=_gl.getShaderPrecisionFormat(_gl.FRAGMENT_SHADER,_gl.MEDIUM_FLOAT),highpAvailable=(_gl.getShaderPrecisionFormat(_gl.FRAGMENT_SHADER,_gl.LOW_FLOAT),_vertexShaderPrecisionHighpFloat.precision>0&&_fragmentShaderPrecisionHighpFloat.precision>0),mediumpAvailable=_vertexShaderPrecisionMediumpFloat.precision>0&&_fragmentShaderPrecisionMediumpFloat.precision>0;"highp"!==_precision||highpAvailable||(mediumpAvailable?(_precision="mediump",console.warn("THREE.WebGLRenderer: highp not supported, using mediump.")):(_precision="lowp",console.warn("THREE.WebGLRenderer: highp and mediump not supported, using lowp."))),"mediump"!==_precision||mediumpAvailable||(_precision="lowp",console.warn("THREE.WebGLRenderer: mediump not supported, using lowp.")),this.getContext=function(){return _gl},this.supportsVertexTextures=function(){return _supportsVertexTextures},this.supportsFloatTextures=function(){return _glExtensionTextureFloat},this.supportsStandardDerivatives=function(){return _glExtensionStandardDerivatives},this.supportsCompressedTextureS3TC=function(){return _glExtensionCompressedTextureS3TC},this.getMaxAnisotropy=function(){return _maxAnisotropy},this.getPrecision=function(){return _precision},this.setSize=function(width,height,updateStyle){_canvas.width=width*this.devicePixelRatio,_canvas.height=height*this.devicePixelRatio,updateStyle!==!1&&(_canvas.style.width=width+"px",_canvas.style.height=height+"px"),this.setViewport(0,0,width,height)},this.setViewport=function(x,y,width,height){_viewportX=x*this.devicePixelRatio,_viewportY=y*this.devicePixelRatio,_viewportWidth=width*this.devicePixelRatio,_viewportHeight=height*this.devicePixelRatio,_gl.viewport(_viewportX,_viewportY,_viewportWidth,_viewportHeight)},this.setScissor=function(x,y,width,height){_gl.scissor(x*this.devicePixelRatio,y*this.devicePixelRatio,width*this.devicePixelRatio,height*this.devicePixelRatio)},this.enableScissorTest=function(enable){enable?_gl.enable(_gl.SCISSOR_TEST):_gl.disable(_gl.SCISSOR_TEST)},this.setClearColor=function(color,alpha){_clearColor.set(color),_clearAlpha=void 0!==alpha?alpha:1,_gl.clearColor(_clearColor.r,_clearColor.g,_clearColor.b,_clearAlpha)},this.setClearColorHex=function(hex,alpha){console.warn("THREE.WebGLRenderer: .setClearColorHex() is being removed. Use .setClearColor() instead."),this.setClearColor(hex,alpha)},this.getClearColor=function(){return _clearColor},this.getClearAlpha=function(){return _clearAlpha},this.clear=function(color,depth,stencil){var bits=0;(void 0===color||color)&&(bits|=_gl.COLOR_BUFFER_BIT),(void 0===depth||depth)&&(bits|=_gl.DEPTH_BUFFER_BIT),(void 0===stencil||stencil)&&(bits|=_gl.STENCIL_BUFFER_BIT),_gl.clear(bits)},this.clearColor=function(){_gl.clear(_gl.COLOR_BUFFER_BIT)},this.clearDepth=function(){_gl.clear(_gl.DEPTH_BUFFER_BIT)},this.clearStencil=function(){_gl.clear(_gl.STENCIL_BUFFER_BIT)},this.clearTarget=function(renderTarget,color,depth,stencil){this.setRenderTarget(renderTarget),this.clear(color,depth,stencil)},this.addPostPlugin=function(plugin){plugin.init(this),this.renderPluginsPost.push(plugin)},this.addPrePlugin=function(plugin){plugin.init(this),this.renderPluginsPre.push(plugin)},this.updateShadowMap=function(scene,camera){_currentProgram=null,_oldBlending=-1,_oldDepthTest=-1,_oldDepthWrite=-1,_currentGeometryGroupHash=-1,_currentMaterialId=-1,_lightsNeedUpdate=!0,_oldDoubleSided=-1,_oldFlipSided=-1,initObjects(scene),this.shadowMapPlugin.update(scene,camera)};var onGeometryDispose=function(event){var geometry=event.target;geometry.removeEventListener("dispose",onGeometryDispose),deallocateGeometry(geometry)},onTextureDispose=function(event){var texture=event.target;texture.removeEventListener("dispose",onTextureDispose),deallocateTexture(texture),_this.info.memory.textures--},onRenderTargetDispose=function(event){var renderTarget=event.target;renderTarget.removeEventListener("dispose",onRenderTargetDispose),deallocateRenderTarget(renderTarget),_this.info.memory.textures--},onMaterialDispose=function(event){var material=event.target;material.removeEventListener("dispose",onMaterialDispose),deallocateMaterial(material)},deleteBuffers=function(geometry){if(void 0!==geometry.__webglVertexBuffer&&_gl.deleteBuffer(geometry.__webglVertexBuffer),void 0!==geometry.__webglNormalBuffer&&_gl.deleteBuffer(geometry.__webglNormalBuffer),void 0!==geometry.__webglTangentBuffer&&_gl.deleteBuffer(geometry.__webglTangentBuffer),void 0!==geometry.__webglColorBuffer&&_gl.deleteBuffer(geometry.__webglColorBuffer),void 0!==geometry.__webglUVBuffer&&_gl.deleteBuffer(geometry.__webglUVBuffer),void 0!==geometry.__webglUV2Buffer&&_gl.deleteBuffer(geometry.__webglUV2Buffer),void 0!==geometry.__webglSkinIndicesBuffer&&_gl.deleteBuffer(geometry.__webglSkinIndicesBuffer),void 0!==geometry.__webglSkinWeightsBuffer&&_gl.deleteBuffer(geometry.__webglSkinWeightsBuffer),void 0!==geometry.__webglFaceBuffer&&_gl.deleteBuffer(geometry.__webglFaceBuffer),void 0!==geometry.__webglLineBuffer&&_gl.deleteBuffer(geometry.__webglLineBuffer),void 0!==geometry.__webglLineDistanceBuffer&&_gl.deleteBuffer(geometry.__webglLineDistanceBuffer),void 0!==geometry.__webglCustomAttributesList)for(var id in geometry.__webglCustomAttributesList)_gl.deleteBuffer(geometry.__webglCustomAttributesList[id].buffer);_this.info.memory.geometries--},deallocateGeometry=function(geometry){if(geometry.__webglInit=void 0,geometry instanceof THREE.BufferGeometry){var attributes=geometry.attributes;for(var key in attributes)void 0!==attributes[key].buffer&&_gl.deleteBuffer(attributes[key].buffer);_this.info.memory.geometries--}else if(void 0!==geometry.geometryGroups)for(var i=0,l=geometry.geometryGroupsList.length;l>i;i++){var geometryGroup=geometry.geometryGroupsList[i];if(void 0!==geometryGroup.numMorphTargets)for(var m=0,ml=geometryGroup.numMorphTargets;ml>m;m++)_gl.deleteBuffer(geometryGroup.__webglMorphTargetsBuffers[m]);if(void 0!==geometryGroup.numMorphNormals)for(var m=0,ml=geometryGroup.numMorphNormals;ml>m;m++)_gl.deleteBuffer(geometryGroup.__webglMorphNormalsBuffers[m]);deleteBuffers(geometryGroup)}else deleteBuffers(geometry)},deallocateTexture=function(texture){if(texture.image&&texture.image.__webglTextureCube)_gl.deleteTexture(texture.image.__webglTextureCube);else{if(!texture.__webglInit)return;texture.__webglInit=!1,_gl.deleteTexture(texture.__webglTexture)}},deallocateRenderTarget=function(renderTarget){if(renderTarget&&renderTarget.__webglTexture)if(_gl.deleteTexture(renderTarget.__webglTexture),renderTarget instanceof THREE.WebGLRenderTargetCube)for(var i=0;6>i;i++)_gl.deleteFramebuffer(renderTarget.__webglFramebuffer[i]),_gl.deleteRenderbuffer(renderTarget.__webglRenderbuffer[i]);else _gl.deleteFramebuffer(renderTarget.__webglFramebuffer),_gl.deleteRenderbuffer(renderTarget.__webglRenderbuffer)},deallocateMaterial=function(material){var program=material.program.program;if(void 0!==program){material.program=void 0;var i,il,programInfo,deleteProgram=!1;for(i=0,il=_programs.length;il>i;i++)if(programInfo=_programs[i],programInfo.program===program){programInfo.usedTimes--,0===programInfo.usedTimes&&(deleteProgram=!0);break}if(deleteProgram===!0){var newPrograms=[];for(i=0,il=_programs.length;il>i;i++)programInfo=_programs[i],programInfo.program!==program&&newPrograms.push(programInfo);_programs=newPrograms,_gl.deleteProgram(program),_this.info.memory.programs--}}};this.renderBufferImmediate=function(object,program,material){if(initAttributes(),object.hasPositions&&!object.__webglVertexBuffer&&(object.__webglVertexBuffer=_gl.createBuffer()),object.hasNormals&&!object.__webglNormalBuffer&&(object.__webglNormalBuffer=_gl.createBuffer()),object.hasUvs&&!object.__webglUvBuffer&&(object.__webglUvBuffer=_gl.createBuffer()),object.hasColors&&!object.__webglColorBuffer&&(object.__webglColorBuffer=_gl.createBuffer()),object.hasPositions&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,object.__webglVertexBuffer),_gl.bufferData(_gl.ARRAY_BUFFER,object.positionArray,_gl.DYNAMIC_DRAW),enableAttribute(program.attributes.position),_gl.vertexAttribPointer(program.attributes.position,3,_gl.FLOAT,!1,0,0)),object.hasNormals){if(_gl.bindBuffer(_gl.ARRAY_BUFFER,object.__webglNormalBuffer),material.shading===THREE.FlatShading){var nx,ny,nz,nax,nbx,ncx,nay,nby,ncy,naz,nbz,ncz,normalArray,i,il=3*object.count;for(i=0;il>i;i+=9)normalArray=object.normalArray,nax=normalArray[i],nay=normalArray[i+1],naz=normalArray[i+2],nbx=normalArray[i+3],nby=normalArray[i+4],nbz=normalArray[i+5],ncx=normalArray[i+6],ncy=normalArray[i+7],ncz=normalArray[i+8],nx=(nax+nbx+ncx)/3,ny=(nay+nby+ncy)/3,nz=(naz+nbz+ncz)/3,normalArray[i]=nx,normalArray[i+1]=ny,normalArray[i+2]=nz,normalArray[i+3]=nx,normalArray[i+4]=ny,normalArray[i+5]=nz,normalArray[i+6]=nx,normalArray[i+7]=ny,normalArray[i+8]=nz}_gl.bufferData(_gl.ARRAY_BUFFER,object.normalArray,_gl.DYNAMIC_DRAW),enableAttribute(program.attributes.normal),_gl.vertexAttribPointer(program.attributes.normal,3,_gl.FLOAT,!1,0,0)}object.hasUvs&&material.map&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,object.__webglUvBuffer),_gl.bufferData(_gl.ARRAY_BUFFER,object.uvArray,_gl.DYNAMIC_DRAW),enableAttribute(program.attributes.uv),_gl.vertexAttribPointer(program.attributes.uv,2,_gl.FLOAT,!1,0,0)),object.hasColors&&material.vertexColors!==THREE.NoColors&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,object.__webglColorBuffer),_gl.bufferData(_gl.ARRAY_BUFFER,object.colorArray,_gl.DYNAMIC_DRAW),enableAttribute(program.attributes.color),_gl.vertexAttribPointer(program.attributes.color,3,_gl.FLOAT,!1,0,0)),disableUnusedAttributes(),_gl.drawArrays(_gl.TRIANGLES,0,object.count),object.count=0},this.renderBufferDirect=function(camera,lights,fog,material,geometry,object){if(material.visible!==!1){var program=setProgram(camera,lights,fog,material,object),programAttributes=program.attributes,geometryAttributes=geometry.attributes,updateBuffers=!1,wireframeBit=material.wireframe?1:0,geometryHash=16777215*geometry.id+2*program.id+wireframeBit;if(geometryHash!==_currentGeometryGroupHash&&(_currentGeometryGroupHash=geometryHash,updateBuffers=!0),updateBuffers&&initAttributes(),object instanceof THREE.Mesh){var index=geometryAttributes.index;if(index){var type,size;index.array instanceof Uint32Array?(type=_gl.UNSIGNED_INT,size=4):(type=_gl.UNSIGNED_SHORT,size=2);var offsets=geometry.offsets;if(0===offsets.length)updateBuffers&&(setupVertexAttributes(material,programAttributes,geometryAttributes,0),_gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER,index.buffer)),_gl.drawElements(_gl.TRIANGLES,index.array.length,type,0),_this.info.render.calls++,_this.info.render.vertices+=index.array.length,_this.info.render.faces+=index.array.length/3;else{updateBuffers=!0;for(var i=0,il=offsets.length;il>i;i++){var startIndex=offsets[i].index;updateBuffers&&(setupVertexAttributes(material,programAttributes,geometryAttributes,startIndex),_gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER,index.buffer)),_gl.drawElements(_gl.TRIANGLES,offsets[i].count,type,offsets[i].start*size),_this.info.render.calls++,_this.info.render.vertices+=offsets[i].count,_this.info.render.faces+=offsets[i].count/3}}}else{updateBuffers&&setupVertexAttributes(material,programAttributes,geometryAttributes,0);var position=geometry.attributes.position;_gl.drawArrays(_gl.TRIANGLES,0,position.array.length/3),_this.info.render.calls++,_this.info.render.vertices+=position.array.length/3,_this.info.render.faces+=position.array.length/9}}else if(object instanceof THREE.PointCloud){updateBuffers&&setupVertexAttributes(material,programAttributes,geometryAttributes,0);var position=geometryAttributes.position;_gl.drawArrays(_gl.POINTS,0,position.array.length/3),_this.info.render.calls++,_this.info.render.points+=position.array.length/3}else if(object instanceof THREE.Line){var mode=object.type===THREE.LineStrip?_gl.LINE_STRIP:_gl.LINES;setLineWidth(material.linewidth);var index=geometryAttributes.index;if(index){var type,size;index.array instanceof Uint32Array?(type=_gl.UNSIGNED_INT,size=4):(type=_gl.UNSIGNED_SHORT,size=2);var offsets=geometry.offsets;if(0===offsets.length)updateBuffers&&(setupVertexAttributes(material,programAttributes,geometryAttributes,0),_gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER,index.buffer)),_gl.drawElements(mode,index.array.length,type,0),_this.info.render.calls++,_this.info.render.vertices+=index.array.length;else{offsets.length>1&&(updateBuffers=!0);for(var i=0,il=offsets.length;il>i;i++){var startIndex=offsets[i].index;updateBuffers&&(setupVertexAttributes(material,programAttributes,geometryAttributes,startIndex),_gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER,index.buffer)),_gl.drawElements(mode,offsets[i].count,type,offsets[i].start*size),_this.info.render.calls++,_this.info.render.vertices+=offsets[i].count}}}else{updateBuffers&&setupVertexAttributes(material,programAttributes,geometryAttributes,0);var position=geometryAttributes.position;_gl.drawArrays(mode,0,position.array.length/3),_this.info.render.calls++,_this.info.render.points+=position.array.length/3}}}},this.renderBuffer=function(camera,lights,fog,material,geometryGroup,object){if(material.visible!==!1){var attribute,i,il,program=setProgram(camera,lights,fog,material,object),attributes=program.attributes,updateBuffers=!1,wireframeBit=material.wireframe?1:0,geometryGroupHash=16777215*geometryGroup.id+2*program.id+wireframeBit;if(geometryGroupHash!==_currentGeometryGroupHash&&(_currentGeometryGroupHash=geometryGroupHash,updateBuffers=!0),updateBuffers&&initAttributes(),!material.morphTargets&&attributes.position>=0?updateBuffers&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglVertexBuffer),enableAttribute(attributes.position),_gl.vertexAttribPointer(attributes.position,3,_gl.FLOAT,!1,0,0)):object.morphTargetBase&&setupMorphTargets(material,geometryGroup,object),updateBuffers){if(geometryGroup.__webglCustomAttributesList)for(i=0,il=geometryGroup.__webglCustomAttributesList.length;il>i;i++)attribute=geometryGroup.__webglCustomAttributesList[i],attributes[attribute.buffer.belongsToAttribute]>=0&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,attribute.buffer),enableAttribute(attributes[attribute.buffer.belongsToAttribute]),_gl.vertexAttribPointer(attributes[attribute.buffer.belongsToAttribute],attribute.size,_gl.FLOAT,!1,0,0));attributes.color>=0&&(object.geometry.colors.length>0||object.geometry.faces.length>0?(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglColorBuffer),enableAttribute(attributes.color),_gl.vertexAttribPointer(attributes.color,3,_gl.FLOAT,!1,0,0)):material.defaultAttributeValues&&_gl.vertexAttrib3fv(attributes.color,material.defaultAttributeValues.color)),attributes.normal>=0&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglNormalBuffer),enableAttribute(attributes.normal),_gl.vertexAttribPointer(attributes.normal,3,_gl.FLOAT,!1,0,0)),attributes.tangent>=0&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglTangentBuffer),enableAttribute(attributes.tangent),_gl.vertexAttribPointer(attributes.tangent,4,_gl.FLOAT,!1,0,0)),attributes.uv>=0&&(object.geometry.faceVertexUvs[0]?(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglUVBuffer),enableAttribute(attributes.uv),_gl.vertexAttribPointer(attributes.uv,2,_gl.FLOAT,!1,0,0)):material.defaultAttributeValues&&_gl.vertexAttrib2fv(attributes.uv,material.defaultAttributeValues.uv)),attributes.uv2>=0&&(object.geometry.faceVertexUvs[1]?(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglUV2Buffer),enableAttribute(attributes.uv2),_gl.vertexAttribPointer(attributes.uv2,2,_gl.FLOAT,!1,0,0)):material.defaultAttributeValues&&_gl.vertexAttrib2fv(attributes.uv2,material.defaultAttributeValues.uv2)),material.skinning&&attributes.skinIndex>=0&&attributes.skinWeight>=0&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglSkinIndicesBuffer),enableAttribute(attributes.skinIndex),_gl.vertexAttribPointer(attributes.skinIndex,4,_gl.FLOAT,!1,0,0),_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglSkinWeightsBuffer),enableAttribute(attributes.skinWeight),_gl.vertexAttribPointer(attributes.skinWeight,4,_gl.FLOAT,!1,0,0)),attributes.lineDistance>=0&&(_gl.bindBuffer(_gl.ARRAY_BUFFER,geometryGroup.__webglLineDistanceBuffer),enableAttribute(attributes.lineDistance),_gl.vertexAttribPointer(attributes.lineDistance,1,_gl.FLOAT,!1,0,0))}if(disableUnusedAttributes(),object instanceof THREE.Mesh){var type=geometryGroup.__typeArray===Uint32Array?_gl.UNSIGNED_INT:_gl.UNSIGNED_SHORT;material.wireframe?(setLineWidth(material.wireframeLinewidth),updateBuffers&&_gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER,geometryGroup.__webglLineBuffer),_gl.drawElements(_gl.LINES,geometryGroup.__webglLineCount,type,0)):(updateBuffers&&_gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER,geometryGroup.__webglFaceBuffer),_gl.drawElements(_gl.TRIANGLES,geometryGroup.__webglFaceCount,type,0)),_this.info.render.calls++,_this.info.render.vertices+=geometryGroup.__webglFaceCount,_this.info.render.faces+=geometryGroup.__webglFaceCount/3}else if(object instanceof THREE.Line){var mode=object.type===THREE.LineStrip?_gl.LINE_STRIP:_gl.LINES;setLineWidth(material.linewidth),_gl.drawArrays(mode,0,geometryGroup.__webglLineCount),_this.info.render.calls++}else object instanceof THREE.PointCloud&&(_gl.drawArrays(_gl.POINTS,0,geometryGroup.__webglParticleCount),_this.info.render.calls++,_this.info.render.points+=geometryGroup.__webglParticleCount)}},this.render=function(scene,camera,renderTarget,forceClear){function updateSkeletons(object){object instanceof THREE.SkinnedMesh&&object.skeleton.update();for(var i=0,l=object.children.length;l>i;i++)updateSkeletons(object.children[i])}if(camera instanceof THREE.Camera==!1)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");var i,il,webglObject,object,renderList,lights=scene.__lights,fog=scene.fog;for(_currentMaterialId=-1,_currentCamera=null,_lightsNeedUpdate=!0,scene.autoUpdate===!0&&scene.updateMatrixWorld(),void 0===camera.parent&&camera.updateMatrixWorld(),updateSkeletons(scene),camera.matrixWorldInverse.getInverse(camera.matrixWorld),_projScreenMatrix.multiplyMatrices(camera.projectionMatrix,camera.matrixWorldInverse),_frustum.setFromMatrix(_projScreenMatrix),initObjects(scene),opaqueObjects.length=0,transparentObjects.length=0,projectObject(scene,scene,camera),_this.sortObjects===!0&&(opaqueObjects.sort(painterSortStable),transparentObjects.sort(reversePainterSortStable)),renderPlugins(this.renderPluginsPre,scene,camera),_this.info.render.calls=0,_this.info.render.vertices=0,_this.info.render.faces=0,_this.info.render.points=0,this.setRenderTarget(renderTarget),(this.autoClear||forceClear)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),renderList=scene.__webglObjectsImmediate,i=0,il=renderList.length;il>i;i++)webglObject=renderList[i],object=webglObject.object,object.visible&&(setupMatrices(object,camera),unrollImmediateBufferMaterial(webglObject));if(scene.overrideMaterial){var material=scene.overrideMaterial;this.setBlending(material.blending,material.blendEquation,material.blendSrc,material.blendDst),this.setDepthTest(material.depthTest),this.setDepthWrite(material.depthWrite),setPolygonOffset(material.polygonOffset,material.polygonOffsetFactor,material.polygonOffsetUnits),renderObjects(opaqueObjects,camera,lights,fog,!0,material),renderObjects(transparentObjects,camera,lights,fog,!0,material),renderObjectsImmediate(scene.__webglObjectsImmediate,"",camera,lights,fog,!1,material)}else{var material=null;this.setBlending(THREE.NoBlending),renderObjects(opaqueObjects,camera,lights,fog,!1,material),renderObjectsImmediate(scene.__webglObjectsImmediate,"opaque",camera,lights,fog,!1,material),renderObjects(transparentObjects,camera,lights,fog,!0,material),renderObjectsImmediate(scene.__webglObjectsImmediate,"transparent",camera,lights,fog,!0,material)}renderPlugins(this.renderPluginsPost,scene,camera),renderTarget&&renderTarget.generateMipmaps&&renderTarget.minFilter!==THREE.NearestFilter&&renderTarget.minFilter!==THREE.LinearFilter&&updateRenderTargetMipmap(renderTarget),this.setDepthTest(!0),this.setDepthWrite(!0)},this.renderImmediateObject=function(camera,lights,fog,material,object){var program=setProgram(camera,lights,fog,material,object);_currentGeometryGroupHash=-1,_this.setMaterialFaces(material),object.immediateRenderCallback?object.immediateRenderCallback(program,_gl,_frustum):object.render(function(object){_this.renderBufferImmediate(object,program,material)})};var initObjects=function(scene){for(scene.__webglObjects||(scene.__webglObjects={},scene.__webglObjectsImmediate=[]);scene.__objectsAdded.length;)addObject(scene.__objectsAdded[0],scene),scene.__objectsAdded.splice(0,1);for(;scene.__objectsRemoved.length;)removeObject(scene.__objectsRemoved[0],scene),scene.__objectsRemoved.splice(0,1)};this.initMaterial=function(material,lights,fog,object){material.addEventListener("dispose",onMaterialDispose);var u,i,parameters,maxLightCount,maxBones,maxShadows,shaderID;if(material instanceof THREE.MeshDepthMaterial?shaderID="depth":material instanceof THREE.MeshNormalMaterial?shaderID="normal":material instanceof THREE.MeshBasicMaterial?shaderID="basic":material instanceof THREE.MeshLambertMaterial?shaderID="lambert":material instanceof THREE.MeshPhongMaterial?shaderID="phong":material instanceof THREE.LineBasicMaterial?shaderID="basic":material instanceof THREE.LineDashedMaterial?shaderID="dashed":material instanceof THREE.PointCloudMaterial&&(shaderID="particle_basic"),shaderID){var shader=THREE.ShaderLib[shaderID];material.__webglShader={uniforms:THREE.UniformsUtils.clone(shader.uniforms),vertexShader:shader.vertexShader,fragmentShader:shader.fragmentShader}}else material.__webglShader={uniforms:material.uniforms,vertexShader:material.vertexShader,fragmentShader:material.fragmentShader};
maxLightCount=allocateLights(lights),maxShadows=allocateShadows(lights),maxBones=allocateBones(object),parameters={precision:_precision,supportsVertexTextures:_supportsVertexTextures,map:!!material.map,envMap:!!material.envMap,lightMap:!!material.lightMap,bumpMap:!!material.bumpMap,normalMap:!!material.normalMap,specularMap:!!material.specularMap,alphaMap:!!material.alphaMap,vertexColors:material.vertexColors,fog:fog,useFog:material.fog,fogExp:fog instanceof THREE.FogExp2,sizeAttenuation:material.sizeAttenuation,logarithmicDepthBuffer:_logarithmicDepthBuffer,skinning:material.skinning,maxBones:maxBones,useVertexTexture:_supportsBoneTextures&&object&&object.skeleton&&object.skeleton.useVertexTexture,morphTargets:material.morphTargets,morphNormals:material.morphNormals,maxMorphTargets:this.maxMorphTargets,maxMorphNormals:this.maxMorphNormals,maxDirLights:maxLightCount.directional,maxPointLights:maxLightCount.point,maxSpotLights:maxLightCount.spot,maxHemiLights:maxLightCount.hemi,maxShadows:maxShadows,shadowMapEnabled:this.shadowMapEnabled&&object.receiveShadow&&maxShadows>0,shadowMapType:this.shadowMapType,shadowMapDebug:this.shadowMapDebug,shadowMapCascade:this.shadowMapCascade,alphaTest:material.alphaTest,metal:material.metal,wrapAround:material.wrapAround,doubleSided:material.side===THREE.DoubleSide,flipSided:material.side===THREE.BackSide};var chunks=[];shaderID?chunks.push(shaderID):(chunks.push(material.fragmentShader),chunks.push(material.vertexShader));for(var d in material.defines)chunks.push(d),chunks.push(material.defines[d]);for(var p in parameters)chunks.push(p),chunks.push(parameters[p]);for(var program,code=chunks.join(),p=0,pl=_programs.length;pl>p;p++){var programInfo=_programs[p];if(programInfo.code===code){program=programInfo,program.usedTimes++;break}}void 0===program&&(program=new THREE.WebGLProgram(this,code,material,parameters),_programs.push(program),_this.info.memory.programs=_programs.length),material.program=program;var attributes=material.program.attributes;if(material.morphTargets){material.numSupportedMorphTargets=0;var id,base="morphTarget";for(i=0;i<this.maxMorphTargets;i++)id=base+i,attributes[id]>=0&&material.numSupportedMorphTargets++}if(material.morphNormals){material.numSupportedMorphNormals=0;var id,base="morphNormal";for(i=0;i<this.maxMorphNormals;i++)id=base+i,attributes[id]>=0&&material.numSupportedMorphNormals++}material.uniformsList=[];for(u in material.__webglShader.uniforms){var location=material.program.uniforms[u];location&&material.uniformsList.push([material.__webglShader.uniforms[u],location])}},this.setFaceCulling=function(cullFace,frontFaceDirection){cullFace===THREE.CullFaceNone?_gl.disable(_gl.CULL_FACE):(_gl.frontFace(frontFaceDirection===THREE.FrontFaceDirectionCW?_gl.CW:_gl.CCW),_gl.cullFace(cullFace===THREE.CullFaceBack?_gl.BACK:cullFace===THREE.CullFaceFront?_gl.FRONT:_gl.FRONT_AND_BACK),_gl.enable(_gl.CULL_FACE))},this.setMaterialFaces=function(material){var doubleSided=material.side===THREE.DoubleSide,flipSided=material.side===THREE.BackSide;_oldDoubleSided!==doubleSided&&(doubleSided?_gl.disable(_gl.CULL_FACE):_gl.enable(_gl.CULL_FACE),_oldDoubleSided=doubleSided),_oldFlipSided!==flipSided&&(_gl.frontFace(flipSided?_gl.CW:_gl.CCW),_oldFlipSided=flipSided)},this.setDepthTest=function(depthTest){_oldDepthTest!==depthTest&&(depthTest?_gl.enable(_gl.DEPTH_TEST):_gl.disable(_gl.DEPTH_TEST),_oldDepthTest=depthTest)},this.setDepthWrite=function(depthWrite){_oldDepthWrite!==depthWrite&&(_gl.depthMask(depthWrite),_oldDepthWrite=depthWrite)},this.setBlending=function(blending,blendEquation,blendSrc,blendDst){blending!==_oldBlending&&(blending===THREE.NoBlending?_gl.disable(_gl.BLEND):blending===THREE.AdditiveBlending?(_gl.enable(_gl.BLEND),_gl.blendEquation(_gl.FUNC_ADD),_gl.blendFunc(_gl.SRC_ALPHA,_gl.ONE)):blending===THREE.SubtractiveBlending?(_gl.enable(_gl.BLEND),_gl.blendEquation(_gl.FUNC_ADD),_gl.blendFunc(_gl.ZERO,_gl.ONE_MINUS_SRC_COLOR)):blending===THREE.MultiplyBlending?(_gl.enable(_gl.BLEND),_gl.blendEquation(_gl.FUNC_ADD),_gl.blendFunc(_gl.ZERO,_gl.SRC_COLOR)):blending===THREE.CustomBlending?_gl.enable(_gl.BLEND):(_gl.enable(_gl.BLEND),_gl.blendEquationSeparate(_gl.FUNC_ADD,_gl.FUNC_ADD),_gl.blendFuncSeparate(_gl.SRC_ALPHA,_gl.ONE_MINUS_SRC_ALPHA,_gl.ONE,_gl.ONE_MINUS_SRC_ALPHA)),_oldBlending=blending),blending===THREE.CustomBlending?(blendEquation!==_oldBlendEquation&&(_gl.blendEquation(paramThreeToGL(blendEquation)),_oldBlendEquation=blendEquation),(blendSrc!==_oldBlendSrc||blendDst!==_oldBlendDst)&&(_gl.blendFunc(paramThreeToGL(blendSrc),paramThreeToGL(blendDst)),_oldBlendSrc=blendSrc,_oldBlendDst=blendDst)):(_oldBlendEquation=null,_oldBlendSrc=null,_oldBlendDst=null)},this.setTexture=function(texture,slot){if(texture.needsUpdate){texture.__webglInit||(texture.__webglInit=!0,texture.addEventListener("dispose",onTextureDispose),texture.__webglTexture=_gl.createTexture(),_this.info.memory.textures++),_gl.activeTexture(_gl.TEXTURE0+slot),_gl.bindTexture(_gl.TEXTURE_2D,texture.__webglTexture),_gl.pixelStorei(_gl.UNPACK_FLIP_Y_WEBGL,texture.flipY),_gl.pixelStorei(_gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,texture.premultiplyAlpha),_gl.pixelStorei(_gl.UNPACK_ALIGNMENT,texture.unpackAlignment);var image=texture.image,isImagePowerOfTwo=THREE.Math.isPowerOfTwo(image.width)&&THREE.Math.isPowerOfTwo(image.height),glFormat=paramThreeToGL(texture.format),glType=paramThreeToGL(texture.type);setTextureParameters(_gl.TEXTURE_2D,texture,isImagePowerOfTwo);var mipmap,mipmaps=texture.mipmaps;if(texture instanceof THREE.DataTexture)if(mipmaps.length>0&&isImagePowerOfTwo){for(var i=0,il=mipmaps.length;il>i;i++)mipmap=mipmaps[i],_gl.texImage2D(_gl.TEXTURE_2D,i,glFormat,mipmap.width,mipmap.height,0,glFormat,glType,mipmap.data);texture.generateMipmaps=!1}else _gl.texImage2D(_gl.TEXTURE_2D,0,glFormat,image.width,image.height,0,glFormat,glType,image.data);else if(texture instanceof THREE.CompressedTexture)for(var i=0,il=mipmaps.length;il>i;i++)mipmap=mipmaps[i],texture.format!==THREE.RGBAFormat?_gl.compressedTexImage2D(_gl.TEXTURE_2D,i,glFormat,mipmap.width,mipmap.height,0,mipmap.data):_gl.texImage2D(_gl.TEXTURE_2D,i,glFormat,mipmap.width,mipmap.height,0,glFormat,glType,mipmap.data);else if(mipmaps.length>0&&isImagePowerOfTwo){for(var i=0,il=mipmaps.length;il>i;i++)mipmap=mipmaps[i],_gl.texImage2D(_gl.TEXTURE_2D,i,glFormat,glFormat,glType,mipmap);texture.generateMipmaps=!1}else _gl.texImage2D(_gl.TEXTURE_2D,0,glFormat,glFormat,glType,texture.image);texture.generateMipmaps&&isImagePowerOfTwo&&_gl.generateMipmap(_gl.TEXTURE_2D),texture.needsUpdate=!1,texture.onUpdate&&texture.onUpdate()}else _gl.activeTexture(_gl.TEXTURE0+slot),_gl.bindTexture(_gl.TEXTURE_2D,texture.__webglTexture)},this.setRenderTarget=function(renderTarget){var isCube=renderTarget instanceof THREE.WebGLRenderTargetCube;if(renderTarget&&!renderTarget.__webglFramebuffer){void 0===renderTarget.depthBuffer&&(renderTarget.depthBuffer=!0),void 0===renderTarget.stencilBuffer&&(renderTarget.stencilBuffer=!0),renderTarget.addEventListener("dispose",onRenderTargetDispose),renderTarget.__webglTexture=_gl.createTexture(),_this.info.memory.textures++;var isTargetPowerOfTwo=THREE.Math.isPowerOfTwo(renderTarget.width)&&THREE.Math.isPowerOfTwo(renderTarget.height),glFormat=paramThreeToGL(renderTarget.format),glType=paramThreeToGL(renderTarget.type);if(isCube){renderTarget.__webglFramebuffer=[],renderTarget.__webglRenderbuffer=[],_gl.bindTexture(_gl.TEXTURE_CUBE_MAP,renderTarget.__webglTexture),setTextureParameters(_gl.TEXTURE_CUBE_MAP,renderTarget,isTargetPowerOfTwo);for(var i=0;6>i;i++)renderTarget.__webglFramebuffer[i]=_gl.createFramebuffer(),renderTarget.__webglRenderbuffer[i]=_gl.createRenderbuffer(),_gl.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,glFormat,renderTarget.width,renderTarget.height,0,glFormat,glType,null),setupFrameBuffer(renderTarget.__webglFramebuffer[i],renderTarget,_gl.TEXTURE_CUBE_MAP_POSITIVE_X+i),setupRenderBuffer(renderTarget.__webglRenderbuffer[i],renderTarget);isTargetPowerOfTwo&&_gl.generateMipmap(_gl.TEXTURE_CUBE_MAP)}else renderTarget.__webglFramebuffer=_gl.createFramebuffer(),renderTarget.__webglRenderbuffer=renderTarget.shareDepthFrom?renderTarget.shareDepthFrom.__webglRenderbuffer:_gl.createRenderbuffer(),_gl.bindTexture(_gl.TEXTURE_2D,renderTarget.__webglTexture),setTextureParameters(_gl.TEXTURE_2D,renderTarget,isTargetPowerOfTwo),_gl.texImage2D(_gl.TEXTURE_2D,0,glFormat,renderTarget.width,renderTarget.height,0,glFormat,glType,null),setupFrameBuffer(renderTarget.__webglFramebuffer,renderTarget,_gl.TEXTURE_2D),renderTarget.shareDepthFrom?renderTarget.depthBuffer&&!renderTarget.stencilBuffer?_gl.framebufferRenderbuffer(_gl.FRAMEBUFFER,_gl.DEPTH_ATTACHMENT,_gl.RENDERBUFFER,renderTarget.__webglRenderbuffer):renderTarget.depthBuffer&&renderTarget.stencilBuffer&&_gl.framebufferRenderbuffer(_gl.FRAMEBUFFER,_gl.DEPTH_STENCIL_ATTACHMENT,_gl.RENDERBUFFER,renderTarget.__webglRenderbuffer):setupRenderBuffer(renderTarget.__webglRenderbuffer,renderTarget),isTargetPowerOfTwo&&_gl.generateMipmap(_gl.TEXTURE_2D);isCube?_gl.bindTexture(_gl.TEXTURE_CUBE_MAP,null):_gl.bindTexture(_gl.TEXTURE_2D,null),_gl.bindRenderbuffer(_gl.RENDERBUFFER,null),_gl.bindFramebuffer(_gl.FRAMEBUFFER,null)}var framebuffer,width,height,vx,vy;renderTarget?(framebuffer=isCube?renderTarget.__webglFramebuffer[renderTarget.activeCubeFace]:renderTarget.__webglFramebuffer,width=renderTarget.width,height=renderTarget.height,vx=0,vy=0):(framebuffer=null,width=_viewportWidth,height=_viewportHeight,vx=_viewportX,vy=_viewportY),framebuffer!==_currentFramebuffer&&(_gl.bindFramebuffer(_gl.FRAMEBUFFER,framebuffer),_gl.viewport(vx,vy,width,height),_currentFramebuffer=framebuffer),_currentWidth=width,_currentHeight=height},this.shadowMapPlugin=new THREE.ShadowMapPlugin,this.addPrePlugin(this.shadowMapPlugin),this.addPostPlugin(new THREE.SpritePlugin),this.addPostPlugin(new THREE.LensFlarePlugin)},THREE.WebGLRenderTarget=function(width,height,options){this.width=width,this.height=height,options=options||{},this.wrapS=void 0!==options.wrapS?options.wrapS:THREE.ClampToEdgeWrapping,this.wrapT=void 0!==options.wrapT?options.wrapT:THREE.ClampToEdgeWrapping,this.magFilter=void 0!==options.magFilter?options.magFilter:THREE.LinearFilter,this.minFilter=void 0!==options.minFilter?options.minFilter:THREE.LinearMipMapLinearFilter,this.anisotropy=void 0!==options.anisotropy?options.anisotropy:1,this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(1,1),this.format=void 0!==options.format?options.format:THREE.RGBAFormat,this.type=void 0!==options.type?options.type:THREE.UnsignedByteType,this.depthBuffer=void 0!==options.depthBuffer?options.depthBuffer:!0,this.stencilBuffer=void 0!==options.stencilBuffer?options.stencilBuffer:!0,this.generateMipmaps=!0,this.shareDepthFrom=null},THREE.WebGLRenderTarget.prototype={constructor:THREE.WebGLRenderTarget,setSize:function(width,height){this.width=width,this.height=height},clone:function(){var tmp=new THREE.WebGLRenderTarget(this.width,this.height);return tmp.wrapS=this.wrapS,tmp.wrapT=this.wrapT,tmp.magFilter=this.magFilter,tmp.minFilter=this.minFilter,tmp.anisotropy=this.anisotropy,tmp.offset.copy(this.offset),tmp.repeat.copy(this.repeat),tmp.format=this.format,tmp.type=this.type,tmp.depthBuffer=this.depthBuffer,tmp.stencilBuffer=this.stencilBuffer,tmp.generateMipmaps=this.generateMipmaps,tmp.shareDepthFrom=this.shareDepthFrom,tmp},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.EventDispatcher.prototype.apply(THREE.WebGLRenderTarget.prototype),THREE.WebGLRenderTargetCube=function(width,height,options){THREE.WebGLRenderTarget.call(this,width,height,options),this.activeCubeFace=0},THREE.WebGLRenderTargetCube.prototype=Object.create(THREE.WebGLRenderTarget.prototype),THREE.WebGLProgram=function(){var programIdCount=0,generateDefines=function(defines){var value,chunk,chunks=[];for(var d in defines)value=defines[d],value!==!1&&(chunk="#define "+d+" "+value,chunks.push(chunk));return chunks.join("\n")},cacheUniformLocations=function(gl,program,identifiers){for(var uniforms={},i=0,l=identifiers.length;l>i;i++){var id=identifiers[i];uniforms[id]=gl.getUniformLocation(program,id)}return uniforms},cacheAttributeLocations=function(gl,program,identifiers){for(var attributes={},i=0,l=identifiers.length;l>i;i++){var id=identifiers[i];attributes[id]=gl.getAttribLocation(program,id)}return attributes};return function(renderer,code,material,parameters){var _this=renderer,_gl=_this.context,defines=material.defines,uniforms=material.__webglShader.uniforms,attributes=material.attributes,vertexShader=material.__webglShader.vertexShader,fragmentShader=material.__webglShader.fragmentShader,index0AttributeName=material.index0AttributeName;void 0===index0AttributeName&&parameters.morphTargets===!0&&(index0AttributeName="position");var shadowMapTypeDefine="SHADOWMAP_TYPE_BASIC";parameters.shadowMapType===THREE.PCFShadowMap?shadowMapTypeDefine="SHADOWMAP_TYPE_PCF":parameters.shadowMapType===THREE.PCFSoftShadowMap&&(shadowMapTypeDefine="SHADOWMAP_TYPE_PCF_SOFT");var prefix_vertex,prefix_fragment,customDefines=generateDefines(defines),program=_gl.createProgram();material instanceof THREE.RawShaderMaterial?(prefix_vertex="",prefix_fragment=""):(prefix_vertex=["precision "+parameters.precision+" float;","precision "+parameters.precision+" int;",customDefines,parameters.supportsVertexTextures?"#define VERTEX_TEXTURES":"",_this.gammaInput?"#define GAMMA_INPUT":"",_this.gammaOutput?"#define GAMMA_OUTPUT":"","#define MAX_DIR_LIGHTS "+parameters.maxDirLights,"#define MAX_POINT_LIGHTS "+parameters.maxPointLights,"#define MAX_SPOT_LIGHTS "+parameters.maxSpotLights,"#define MAX_HEMI_LIGHTS "+parameters.maxHemiLights,"#define MAX_SHADOWS "+parameters.maxShadows,"#define MAX_BONES "+parameters.maxBones,parameters.map?"#define USE_MAP":"",parameters.envMap?"#define USE_ENVMAP":"",parameters.lightMap?"#define USE_LIGHTMAP":"",parameters.bumpMap?"#define USE_BUMPMAP":"",parameters.normalMap?"#define USE_NORMALMAP":"",parameters.specularMap?"#define USE_SPECULARMAP":"",parameters.alphaMap?"#define USE_ALPHAMAP":"",parameters.vertexColors?"#define USE_COLOR":"",parameters.skinning?"#define USE_SKINNING":"",parameters.useVertexTexture?"#define BONE_TEXTURE":"",parameters.morphTargets?"#define USE_MORPHTARGETS":"",parameters.morphNormals?"#define USE_MORPHNORMALS":"",parameters.wrapAround?"#define WRAP_AROUND":"",parameters.doubleSided?"#define DOUBLE_SIDED":"",parameters.flipSided?"#define FLIP_SIDED":"",parameters.shadowMapEnabled?"#define USE_SHADOWMAP":"",parameters.shadowMapEnabled?"#define "+shadowMapTypeDefine:"",parameters.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",parameters.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",parameters.sizeAttenuation?"#define USE_SIZEATTENUATION":"",parameters.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","attribute vec2 uv2;","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",""].join("\n"),prefix_fragment=["precision "+parameters.precision+" float;","precision "+parameters.precision+" int;",parameters.bumpMap||parameters.normalMap?"#extension GL_OES_standard_derivatives : enable":"",customDefines,"#define MAX_DIR_LIGHTS "+parameters.maxDirLights,"#define MAX_POINT_LIGHTS "+parameters.maxPointLights,"#define MAX_SPOT_LIGHTS "+parameters.maxSpotLights,"#define MAX_HEMI_LIGHTS "+parameters.maxHemiLights,"#define MAX_SHADOWS "+parameters.maxShadows,parameters.alphaTest?"#define ALPHATEST "+parameters.alphaTest:"",_this.gammaInput?"#define GAMMA_INPUT":"",_this.gammaOutput?"#define GAMMA_OUTPUT":"",parameters.useFog&&parameters.fog?"#define USE_FOG":"",parameters.useFog&&parameters.fogExp?"#define FOG_EXP2":"",parameters.map?"#define USE_MAP":"",parameters.envMap?"#define USE_ENVMAP":"",parameters.lightMap?"#define USE_LIGHTMAP":"",parameters.bumpMap?"#define USE_BUMPMAP":"",parameters.normalMap?"#define USE_NORMALMAP":"",parameters.specularMap?"#define USE_SPECULARMAP":"",parameters.alphaMap?"#define USE_ALPHAMAP":"",parameters.vertexColors?"#define USE_COLOR":"",parameters.metal?"#define METAL":"",parameters.wrapAround?"#define WRAP_AROUND":"",parameters.doubleSided?"#define DOUBLE_SIDED":"",parameters.flipSided?"#define FLIP_SIDED":"",parameters.shadowMapEnabled?"#define USE_SHADOWMAP":"",parameters.shadowMapEnabled?"#define "+shadowMapTypeDefine:"",parameters.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",parameters.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",parameters.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",""].join("\n"));var glVertexShader=new THREE.WebGLShader(_gl,_gl.VERTEX_SHADER,prefix_vertex+vertexShader),glFragmentShader=new THREE.WebGLShader(_gl,_gl.FRAGMENT_SHADER,prefix_fragment+fragmentShader);_gl.attachShader(program,glVertexShader),_gl.attachShader(program,glFragmentShader),void 0!==index0AttributeName&&_gl.bindAttribLocation(program,0,index0AttributeName),_gl.linkProgram(program),_gl.getProgramParameter(program,_gl.LINK_STATUS)===!1&&(console.error("THREE.WebGLProgram: Could not initialise shader."),console.error("gl.VALIDATE_STATUS",_gl.getProgramParameter(program,_gl.VALIDATE_STATUS)),console.error("gl.getError()",_gl.getError())),""!==_gl.getProgramInfoLog(program)&&console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",_gl.getProgramInfoLog(program)),_gl.deleteShader(glVertexShader),_gl.deleteShader(glFragmentShader);var identifiers=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","modelMatrix","cameraPosition","morphTargetInfluences","bindMatrix","bindMatrixInverse"];parameters.useVertexTexture?(identifiers.push("boneTexture"),identifiers.push("boneTextureWidth"),identifiers.push("boneTextureHeight")):identifiers.push("boneGlobalMatrices"),parameters.logarithmicDepthBuffer&&identifiers.push("logDepthBufFC");for(var u in uniforms)identifiers.push(u);this.uniforms=cacheUniformLocations(_gl,program,identifiers),identifiers=["position","normal","uv","uv2","tangent","color","skinIndex","skinWeight","lineDistance"];for(var i=0;i<parameters.maxMorphTargets;i++)identifiers.push("morphTarget"+i);for(var i=0;i<parameters.maxMorphNormals;i++)identifiers.push("morphNormal"+i);for(var a in attributes)identifiers.push(a);return this.attributes=cacheAttributeLocations(_gl,program,identifiers),this.id=programIdCount++,this.code=code,this.usedTimes=1,this.program=program,this.vertexShader=glVertexShader,this.fragmentShader=glFragmentShader,this}}(),THREE.WebGLShader=function(){var addLineNumbers=function(string){for(var lines=string.split("\n"),i=0;i<lines.length;i++)lines[i]=i+1+": "+lines[i];return lines.join("\n")};return function(gl,type,string){var shader=gl.createShader(type);return gl.shaderSource(shader,string),gl.compileShader(shader),gl.getShaderParameter(shader,gl.COMPILE_STATUS)===!1&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==gl.getShaderInfoLog(shader)&&(console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",gl.getShaderInfoLog(shader)),console.warn(addLineNumbers(string))),shader}}(),THREE.RenderableVertex=function(){this.position=new THREE.Vector3,this.positionWorld=new THREE.Vector3,this.positionScreen=new THREE.Vector4,this.visible=!0},THREE.RenderableVertex.prototype.copy=function(vertex){this.positionWorld.copy(vertex.positionWorld),this.positionScreen.copy(vertex.positionScreen)},THREE.RenderableFace=function(){this.id=0,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.v3=new THREE.RenderableVertex,this.normalModel=new THREE.Vector3,this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.vertexNormalsLength=0,this.color=new THREE.Color,this.material=null,this.uvs=[new THREE.Vector2,new THREE.Vector2,new THREE.Vector2],this.z=0},THREE.RenderableObject=function(){this.id=0,this.object=null,this.z=0},THREE.RenderableSprite=function(){this.id=0,this.object=null,this.x=0,this.y=0,this.z=0,this.rotation=0,this.scale=new THREE.Vector2,this.material=null},THREE.RenderableLine=function(){this.id=0,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.vertexColors=[new THREE.Color,new THREE.Color],this.material=null,this.z=0},THREE.GeometryUtils={merge:function(geometry1,geometry2,materialIndexOffset){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var matrix;geometry2 instanceof THREE.Mesh&&(geometry2.matrixAutoUpdate&&geometry2.updateMatrix(),matrix=geometry2.matrix,geometry2=geometry2.geometry),geometry1.merge(geometry2,matrix,materialIndexOffset)},center:function(geometry){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),geometry.center()}},THREE.ImageUtils={crossOrigin:void 0,loadTexture:function(url,mapping,onLoad,onError){var loader=new THREE.ImageLoader;loader.crossOrigin=this.crossOrigin;var texture=new THREE.Texture(void 0,mapping);return loader.load(url,function(image){texture.image=image,texture.needsUpdate=!0,onLoad&&onLoad(texture)},void 0,function(event){onError&&onError(event)}),texture.sourceFile=url,texture},loadTextureCube:function(array,mapping,onLoad){var images=[],loader=new THREE.ImageLoader;loader.crossOrigin=this.crossOrigin;var texture=new THREE.CubeTexture(images,mapping);texture.flipY=!1;for(var loaded=0,loadTexture=function(i){loader.load(array[i],function(image){texture.images[i]=image,loaded+=1,6===loaded&&(texture.needsUpdate=!0,onLoad&&onLoad(texture))})},i=0,il=array.length;il>i;++i)loadTexture(i);return texture},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},getNormalMap:function(image,depth){var cross=function(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]},subtract=function(a,b){return[a[0]-b[0],a[1]-b[1],a[2]-b[2]]},normalize=function(a){var l=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);return[a[0]/l,a[1]/l,a[2]/l]};depth=1|depth;var width=image.width,height=image.height,canvas=document.createElement("canvas");canvas.width=width,canvas.height=height;var context=canvas.getContext("2d");context.drawImage(image,0,0);for(var data=context.getImageData(0,0,width,height).data,imageData=context.createImageData(width,height),output=imageData.data,x=0;width>x;x++)for(var y=0;height>y;y++){var ly=0>y-1?0:y-1,uy=y+1>height-1?height-1:y+1,lx=0>x-1?0:x-1,ux=x+1>width-1?width-1:x+1,points=[],origin=[0,0,data[4*(y*width+x)]/255*depth];points.push([-1,0,data[4*(y*width+lx)]/255*depth]),points.push([-1,-1,data[4*(ly*width+lx)]/255*depth]),points.push([0,-1,data[4*(ly*width+x)]/255*depth]),points.push([1,-1,data[4*(ly*width+ux)]/255*depth]),points.push([1,0,data[4*(y*width+ux)]/255*depth]),points.push([1,1,data[4*(uy*width+ux)]/255*depth]),points.push([0,1,data[4*(uy*width+x)]/255*depth]),points.push([-1,1,data[4*(uy*width+lx)]/255*depth]);for(var normals=[],num_points=points.length,i=0;num_points>i;i++){var v1=points[i],v2=points[(i+1)%num_points];v1=subtract(v1,origin),v2=subtract(v2,origin),normals.push(normalize(cross(v1,v2)))}for(var normal=[0,0,0],i=0;i<normals.length;i++)normal[0]+=normals[i][0],normal[1]+=normals[i][1],normal[2]+=normals[i][2];normal[0]/=normals.length,normal[1]/=normals.length,normal[2]/=normals.length;var idx=4*(y*width+x);output[idx]=(normal[0]+1)/2*255|0,output[idx+1]=(normal[1]+1)/2*255|0,output[idx+2]=255*normal[2]|0,output[idx+3]=255}return context.putImageData(imageData,0,0),canvas},generateDataTexture:function(width,height,color){for(var size=width*height,data=new Uint8Array(3*size),r=Math.floor(255*color.r),g=Math.floor(255*color.g),b=Math.floor(255*color.b),i=0;size>i;i++)data[3*i]=r,data[3*i+1]=g,data[3*i+2]=b;var texture=new THREE.DataTexture(data,width,height,THREE.RGBFormat);return texture.needsUpdate=!0,texture}},THREE.SceneUtils={createMultiMaterialObject:function(geometry,materials){for(var group=new THREE.Object3D,i=0,l=materials.length;l>i;i++)group.add(new THREE.Mesh(geometry,materials[i]));return group},detach:function(child,parent,scene){child.applyMatrix(parent.matrixWorld),parent.remove(child),scene.add(child)},attach:function(child,scene,parent){var matrixWorldInverse=new THREE.Matrix4;matrixWorldInverse.getInverse(parent.matrixWorld),child.applyMatrix(matrixWorldInverse),scene.remove(child),parent.add(child)}},THREE.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(e){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(data){var family=data.familyName.toLowerCase(),ThreeFont=this;ThreeFont.faces[family]=ThreeFont.faces[family]||{},ThreeFont.faces[family][data.cssFontWeight]=ThreeFont.faces[family][data.cssFontWeight]||{},ThreeFont.faces[family][data.cssFontWeight][data.cssFontStyle]=data;ThreeFont.faces[family][data.cssFontWeight][data.cssFontStyle]=data;return data},drawText:function(text){var i,face=this.getFace(),scale=this.size/face.resolution,offset=0,chars=String(text).split(""),length=chars.length,fontPaths=[];for(i=0;length>i;i++){var path=new THREE.Path,ret=this.extractGlyphPoints(chars[i],face,scale,offset,path);offset+=ret.offset,fontPaths.push(ret.path)}var width=offset/2;return{paths:fontPaths,offset:width}},extractGlyphPoints:function(c,face,scale,offset,path){var i,i2,divisions,outline,action,length,scaleX,scaleY,x,y,cpx,cpy,cpx0,cpy0,cpx1,cpy1,cpx2,cpy2,laste,pts=[],glyph=face.glyphs[c]||face.glyphs["?"];if(glyph){if(glyph.o)for(outline=glyph._cachedOutline||(glyph._cachedOutline=glyph.o.split(" ")),length=outline.length,scaleX=scale,scaleY=scale,i=0;length>i;)switch(action=outline[i++]){case"m":x=outline[i++]*scaleX+offset,y=outline[i++]*scaleY,path.moveTo(x,y);break;case"l":x=outline[i++]*scaleX+offset,y=outline[i++]*scaleY,path.lineTo(x,y);break;case"q":if(cpx=outline[i++]*scaleX+offset,cpy=outline[i++]*scaleY,cpx1=outline[i++]*scaleX+offset,cpy1=outline[i++]*scaleY,path.quadraticCurveTo(cpx1,cpy1,cpx,cpy),laste=pts[pts.length-1])for(cpx0=laste.x,cpy0=laste.y,i2=1,divisions=this.divisions;divisions>=i2;i2++){var t=i2/divisions;THREE.Shape.Utils.b2(t,cpx0,cpx1,cpx),THREE.Shape.Utils.b2(t,cpy0,cpy1,cpy)}break;case"b":if(cpx=outline[i++]*scaleX+offset,cpy=outline[i++]*scaleY,cpx1=outline[i++]*scaleX+offset,cpy1=outline[i++]*scaleY,cpx2=outline[i++]*scaleX+offset,cpy2=outline[i++]*scaleY,path.bezierCurveTo(cpx1,cpy1,cpx2,cpy2,cpx,cpy),laste=pts[pts.length-1])for(cpx0=laste.x,cpy0=laste.y,i2=1,divisions=this.divisions;divisions>=i2;i2++){var t=i2/divisions;THREE.Shape.Utils.b3(t,cpx0,cpx1,cpx2,cpx),THREE.Shape.Utils.b3(t,cpy0,cpy1,cpy2,cpy)}}return{offset:glyph.ha*scale,path:path}}}},THREE.FontUtils.generateShapes=function(text,parameters){parameters=parameters||{};var size=void 0!==parameters.size?parameters.size:100,curveSegments=void 0!==parameters.curveSegments?parameters.curveSegments:4,font=void 0!==parameters.font?parameters.font:"helvetiker",weight=void 0!==parameters.weight?parameters.weight:"normal",style=void 0!==parameters.style?parameters.style:"normal";THREE.FontUtils.size=size,THREE.FontUtils.divisions=curveSegments,THREE.FontUtils.face=font,THREE.FontUtils.weight=weight,THREE.FontUtils.style=style;for(var data=THREE.FontUtils.drawText(text),paths=data.paths,shapes=[],p=0,pl=paths.length;pl>p;p++)Array.prototype.push.apply(shapes,paths[p].toShapes());return shapes},function(namespace){var EPSILON=1e-10,process=function(contour,indices){var n=contour.length;if(3>n)return null;var u,v,w,result=[],verts=[],vertIndices=[];if(area(contour)>0)for(v=0;n>v;v++)verts[v]=v;else for(v=0;n>v;v++)verts[v]=n-1-v;var nv=n,count=2*nv;for(v=nv-1;nv>2;){if(count--<=0)return console.log("Warning, unable to triangulate polygon!"),indices?vertIndices:result;if(u=v,u>=nv&&(u=0),v=u+1,v>=nv&&(v=0),w=v+1,w>=nv&&(w=0),snip(contour,u,v,w,nv,verts)){var a,b,c,s,t;for(a=verts[u],b=verts[v],c=verts[w],result.push([contour[a],contour[b],contour[c]]),vertIndices.push([verts[u],verts[v],verts[w]]),s=v,t=v+1;nv>t;s++,t++)verts[s]=verts[t];nv--,count=2*nv}}return indices?vertIndices:result},area=function(contour){for(var n=contour.length,a=0,p=n-1,q=0;n>q;p=q++)a+=contour[p].x*contour[q].y-contour[q].x*contour[p].y;return.5*a},snip=function(contour,u,v,w,n,verts){var p,ax,ay,bx,by,cx,cy,px,py;if(ax=contour[verts[u]].x,ay=contour[verts[u]].y,bx=contour[verts[v]].x,by=contour[verts[v]].y,cx=contour[verts[w]].x,cy=contour[verts[w]].y,EPSILON>(bx-ax)*(cy-ay)-(by-ay)*(cx-ax))return!1;var aX,aY,bX,bY,cX,cY,apx,apy,bpx,bpy,cpx,cpy,cCROSSap,bCROSScp,aCROSSbp;for(aX=cx-bx,aY=cy-by,bX=ax-cx,bY=ay-cy,cX=bx-ax,cY=by-ay,p=0;n>p;p++)if(px=contour[verts[p]].x,py=contour[verts[p]].y,!(px===ax&&py===ay||px===bx&&py===by||px===cx&&py===cy)&&(apx=px-ax,apy=py-ay,bpx=px-bx,bpy=py-by,cpx=px-cx,cpy=py-cy,aCROSSbp=aX*bpy-aY*bpx,cCROSSap=cX*apy-cY*apx,bCROSScp=bX*cpy-bY*cpx,aCROSSbp>=-EPSILON&&bCROSScp>=-EPSILON&&cCROSSap>=-EPSILON))return!1;return!0};return namespace.Triangulate=process,namespace.Triangulate.area=area,namespace}(THREE.FontUtils),self._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace},THREE.typeface_js=self._typeface_js,THREE.Curve=function(){},THREE.Curve.prototype.getPoint=function(){return console.log("Warning, getPoint() not implemented!"),null},THREE.Curve.prototype.getPointAt=function(u){var t=this.getUtoTmapping(u);return this.getPoint(t)},THREE.Curve.prototype.getPoints=function(divisions){divisions||(divisions=5);var d,pts=[];for(d=0;divisions>=d;d++)pts.push(this.getPoint(d/divisions));return pts},THREE.Curve.prototype.getSpacedPoints=function(divisions){divisions||(divisions=5);var d,pts=[];for(d=0;divisions>=d;d++)pts.push(this.getPointAt(d/divisions));return pts},THREE.Curve.prototype.getLength=function(){var lengths=this.getLengths();return lengths[lengths.length-1]},THREE.Curve.prototype.getLengths=function(divisions){if(divisions||(divisions=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==divisions+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var current,p,cache=[],last=this.getPoint(0),sum=0;for(cache.push(0),p=1;divisions>=p;p++)current=this.getPoint(p/divisions),sum+=current.distanceTo(last),cache.push(sum),last=current;return this.cacheArcLengths=cache,cache},THREE.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0,this.getLengths()},THREE.Curve.prototype.getUtoTmapping=function(u,distance){var targetArcLength,arcLengths=this.getLengths(),i=0,il=arcLengths.length;targetArcLength=distance?distance:u*arcLengths[il-1];for(var comparison,low=0,high=il-1;high>=low;)if(i=Math.floor(low+(high-low)/2),comparison=arcLengths[i]-targetArcLength,0>comparison)low=i+1;else{if(!(comparison>0)){high=i;break}high=i-1}if(i=high,arcLengths[i]==targetArcLength){var t=i/(il-1);return t}var lengthBefore=arcLengths[i],lengthAfter=arcLengths[i+1],segmentLength=lengthAfter-lengthBefore,segmentFraction=(targetArcLength-lengthBefore)/segmentLength,t=(i+segmentFraction)/(il-1);
return t},THREE.Curve.prototype.getTangent=function(t){var delta=1e-4,t1=t-delta,t2=t+delta;0>t1&&(t1=0),t2>1&&(t2=1);var pt1=this.getPoint(t1),pt2=this.getPoint(t2),vec=pt2.clone().sub(pt1);return vec.normalize()},THREE.Curve.prototype.getTangentAt=function(u){var t=this.getUtoTmapping(u);return this.getTangent(t)},THREE.Curve.Utils={tangentQuadraticBezier:function(t,p0,p1,p2){return 2*(1-t)*(p1-p0)+2*t*(p2-p1)},tangentCubicBezier:function(t,p0,p1,p2,p3){return-3*p0*(1-t)*(1-t)+3*p1*(1-t)*(1-t)-6*t*p1*(1-t)+6*t*p2*(1-t)-3*t*t*p2+3*t*t*p3},tangentSpline:function(t){var h00=6*t*t-6*t,h10=3*t*t-4*t+1,h01=-6*t*t+6*t,h11=3*t*t-2*t;return h00+h10+h01+h11},interpolate:function(p0,p1,p2,p3,t){var v0=.5*(p2-p0),v1=.5*(p3-p1),t2=t*t,t3=t*t2;return(2*p1-2*p2+v0+v1)*t3+(-3*p1+3*p2-2*v0-v1)*t2+v0*t+p1}},THREE.Curve.create=function(constructor,getPointFunc){return constructor.prototype=Object.create(THREE.Curve.prototype),constructor.prototype.getPoint=getPointFunc,constructor},THREE.CurvePath=function(){this.curves=[],this.bends=[],this.autoClose=!1},THREE.CurvePath.prototype=Object.create(THREE.Curve.prototype),THREE.CurvePath.prototype.add=function(curve){this.curves.push(curve)},THREE.CurvePath.prototype.checkConnection=function(){},THREE.CurvePath.prototype.closePath=function(){var startPoint=this.curves[0].getPoint(0),endPoint=this.curves[this.curves.length-1].getPoint(1);startPoint.equals(endPoint)||this.curves.push(new THREE.LineCurve(endPoint,startPoint))},THREE.CurvePath.prototype.getPoint=function(t){for(var diff,curve,d=t*this.getLength(),curveLengths=this.getCurveLengths(),i=0;i<curveLengths.length;){if(curveLengths[i]>=d){diff=curveLengths[i]-d,curve=this.curves[i];var u=1-diff/curve.getLength();return curve.getPointAt(u)}i++}return null},THREE.CurvePath.prototype.getLength=function(){var lens=this.getCurveLengths();return lens[lens.length-1]},THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var i,lengths=[],sums=0,il=this.curves.length;for(i=0;il>i;i++)sums+=this.curves[i].getLength(),lengths.push(sums);return this.cacheLengths=lengths,lengths},THREE.CurvePath.prototype.getBoundingBox=function(){var maxX,maxY,maxZ,minX,minY,minZ,points=this.getPoints();maxX=maxY=Number.NEGATIVE_INFINITY,minX=minY=Number.POSITIVE_INFINITY;var p,i,il,sum,v3=points[0]instanceof THREE.Vector3;for(sum=v3?new THREE.Vector3:new THREE.Vector2,i=0,il=points.length;il>i;i++)p=points[i],p.x>maxX?maxX=p.x:p.x<minX&&(minX=p.x),p.y>maxY?maxY=p.y:p.y<minY&&(minY=p.y),v3&&(p.z>maxZ?maxZ=p.z:p.z<minZ&&(minZ=p.z)),sum.add(p);var ret={minX:minX,minY:minY,maxX:maxX,maxY:maxY};return v3&&(ret.maxZ=maxZ,ret.minZ=minZ),ret},THREE.CurvePath.prototype.createPointsGeometry=function(divisions){var pts=this.getPoints(divisions,!0);return this.createGeometry(pts)},THREE.CurvePath.prototype.createSpacedPointsGeometry=function(divisions){var pts=this.getSpacedPoints(divisions,!0);return this.createGeometry(pts)},THREE.CurvePath.prototype.createGeometry=function(points){for(var geometry=new THREE.Geometry,i=0;i<points.length;i++)geometry.vertices.push(new THREE.Vector3(points[i].x,points[i].y,points[i].z||0));return geometry},THREE.CurvePath.prototype.addWrapPath=function(bendpath){this.bends.push(bendpath)},THREE.CurvePath.prototype.getTransformedPoints=function(segments,bends){var i,il,oldPts=this.getPoints(segments);for(bends||(bends=this.bends),i=0,il=bends.length;il>i;i++)oldPts=this.getWrapPoints(oldPts,bends[i]);return oldPts},THREE.CurvePath.prototype.getTransformedSpacedPoints=function(segments,bends){var i,il,oldPts=this.getSpacedPoints(segments);for(bends||(bends=this.bends),i=0,il=bends.length;il>i;i++)oldPts=this.getWrapPoints(oldPts,bends[i]);return oldPts},THREE.CurvePath.prototype.getWrapPoints=function(oldPts,path){var i,il,p,oldX,oldY,xNorm,bounds=this.getBoundingBox();for(i=0,il=oldPts.length;il>i;i++){p=oldPts[i],oldX=p.x,oldY=p.y,xNorm=oldX/bounds.maxX,xNorm=path.getUtoTmapping(xNorm,oldX);var pathPt=path.getPoint(xNorm),normal=path.getTangent(xNorm);normal.set(-normal.y,normal.x).multiplyScalar(oldY),p.x=pathPt.x+normal.x,p.y=pathPt.y+normal.y}return oldPts},THREE.Gyroscope=function(){THREE.Object3D.call(this)},THREE.Gyroscope.prototype=Object.create(THREE.Object3D.prototype),THREE.Gyroscope.prototype.updateMatrixWorld=function(force){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||force)&&(this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(this.translationWorld,this.quaternionWorld,this.scaleWorld),this.matrix.decompose(this.translationObject,this.quaternionObject,this.scaleObject),this.matrixWorld.compose(this.translationWorld,this.quaternionObject,this.scaleWorld)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,force=!0);for(var i=0,l=this.children.length;l>i;i++)this.children[i].updateMatrixWorld(force)},THREE.Gyroscope.prototype.translationWorld=new THREE.Vector3,THREE.Gyroscope.prototype.translationObject=new THREE.Vector3,THREE.Gyroscope.prototype.quaternionWorld=new THREE.Quaternion,THREE.Gyroscope.prototype.quaternionObject=new THREE.Quaternion,THREE.Gyroscope.prototype.scaleWorld=new THREE.Vector3,THREE.Gyroscope.prototype.scaleObject=new THREE.Vector3,THREE.Path=function(points){THREE.CurvePath.call(this),this.actions=[],points&&this.fromPoints(points)},THREE.Path.prototype=Object.create(THREE.CurvePath.prototype),THREE.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"},THREE.Path.prototype.fromPoints=function(vectors){this.moveTo(vectors[0].x,vectors[0].y);for(var v=1,vlen=vectors.length;vlen>v;v++)this.lineTo(vectors[v].x,vectors[v].y)},THREE.Path.prototype.moveTo=function(){var args=Array.prototype.slice.call(arguments);this.actions.push({action:THREE.PathActions.MOVE_TO,args:args})},THREE.Path.prototype.lineTo=function(x,y){var args=Array.prototype.slice.call(arguments),lastargs=this.actions[this.actions.length-1].args,x0=lastargs[lastargs.length-2],y0=lastargs[lastargs.length-1],curve=new THREE.LineCurve(new THREE.Vector2(x0,y0),new THREE.Vector2(x,y));this.curves.push(curve),this.actions.push({action:THREE.PathActions.LINE_TO,args:args})},THREE.Path.prototype.quadraticCurveTo=function(aCPx,aCPy,aX,aY){var args=Array.prototype.slice.call(arguments),lastargs=this.actions[this.actions.length-1].args,x0=lastargs[lastargs.length-2],y0=lastargs[lastargs.length-1],curve=new THREE.QuadraticBezierCurve(new THREE.Vector2(x0,y0),new THREE.Vector2(aCPx,aCPy),new THREE.Vector2(aX,aY));this.curves.push(curve),this.actions.push({action:THREE.PathActions.QUADRATIC_CURVE_TO,args:args})},THREE.Path.prototype.bezierCurveTo=function(aCP1x,aCP1y,aCP2x,aCP2y,aX,aY){var args=Array.prototype.slice.call(arguments),lastargs=this.actions[this.actions.length-1].args,x0=lastargs[lastargs.length-2],y0=lastargs[lastargs.length-1],curve=new THREE.CubicBezierCurve(new THREE.Vector2(x0,y0),new THREE.Vector2(aCP1x,aCP1y),new THREE.Vector2(aCP2x,aCP2y),new THREE.Vector2(aX,aY));this.curves.push(curve),this.actions.push({action:THREE.PathActions.BEZIER_CURVE_TO,args:args})},THREE.Path.prototype.splineThru=function(pts){var args=Array.prototype.slice.call(arguments),lastargs=this.actions[this.actions.length-1].args,x0=lastargs[lastargs.length-2],y0=lastargs[lastargs.length-1],npts=[new THREE.Vector2(x0,y0)];Array.prototype.push.apply(npts,pts);var curve=new THREE.SplineCurve(npts);this.curves.push(curve),this.actions.push({action:THREE.PathActions.CSPLINE_THRU,args:args})},THREE.Path.prototype.arc=function(aX,aY,aRadius,aStartAngle,aEndAngle,aClockwise){var lastargs=this.actions[this.actions.length-1].args,x0=lastargs[lastargs.length-2],y0=lastargs[lastargs.length-1];this.absarc(aX+x0,aY+y0,aRadius,aStartAngle,aEndAngle,aClockwise)},THREE.Path.prototype.absarc=function(aX,aY,aRadius,aStartAngle,aEndAngle,aClockwise){this.absellipse(aX,aY,aRadius,aRadius,aStartAngle,aEndAngle,aClockwise)},THREE.Path.prototype.ellipse=function(aX,aY,xRadius,yRadius,aStartAngle,aEndAngle,aClockwise){var lastargs=this.actions[this.actions.length-1].args,x0=lastargs[lastargs.length-2],y0=lastargs[lastargs.length-1];this.absellipse(aX+x0,aY+y0,xRadius,yRadius,aStartAngle,aEndAngle,aClockwise)},THREE.Path.prototype.absellipse=function(aX,aY,xRadius,yRadius,aStartAngle,aEndAngle,aClockwise){var args=Array.prototype.slice.call(arguments),curve=new THREE.EllipseCurve(aX,aY,xRadius,yRadius,aStartAngle,aEndAngle,aClockwise);this.curves.push(curve);var lastPoint=curve.getPoint(1);args.push(lastPoint.x),args.push(lastPoint.y),this.actions.push({action:THREE.PathActions.ELLIPSE,args:args})},THREE.Path.prototype.getSpacedPoints=function(divisions){divisions||(divisions=40);for(var points=[],i=0;divisions>i;i++)points.push(this.getPoint(i/divisions));return points},THREE.Path.prototype.getPoints=function(divisions,closedPath){if(this.useSpacedPoints)return console.log("tata"),this.getSpacedPoints(divisions,closedPath);divisions=divisions||12;var i,il,item,action,args,cpx,cpy,cpx2,cpy2,cpx1,cpy1,cpx0,cpy0,laste,j,t,tx,ty,points=[];for(i=0,il=this.actions.length;il>i;i++)switch(item=this.actions[i],action=item.action,args=item.args,action){case THREE.PathActions.MOVE_TO:points.push(new THREE.Vector2(args[0],args[1]));break;case THREE.PathActions.LINE_TO:points.push(new THREE.Vector2(args[0],args[1]));break;case THREE.PathActions.QUADRATIC_CURVE_TO:for(cpx=args[2],cpy=args[3],cpx1=args[0],cpy1=args[1],points.length>0?(laste=points[points.length-1],cpx0=laste.x,cpy0=laste.y):(laste=this.actions[i-1].args,cpx0=laste[laste.length-2],cpy0=laste[laste.length-1]),j=1;divisions>=j;j++)t=j/divisions,tx=THREE.Shape.Utils.b2(t,cpx0,cpx1,cpx),ty=THREE.Shape.Utils.b2(t,cpy0,cpy1,cpy),points.push(new THREE.Vector2(tx,ty));break;case THREE.PathActions.BEZIER_CURVE_TO:for(cpx=args[4],cpy=args[5],cpx1=args[0],cpy1=args[1],cpx2=args[2],cpy2=args[3],points.length>0?(laste=points[points.length-1],cpx0=laste.x,cpy0=laste.y):(laste=this.actions[i-1].args,cpx0=laste[laste.length-2],cpy0=laste[laste.length-1]),j=1;divisions>=j;j++)t=j/divisions,tx=THREE.Shape.Utils.b3(t,cpx0,cpx1,cpx2,cpx),ty=THREE.Shape.Utils.b3(t,cpy0,cpy1,cpy2,cpy),points.push(new THREE.Vector2(tx,ty));break;case THREE.PathActions.CSPLINE_THRU:laste=this.actions[i-1].args;var last=new THREE.Vector2(laste[laste.length-2],laste[laste.length-1]),spts=[last],n=divisions*args[0].length;spts=spts.concat(args[0]);var spline=new THREE.SplineCurve(spts);for(j=1;n>=j;j++)points.push(spline.getPointAt(j/n));break;case THREE.PathActions.ARC:var angle,aX=args[0],aY=args[1],aRadius=args[2],aStartAngle=args[3],aEndAngle=args[4],aClockwise=!!args[5],deltaAngle=aEndAngle-aStartAngle,tdivisions=2*divisions;for(j=1;tdivisions>=j;j++)t=j/tdivisions,aClockwise||(t=1-t),angle=aStartAngle+t*deltaAngle,tx=aX+aRadius*Math.cos(angle),ty=aY+aRadius*Math.sin(angle),points.push(new THREE.Vector2(tx,ty));break;case THREE.PathActions.ELLIPSE:var angle,aX=args[0],aY=args[1],xRadius=args[2],yRadius=args[3],aStartAngle=args[4],aEndAngle=args[5],aClockwise=!!args[6],deltaAngle=aEndAngle-aStartAngle,tdivisions=2*divisions;for(j=1;tdivisions>=j;j++)t=j/tdivisions,aClockwise||(t=1-t),angle=aStartAngle+t*deltaAngle,tx=aX+xRadius*Math.cos(angle),ty=aY+yRadius*Math.sin(angle),points.push(new THREE.Vector2(tx,ty))}var lastPoint=points[points.length-1],EPSILON=1e-10;return Math.abs(lastPoint.x-points[0].x)<EPSILON&&Math.abs(lastPoint.y-points[0].y)<EPSILON&&points.splice(points.length-1,1),closedPath&&points.push(points[0]),points},THREE.Path.prototype.toShapes=function(isCCW,noHoles){function extractSubpaths(inActions){var i,il,item,action,args,subPaths=[],lastPath=new THREE.Path;for(i=0,il=inActions.length;il>i;i++)item=inActions[i],args=item.args,action=item.action,action==THREE.PathActions.MOVE_TO&&0!=lastPath.actions.length&&(subPaths.push(lastPath),lastPath=new THREE.Path),lastPath[action].apply(lastPath,args);return 0!=lastPath.actions.length&&subPaths.push(lastPath),subPaths}function toShapesNoHoles(inSubpaths){for(var shapes=[],i=0,il=inSubpaths.length;il>i;i++){var tmpPath=inSubpaths[i],tmpShape=new THREE.Shape;tmpShape.actions=tmpPath.actions,tmpShape.curves=tmpPath.curves,shapes.push(tmpShape)}return shapes}function isPointInsidePolygon(inPt,inPolygon){for(var EPSILON=1e-10,polyLen=inPolygon.length,inside=!1,p=polyLen-1,q=0;polyLen>q;p=q++){var edgeLowPt=inPolygon[p],edgeHighPt=inPolygon[q],edgeDx=edgeHighPt.x-edgeLowPt.x,edgeDy=edgeHighPt.y-edgeLowPt.y;if(Math.abs(edgeDy)>EPSILON){if(0>edgeDy&&(edgeLowPt=inPolygon[q],edgeDx=-edgeDx,edgeHighPt=inPolygon[p],edgeDy=-edgeDy),inPt.y<edgeLowPt.y||inPt.y>edgeHighPt.y)continue;if(inPt.y==edgeLowPt.y){if(inPt.x==edgeLowPt.x)return!0}else{var perpEdge=edgeDy*(inPt.x-edgeLowPt.x)-edgeDx*(inPt.y-edgeLowPt.y);if(0==perpEdge)return!0;if(0>perpEdge)continue;inside=!inside}}else{if(inPt.y!=edgeLowPt.y)continue;if(edgeHighPt.x<=inPt.x&&inPt.x<=edgeLowPt.x||edgeLowPt.x<=inPt.x&&inPt.x<=edgeHighPt.x)return!0}}return inside}var subPaths=extractSubpaths(this.actions);if(0==subPaths.length)return[];if(noHoles===!0)return toShapesNoHoles(subPaths);var solid,tmpPath,tmpShape,shapes=[];if(1==subPaths.length)return tmpPath=subPaths[0],tmpShape=new THREE.Shape,tmpShape.actions=tmpPath.actions,tmpShape.curves=tmpPath.curves,shapes.push(tmpShape),shapes;var holesFirst=!THREE.Shape.Utils.isClockWise(subPaths[0].getPoints());holesFirst=isCCW?!holesFirst:holesFirst;var tmpPoints,betterShapeHoles=[],newShapes=[],newShapeHoles=[],mainIdx=0;newShapes[mainIdx]=void 0,newShapeHoles[mainIdx]=[];var i,il;for(i=0,il=subPaths.length;il>i;i++)tmpPath=subPaths[i],tmpPoints=tmpPath.getPoints(),solid=THREE.Shape.Utils.isClockWise(tmpPoints),solid=isCCW?!solid:solid,solid?(!holesFirst&&newShapes[mainIdx]&&mainIdx++,newShapes[mainIdx]={s:new THREE.Shape,p:tmpPoints},newShapes[mainIdx].s.actions=tmpPath.actions,newShapes[mainIdx].s.curves=tmpPath.curves,holesFirst&&mainIdx++,newShapeHoles[mainIdx]=[]):newShapeHoles[mainIdx].push({h:tmpPath,p:tmpPoints[0]});if(!newShapes[0])return toShapesNoHoles(subPaths);if(newShapes.length>1){for(var ambigious=!1,toChange=[],sIdx=0,sLen=newShapes.length;sLen>sIdx;sIdx++)betterShapeHoles[sIdx]=[];for(var sIdx=0,sLen=newShapes.length;sLen>sIdx;sIdx++)for(var sho=(newShapes[sIdx],newShapeHoles[sIdx]),hIdx=0;hIdx<sho.length;hIdx++){for(var ho=sho[hIdx],hole_unassigned=!0,s2Idx=0;s2Idx<newShapes.length;s2Idx++)isPointInsidePolygon(ho.p,newShapes[s2Idx].p)&&(sIdx!=s2Idx&&toChange.push({froms:sIdx,tos:s2Idx,hole:hIdx}),hole_unassigned?(hole_unassigned=!1,betterShapeHoles[s2Idx].push(ho)):ambigious=!0);hole_unassigned&&betterShapeHoles[sIdx].push(ho)}toChange.length>0&&(ambigious||(newShapeHoles=betterShapeHoles))}var tmpHoles,j,jl;for(i=0,il=newShapes.length;il>i;i++)for(tmpShape=newShapes[i].s,shapes.push(tmpShape),tmpHoles=newShapeHoles[i],j=0,jl=tmpHoles.length;jl>j;j++)tmpShape.holes.push(tmpHoles[j].h);return shapes},THREE.Shape=function(){THREE.Path.apply(this,arguments),this.holes=[]},THREE.Shape.prototype=Object.create(THREE.Path.prototype),THREE.Shape.prototype.extrude=function(options){var extruded=new THREE.ExtrudeGeometry(this,options);return extruded},THREE.Shape.prototype.makeGeometry=function(options){var geometry=new THREE.ShapeGeometry(this,options);return geometry},THREE.Shape.prototype.getPointsHoles=function(divisions){var i,il=this.holes.length,holesPts=[];for(i=0;il>i;i++)holesPts[i]=this.holes[i].getTransformedPoints(divisions,this.bends);return holesPts},THREE.Shape.prototype.getSpacedPointsHoles=function(divisions){var i,il=this.holes.length,holesPts=[];for(i=0;il>i;i++)holesPts[i]=this.holes[i].getTransformedSpacedPoints(divisions,this.bends);return holesPts},THREE.Shape.prototype.extractAllPoints=function(divisions){return{shape:this.getTransformedPoints(divisions),holes:this.getPointsHoles(divisions)}},THREE.Shape.prototype.extractPoints=function(divisions){return this.useSpacedPoints?this.extractAllSpacedPoints(divisions):this.extractAllPoints(divisions)},THREE.Shape.prototype.extractAllSpacedPoints=function(divisions){return{shape:this.getTransformedSpacedPoints(divisions),holes:this.getSpacedPointsHoles(divisions)}},THREE.Shape.Utils={triangulateShape:function(contour,holes){function point_in_segment_2D_colin(inSegPt1,inSegPt2,inOtherPt){return inSegPt1.x!=inSegPt2.x?inSegPt1.x<inSegPt2.x?inSegPt1.x<=inOtherPt.x&&inOtherPt.x<=inSegPt2.x:inSegPt2.x<=inOtherPt.x&&inOtherPt.x<=inSegPt1.x:inSegPt1.y<inSegPt2.y?inSegPt1.y<=inOtherPt.y&&inOtherPt.y<=inSegPt2.y:inSegPt2.y<=inOtherPt.y&&inOtherPt.y<=inSegPt1.y}function intersect_segments_2D(inSeg1Pt1,inSeg1Pt2,inSeg2Pt1,inSeg2Pt2,inExcludeAdjacentSegs){var EPSILON=1e-10,seg1dx=inSeg1Pt2.x-inSeg1Pt1.x,seg1dy=inSeg1Pt2.y-inSeg1Pt1.y,seg2dx=inSeg2Pt2.x-inSeg2Pt1.x,seg2dy=inSeg2Pt2.y-inSeg2Pt1.y,seg1seg2dx=inSeg1Pt1.x-inSeg2Pt1.x,seg1seg2dy=inSeg1Pt1.y-inSeg2Pt1.y,limit=seg1dy*seg2dx-seg1dx*seg2dy,perpSeg1=seg1dy*seg1seg2dx-seg1dx*seg1seg2dy;if(Math.abs(limit)>EPSILON){var perpSeg2;if(limit>0){if(0>perpSeg1||perpSeg1>limit)return[];if(perpSeg2=seg2dy*seg1seg2dx-seg2dx*seg1seg2dy,0>perpSeg2||perpSeg2>limit)return[]}else{if(perpSeg1>0||limit>perpSeg1)return[];if(perpSeg2=seg2dy*seg1seg2dx-seg2dx*seg1seg2dy,perpSeg2>0||limit>perpSeg2)return[]}if(0==perpSeg2)return!inExcludeAdjacentSegs||0!=perpSeg1&&perpSeg1!=limit?[inSeg1Pt1]:[];if(perpSeg2==limit)return!inExcludeAdjacentSegs||0!=perpSeg1&&perpSeg1!=limit?[inSeg1Pt2]:[];if(0==perpSeg1)return[inSeg2Pt1];if(perpSeg1==limit)return[inSeg2Pt2];var factorSeg1=perpSeg2/limit;return[{x:inSeg1Pt1.x+factorSeg1*seg1dx,y:inSeg1Pt1.y+factorSeg1*seg1dy}]}if(0!=perpSeg1||seg2dy*seg1seg2dx!=seg2dx*seg1seg2dy)return[];var seg1Pt=0==seg1dx&&0==seg1dy,seg2Pt=0==seg2dx&&0==seg2dy;if(seg1Pt&&seg2Pt)return inSeg1Pt1.x!=inSeg2Pt1.x||inSeg1Pt1.y!=inSeg2Pt1.y?[]:[inSeg1Pt1];if(seg1Pt)return point_in_segment_2D_colin(inSeg2Pt1,inSeg2Pt2,inSeg1Pt1)?[inSeg1Pt1]:[];if(seg2Pt)return point_in_segment_2D_colin(inSeg1Pt1,inSeg1Pt2,inSeg2Pt1)?[inSeg2Pt1]:[];var seg1min,seg1max,seg1minVal,seg1maxVal,seg2min,seg2max,seg2minVal,seg2maxVal;return 0!=seg1dx?(inSeg1Pt1.x<inSeg1Pt2.x?(seg1min=inSeg1Pt1,seg1minVal=inSeg1Pt1.x,seg1max=inSeg1Pt2,seg1maxVal=inSeg1Pt2.x):(seg1min=inSeg1Pt2,seg1minVal=inSeg1Pt2.x,seg1max=inSeg1Pt1,seg1maxVal=inSeg1Pt1.x),inSeg2Pt1.x<inSeg2Pt2.x?(seg2min=inSeg2Pt1,seg2minVal=inSeg2Pt1.x,seg2max=inSeg2Pt2,seg2maxVal=inSeg2Pt2.x):(seg2min=inSeg2Pt2,seg2minVal=inSeg2Pt2.x,seg2max=inSeg2Pt1,seg2maxVal=inSeg2Pt1.x)):(inSeg1Pt1.y<inSeg1Pt2.y?(seg1min=inSeg1Pt1,seg1minVal=inSeg1Pt1.y,seg1max=inSeg1Pt2,seg1maxVal=inSeg1Pt2.y):(seg1min=inSeg1Pt2,seg1minVal=inSeg1Pt2.y,seg1max=inSeg1Pt1,seg1maxVal=inSeg1Pt1.y),inSeg2Pt1.y<inSeg2Pt2.y?(seg2min=inSeg2Pt1,seg2minVal=inSeg2Pt1.y,seg2max=inSeg2Pt2,seg2maxVal=inSeg2Pt2.y):(seg2min=inSeg2Pt2,seg2minVal=inSeg2Pt2.y,seg2max=inSeg2Pt1,seg2maxVal=inSeg2Pt1.y)),seg2minVal>=seg1minVal?seg2minVal>seg1maxVal?[]:seg1maxVal==seg2minVal?inExcludeAdjacentSegs?[]:[seg2min]:seg2maxVal>=seg1maxVal?[seg2min,seg1max]:[seg2min,seg2max]:seg1minVal>seg2maxVal?[]:seg1minVal==seg2maxVal?inExcludeAdjacentSegs?[]:[seg1min]:seg2maxVal>=seg1maxVal?[seg1min,seg1max]:[seg1min,seg2max]}function isPointInsideAngle(inVertex,inLegFromPt,inLegToPt,inOtherPt){var EPSILON=1e-10,legFromPtX=inLegFromPt.x-inVertex.x,legFromPtY=inLegFromPt.y-inVertex.y,legToPtX=inLegToPt.x-inVertex.x,legToPtY=inLegToPt.y-inVertex.y,otherPtX=inOtherPt.x-inVertex.x,otherPtY=inOtherPt.y-inVertex.y,from2toAngle=legFromPtX*legToPtY-legFromPtY*legToPtX,from2otherAngle=legFromPtX*otherPtY-legFromPtY*otherPtX;if(Math.abs(from2toAngle)>EPSILON){var other2toAngle=otherPtX*legToPtY-otherPtY*legToPtX;return from2toAngle>0?from2otherAngle>=0&&other2toAngle>=0:from2otherAngle>=0||other2toAngle>=0}return from2otherAngle>0}function removeHoles(contour,holes){function isCutLineInsideAngles(inShapeIdx,inHoleIdx){var lastShapeIdx=shape.length-1,prevShapeIdx=inShapeIdx-1;0>prevShapeIdx&&(prevShapeIdx=lastShapeIdx);var nextShapeIdx=inShapeIdx+1;nextShapeIdx>lastShapeIdx&&(nextShapeIdx=0);var insideAngle=isPointInsideAngle(shape[inShapeIdx],shape[prevShapeIdx],shape[nextShapeIdx],hole[inHoleIdx]);if(!insideAngle)return!1;var lastHoleIdx=hole.length-1,prevHoleIdx=inHoleIdx-1;0>prevHoleIdx&&(prevHoleIdx=lastHoleIdx);var nextHoleIdx=inHoleIdx+1;return nextHoleIdx>lastHoleIdx&&(nextHoleIdx=0),insideAngle=isPointInsideAngle(hole[inHoleIdx],hole[prevHoleIdx],hole[nextHoleIdx],shape[inShapeIdx]),insideAngle?!0:!1}function intersectsShapeEdge(inShapePt,inHolePt){var sIdx,nextIdx,intersection;for(sIdx=0;sIdx<shape.length;sIdx++)if(nextIdx=sIdx+1,nextIdx%=shape.length,intersection=intersect_segments_2D(inShapePt,inHolePt,shape[sIdx],shape[nextIdx],!0),intersection.length>0)return!0;return!1}function intersectsHoleEdge(inShapePt,inHolePt){var ihIdx,chkHole,hIdx,nextIdx,intersection;for(ihIdx=0;ihIdx<indepHoles.length;ihIdx++)for(chkHole=holes[indepHoles[ihIdx]],hIdx=0;hIdx<chkHole.length;hIdx++)if(nextIdx=hIdx+1,nextIdx%=chkHole.length,intersection=intersect_segments_2D(inShapePt,inHolePt,chkHole[hIdx],chkHole[nextIdx],!0),intersection.length>0)return!0;return!1}for(var hole,holeIndex,shapeIndex,shapePt,holePt,holeIdx,cutKey,tmpShape1,tmpShape2,tmpHole1,tmpHole2,shape=contour.concat(),indepHoles=[],failedCuts=[],h=0,hl=holes.length;hl>h;h++)indepHoles.push(h);for(var minShapeIndex=0,counter=2*indepHoles.length;indepHoles.length>0;){if(counter--,0>counter){console.log("Infinite Loop! Holes left:"+indepHoles.length+", Probably Hole outside Shape!");break}for(shapeIndex=minShapeIndex;shapeIndex<shape.length;shapeIndex++){shapePt=shape[shapeIndex],holeIndex=-1;for(var h=0;h<indepHoles.length;h++)if(holeIdx=indepHoles[h],cutKey=shapePt.x+":"+shapePt.y+":"+holeIdx,void 0===failedCuts[cutKey]){hole=holes[holeIdx];for(var h2=0;h2<hole.length;h2++)if(holePt=hole[h2],isCutLineInsideAngles(shapeIndex,h2)&&!intersectsShapeEdge(shapePt,holePt)&&!intersectsHoleEdge(shapePt,holePt)){holeIndex=h2,indepHoles.splice(h,1),tmpShape1=shape.slice(0,shapeIndex+1),tmpShape2=shape.slice(shapeIndex),tmpHole1=hole.slice(holeIndex),tmpHole2=hole.slice(0,holeIndex+1),shape=tmpShape1.concat(tmpHole1).concat(tmpHole2).concat(tmpShape2),minShapeIndex=shapeIndex;break}if(holeIndex>=0)break;failedCuts[cutKey]=!0}if(holeIndex>=0)break}}return shape}for(var i,il,f,face,key,index,allPointsMap={},allpoints=contour.concat(),h=0,hl=holes.length;hl>h;h++)Array.prototype.push.apply(allpoints,holes[h]);for(i=0,il=allpoints.length;il>i;i++)key=allpoints[i].x+":"+allpoints[i].y,void 0!==allPointsMap[key]&&console.log("Duplicate point",key),allPointsMap[key]=i;var shapeWithoutHoles=removeHoles(contour,holes),triangles=THREE.FontUtils.Triangulate(shapeWithoutHoles,!1);for(i=0,il=triangles.length;il>i;i++)for(face=triangles[i],f=0;3>f;f++)key=face[f].x+":"+face[f].y,index=allPointsMap[key],void 0!==index&&(face[f]=index);return triangles.concat()},isClockWise:function(pts){return THREE.FontUtils.Triangulate.area(pts)<0},b2p0:function(t,p){var k=1-t;return k*k*p},b2p1:function(t,p){return 2*(1-t)*t*p},b2p2:function(t,p){return t*t*p},b2:function(t,p0,p1,p2){return this.b2p0(t,p0)+this.b2p1(t,p1)+this.b2p2(t,p2)},b3p0:function(t,p){var k=1-t;return k*k*k*p},b3p1:function(t,p){var k=1-t;return 3*k*k*t*p},b3p2:function(t,p){var k=1-t;return 3*k*t*t*p},b3p3:function(t,p){return t*t*t*p},b3:function(t,p0,p1,p2,p3){return this.b3p0(t,p0)+this.b3p1(t,p1)+this.b3p2(t,p2)+this.b3p3(t,p3)}},THREE.LineCurve=function(v1,v2){this.v1=v1,this.v2=v2},THREE.LineCurve.prototype=Object.create(THREE.Curve.prototype),THREE.LineCurve.prototype.getPoint=function(t){var point=this.v2.clone().sub(this.v1);return point.multiplyScalar(t).add(this.v1),point},THREE.LineCurve.prototype.getPointAt=function(u){return this.getPoint(u)},THREE.LineCurve.prototype.getTangent=function(){var tangent=this.v2.clone().sub(this.v1);return tangent.normalize()},THREE.QuadraticBezierCurve=function(v0,v1,v2){this.v0=v0,this.v1=v1,this.v2=v2},THREE.QuadraticBezierCurve.prototype=Object.create(THREE.Curve.prototype),THREE.QuadraticBezierCurve.prototype.getPoint=function(t){var tx,ty;return tx=THREE.Shape.Utils.b2(t,this.v0.x,this.v1.x,this.v2.x),ty=THREE.Shape.Utils.b2(t,this.v0.y,this.v1.y,this.v2.y),new THREE.Vector2(tx,ty)},THREE.QuadraticBezierCurve.prototype.getTangent=function(t){var tx,ty;tx=THREE.Curve.Utils.tangentQuadraticBezier(t,this.v0.x,this.v1.x,this.v2.x),ty=THREE.Curve.Utils.tangentQuadraticBezier(t,this.v0.y,this.v1.y,this.v2.y);var tangent=new THREE.Vector2(tx,ty);return tangent.normalize(),tangent},THREE.CubicBezierCurve=function(v0,v1,v2,v3){this.v0=v0,this.v1=v1,this.v2=v2,this.v3=v3},THREE.CubicBezierCurve.prototype=Object.create(THREE.Curve.prototype),THREE.CubicBezierCurve.prototype.getPoint=function(t){var tx,ty;return tx=THREE.Shape.Utils.b3(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),ty=THREE.Shape.Utils.b3(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new THREE.Vector2(tx,ty)},THREE.CubicBezierCurve.prototype.getTangent=function(t){var tx,ty;tx=THREE.Curve.Utils.tangentCubicBezier(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),ty=THREE.Curve.Utils.tangentCubicBezier(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y);var tangent=new THREE.Vector2(tx,ty);return tangent.normalize(),tangent},THREE.SplineCurve=function(points){this.points=void 0==points?[]:points},THREE.SplineCurve.prototype=Object.create(THREE.Curve.prototype),THREE.SplineCurve.prototype.getPoint=function(t){var point,intPoint,weight,v=new THREE.Vector2,c=[],points=this.points;return point=(points.length-1)*t,intPoint=Math.floor(point),weight=point-intPoint,c[0]=0==intPoint?intPoint:intPoint-1,c[1]=intPoint,c[2]=intPoint>points.length-2?points.length-1:intPoint+1,c[3]=intPoint>points.length-3?points.length-1:intPoint+2,v.x=THREE.Curve.Utils.interpolate(points[c[0]].x,points[c[1]].x,points[c[2]].x,points[c[3]].x,weight),v.y=THREE.Curve.Utils.interpolate(points[c[0]].y,points[c[1]].y,points[c[2]].y,points[c[3]].y,weight),v},THREE.EllipseCurve=function(aX,aY,xRadius,yRadius,aStartAngle,aEndAngle,aClockwise){this.aX=aX,this.aY=aY,this.xRadius=xRadius,this.yRadius=yRadius,this.aStartAngle=aStartAngle,this.aEndAngle=aEndAngle,this.aClockwise=aClockwise},THREE.EllipseCurve.prototype=Object.create(THREE.Curve.prototype),THREE.EllipseCurve.prototype.getPoint=function(t){var angle,deltaAngle=this.aEndAngle-this.aStartAngle;0>deltaAngle&&(deltaAngle+=2*Math.PI),deltaAngle>2*Math.PI&&(deltaAngle-=2*Math.PI),angle=this.aClockwise===!0?this.aEndAngle+(1-t)*(2*Math.PI-deltaAngle):this.aStartAngle+t*deltaAngle;var tx=this.aX+this.xRadius*Math.cos(angle),ty=this.aY+this.yRadius*Math.sin(angle);return new THREE.Vector2(tx,ty)},THREE.ArcCurve=function(aX,aY,aRadius,aStartAngle,aEndAngle,aClockwise){THREE.EllipseCurve.call(this,aX,aY,aRadius,aRadius,aStartAngle,aEndAngle,aClockwise)},THREE.ArcCurve.prototype=Object.create(THREE.EllipseCurve.prototype),THREE.LineCurve3=THREE.Curve.create(function(v1,v2){this.v1=v1,this.v2=v2},function(t){var r=new THREE.Vector3;return r.subVectors(this.v2,this.v1),r.multiplyScalar(t),r.add(this.v1),r}),THREE.QuadraticBezierCurve3=THREE.Curve.create(function(v0,v1,v2){this.v0=v0,this.v1=v1,this.v2=v2},function(t){var tx,ty,tz;return tx=THREE.Shape.Utils.b2(t,this.v0.x,this.v1.x,this.v2.x),ty=THREE.Shape.Utils.b2(t,this.v0.y,this.v1.y,this.v2.y),tz=THREE.Shape.Utils.b2(t,this.v0.z,this.v1.z,this.v2.z),new THREE.Vector3(tx,ty,tz)}),THREE.CubicBezierCurve3=THREE.Curve.create(function(v0,v1,v2,v3){this.v0=v0,this.v1=v1,this.v2=v2,this.v3=v3},function(t){var tx,ty,tz;return tx=THREE.Shape.Utils.b3(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),ty=THREE.Shape.Utils.b3(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y),tz=THREE.Shape.Utils.b3(t,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new THREE.Vector3(tx,ty,tz)}),THREE.SplineCurve3=THREE.Curve.create(function(points){this.points=void 0==points?[]:points},function(t){var point,intPoint,weight,v=new THREE.Vector3,c=[],points=this.points;point=(points.length-1)*t,intPoint=Math.floor(point),weight=point-intPoint,c[0]=0==intPoint?intPoint:intPoint-1,c[1]=intPoint,c[2]=intPoint>points.length-2?points.length-1:intPoint+1,c[3]=intPoint>points.length-3?points.length-1:intPoint+2;var pt0=points[c[0]],pt1=points[c[1]],pt2=points[c[2]],pt3=points[c[3]];return v.x=THREE.Curve.Utils.interpolate(pt0.x,pt1.x,pt2.x,pt3.x,weight),v.y=THREE.Curve.Utils.interpolate(pt0.y,pt1.y,pt2.y,pt3.y,weight),v.z=THREE.Curve.Utils.interpolate(pt0.z,pt1.z,pt2.z,pt3.z,weight),v}),THREE.ClosedSplineCurve3=THREE.Curve.create(function(points){this.points=void 0==points?[]:points},function(t){var point,intPoint,weight,v=new THREE.Vector3,c=[],points=this.points;return point=(points.length-0)*t,intPoint=Math.floor(point),weight=point-intPoint,intPoint+=intPoint>0?0:(Math.floor(Math.abs(intPoint)/points.length)+1)*points.length,c[0]=(intPoint-1)%points.length,c[1]=intPoint%points.length,c[2]=(intPoint+1)%points.length,c[3]=(intPoint+2)%points.length,v.x=THREE.Curve.Utils.interpolate(points[c[0]].x,points[c[1]].x,points[c[2]].x,points[c[3]].x,weight),v.y=THREE.Curve.Utils.interpolate(points[c[0]].y,points[c[1]].y,points[c[2]].y,points[c[3]].y,weight),v.z=THREE.Curve.Utils.interpolate(points[c[0]].z,points[c[1]].z,points[c[2]].z,points[c[3]].z,weight),v}),THREE.AnimationHandler={LINEAR:0,CATMULLROM:1,CATMULLROM_FORWARD:2,add:function(){console.warn("THREE.AnimationHandler.add() has been deprecated.")},get:function(){console.warn("THREE.AnimationHandler.get() has been deprecated.")},remove:function(){console.warn("THREE.AnimationHandler.remove() has been deprecated.")},animations:[],init:function(data){if(data.initialized!==!0){for(var h=0;h<data.hierarchy.length;h++){for(var k=0;k<data.hierarchy[h].keys.length;k++)if(data.hierarchy[h].keys[k].time<0&&(data.hierarchy[h].keys[k].time=0),void 0!==data.hierarchy[h].keys[k].rot&&!(data.hierarchy[h].keys[k].rot instanceof THREE.Quaternion)){var quat=data.hierarchy[h].keys[k].rot;data.hierarchy[h].keys[k].rot=(new THREE.Quaternion).fromArray(quat)}if(data.hierarchy[h].keys.length&&void 0!==data.hierarchy[h].keys[0].morphTargets){for(var usedMorphTargets={},k=0;k<data.hierarchy[h].keys.length;k++)for(var m=0;m<data.hierarchy[h].keys[k].morphTargets.length;m++){var morphTargetName=data.hierarchy[h].keys[k].morphTargets[m];usedMorphTargets[morphTargetName]=-1}data.hierarchy[h].usedMorphTargets=usedMorphTargets;for(var k=0;k<data.hierarchy[h].keys.length;k++){var influences={};for(var morphTargetName in usedMorphTargets){for(var m=0;m<data.hierarchy[h].keys[k].morphTargets.length;m++)if(data.hierarchy[h].keys[k].morphTargets[m]===morphTargetName){influences[morphTargetName]=data.hierarchy[h].keys[k].morphTargetsInfluences[m];break}m===data.hierarchy[h].keys[k].morphTargets.length&&(influences[morphTargetName]=0)}data.hierarchy[h].keys[k].morphTargetsInfluences=influences}}for(var k=1;k<data.hierarchy[h].keys.length;k++)data.hierarchy[h].keys[k].time===data.hierarchy[h].keys[k-1].time&&(data.hierarchy[h].keys.splice(k,1),k--);for(var k=0;k<data.hierarchy[h].keys.length;k++)data.hierarchy[h].keys[k].index=k}return data.initialized=!0,data}},parse:function(root){var parseRecurseHierarchy=function(root,hierarchy){hierarchy.push(root);for(var c=0;c<root.children.length;c++)parseRecurseHierarchy(root.children[c],hierarchy)},hierarchy=[];if(root instanceof THREE.SkinnedMesh)for(var b=0;b<root.skeleton.bones.length;b++)hierarchy.push(root.skeleton.bones[b]);else parseRecurseHierarchy(root,hierarchy);return hierarchy},play:function(animation){-1===this.animations.indexOf(animation)&&this.animations.push(animation)},stop:function(animation){var index=this.animations.indexOf(animation);-1!==index&&this.animations.splice(index,1)},update:function(deltaTimeMS){for(var i=0;i<this.animations.length;i++)this.animations[i].update(deltaTimeMS)
}},THREE.Animation=function(root,data){this.root=root,this.data=THREE.AnimationHandler.init(data),this.hierarchy=THREE.AnimationHandler.parse(root),this.currentTime=0,this.timeScale=1,this.isPlaying=!1,this.loop=!0,this.weight=0,this.interpolationType=THREE.AnimationHandler.LINEAR},THREE.Animation.prototype.keyTypes=["pos","rot","scl"],THREE.Animation.prototype.play=function(startTime,weight){this.currentTime=void 0!==startTime?startTime:0,this.weight=void 0!==weight?weight:1,this.isPlaying=!0,this.reset(),THREE.AnimationHandler.play(this)},THREE.Animation.prototype.stop=function(){this.isPlaying=!1,THREE.AnimationHandler.stop(this)},THREE.Animation.prototype.reset=function(){for(var h=0,hl=this.hierarchy.length;hl>h;h++){var object=this.hierarchy[h];object.matrixAutoUpdate=!0,void 0===object.animationCache&&(object.animationCache={}),void 0===object.animationCache[this.data.name]&&(object.animationCache[this.data.name]={},object.animationCache[this.data.name].prevKey={pos:0,rot:0,scl:0},object.animationCache[this.data.name].nextKey={pos:0,rot:0,scl:0},object.animationCache[this.data.name].originalMatrix=object.matrix);for(var animationCache=object.animationCache[this.data.name],t=0;3>t;t++){for(var type=this.keyTypes[t],prevKey=this.data.hierarchy[h].keys[0],nextKey=this.getNextKeyWith(type,h,1);nextKey.time<this.currentTime&&nextKey.index>prevKey.index;)prevKey=nextKey,nextKey=this.getNextKeyWith(type,h,nextKey.index+1);animationCache.prevKey[type]=prevKey,animationCache.nextKey[type]=nextKey}}},THREE.Animation.prototype.update=function(){var points=[],target=new THREE.Vector3,newVector=new THREE.Vector3,newQuat=new THREE.Quaternion,interpolateCatmullRom=function(points,scale){var point,intPoint,weight,w2,w3,pa,pb,pc,pd,c=[],v3=[];return point=(points.length-1)*scale,intPoint=Math.floor(point),weight=point-intPoint,c[0]=0===intPoint?intPoint:intPoint-1,c[1]=intPoint,c[2]=intPoint>points.length-2?intPoint:intPoint+1,c[3]=intPoint>points.length-3?intPoint:intPoint+2,pa=points[c[0]],pb=points[c[1]],pc=points[c[2]],pd=points[c[3]],w2=weight*weight,w3=weight*w2,v3[0]=interpolate(pa[0],pb[0],pc[0],pd[0],weight,w2,w3),v3[1]=interpolate(pa[1],pb[1],pc[1],pd[1],weight,w2,w3),v3[2]=interpolate(pa[2],pb[2],pc[2],pd[2],weight,w2,w3),v3},interpolate=function(p0,p1,p2,p3,t,t2,t3){var v0=.5*(p2-p0),v1=.5*(p3-p1);return(2*(p1-p2)+v0+v1)*t3+(-3*(p1-p2)-2*v0-v1)*t2+v0*t+p1};return function(delta){if(this.isPlaying!==!1&&(this.currentTime+=delta*this.timeScale,0!==this.weight)){var duration=this.data.length;if(this.loop===!0&&this.currentTime>duration)this.currentTime%=duration,this.reset();else if(this.loop===!1&&this.currentTime>duration)return void this.stop();for(var h=0,hl=this.hierarchy.length;hl>h;h++)for(var object=this.hierarchy[h],animationCache=object.animationCache[this.data.name],t=0;3>t;t++){var type=this.keyTypes[t],prevKey=animationCache.prevKey[type],nextKey=animationCache.nextKey[type];if(nextKey.time<=this.currentTime){for(prevKey=this.data.hierarchy[h].keys[0],nextKey=this.getNextKeyWith(type,h,1);nextKey.time<this.currentTime&&nextKey.index>prevKey.index;)prevKey=nextKey,nextKey=this.getNextKeyWith(type,h,nextKey.index+1);animationCache.prevKey[type]=prevKey,animationCache.nextKey[type]=nextKey}object.matrixAutoUpdate=!0,object.matrixWorldNeedsUpdate=!0;var scale=(this.currentTime-prevKey.time)/(nextKey.time-prevKey.time),prevXYZ=prevKey[type],nextXYZ=nextKey[type];if(0>scale&&(scale=0),scale>1&&(scale=1),"pos"===type){if(this.interpolationType===THREE.AnimationHandler.LINEAR)if(newVector.x=prevXYZ[0]+(nextXYZ[0]-prevXYZ[0])*scale,newVector.y=prevXYZ[1]+(nextXYZ[1]-prevXYZ[1])*scale,newVector.z=prevXYZ[2]+(nextXYZ[2]-prevXYZ[2])*scale,object instanceof THREE.Bone){var proportionalWeight=this.weight/(this.weight+object.accumulatedPosWeight);object.position.lerp(newVector,proportionalWeight),object.accumulatedPosWeight+=this.weight}else object.position.copy(newVector);else if(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD){points[0]=this.getPrevKeyWith("pos",h,prevKey.index-1).pos,points[1]=prevXYZ,points[2]=nextXYZ,points[3]=this.getNextKeyWith("pos",h,nextKey.index+1).pos,scale=.33*scale+.33;var currentPoint=interpolateCatmullRom(points,scale),proportionalWeight=1;object instanceof THREE.Bone&&(proportionalWeight=this.weight/(this.weight+object.accumulatedPosWeight),object.accumulatedPosWeight+=this.weight);var vector=object.position;if(vector.x=vector.x+(currentPoint[0]-vector.x)*proportionalWeight,vector.y=vector.y+(currentPoint[1]-vector.y)*proportionalWeight,vector.z=vector.z+(currentPoint[2]-vector.z)*proportionalWeight,this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD){var forwardPoint=interpolateCatmullRom(points,1.01*scale);target.set(forwardPoint[0],forwardPoint[1],forwardPoint[2]),target.sub(vector),target.y=0,target.normalize();var angle=Math.atan2(target.x,target.z);object.rotation.set(0,angle,0)}}}else if("rot"===type)if(THREE.Quaternion.slerp(prevXYZ,nextXYZ,newQuat,scale),object instanceof THREE.Bone)if(0===object.accumulatedRotWeight)object.quaternion.copy(newQuat),object.accumulatedRotWeight=this.weight;else{var proportionalWeight=this.weight/(this.weight+object.accumulatedRotWeight);THREE.Quaternion.slerp(object.quaternion,newQuat,object.quaternion,proportionalWeight),object.accumulatedRotWeight+=this.weight}else object.quaternion.copy(newQuat);else if("scl"===type)if(newVector.x=prevXYZ[0]+(nextXYZ[0]-prevXYZ[0])*scale,newVector.y=prevXYZ[1]+(nextXYZ[1]-prevXYZ[1])*scale,newVector.z=prevXYZ[2]+(nextXYZ[2]-prevXYZ[2])*scale,object instanceof THREE.Bone){var proportionalWeight=this.weight/(this.weight+object.accumulatedSclWeight);object.scale.lerp(newVector,proportionalWeight),object.accumulatedSclWeight+=this.weight}else object.scale.copy(newVector)}return!0}}}(),THREE.Animation.prototype.getNextKeyWith=function(type,h,key){var keys=this.data.hierarchy[h].keys;for(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?key=key<keys.length-1?key:keys.length-1:key%=keys.length;key<keys.length;key++)if(void 0!==keys[key][type])return keys[key];return this.data.hierarchy[h].keys[0]},THREE.Animation.prototype.getPrevKeyWith=function(type,h,key){var keys=this.data.hierarchy[h].keys;for(key=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?key>0?key:0:key>=0?key:key+keys.length;key>=0;key--)if(void 0!==keys[key][type])return keys[key];return this.data.hierarchy[h].keys[keys.length-1]},THREE.KeyFrameAnimation=function(data){this.root=data.node,this.data=THREE.AnimationHandler.init(data),this.hierarchy=THREE.AnimationHandler.parse(this.root),this.currentTime=0,this.timeScale=.001,this.isPlaying=!1,this.isPaused=!0,this.loop=!0;for(var h=0,hl=this.hierarchy.length;hl>h;h++){var keys=this.data.hierarchy[h].keys,sids=this.data.hierarchy[h].sids,obj=this.hierarchy[h];if(keys.length&&sids){for(var s=0;s<sids.length;s++){var sid=sids[s],next=this.getNextKeyWith(sid,h,0);next&&next.apply(sid)}obj.matrixAutoUpdate=!1,this.data.hierarchy[h].node.updateMatrix(),obj.matrixWorldNeedsUpdate=!0}}},THREE.KeyFrameAnimation.prototype.play=function(startTime){if(this.currentTime=void 0!==startTime?startTime:0,this.isPlaying===!1){this.isPlaying=!0;var h,object,node,hl=this.hierarchy.length;for(h=0;hl>h;h++){object=this.hierarchy[h],node=this.data.hierarchy[h],void 0===node.animationCache&&(node.animationCache={},node.animationCache.prevKey=null,node.animationCache.nextKey=null,node.animationCache.originalMatrix=object.matrix);var keys=this.data.hierarchy[h].keys;keys.length&&(node.animationCache.prevKey=keys[0],node.animationCache.nextKey=keys[1],this.startTime=Math.min(keys[0].time,this.startTime),this.endTime=Math.max(keys[keys.length-1].time,this.endTime))}this.update(0)}this.isPaused=!1,THREE.AnimationHandler.play(this)},THREE.KeyFrameAnimation.prototype.stop=function(){this.isPlaying=!1,this.isPaused=!1,THREE.AnimationHandler.stop(this);for(var h=0;h<this.data.hierarchy.length;h++){var obj=this.hierarchy[h],node=this.data.hierarchy[h];if(void 0!==node.animationCache){var original=node.animationCache.originalMatrix;original.copy(obj.matrix),obj.matrix=original,delete node.animationCache}}},THREE.KeyFrameAnimation.prototype.update=function(delta){if(this.isPlaying!==!1){this.currentTime+=delta*this.timeScale;var duration=this.data.length;this.loop===!0&&this.currentTime>duration&&(this.currentTime%=duration),this.currentTime=Math.min(this.currentTime,duration);for(var h=0,hl=this.hierarchy.length;hl>h;h++){var object=this.hierarchy[h],node=this.data.hierarchy[h],keys=node.keys,animationCache=node.animationCache;if(keys.length){var prevKey=animationCache.prevKey,nextKey=animationCache.nextKey;if(nextKey.time<=this.currentTime){for(;nextKey.time<this.currentTime&&nextKey.index>prevKey.index;)prevKey=nextKey,nextKey=keys[prevKey.index+1];animationCache.prevKey=prevKey,animationCache.nextKey=nextKey}nextKey.time>=this.currentTime?prevKey.interpolate(nextKey,this.currentTime):prevKey.interpolate(nextKey,nextKey.time),this.data.hierarchy[h].node.updateMatrix(),object.matrixWorldNeedsUpdate=!0}}}},THREE.KeyFrameAnimation.prototype.getNextKeyWith=function(sid,h,key){var keys=this.data.hierarchy[h].keys;for(key%=keys.length;key<keys.length;key++)if(keys[key].hasTarget(sid))return keys[key];return keys[0]},THREE.KeyFrameAnimation.prototype.getPrevKeyWith=function(sid,h,key){var keys=this.data.hierarchy[h].keys;for(key=key>=0?key:key+keys.length;key>=0;key--)if(keys[key].hasTarget(sid))return keys[key];return keys[keys.length-1]},THREE.MorphAnimation=function(mesh){this.mesh=mesh,this.frames=mesh.morphTargetInfluences.length,this.currentTime=0,this.duration=1e3,this.loop=!0,this.isPlaying=!1},THREE.MorphAnimation.prototype={play:function(){this.isPlaying=!0},pause:function(){this.isPlaying=!1},update:function(){var lastFrame=0,currentFrame=0;return function(delta){if(this.isPlaying!==!1){this.currentTime+=delta,this.loop===!0&&this.currentTime>this.duration&&(this.currentTime%=this.duration),this.currentTime=Math.min(this.currentTime,this.duration);var interpolation=this.duration/this.frames,frame=Math.floor(this.currentTime/interpolation);frame!=currentFrame&&(this.mesh.morphTargetInfluences[lastFrame]=0,this.mesh.morphTargetInfluences[currentFrame]=1,this.mesh.morphTargetInfluences[frame]=0,lastFrame=currentFrame,currentFrame=frame),this.mesh.morphTargetInfluences[frame]=this.currentTime%interpolation/interpolation,this.mesh.morphTargetInfluences[lastFrame]=1-this.mesh.morphTargetInfluences[frame]}}}()},THREE.BoxGeometry=function(width,height,depth,widthSegments,heightSegments,depthSegments){function buildPlane(u,v,udir,vdir,width,height,depth,materialIndex){var w,ix,iy,gridX=scope.widthSegments,gridY=scope.heightSegments,width_half=width/2,height_half=height/2,offset=scope.vertices.length;"x"===u&&"y"===v||"y"===u&&"x"===v?w="z":"x"===u&&"z"===v||"z"===u&&"x"===v?(w="y",gridY=scope.depthSegments):("z"===u&&"y"===v||"y"===u&&"z"===v)&&(w="x",gridX=scope.depthSegments);var gridX1=gridX+1,gridY1=gridY+1,segment_width=width/gridX,segment_height=height/gridY,normal=new THREE.Vector3;for(normal[w]=depth>0?1:-1,iy=0;gridY1>iy;iy++)for(ix=0;gridX1>ix;ix++){var vector=new THREE.Vector3;vector[u]=(ix*segment_width-width_half)*udir,vector[v]=(iy*segment_height-height_half)*vdir,vector[w]=depth,scope.vertices.push(vector)}for(iy=0;gridY>iy;iy++)for(ix=0;gridX>ix;ix++){var a=ix+gridX1*iy,b=ix+gridX1*(iy+1),c=ix+1+gridX1*(iy+1),d=ix+1+gridX1*iy,uva=new THREE.Vector2(ix/gridX,1-iy/gridY),uvb=new THREE.Vector2(ix/gridX,1-(iy+1)/gridY),uvc=new THREE.Vector2((ix+1)/gridX,1-(iy+1)/gridY),uvd=new THREE.Vector2((ix+1)/gridX,1-iy/gridY),face=new THREE.Face3(a+offset,b+offset,d+offset);face.normal.copy(normal),face.vertexNormals.push(normal.clone(),normal.clone(),normal.clone()),face.materialIndex=materialIndex,scope.faces.push(face),scope.faceVertexUvs[0].push([uva,uvb,uvd]),face=new THREE.Face3(b+offset,c+offset,d+offset),face.normal.copy(normal),face.vertexNormals.push(normal.clone(),normal.clone(),normal.clone()),face.materialIndex=materialIndex,scope.faces.push(face),scope.faceVertexUvs[0].push([uvb.clone(),uvc,uvd.clone()])}}THREE.Geometry.call(this),this.parameters={width:width,height:height,depth:depth,widthSegments:widthSegments,heightSegments:heightSegments,depthSegments:depthSegments},this.widthSegments=widthSegments||1,this.heightSegments=heightSegments||1,this.depthSegments=depthSegments||1;var scope=this,width_half=width/2,height_half=height/2,depth_half=depth/2;buildPlane("z","y",-1,-1,depth,height,width_half,0),buildPlane("z","y",1,-1,depth,height,-width_half,1),buildPlane("x","z",1,1,width,depth,height_half,2),buildPlane("x","z",1,-1,width,depth,-height_half,3),buildPlane("x","y",1,-1,width,height,depth_half,4),buildPlane("x","y",-1,-1,width,height,-depth_half,5),this.mergeVertices()},THREE.BoxGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.CircleGeometry=function(radius,segments,thetaStart,thetaLength){THREE.Geometry.call(this),this.parameters={radius:radius,segments:segments,thetaStart:thetaStart,thetaLength:thetaLength},radius=radius||50,segments=void 0!==segments?Math.max(3,segments):8,thetaStart=void 0!==thetaStart?thetaStart:0,thetaLength=void 0!==thetaLength?thetaLength:2*Math.PI;var i,uvs=[],center=new THREE.Vector3,centerUV=new THREE.Vector2(.5,.5);for(this.vertices.push(center),uvs.push(centerUV),i=0;segments>=i;i++){var vertex=new THREE.Vector3,segment=thetaStart+i/segments*thetaLength;vertex.x=radius*Math.cos(segment),vertex.y=radius*Math.sin(segment),this.vertices.push(vertex),uvs.push(new THREE.Vector2((vertex.x/radius+1)/2,(vertex.y/radius+1)/2))}var n=new THREE.Vector3(0,0,1);for(i=1;segments>=i;i++)this.faces.push(new THREE.Face3(i,i+1,0,[n.clone(),n.clone(),n.clone()])),this.faceVertexUvs[0].push([uvs[i].clone(),uvs[i+1].clone(),centerUV.clone()]);this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,radius)},THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.CubeGeometry=function(width,height,depth,widthSegments,heightSegments,depthSegments){return console.warn("THEE.CubeGeometry has been renamed to THREE.BoxGeometry."),new THREE.BoxGeometry(width,height,depth,widthSegments,heightSegments,depthSegments)},THREE.CylinderGeometry=function(radiusTop,radiusBottom,height,radialSegments,heightSegments,openEnded){THREE.Geometry.call(this),this.parameters={radiusTop:radiusTop,radiusBottom:radiusBottom,height:height,radialSegments:radialSegments,heightSegments:heightSegments,openEnded:openEnded},radiusTop=void 0!==radiusTop?radiusTop:20,radiusBottom=void 0!==radiusBottom?radiusBottom:20,height=void 0!==height?height:100,radialSegments=radialSegments||8,heightSegments=heightSegments||1,openEnded=void 0!==openEnded?openEnded:!1;var x,y,heightHalf=height/2,vertices=[],uvs=[];for(y=0;heightSegments>=y;y++){var verticesRow=[],uvsRow=[],v=y/heightSegments,radius=v*(radiusBottom-radiusTop)+radiusTop;for(x=0;radialSegments>=x;x++){var u=x/radialSegments,vertex=new THREE.Vector3;vertex.x=radius*Math.sin(u*Math.PI*2),vertex.y=-v*height+heightHalf,vertex.z=radius*Math.cos(u*Math.PI*2),this.vertices.push(vertex),verticesRow.push(this.vertices.length-1),uvsRow.push(new THREE.Vector2(u,1-v))}vertices.push(verticesRow),uvs.push(uvsRow)}var na,nb,tanTheta=(radiusBottom-radiusTop)/height;for(x=0;radialSegments>x;x++)for(0!==radiusTop?(na=this.vertices[vertices[0][x]].clone(),nb=this.vertices[vertices[0][x+1]].clone()):(na=this.vertices[vertices[1][x]].clone(),nb=this.vertices[vertices[1][x+1]].clone()),na.setY(Math.sqrt(na.x*na.x+na.z*na.z)*tanTheta).normalize(),nb.setY(Math.sqrt(nb.x*nb.x+nb.z*nb.z)*tanTheta).normalize(),y=0;heightSegments>y;y++){var v1=vertices[y][x],v2=vertices[y+1][x],v3=vertices[y+1][x+1],v4=vertices[y][x+1],n1=na.clone(),n2=na.clone(),n3=nb.clone(),n4=nb.clone(),uv1=uvs[y][x].clone(),uv2=uvs[y+1][x].clone(),uv3=uvs[y+1][x+1].clone(),uv4=uvs[y][x+1].clone();this.faces.push(new THREE.Face3(v1,v2,v4,[n1,n2,n4])),this.faceVertexUvs[0].push([uv1,uv2,uv4]),this.faces.push(new THREE.Face3(v2,v3,v4,[n2.clone(),n3,n4.clone()])),this.faceVertexUvs[0].push([uv2.clone(),uv3,uv4.clone()])}if(openEnded===!1&&radiusTop>0)for(this.vertices.push(new THREE.Vector3(0,heightHalf,0)),x=0;radialSegments>x;x++){var v1=vertices[0][x],v2=vertices[0][x+1],v3=this.vertices.length-1,n1=new THREE.Vector3(0,1,0),n2=new THREE.Vector3(0,1,0),n3=new THREE.Vector3(0,1,0),uv1=uvs[0][x].clone(),uv2=uvs[0][x+1].clone(),uv3=new THREE.Vector2(uv2.x,0);this.faces.push(new THREE.Face3(v1,v2,v3,[n1,n2,n3])),this.faceVertexUvs[0].push([uv1,uv2,uv3])}if(openEnded===!1&&radiusBottom>0)for(this.vertices.push(new THREE.Vector3(0,-heightHalf,0)),x=0;radialSegments>x;x++){var v1=vertices[y][x+1],v2=vertices[y][x],v3=this.vertices.length-1,n1=new THREE.Vector3(0,-1,0),n2=new THREE.Vector3(0,-1,0),n3=new THREE.Vector3(0,-1,0),uv1=uvs[y][x+1].clone(),uv2=uvs[y][x].clone(),uv3=new THREE.Vector2(uv2.x,1);this.faces.push(new THREE.Face3(v1,v2,v3,[n1,n2,n3])),this.faceVertexUvs[0].push([uv1,uv2,uv3])}this.computeFaceNormals()},THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ExtrudeGeometry=function(shapes,options){return"undefined"==typeof shapes?void(shapes=[]):(THREE.Geometry.call(this),shapes=shapes instanceof Array?shapes:[shapes],this.addShapeList(shapes,options),void this.computeFaceNormals())},THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ExtrudeGeometry.prototype.addShapeList=function(shapes,options){for(var sl=shapes.length,s=0;sl>s;s++){var shape=shapes[s];this.addShape(shape,options)}},THREE.ExtrudeGeometry.prototype.addShape=function(shape,options){function scalePt2(pt,vec,size){return vec||console.log("die"),vec.clone().multiplyScalar(size).add(pt)}function getBevelVec(inPt,inPrev,inNext){var v_trans_x,v_trans_y,EPSILON=1e-10,sign=THREE.Math.sign,shrink_by=1,v_prev_x=inPt.x-inPrev.x,v_prev_y=inPt.y-inPrev.y,v_next_x=inNext.x-inPt.x,v_next_y=inNext.y-inPt.y,v_prev_lensq=v_prev_x*v_prev_x+v_prev_y*v_prev_y,colinear0=v_prev_x*v_next_y-v_prev_y*v_next_x;if(Math.abs(colinear0)>EPSILON){var v_prev_len=Math.sqrt(v_prev_lensq),v_next_len=Math.sqrt(v_next_x*v_next_x+v_next_y*v_next_y),ptPrevShift_x=inPrev.x-v_prev_y/v_prev_len,ptPrevShift_y=inPrev.y+v_prev_x/v_prev_len,ptNextShift_x=inNext.x-v_next_y/v_next_len,ptNextShift_y=inNext.y+v_next_x/v_next_len,sf=((ptNextShift_x-ptPrevShift_x)*v_next_y-(ptNextShift_y-ptPrevShift_y)*v_next_x)/(v_prev_x*v_next_y-v_prev_y*v_next_x);v_trans_x=ptPrevShift_x+v_prev_x*sf-inPt.x,v_trans_y=ptPrevShift_y+v_prev_y*sf-inPt.y;var v_trans_lensq=v_trans_x*v_trans_x+v_trans_y*v_trans_y;if(2>=v_trans_lensq)return new THREE.Vector2(v_trans_x,v_trans_y);shrink_by=Math.sqrt(v_trans_lensq/2)}else{var direction_eq=!1;v_prev_x>EPSILON?v_next_x>EPSILON&&(direction_eq=!0):-EPSILON>v_prev_x?-EPSILON>v_next_x&&(direction_eq=!0):sign(v_prev_y)==sign(v_next_y)&&(direction_eq=!0),direction_eq?(v_trans_x=-v_prev_y,v_trans_y=v_prev_x,shrink_by=Math.sqrt(v_prev_lensq)):(v_trans_x=v_prev_x,v_trans_y=v_prev_y,shrink_by=Math.sqrt(v_prev_lensq/2))}return new THREE.Vector2(v_trans_x/shrink_by,v_trans_y/shrink_by)}function buildLidFaces(){if(bevelEnabled){var layer=0,offset=vlen*layer;for(i=0;flen>i;i++)face=faces[i],f3(face[2]+offset,face[1]+offset,face[0]+offset,!0);for(layer=steps+2*bevelSegments,offset=vlen*layer,i=0;flen>i;i++)face=faces[i],f3(face[0]+offset,face[1]+offset,face[2]+offset,!1)}else{for(i=0;flen>i;i++)face=faces[i],f3(face[2],face[1],face[0],!0);for(i=0;flen>i;i++)face=faces[i],f3(face[0]+vlen*steps,face[1]+vlen*steps,face[2]+vlen*steps,!1)}}function buildSideFaces(){var layeroffset=0;for(sidewalls(contour,layeroffset),layeroffset+=contour.length,h=0,hl=holes.length;hl>h;h++)ahole=holes[h],sidewalls(ahole,layeroffset),layeroffset+=ahole.length}function sidewalls(contour,layeroffset){var j,k;for(i=contour.length;--i>=0;){j=i,k=i-1,0>k&&(k=contour.length-1);var s=0,sl=steps+2*bevelSegments;for(s=0;sl>s;s++){var slen1=vlen*s,slen2=vlen*(s+1),a=layeroffset+j+slen1,b=layeroffset+k+slen1,c=layeroffset+k+slen2,d=layeroffset+j+slen2;f4(a,b,c,d,contour,s,sl,j,k)}}}function v(x,y,z){scope.vertices.push(new THREE.Vector3(x,y,z))}function f3(a,b,c,isBottom){a+=shapesOffset,b+=shapesOffset,c+=shapesOffset,scope.faces.push(new THREE.Face3(a,b,c,null,null,material));var uvs=isBottom?uvgen.generateBottomUV(scope,shape,options,a,b,c):uvgen.generateTopUV(scope,shape,options,a,b,c);scope.faceVertexUvs[0].push(uvs)}function f4(a,b,c,d,wallContour,stepIndex,stepsLength,contourIndex1,contourIndex2){a+=shapesOffset,b+=shapesOffset,c+=shapesOffset,d+=shapesOffset,scope.faces.push(new THREE.Face3(a,b,d,null,null,extrudeMaterial)),scope.faces.push(new THREE.Face3(b,c,d,null,null,extrudeMaterial));var uvs=uvgen.generateSideWallUV(scope,shape,wallContour,options,a,b,c,d,stepIndex,stepsLength,contourIndex1,contourIndex2);scope.faceVertexUvs[0].push([uvs[0],uvs[1],uvs[3]]),scope.faceVertexUvs[0].push([uvs[1],uvs[2],uvs[3]])}var extrudePts,splineTube,binormal,normal,position2,amount=void 0!==options.amount?options.amount:100,bevelThickness=void 0!==options.bevelThickness?options.bevelThickness:6,bevelSize=void 0!==options.bevelSize?options.bevelSize:bevelThickness-2,bevelSegments=void 0!==options.bevelSegments?options.bevelSegments:3,bevelEnabled=void 0!==options.bevelEnabled?options.bevelEnabled:!0,curveSegments=void 0!==options.curveSegments?options.curveSegments:12,steps=void 0!==options.steps?options.steps:1,extrudePath=options.extrudePath,extrudeByPath=!1,material=options.material,extrudeMaterial=options.extrudeMaterial,uvgen=void 0!==options.UVGenerator?options.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator;extrudePath&&(extrudePts=extrudePath.getSpacedPoints(steps),extrudeByPath=!0,bevelEnabled=!1,splineTube=void 0!==options.frames?options.frames:new THREE.TubeGeometry.FrenetFrames(extrudePath,steps,!1),binormal=new THREE.Vector3,normal=new THREE.Vector3,position2=new THREE.Vector3),bevelEnabled||(bevelSegments=0,bevelThickness=0,bevelSize=0);var ahole,h,hl,scope=this,shapesOffset=this.vertices.length,shapePoints=shape.extractPoints(curveSegments),vertices=shapePoints.shape,holes=shapePoints.holes,reverse=!THREE.Shape.Utils.isClockWise(vertices);if(reverse){for(vertices=vertices.reverse(),h=0,hl=holes.length;hl>h;h++)ahole=holes[h],THREE.Shape.Utils.isClockWise(ahole)&&(holes[h]=ahole.reverse());reverse=!1}var faces=THREE.Shape.Utils.triangulateShape(vertices,holes),contour=vertices;for(h=0,hl=holes.length;hl>h;h++)ahole=holes[h],vertices=vertices.concat(ahole);for(var b,bs,t,z,vert,face,vlen=vertices.length,flen=faces.length,contourMovements=(contour.length,180/Math.PI,[]),i=0,il=contour.length,j=il-1,k=i+1;il>i;i++,j++,k++){j===il&&(j=0),k===il&&(k=0);{contour[i],contour[j],contour[k]}contourMovements[i]=getBevelVec(contour[i],contour[j],contour[k])}var oneHoleMovements,holesMovements=[],verticesMovements=contourMovements.concat();for(h=0,hl=holes.length;hl>h;h++){for(ahole=holes[h],oneHoleMovements=[],i=0,il=ahole.length,j=il-1,k=i+1;il>i;i++,j++,k++)j===il&&(j=0),k===il&&(k=0),oneHoleMovements[i]=getBevelVec(ahole[i],ahole[j],ahole[k]);holesMovements.push(oneHoleMovements),verticesMovements=verticesMovements.concat(oneHoleMovements)}for(b=0;bevelSegments>b;b++){for(t=b/bevelSegments,z=bevelThickness*(1-t),bs=bevelSize*Math.sin(t*Math.PI/2),i=0,il=contour.length;il>i;i++)vert=scalePt2(contour[i],contourMovements[i],bs),v(vert.x,vert.y,-z);for(h=0,hl=holes.length;hl>h;h++)for(ahole=holes[h],oneHoleMovements=holesMovements[h],i=0,il=ahole.length;il>i;i++)vert=scalePt2(ahole[i],oneHoleMovements[i],bs),v(vert.x,vert.y,-z)}for(bs=bevelSize,i=0;vlen>i;i++)vert=bevelEnabled?scalePt2(vertices[i],verticesMovements[i],bs):vertices[i],extrudeByPath?(normal.copy(splineTube.normals[0]).multiplyScalar(vert.x),binormal.copy(splineTube.binormals[0]).multiplyScalar(vert.y),position2.copy(extrudePts[0]).add(normal).add(binormal),v(position2.x,position2.y,position2.z)):v(vert.x,vert.y,0);var s;for(s=1;steps>=s;s++)for(i=0;vlen>i;i++)vert=bevelEnabled?scalePt2(vertices[i],verticesMovements[i],bs):vertices[i],extrudeByPath?(normal.copy(splineTube.normals[s]).multiplyScalar(vert.x),binormal.copy(splineTube.binormals[s]).multiplyScalar(vert.y),position2.copy(extrudePts[s]).add(normal).add(binormal),v(position2.x,position2.y,position2.z)):v(vert.x,vert.y,amount/steps*s);for(b=bevelSegments-1;b>=0;b--){for(t=b/bevelSegments,z=bevelThickness*(1-t),bs=bevelSize*Math.sin(t*Math.PI/2),i=0,il=contour.length;il>i;i++)vert=scalePt2(contour[i],contourMovements[i],bs),v(vert.x,vert.y,amount+z);for(h=0,hl=holes.length;hl>h;h++)for(ahole=holes[h],oneHoleMovements=holesMovements[h],i=0,il=ahole.length;il>i;i++)vert=scalePt2(ahole[i],oneHoleMovements[i],bs),extrudeByPath?v(vert.x,vert.y+extrudePts[steps-1].y,extrudePts[steps-1].x+z):v(vert.x,vert.y,amount+z)}buildLidFaces(),buildSideFaces()},THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(geometry,extrudedShape,extrudeOptions,indexA,indexB,indexC){var ax=geometry.vertices[indexA].x,ay=geometry.vertices[indexA].y,bx=geometry.vertices[indexB].x,by=geometry.vertices[indexB].y,cx=geometry.vertices[indexC].x,cy=geometry.vertices[indexC].y;return[new THREE.Vector2(ax,ay),new THREE.Vector2(bx,by),new THREE.Vector2(cx,cy)]},generateBottomUV:function(geometry,extrudedShape,extrudeOptions,indexA,indexB,indexC){return this.generateTopUV(geometry,extrudedShape,extrudeOptions,indexA,indexB,indexC)},generateSideWallUV:function(geometry,extrudedShape,wallContour,extrudeOptions,indexA,indexB,indexC,indexD){var ax=geometry.vertices[indexA].x,ay=geometry.vertices[indexA].y,az=geometry.vertices[indexA].z,bx=geometry.vertices[indexB].x,by=geometry.vertices[indexB].y,bz=geometry.vertices[indexB].z,cx=geometry.vertices[indexC].x,cy=geometry.vertices[indexC].y,cz=geometry.vertices[indexC].z,dx=geometry.vertices[indexD].x,dy=geometry.vertices[indexD].y,dz=geometry.vertices[indexD].z;return Math.abs(ay-by)<.01?[new THREE.Vector2(ax,1-az),new THREE.Vector2(bx,1-bz),new THREE.Vector2(cx,1-cz),new THREE.Vector2(dx,1-dz)]:[new THREE.Vector2(ay,1-az),new THREE.Vector2(by,1-bz),new THREE.Vector2(cy,1-cz),new THREE.Vector2(dy,1-dz)]}},THREE.ExtrudeGeometry.__v1=new THREE.Vector2,THREE.ExtrudeGeometry.__v2=new THREE.Vector2,THREE.ExtrudeGeometry.__v3=new THREE.Vector2,THREE.ExtrudeGeometry.__v4=new THREE.Vector2,THREE.ExtrudeGeometry.__v5=new THREE.Vector2,THREE.ExtrudeGeometry.__v6=new THREE.Vector2,THREE.ShapeGeometry=function(shapes,options){THREE.Geometry.call(this),shapes instanceof Array==!1&&(shapes=[shapes]),this.addShapeList(shapes,options),this.computeFaceNormals()},THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ShapeGeometry.prototype.addShapeList=function(shapes,options){for(var i=0,l=shapes.length;l>i;i++)this.addShape(shapes[i],options);return this},THREE.ShapeGeometry.prototype.addShape=function(shape,options){void 0===options&&(options={});var i,l,hole,curveSegments=void 0!==options.curveSegments?options.curveSegments:12,material=options.material,uvgen=void 0===options.UVGenerator?THREE.ExtrudeGeometry.WorldUVGenerator:options.UVGenerator,shapesOffset=this.vertices.length,shapePoints=shape.extractPoints(curveSegments),vertices=shapePoints.shape,holes=shapePoints.holes,reverse=!THREE.Shape.Utils.isClockWise(vertices);if(reverse){for(vertices=vertices.reverse(),i=0,l=holes.length;l>i;i++)hole=holes[i],THREE.Shape.Utils.isClockWise(hole)&&(holes[i]=hole.reverse());reverse=!1}var faces=THREE.Shape.Utils.triangulateShape(vertices,holes),contour=vertices;for(i=0,l=holes.length;l>i;i++)hole=holes[i],vertices=vertices.concat(hole);{var vert,face,vlen=vertices.length,flen=faces.length;contour.length}for(i=0;vlen>i;i++)vert=vertices[i],this.vertices.push(new THREE.Vector3(vert.x,vert.y,0));for(i=0;flen>i;i++){face=faces[i];var a=face[0]+shapesOffset,b=face[1]+shapesOffset,c=face[2]+shapesOffset;this.faces.push(new THREE.Face3(a,b,c,null,null,material)),this.faceVertexUvs[0].push(uvgen.generateBottomUV(this,shape,options,a,b,c))}},THREE.LatheGeometry=function(points,segments,phiStart,phiLength){THREE.Geometry.call(this),segments=segments||12,phiStart=phiStart||0,phiLength=phiLength||2*Math.PI;for(var inversePointLength=1/(points.length-1),inverseSegments=1/segments,i=0,il=segments;il>=i;i++)for(var phi=phiStart+i*inverseSegments*phiLength,c=Math.cos(phi),s=Math.sin(phi),j=0,jl=points.length;jl>j;j++){var pt=points[j],vertex=new THREE.Vector3;vertex.x=c*pt.x-s*pt.y,vertex.y=s*pt.x+c*pt.y,vertex.z=pt.z,this.vertices.push(vertex)}for(var np=points.length,i=0,il=segments;il>i;i++)for(var j=0,jl=points.length-1;jl>j;j++){var base=j+np*i,a=base,b=base+np,c=base+1+np,d=base+1,u0=i*inverseSegments,v0=j*inversePointLength,u1=u0+inverseSegments,v1=v0+inversePointLength;this.faces.push(new THREE.Face3(a,b,d)),this.faceVertexUvs[0].push([new THREE.Vector2(u0,v0),new THREE.Vector2(u1,v0),new THREE.Vector2(u0,v1)]),this.faces.push(new THREE.Face3(b,c,d)),this.faceVertexUvs[0].push([new THREE.Vector2(u1,v0),new THREE.Vector2(u1,v1),new THREE.Vector2(u0,v1)])}this.mergeVertices(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.PlaneGeometry=function(width,height,widthSegments,heightSegments){THREE.Geometry.call(this),this.parameters={width:width,height:height,widthSegments:widthSegments,heightSegments:heightSegments};var ix,iz,width_half=width/2,height_half=height/2,gridX=widthSegments||1,gridZ=heightSegments||1,gridX1=gridX+1,gridZ1=gridZ+1,segment_width=width/gridX,segment_height=height/gridZ,normal=new THREE.Vector3(0,0,1);for(iz=0;gridZ1>iz;iz++){var y=iz*segment_height-height_half;for(ix=0;gridX1>ix;ix++){var x=ix*segment_width-width_half;this.vertices.push(new THREE.Vector3(x,-y,0))}}for(iz=0;gridZ>iz;iz++)for(ix=0;gridX>ix;ix++){var a=ix+gridX1*iz,b=ix+gridX1*(iz+1),c=ix+1+gridX1*(iz+1),d=ix+1+gridX1*iz,uva=new THREE.Vector2(ix/gridX,1-iz/gridZ),uvb=new THREE.Vector2(ix/gridX,1-(iz+1)/gridZ),uvc=new THREE.Vector2((ix+1)/gridX,1-(iz+1)/gridZ),uvd=new THREE.Vector2((ix+1)/gridX,1-iz/gridZ),face=new THREE.Face3(a,b,d);face.normal.copy(normal),face.vertexNormals.push(normal.clone(),normal.clone(),normal.clone()),this.faces.push(face),this.faceVertexUvs[0].push([uva,uvb,uvd]),face=new THREE.Face3(b,c,d),face.normal.copy(normal),face.vertexNormals.push(normal.clone(),normal.clone(),normal.clone()),this.faces.push(face),this.faceVertexUvs[0].push([uvb.clone(),uvc,uvd.clone()])}},THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.RingGeometry=function(innerRadius,outerRadius,thetaSegments,phiSegments,thetaStart,thetaLength){THREE.Geometry.call(this),innerRadius=innerRadius||0,outerRadius=outerRadius||50,thetaStart=void 0!==thetaStart?thetaStart:0,thetaLength=void 0!==thetaLength?thetaLength:2*Math.PI,thetaSegments=void 0!==thetaSegments?Math.max(3,thetaSegments):8,phiSegments=void 0!==phiSegments?Math.max(1,phiSegments):8;var i,o,uvs=[],radius=innerRadius,radiusStep=(outerRadius-innerRadius)/phiSegments;for(i=0;phiSegments+1>i;i++){for(o=0;thetaSegments+1>o;o++){var vertex=new THREE.Vector3,segment=thetaStart+o/thetaSegments*thetaLength;vertex.x=radius*Math.cos(segment),vertex.y=radius*Math.sin(segment),this.vertices.push(vertex),uvs.push(new THREE.Vector2((vertex.x/outerRadius+1)/2,(vertex.y/outerRadius+1)/2))}radius+=radiusStep}var n=new THREE.Vector3(0,0,1);for(i=0;phiSegments>i;i++){var thetaSegment=i*(thetaSegments+1);for(o=0;thetaSegments>o;o++){var segment=o+thetaSegment,v1=segment,v2=segment+thetaSegments+1,v3=segment+thetaSegments+2;this.faces.push(new THREE.Face3(v1,v2,v3,[n.clone(),n.clone(),n.clone()])),this.faceVertexUvs[0].push([uvs[v1].clone(),uvs[v2].clone(),uvs[v3].clone()]),v1=segment,v2=segment+thetaSegments+2,v3=segment+1,this.faces.push(new THREE.Face3(v1,v2,v3,[n.clone(),n.clone(),n.clone()])),this.faceVertexUvs[0].push([uvs[v1].clone(),uvs[v2].clone(),uvs[v3].clone()])
}}this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,radius)},THREE.RingGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.SphereGeometry=function(radius,widthSegments,heightSegments,phiStart,phiLength,thetaStart,thetaLength){THREE.Geometry.call(this),this.parameters={radius:radius,widthSegments:widthSegments,heightSegments:heightSegments,phiStart:phiStart,phiLength:phiLength,thetaStart:thetaStart,thetaLength:thetaLength},radius=radius||50,widthSegments=Math.max(3,Math.floor(widthSegments)||8),heightSegments=Math.max(2,Math.floor(heightSegments)||6),phiStart=void 0!==phiStart?phiStart:0,phiLength=void 0!==phiLength?phiLength:2*Math.PI,thetaStart=void 0!==thetaStart?thetaStart:0,thetaLength=void 0!==thetaLength?thetaLength:Math.PI;var x,y,vertices=[],uvs=[];for(y=0;heightSegments>=y;y++){var verticesRow=[],uvsRow=[];for(x=0;widthSegments>=x;x++){var u=x/widthSegments,v=y/heightSegments,vertex=new THREE.Vector3;vertex.x=-radius*Math.cos(phiStart+u*phiLength)*Math.sin(thetaStart+v*thetaLength),vertex.y=radius*Math.cos(thetaStart+v*thetaLength),vertex.z=radius*Math.sin(phiStart+u*phiLength)*Math.sin(thetaStart+v*thetaLength),this.vertices.push(vertex),verticesRow.push(this.vertices.length-1),uvsRow.push(new THREE.Vector2(u,1-v))}vertices.push(verticesRow),uvs.push(uvsRow)}for(y=0;heightSegments>y;y++)for(x=0;widthSegments>x;x++){var v1=vertices[y][x+1],v2=vertices[y][x],v3=vertices[y+1][x],v4=vertices[y+1][x+1],n1=this.vertices[v1].clone().normalize(),n2=this.vertices[v2].clone().normalize(),n3=this.vertices[v3].clone().normalize(),n4=this.vertices[v4].clone().normalize(),uv1=uvs[y][x+1].clone(),uv2=uvs[y][x].clone(),uv3=uvs[y+1][x].clone(),uv4=uvs[y+1][x+1].clone();Math.abs(this.vertices[v1].y)===radius?(uv1.x=(uv1.x+uv2.x)/2,this.faces.push(new THREE.Face3(v1,v3,v4,[n1,n3,n4])),this.faceVertexUvs[0].push([uv1,uv3,uv4])):Math.abs(this.vertices[v3].y)===radius?(uv3.x=(uv3.x+uv4.x)/2,this.faces.push(new THREE.Face3(v1,v2,v3,[n1,n2,n3])),this.faceVertexUvs[0].push([uv1,uv2,uv3])):(this.faces.push(new THREE.Face3(v1,v2,v4,[n1,n2,n4])),this.faceVertexUvs[0].push([uv1,uv2,uv4]),this.faces.push(new THREE.Face3(v2,v3,v4,[n2.clone(),n3,n4.clone()])),this.faceVertexUvs[0].push([uv2.clone(),uv3,uv4.clone()]))}this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,radius)},THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TextGeometry=function(text,parameters){parameters=parameters||{};var textShapes=THREE.FontUtils.generateShapes(text,parameters);parameters.amount=void 0!==parameters.height?parameters.height:50,void 0===parameters.bevelThickness&&(parameters.bevelThickness=10),void 0===parameters.bevelSize&&(parameters.bevelSize=8),void 0===parameters.bevelEnabled&&(parameters.bevelEnabled=!1),THREE.ExtrudeGeometry.call(this,textShapes,parameters)},THREE.TextGeometry.prototype=Object.create(THREE.ExtrudeGeometry.prototype),THREE.TorusGeometry=function(radius,tube,radialSegments,tubularSegments,arc){THREE.Geometry.call(this),this.parameters={radius:radius,tube:tube,radialSegments:radialSegments,tubularSegments:tubularSegments,arc:arc},radius=radius||100,tube=tube||40,radialSegments=radialSegments||8,tubularSegments=tubularSegments||6,arc=arc||2*Math.PI;for(var center=new THREE.Vector3,uvs=[],normals=[],j=0;radialSegments>=j;j++)for(var i=0;tubularSegments>=i;i++){var u=i/tubularSegments*arc,v=j/radialSegments*Math.PI*2;center.x=radius*Math.cos(u),center.y=radius*Math.sin(u);var vertex=new THREE.Vector3;vertex.x=(radius+tube*Math.cos(v))*Math.cos(u),vertex.y=(radius+tube*Math.cos(v))*Math.sin(u),vertex.z=tube*Math.sin(v),this.vertices.push(vertex),uvs.push(new THREE.Vector2(i/tubularSegments,j/radialSegments)),normals.push(vertex.clone().sub(center).normalize())}for(var j=1;radialSegments>=j;j++)for(var i=1;tubularSegments>=i;i++){var a=(tubularSegments+1)*j+i-1,b=(tubularSegments+1)*(j-1)+i-1,c=(tubularSegments+1)*(j-1)+i,d=(tubularSegments+1)*j+i,face=new THREE.Face3(a,b,d,[normals[a].clone(),normals[b].clone(),normals[d].clone()]);this.faces.push(face),this.faceVertexUvs[0].push([uvs[a].clone(),uvs[b].clone(),uvs[d].clone()]),face=new THREE.Face3(b,c,d,[normals[b].clone(),normals[c].clone(),normals[d].clone()]),this.faces.push(face),this.faceVertexUvs[0].push([uvs[b].clone(),uvs[c].clone(),uvs[d].clone()])}this.computeFaceNormals()},THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TorusKnotGeometry=function(radius,tube,radialSegments,tubularSegments,p,q,heightScale){function getPos(u,in_q,in_p,radius,heightScale){var cu=Math.cos(u),su=Math.sin(u),quOverP=in_q/in_p*u,cs=Math.cos(quOverP),tx=radius*(2+cs)*.5*cu,ty=radius*(2+cs)*su*.5,tz=heightScale*radius*Math.sin(quOverP)*.5;return new THREE.Vector3(tx,ty,tz)}THREE.Geometry.call(this),this.parameters={radius:radius,tube:tube,radialSegments:radialSegments,tubularSegments:tubularSegments,p:p,q:q,heightScale:heightScale},radius=radius||100,tube=tube||40,radialSegments=radialSegments||64,tubularSegments=tubularSegments||8,p=p||2,q=q||3,heightScale=heightScale||1;for(var grid=new Array(radialSegments),tang=new THREE.Vector3,n=new THREE.Vector3,bitan=new THREE.Vector3,i=0;radialSegments>i;++i){grid[i]=new Array(tubularSegments);var u=i/radialSegments*2*p*Math.PI,p1=getPos(u,q,p,radius,heightScale),p2=getPos(u+.01,q,p,radius,heightScale);tang.subVectors(p2,p1),n.addVectors(p2,p1),bitan.crossVectors(tang,n),n.crossVectors(bitan,tang),bitan.normalize(),n.normalize();for(var j=0;tubularSegments>j;++j){var v=j/tubularSegments*2*Math.PI,cx=-tube*Math.cos(v),cy=tube*Math.sin(v),pos=new THREE.Vector3;pos.x=p1.x+cx*n.x+cy*bitan.x,pos.y=p1.y+cx*n.y+cy*bitan.y,pos.z=p1.z+cx*n.z+cy*bitan.z,grid[i][j]=this.vertices.push(pos)-1}}for(var i=0;radialSegments>i;++i)for(var j=0;tubularSegments>j;++j){var ip=(i+1)%radialSegments,jp=(j+1)%tubularSegments,a=grid[i][j],b=grid[ip][j],c=grid[ip][jp],d=grid[i][jp],uva=new THREE.Vector2(i/radialSegments,j/tubularSegments),uvb=new THREE.Vector2((i+1)/radialSegments,j/tubularSegments),uvc=new THREE.Vector2((i+1)/radialSegments,(j+1)/tubularSegments),uvd=new THREE.Vector2(i/radialSegments,(j+1)/tubularSegments);this.faces.push(new THREE.Face3(a,b,d)),this.faceVertexUvs[0].push([uva,uvb,uvd]),this.faces.push(new THREE.Face3(b,c,d)),this.faceVertexUvs[0].push([uvb.clone(),uvc,uvd.clone()])}this.computeFaceNormals(),this.computeVertexNormals()},THREE.TorusKnotGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TubeGeometry=function(path,segments,radius,radialSegments,closed){function vert(x,y,z){return scope.vertices.push(new THREE.Vector3(x,y,z))-1}THREE.Geometry.call(this),this.parameters={path:path,segments:segments,radius:radius,radialSegments:radialSegments,closed:closed},segments=segments||64,radius=radius||1,radialSegments=radialSegments||8,closed=closed||!1;var tangent,normal,binormal,u,v,cx,cy,pos,i,j,ip,jp,a,b,c,d,uva,uvb,uvc,uvd,grid=[],scope=this,numpoints=segments+1,pos2=new THREE.Vector3,frames=new THREE.TubeGeometry.FrenetFrames(path,segments,closed),tangents=frames.tangents,normals=frames.normals,binormals=frames.binormals;for(this.tangents=tangents,this.normals=normals,this.binormals=binormals,i=0;numpoints>i;i++)for(grid[i]=[],u=i/(numpoints-1),pos=path.getPointAt(u),tangent=tangents[i],normal=normals[i],binormal=binormals[i],j=0;radialSegments>j;j++)v=j/radialSegments*2*Math.PI,cx=-radius*Math.cos(v),cy=radius*Math.sin(v),pos2.copy(pos),pos2.x+=cx*normal.x+cy*binormal.x,pos2.y+=cx*normal.y+cy*binormal.y,pos2.z+=cx*normal.z+cy*binormal.z,grid[i][j]=vert(pos2.x,pos2.y,pos2.z);for(i=0;segments>i;i++)for(j=0;radialSegments>j;j++)ip=closed?(i+1)%segments:i+1,jp=(j+1)%radialSegments,a=grid[i][j],b=grid[ip][j],c=grid[ip][jp],d=grid[i][jp],uva=new THREE.Vector2(i/segments,j/radialSegments),uvb=new THREE.Vector2((i+1)/segments,j/radialSegments),uvc=new THREE.Vector2((i+1)/segments,(j+1)/radialSegments),uvd=new THREE.Vector2(i/segments,(j+1)/radialSegments),this.faces.push(new THREE.Face3(a,b,d)),this.faceVertexUvs[0].push([uva,uvb,uvd]),this.faces.push(new THREE.Face3(b,c,d)),this.faceVertexUvs[0].push([uvb.clone(),uvc,uvd.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TubeGeometry.FrenetFrames=function(path,segments,closed){function initialNormal3(){normals[0]=new THREE.Vector3,binormals[0]=new THREE.Vector3,smallest=Number.MAX_VALUE,tx=Math.abs(tangents[0].x),ty=Math.abs(tangents[0].y),tz=Math.abs(tangents[0].z),smallest>=tx&&(smallest=tx,normal.set(1,0,0)),smallest>=ty&&(smallest=ty,normal.set(0,1,0)),smallest>=tz&&normal.set(0,0,1),vec.crossVectors(tangents[0],normal).normalize(),normals[0].crossVectors(tangents[0],vec),binormals[0].crossVectors(tangents[0],normals[0])}var theta,smallest,tx,ty,tz,i,u,normal=(new THREE.Vector3,new THREE.Vector3),tangents=(new THREE.Vector3,[]),normals=[],binormals=[],vec=new THREE.Vector3,mat=new THREE.Matrix4,numpoints=segments+1,epsilon=1e-4;for(this.tangents=tangents,this.normals=normals,this.binormals=binormals,i=0;numpoints>i;i++)u=i/(numpoints-1),tangents[i]=path.getTangentAt(u),tangents[i].normalize();for(initialNormal3(),i=1;numpoints>i;i++)normals[i]=normals[i-1].clone(),binormals[i]=binormals[i-1].clone(),vec.crossVectors(tangents[i-1],tangents[i]),vec.length()>epsilon&&(vec.normalize(),theta=Math.acos(THREE.Math.clamp(tangents[i-1].dot(tangents[i]),-1,1)),normals[i].applyMatrix4(mat.makeRotationAxis(vec,theta))),binormals[i].crossVectors(tangents[i],normals[i]);if(closed)for(theta=Math.acos(THREE.Math.clamp(normals[0].dot(normals[numpoints-1]),-1,1)),theta/=numpoints-1,tangents[0].dot(vec.crossVectors(normals[0],normals[numpoints-1]))>0&&(theta=-theta),i=1;numpoints>i;i++)normals[i].applyMatrix4(mat.makeRotationAxis(tangents[i],theta*i)),binormals[i].crossVectors(tangents[i],normals[i])},THREE.PolyhedronGeometry=function(vertices,indices,radius,detail){function prepare(vector){var vertex=vector.normalize().clone();vertex.index=that.vertices.push(vertex)-1;var u=azimuth(vector)/2/Math.PI+.5,v=inclination(vector)/Math.PI+.5;return vertex.uv=new THREE.Vector2(u,1-v),vertex}function make(v1,v2,v3){var face=new THREE.Face3(v1.index,v2.index,v3.index,[v1.clone(),v2.clone(),v3.clone()]);that.faces.push(face),centroid.copy(v1).add(v2).add(v3).divideScalar(3);var azi=azimuth(centroid);that.faceVertexUvs[0].push([correctUV(v1.uv,v1,azi),correctUV(v2.uv,v2,azi),correctUV(v3.uv,v3,azi)])}function subdivide(face,detail){for(var cols=Math.pow(2,detail),a=(Math.pow(4,detail),prepare(that.vertices[face.a])),b=prepare(that.vertices[face.b]),c=prepare(that.vertices[face.c]),v=[],i=0;cols>=i;i++){v[i]=[];for(var aj=prepare(a.clone().lerp(c,i/cols)),bj=prepare(b.clone().lerp(c,i/cols)),rows=cols-i,j=0;rows>=j;j++)v[i][j]=0==j&&i==cols?aj:prepare(aj.clone().lerp(bj,j/rows))}for(var i=0;cols>i;i++)for(var j=0;2*(cols-i)-1>j;j++){var k=Math.floor(j/2);j%2==0?make(v[i][k+1],v[i+1][k],v[i][k]):make(v[i][k+1],v[i+1][k+1],v[i+1][k])}}function azimuth(vector){return Math.atan2(vector.z,-vector.x)}function inclination(vector){return Math.atan2(-vector.y,Math.sqrt(vector.x*vector.x+vector.z*vector.z))}function correctUV(uv,vector,azimuth){return 0>azimuth&&1===uv.x&&(uv=new THREE.Vector2(uv.x-1,uv.y)),0===vector.x&&0===vector.z&&(uv=new THREE.Vector2(azimuth/2/Math.PI+.5,uv.y)),uv.clone()}THREE.Geometry.call(this),radius=radius||1,detail=detail||0;for(var that=this,i=0,l=vertices.length;l>i;i+=3)prepare(new THREE.Vector3(vertices[i],vertices[i+1],vertices[i+2]));for(var p=this.vertices,faces=[],i=0,j=0,l=indices.length;l>i;i+=3,j++){var v1=p[indices[i]],v2=p[indices[i+1]],v3=p[indices[i+2]];faces[j]=new THREE.Face3(v1.index,v2.index,v3.index,[v1.clone(),v2.clone(),v3.clone()])}for(var centroid=new THREE.Vector3,i=0,l=faces.length;l>i;i++)subdivide(faces[i],detail);for(var i=0,l=this.faceVertexUvs[0].length;l>i;i++){var uvs=this.faceVertexUvs[0][i],x0=uvs[0].x,x1=uvs[1].x,x2=uvs[2].x,max=Math.max(x0,Math.max(x1,x2)),min=Math.min(x0,Math.min(x1,x2));max>.9&&.1>min&&(.2>x0&&(uvs[0].x+=1),.2>x1&&(uvs[1].x+=1),.2>x2&&(uvs[2].x+=1))}for(var i=0,l=this.vertices.length;l>i;i++)this.vertices[i].multiplyScalar(radius);this.mergeVertices(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,radius)},THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.IcosahedronGeometry=function(radius,detail){this.parameters={radius:radius,detail:detail};var t=(1+Math.sqrt(5))/2,vertices=[-1,t,0,1,t,0,-1,-t,0,1,-t,0,0,-1,t,0,1,t,0,-1,-t,0,1,-t,t,0,-1,t,0,1,-t,0,-1,-t,0,1],indices=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];THREE.PolyhedronGeometry.call(this,vertices,indices,radius,detail)},THREE.IcosahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.OctahedronGeometry=function(radius,detail){this.parameters={radius:radius,detail:detail};var vertices=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],indices=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];THREE.PolyhedronGeometry.call(this,vertices,indices,radius,detail)},THREE.OctahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TetrahedronGeometry=function(radius,detail){var vertices=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],indices=[2,1,0,0,3,2,1,3,0,2,3,1];THREE.PolyhedronGeometry.call(this,vertices,indices,radius,detail)},THREE.TetrahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ParametricGeometry=function(func,slices,stacks){THREE.Geometry.call(this);var i,j,p,u,v,verts=this.vertices,faces=this.faces,uvs=this.faceVertexUvs[0],sliceCount=slices+1;for(i=0;stacks>=i;i++)for(v=i/stacks,j=0;slices>=j;j++)u=j/slices,p=func(u,v),verts.push(p);var a,b,c,d,uva,uvb,uvc,uvd;for(i=0;stacks>i;i++)for(j=0;slices>j;j++)a=i*sliceCount+j,b=i*sliceCount+j+1,c=(i+1)*sliceCount+j+1,d=(i+1)*sliceCount+j,uva=new THREE.Vector2(j/slices,i/stacks),uvb=new THREE.Vector2((j+1)/slices,i/stacks),uvc=new THREE.Vector2((j+1)/slices,(i+1)/stacks),uvd=new THREE.Vector2(j/slices,(i+1)/stacks),faces.push(new THREE.Face3(a,b,d)),uvs.push([uva,uvb,uvd]),faces.push(new THREE.Face3(b,c,d)),uvs.push([uvb.clone(),uvc,uvd.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},THREE.ParametricGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.AxisHelper=function(size){size=size||1;var vertices=new Float32Array([0,0,0,size,0,0,0,0,0,0,size,0,0,0,0,0,0,size]),colors=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]),geometry=new THREE.BufferGeometry;geometry.addAttribute("position",new THREE.BufferAttribute(vertices,3)),geometry.addAttribute("color",new THREE.BufferAttribute(colors,3));var material=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});THREE.Line.call(this,geometry,material,THREE.LinePieces)},THREE.AxisHelper.prototype=Object.create(THREE.Line.prototype),THREE.ArrowHelper=function(){var lineGeometry=new THREE.Geometry;lineGeometry.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,1,0));var coneGeometry=new THREE.CylinderGeometry(0,.5,1,5,1);return coneGeometry.applyMatrix((new THREE.Matrix4).makeTranslation(0,-.5,0)),function(dir,origin,length,color,headLength,headWidth){THREE.Object3D.call(this),void 0===color&&(color=16776960),void 0===length&&(length=1),void 0===headLength&&(headLength=.2*length),void 0===headWidth&&(headWidth=.2*headLength),this.position.copy(origin),this.line=new THREE.Line(lineGeometry,new THREE.LineBasicMaterial({color:color})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new THREE.Mesh(coneGeometry,new THREE.MeshBasicMaterial({color:color})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(dir),this.setLength(length,headLength,headWidth)}}(),THREE.ArrowHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.ArrowHelper.prototype.setDirection=function(){var radians,axis=new THREE.Vector3;return function(dir){dir.y>.99999?this.quaternion.set(0,0,0,1):dir.y<-.99999?this.quaternion.set(1,0,0,0):(axis.set(dir.z,0,-dir.x).normalize(),radians=Math.acos(dir.y),this.quaternion.setFromAxisAngle(axis,radians))}}(),THREE.ArrowHelper.prototype.setLength=function(length,headLength,headWidth){void 0===headLength&&(headLength=.2*length),void 0===headWidth&&(headWidth=.2*headLength),this.line.scale.set(1,length,1),this.line.updateMatrix(),this.cone.scale.set(headWidth,headLength,headWidth),this.cone.position.y=length,this.cone.updateMatrix()},THREE.ArrowHelper.prototype.setColor=function(color){this.line.material.color.set(color),this.cone.material.color.set(color)},THREE.BoxHelper=function(object){var geometry=new THREE.BufferGeometry;geometry.addAttribute("position",new THREE.BufferAttribute(new Float32Array(72),3)),THREE.Line.call(this,geometry,new THREE.LineBasicMaterial({color:16776960}),THREE.LinePieces),void 0!==object&&this.update(object)},THREE.BoxHelper.prototype=Object.create(THREE.Line.prototype),THREE.BoxHelper.prototype.update=function(object){var geometry=object.geometry;null===geometry.boundingBox&&geometry.computeBoundingBox();var min=geometry.boundingBox.min,max=geometry.boundingBox.max,vertices=this.geometry.attributes.position.array;vertices[0]=max.x,vertices[1]=max.y,vertices[2]=max.z,vertices[3]=min.x,vertices[4]=max.y,vertices[5]=max.z,vertices[6]=min.x,vertices[7]=max.y,vertices[8]=max.z,vertices[9]=min.x,vertices[10]=min.y,vertices[11]=max.z,vertices[12]=min.x,vertices[13]=min.y,vertices[14]=max.z,vertices[15]=max.x,vertices[16]=min.y,vertices[17]=max.z,vertices[18]=max.x,vertices[19]=min.y,vertices[20]=max.z,vertices[21]=max.x,vertices[22]=max.y,vertices[23]=max.z,vertices[24]=max.x,vertices[25]=max.y,vertices[26]=min.z,vertices[27]=min.x,vertices[28]=max.y,vertices[29]=min.z,vertices[30]=min.x,vertices[31]=max.y,vertices[32]=min.z,vertices[33]=min.x,vertices[34]=min.y,vertices[35]=min.z,vertices[36]=min.x,vertices[37]=min.y,vertices[38]=min.z,vertices[39]=max.x,vertices[40]=min.y,vertices[41]=min.z,vertices[42]=max.x,vertices[43]=min.y,vertices[44]=min.z,vertices[45]=max.x,vertices[46]=max.y,vertices[47]=min.z,vertices[48]=max.x,vertices[49]=max.y,vertices[50]=max.z,vertices[51]=max.x,vertices[52]=max.y,vertices[53]=min.z,vertices[54]=min.x,vertices[55]=max.y,vertices[56]=max.z,vertices[57]=min.x,vertices[58]=max.y,vertices[59]=min.z,vertices[60]=min.x,vertices[61]=min.y,vertices[62]=max.z,vertices[63]=min.x,vertices[64]=min.y,vertices[65]=min.z,vertices[66]=max.x,vertices[67]=min.y,vertices[68]=max.z,vertices[69]=max.x,vertices[70]=min.y,vertices[71]=min.z,this.geometry.attributes.position.needsUpdate=!0,this.geometry.computeBoundingSphere(),this.matrixAutoUpdate=!1,this.matrixWorld=object.matrixWorld},THREE.BoundingBoxHelper=function(object,hex){var color=void 0!==hex?hex:8947848;this.object=object,this.box=new THREE.Box3,THREE.Mesh.call(this,new THREE.BoxGeometry(1,1,1),new THREE.MeshBasicMaterial({color:color,wireframe:!0}))},THREE.BoundingBoxHelper.prototype=Object.create(THREE.Mesh.prototype),THREE.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object),this.box.size(this.scale),this.box.center(this.position)},THREE.CameraHelper=function(camera){function addLine(a,b,hex){addPoint(a,hex),addPoint(b,hex)}function addPoint(id,hex){geometry.vertices.push(new THREE.Vector3),geometry.colors.push(new THREE.Color(hex)),void 0===pointMap[id]&&(pointMap[id]=[]),pointMap[id].push(geometry.vertices.length-1)}var geometry=new THREE.Geometry,material=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors}),pointMap={},hexFrustum=16755200,hexCone=16711680,hexUp=43775,hexTarget=16777215,hexCross=3355443;addLine("n1","n2",hexFrustum),addLine("n2","n4",hexFrustum),addLine("n4","n3",hexFrustum),addLine("n3","n1",hexFrustum),addLine("f1","f2",hexFrustum),addLine("f2","f4",hexFrustum),addLine("f4","f3",hexFrustum),addLine("f3","f1",hexFrustum),addLine("n1","f1",hexFrustum),addLine("n2","f2",hexFrustum),addLine("n3","f3",hexFrustum),addLine("n4","f4",hexFrustum),addLine("p","n1",hexCone),addLine("p","n2",hexCone),addLine("p","n3",hexCone),addLine("p","n4",hexCone),addLine("u1","u2",hexUp),addLine("u2","u3",hexUp),addLine("u3","u1",hexUp),addLine("c","t",hexTarget),addLine("p","c",hexCross),addLine("cn1","cn2",hexCross),addLine("cn3","cn4",hexCross),addLine("cf1","cf2",hexCross),addLine("cf3","cf4",hexCross),THREE.Line.call(this,geometry,material,THREE.LinePieces),this.camera=camera,this.matrixWorld=camera.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=pointMap,this.update()},THREE.CameraHelper.prototype=Object.create(THREE.Line.prototype),THREE.CameraHelper.prototype.update=function(){var vector=new THREE.Vector3,camera=new THREE.Camera,projector=new THREE.Projector;return function(){function setPoint(point,x,y,z){vector.set(x,y,z),projector.unprojectVector(vector,camera);var points=scope.pointMap[point];if(void 0!==points)for(var i=0,il=points.length;il>i;i++)scope.geometry.vertices[points[i]].copy(vector)}var scope=this,w=1,h=1;camera.projectionMatrix.copy(this.camera.projectionMatrix),setPoint("c",0,0,-1),setPoint("t",0,0,1),setPoint("n1",-w,-h,-1),setPoint("n2",w,-h,-1),setPoint("n3",-w,h,-1),setPoint("n4",w,h,-1),setPoint("f1",-w,-h,1),setPoint("f2",w,-h,1),setPoint("f3",-w,h,1),setPoint("f4",w,h,1),setPoint("u1",.7*w,1.1*h,-1),setPoint("u2",.7*-w,1.1*h,-1),setPoint("u3",0,2*h,-1),setPoint("cf1",-w,0,1),setPoint("cf2",w,0,1),setPoint("cf3",0,-h,1),setPoint("cf4",0,h,1),setPoint("cn1",-w,0,-1),setPoint("cn2",w,0,-1),setPoint("cn3",0,-h,-1),setPoint("cn4",0,h,-1),this.geometry.verticesNeedUpdate=!0}}(),THREE.DirectionalLightHelper=function(light,size){THREE.Object3D.call(this),this.light=light,this.light.updateMatrixWorld(),this.matrixWorld=light.matrixWorld,this.matrixAutoUpdate=!1,size=size||1;var geometry=new THREE.Geometry;geometry.vertices.push(new THREE.Vector3(-size,size,0),new THREE.Vector3(size,size,0),new THREE.Vector3(size,-size,0),new THREE.Vector3(-size,-size,0),new THREE.Vector3(-size,size,0));var material=new THREE.LineBasicMaterial({fog:!1});material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightPlane=new THREE.Line(geometry,material),this.add(this.lightPlane),geometry=new THREE.Geometry,geometry.vertices.push(new THREE.Vector3,new THREE.Vector3),material=new THREE.LineBasicMaterial({fog:!1}),material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine=new THREE.Line(geometry,material),this.add(this.targetLine),this.update()},THREE.DirectionalLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},THREE.DirectionalLightHelper.prototype.update=function(){var v1=new THREE.Vector3,v2=new THREE.Vector3,v3=new THREE.Vector3;return function(){v1.setFromMatrixPosition(this.light.matrixWorld),v2.setFromMatrixPosition(this.light.target.matrixWorld),v3.subVectors(v2,v1),this.lightPlane.lookAt(v3),this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine.geometry.vertices[1].copy(v3),this.targetLine.geometry.verticesNeedUpdate=!0,this.targetLine.material.color.copy(this.lightPlane.material.color)}}(),THREE.EdgesHelper=function(object,hex){var color=void 0!==hex?hex:16777215,edge=[0,0],hash={},sortFunction=function(a,b){return a-b},keys=["a","b","c"],geometry=new THREE.BufferGeometry,geometry2=object.geometry.clone();geometry2.mergeVertices(),geometry2.computeFaceNormals();for(var vertices=geometry2.vertices,faces=geometry2.faces,numEdges=0,i=0,l=faces.length;l>i;i++)for(var face=faces[i],j=0;3>j;j++){edge[0]=face[keys[j]],edge[1]=face[keys[(j+1)%3]],edge.sort(sortFunction);var key=edge.toString();void 0===hash[key]?(hash[key]={vert1:edge[0],vert2:edge[1],face1:i,face2:void 0},numEdges++):hash[key].face2=i}geometry.addAttribute("position",new THREE.Float32Attribute(2*numEdges*3,3));var coords=geometry.attributes.position.array,index=0;for(var key in hash){var h=hash[key];if(void 0===h.face2||faces[h.face1].normal.dot(faces[h.face2].normal)<.9999){var vertex=vertices[h.vert1];coords[index++]=vertex.x,coords[index++]=vertex.y,coords[index++]=vertex.z,vertex=vertices[h.vert2],coords[index++]=vertex.x,coords[index++]=vertex.y,coords[index++]=vertex.z}}THREE.Line.call(this,geometry,new THREE.LineBasicMaterial({color:color}),THREE.LinePieces),this.matrixAutoUpdate=!1,this.matrixWorld=object.matrixWorld},THREE.EdgesHelper.prototype=Object.create(THREE.Line.prototype),THREE.FaceNormalsHelper=function(object,size,hex,linewidth){this.object=object,this.size=void 0!==size?size:1;for(var color=void 0!==hex?hex:16776960,width=void 0!==linewidth?linewidth:1,geometry=new THREE.Geometry,faces=this.object.geometry.faces,i=0,l=faces.length;l>i;i++)geometry.vertices.push(new THREE.Vector3,new THREE.Vector3);THREE.Line.call(this,geometry,new THREE.LineBasicMaterial({color:color,linewidth:width}),THREE.LinePieces),this.matrixAutoUpdate=!1,this.normalMatrix=new THREE.Matrix3,this.update()},THREE.FaceNormalsHelper.prototype=Object.create(THREE.Line.prototype),THREE.FaceNormalsHelper.prototype.update=function(){var vertices=this.geometry.vertices,object=this.object,objectVertices=object.geometry.vertices,objectFaces=object.geometry.faces,objectWorldMatrix=object.matrixWorld;object.updateMatrixWorld(!0),this.normalMatrix.getNormalMatrix(objectWorldMatrix);for(var i=0,i2=0,l=objectFaces.length;l>i;i++,i2+=2){var face=objectFaces[i];vertices[i2].copy(objectVertices[face.a]).add(objectVertices[face.b]).add(objectVertices[face.c]).divideScalar(3).applyMatrix4(objectWorldMatrix),vertices[i2+1].copy(face.normal).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size).add(vertices[i2])}return this.geometry.verticesNeedUpdate=!0,this},THREE.GridHelper=function(size,step){var geometry=new THREE.Geometry,material=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});this.color1=new THREE.Color(4473924),this.color2=new THREE.Color(8947848);for(var i=-size;size>=i;i+=step){geometry.vertices.push(new THREE.Vector3(-size,0,i),new THREE.Vector3(size,0,i),new THREE.Vector3(i,0,-size),new THREE.Vector3(i,0,size));var color=0===i?this.color1:this.color2;geometry.colors.push(color,color,color,color)}THREE.Line.call(this,geometry,material,THREE.LinePieces)},THREE.GridHelper.prototype=Object.create(THREE.Line.prototype),THREE.GridHelper.prototype.setColors=function(colorCenterLine,colorGrid){this.color1.set(colorCenterLine),this.color2.set(colorGrid),this.geometry.colorsNeedUpdate=!0},THREE.HemisphereLightHelper=function(light,sphereSize){THREE.Object3D.call(this),this.light=light,this.light.updateMatrixWorld(),this.matrixWorld=light.matrixWorld,this.matrixAutoUpdate=!1,this.colors=[new THREE.Color,new THREE.Color];var geometry=new THREE.SphereGeometry(sphereSize,4,2);geometry.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));for(var i=0,il=8;il>i;i++)geometry.faces[i].color=this.colors[4>i?0:1];var material=new THREE.MeshBasicMaterial({vertexColors:THREE.FaceColors,wireframe:!0});this.lightSphere=new THREE.Mesh(geometry,material),this.add(this.lightSphere),this.update()},THREE.HemisphereLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose(),this.lightSphere.material.dispose()},THREE.HemisphereLightHelper.prototype.update=function(){var vector=new THREE.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity),this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity),this.lightSphere.lookAt(vector.setFromMatrixPosition(this.light.matrixWorld).negate()),this.lightSphere.geometry.colorsNeedUpdate=!0}}(),THREE.PointLightHelper=function(light,sphereSize){this.light=light,this.light.updateMatrixWorld();var geometry=new THREE.SphereGeometry(sphereSize,4,2),material=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});material.color.copy(this.light.color).multiplyScalar(this.light.intensity),THREE.Mesh.call(this,geometry,material),this.matrixWorld=this.light.matrixWorld,this.matrixAutoUpdate=!1},THREE.PointLightHelper.prototype=Object.create(THREE.Mesh.prototype),THREE.PointLightHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},THREE.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},THREE.SkeletonHelper=function(object){this.bones=this.getBoneList(object);for(var geometry=new THREE.Geometry,i=0;i<this.bones.length;i++){var bone=this.bones[i];bone.parent instanceof THREE.Bone&&(geometry.vertices.push(new THREE.Vector3),geometry.vertices.push(new THREE.Vector3),geometry.colors.push(new THREE.Color(0,0,1)),geometry.colors.push(new THREE.Color(0,1,0)))}var material=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0});THREE.Line.call(this,geometry,material,THREE.LinePieces),this.root=object,this.matrixWorld=object.matrixWorld,this.matrixAutoUpdate=!1,this.update()},THREE.SkeletonHelper.prototype=Object.create(THREE.Line.prototype),THREE.SkeletonHelper.prototype.getBoneList=function(object){var boneList=[];object instanceof THREE.Bone&&boneList.push(object);for(var i=0;i<object.children.length;i++)boneList.push.apply(boneList,this.getBoneList(object.children[i]));return boneList},THREE.SkeletonHelper.prototype.update=function(){for(var geometry=this.geometry,matrixWorldInv=(new THREE.Matrix4).getInverse(this.root.matrixWorld),boneMatrix=new THREE.Matrix4,j=0,i=0;i<this.bones.length;i++){var bone=this.bones[i];bone.parent instanceof THREE.Bone&&(boneMatrix.multiplyMatrices(matrixWorldInv,bone.matrixWorld),geometry.vertices[j].setFromMatrixPosition(boneMatrix),boneMatrix.multiplyMatrices(matrixWorldInv,bone.parent.matrixWorld),geometry.vertices[j+1].setFromMatrixPosition(boneMatrix),j+=2)}geometry.verticesNeedUpdate=!0,geometry.computeBoundingSphere()},THREE.SpotLightHelper=function(light){THREE.Object3D.call(this),this.light=light,this.light.updateMatrixWorld(),this.matrixWorld=light.matrixWorld,this.matrixAutoUpdate=!1;var geometry=new THREE.CylinderGeometry(0,1,1,8,1,!0);geometry.applyMatrix((new THREE.Matrix4).makeTranslation(0,-.5,0)),geometry.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));var material=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new THREE.Mesh(geometry,material),this.add(this.cone),this.update()},THREE.SpotLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},THREE.SpotLightHelper.prototype.update=function(){var vector=new THREE.Vector3,vector2=new THREE.Vector3;return function(){var coneLength=this.light.distance?this.light.distance:1e4,coneWidth=coneLength*Math.tan(this.light.angle);this.cone.scale.set(coneWidth,coneWidth,coneLength),vector.setFromMatrixPosition(this.light.matrixWorld),vector2.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(vector2.sub(vector)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}(),THREE.VertexNormalsHelper=function(object,size,hex,linewidth){this.object=object,this.size=void 0!==size?size:1;for(var color=void 0!==hex?hex:16711680,width=void 0!==linewidth?linewidth:1,geometry=new THREE.Geometry,faces=(object.geometry.vertices,object.geometry.faces),i=0,l=faces.length;l>i;i++)for(var face=faces[i],j=0,jl=face.vertexNormals.length;jl>j;j++)geometry.vertices.push(new THREE.Vector3,new THREE.Vector3);THREE.Line.call(this,geometry,new THREE.LineBasicMaterial({color:color,linewidth:width}),THREE.LinePieces),this.matrixAutoUpdate=!1,this.normalMatrix=new THREE.Matrix3,this.update()
},THREE.VertexNormalsHelper.prototype=Object.create(THREE.Line.prototype),THREE.VertexNormalsHelper.prototype.update=function(){var v1=new THREE.Vector3;return function(){var keys=["a","b","c","d"];this.object.updateMatrixWorld(!0),this.normalMatrix.getNormalMatrix(this.object.matrixWorld);for(var vertices=this.geometry.vertices,verts=this.object.geometry.vertices,faces=this.object.geometry.faces,worldMatrix=this.object.matrixWorld,idx=0,i=0,l=faces.length;l>i;i++)for(var face=faces[i],j=0,jl=face.vertexNormals.length;jl>j;j++){var vertexId=face[keys[j]],vertex=verts[vertexId],normal=face.vertexNormals[j];vertices[idx].copy(vertex).applyMatrix4(worldMatrix),v1.copy(normal).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size),v1.add(vertices[idx]),idx+=1,vertices[idx].copy(v1),idx+=1}return this.geometry.verticesNeedUpdate=!0,this}}(),THREE.VertexTangentsHelper=function(object,size,hex,linewidth){this.object=object,this.size=void 0!==size?size:1;for(var color=void 0!==hex?hex:255,width=void 0!==linewidth?linewidth:1,geometry=new THREE.Geometry,faces=(object.geometry.vertices,object.geometry.faces),i=0,l=faces.length;l>i;i++)for(var face=faces[i],j=0,jl=face.vertexTangents.length;jl>j;j++)geometry.vertices.push(new THREE.Vector3),geometry.vertices.push(new THREE.Vector3);THREE.Line.call(this,geometry,new THREE.LineBasicMaterial({color:color,linewidth:width}),THREE.LinePieces),this.matrixAutoUpdate=!1,this.update()},THREE.VertexTangentsHelper.prototype=Object.create(THREE.Line.prototype),THREE.VertexTangentsHelper.prototype.update=function(){var v1=new THREE.Vector3;return function(){var keys=["a","b","c","d"];this.object.updateMatrixWorld(!0);for(var vertices=this.geometry.vertices,verts=this.object.geometry.vertices,faces=this.object.geometry.faces,worldMatrix=this.object.matrixWorld,idx=0,i=0,l=faces.length;l>i;i++)for(var face=faces[i],j=0,jl=face.vertexTangents.length;jl>j;j++){var vertexId=face[keys[j]],vertex=verts[vertexId],tangent=face.vertexTangents[j];vertices[idx].copy(vertex).applyMatrix4(worldMatrix),v1.copy(tangent).transformDirection(worldMatrix).multiplyScalar(this.size),v1.add(vertices[idx]),idx+=1,vertices[idx].copy(v1),idx+=1}return this.geometry.verticesNeedUpdate=!0,this}}(),THREE.WireframeHelper=function(object,hex){var color=void 0!==hex?hex:16777215,edge=[0,0],hash={},sortFunction=function(a,b){return a-b},keys=["a","b","c"],geometry=new THREE.BufferGeometry;if(object.geometry instanceof THREE.Geometry){for(var vertices=object.geometry.vertices,faces=object.geometry.faces,numEdges=0,edges=new Uint32Array(6*faces.length),i=0,l=faces.length;l>i;i++)for(var face=faces[i],j=0;3>j;j++){edge[0]=face[keys[j]],edge[1]=face[keys[(j+1)%3]],edge.sort(sortFunction);var key=edge.toString();void 0===hash[key]&&(edges[2*numEdges]=edge[0],edges[2*numEdges+1]=edge[1],hash[key]=!0,numEdges++)}for(var coords=new Float32Array(2*numEdges*3),i=0,l=numEdges;l>i;i++)for(var j=0;2>j;j++){var vertex=vertices[edges[2*i+j]],index=6*i+3*j;coords[index+0]=vertex.x,coords[index+1]=vertex.y,coords[index+2]=vertex.z}geometry.addAttribute("position",new THREE.BufferAttribute(coords,3))}else if(object.geometry instanceof THREE.BufferGeometry)if(void 0!==object.geometry.attributes.index){for(var vertices=object.geometry.attributes.position.array,indices=object.geometry.attributes.index.array,offsets=object.geometry.offsets,numEdges=0,edges=new Uint32Array(2*indices.length),o=0,ol=offsets.length;ol>o;++o)for(var start=offsets[o].start,count=offsets[o].count,index=offsets[o].index,i=start,il=start+count;il>i;i+=3)for(var j=0;3>j;j++){edge[0]=index+indices[i+j],edge[1]=index+indices[i+(j+1)%3],edge.sort(sortFunction);var key=edge.toString();void 0===hash[key]&&(edges[2*numEdges]=edge[0],edges[2*numEdges+1]=edge[1],hash[key]=!0,numEdges++)}for(var coords=new Float32Array(2*numEdges*3),i=0,l=numEdges;l>i;i++)for(var j=0;2>j;j++){var index=6*i+3*j,index2=3*edges[2*i+j];coords[index+0]=vertices[index2],coords[index+1]=vertices[index2+1],coords[index+2]=vertices[index2+2]}geometry.addAttribute("position",new THREE.BufferAttribute(coords,3))}else{for(var vertices=object.geometry.attributes.position.array,numEdges=vertices.length/3,numTris=numEdges/3,coords=new Float32Array(2*numEdges*3),i=0,l=numTris;l>i;i++)for(var j=0;3>j;j++){var index=18*i+6*j,index1=9*i+3*j;coords[index+0]=vertices[index1],coords[index+1]=vertices[index1+1],coords[index+2]=vertices[index1+2];var index2=9*i+3*((j+1)%3);coords[index+3]=vertices[index2],coords[index+4]=vertices[index2+1],coords[index+5]=vertices[index2+2]}geometry.addAttribute("position",new THREE.BufferAttribute(coords,3))}THREE.Line.call(this,geometry,new THREE.LineBasicMaterial({color:color}),THREE.LinePieces),this.matrixAutoUpdate=!1,this.matrixWorld=object.matrixWorld},THREE.WireframeHelper.prototype=Object.create(THREE.Line.prototype),THREE.ImmediateRenderObject=function(){THREE.Object3D.call(this),this.render=function(){}},THREE.ImmediateRenderObject.prototype=Object.create(THREE.Object3D.prototype),THREE.LensFlare=function(texture,size,distance,blending,color){THREE.Object3D.call(this),this.lensFlares=[],this.positionScreen=new THREE.Vector3,this.customUpdateCallback=void 0,void 0!==texture&&this.add(texture,size,distance,blending,color)},THREE.LensFlare.prototype=Object.create(THREE.Object3D.prototype),THREE.LensFlare.prototype.add=function(texture,size,distance,blending,color,opacity){void 0===size&&(size=-1),void 0===distance&&(distance=0),void 0===opacity&&(opacity=1),void 0===color&&(color=new THREE.Color(16777215)),void 0===blending&&(blending=THREE.NormalBlending),distance=Math.min(distance,Math.max(0,distance)),this.lensFlares.push({texture:texture,size:size,distance:distance,x:0,y:0,z:0,scale:1,rotation:1,opacity:opacity,color:color,blending:blending})},THREE.LensFlare.prototype.updateLensFlares=function(){var f,flare,fl=this.lensFlares.length,vecX=2*-this.positionScreen.x,vecY=2*-this.positionScreen.y;for(f=0;fl>f;f++)flare=this.lensFlares[f],flare.x=this.positionScreen.x+vecX*flare.distance,flare.y=this.positionScreen.y+vecY*flare.distance,flare.wantedRotation=flare.x*Math.PI*.25,flare.rotation+=.25*(flare.wantedRotation-flare.rotation)},THREE.MorphBlendMesh=function(geometry,material){THREE.Mesh.call(this,geometry,material),this.animationsMap={},this.animationsList=[];var numFrames=this.geometry.morphTargets.length,name="__default",startFrame=0,endFrame=numFrames-1,fps=numFrames/1;this.createAnimation(name,startFrame,endFrame,fps),this.setAnimationWeight(name,1)},THREE.MorphBlendMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.MorphBlendMesh.prototype.createAnimation=function(name,start,end,fps){var animation={startFrame:start,endFrame:end,length:end-start+1,fps:fps,duration:(end-start)/fps,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[name]=animation,this.animationsList.push(animation)},THREE.MorphBlendMesh.prototype.autoCreateAnimations=function(fps){for(var firstAnimation,pattern=/([a-z]+)_?(\d+)/,frameRanges={},geometry=this.geometry,i=0,il=geometry.morphTargets.length;il>i;i++){var morph=geometry.morphTargets[i],chunks=morph.name.match(pattern);if(chunks&&chunks.length>1){{var name=chunks[1];chunks[2]}frameRanges[name]||(frameRanges[name]={start:1/0,end:-1/0});var range=frameRanges[name];i<range.start&&(range.start=i),i>range.end&&(range.end=i),firstAnimation||(firstAnimation=name)}}for(var name in frameRanges){var range=frameRanges[name];this.createAnimation(name,range.start,range.end,fps)}this.firstAnimation=firstAnimation},THREE.MorphBlendMesh.prototype.setAnimationDirectionForward=function(name){var animation=this.animationsMap[name];animation&&(animation.direction=1,animation.directionBackwards=!1)},THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(name){var animation=this.animationsMap[name];animation&&(animation.direction=-1,animation.directionBackwards=!0)},THREE.MorphBlendMesh.prototype.setAnimationFPS=function(name,fps){var animation=this.animationsMap[name];animation&&(animation.fps=fps,animation.duration=(animation.end-animation.start)/animation.fps)},THREE.MorphBlendMesh.prototype.setAnimationDuration=function(name,duration){var animation=this.animationsMap[name];animation&&(animation.duration=duration,animation.fps=(animation.end-animation.start)/animation.duration)},THREE.MorphBlendMesh.prototype.setAnimationWeight=function(name,weight){var animation=this.animationsMap[name];animation&&(animation.weight=weight)},THREE.MorphBlendMesh.prototype.setAnimationTime=function(name,time){var animation=this.animationsMap[name];animation&&(animation.time=time)},THREE.MorphBlendMesh.prototype.getAnimationTime=function(name){var time=0,animation=this.animationsMap[name];return animation&&(time=animation.time),time},THREE.MorphBlendMesh.prototype.getAnimationDuration=function(name){var duration=-1,animation=this.animationsMap[name];return animation&&(duration=animation.duration),duration},THREE.MorphBlendMesh.prototype.playAnimation=function(name){var animation=this.animationsMap[name];animation?(animation.time=0,animation.active=!0):console.warn("animation["+name+"] undefined")},THREE.MorphBlendMesh.prototype.stopAnimation=function(name){var animation=this.animationsMap[name];animation&&(animation.active=!1)},THREE.MorphBlendMesh.prototype.update=function(delta){for(var i=0,il=this.animationsList.length;il>i;i++){var animation=this.animationsList[i];if(animation.active){var frameTime=animation.duration/animation.length;animation.time+=animation.direction*delta,animation.mirroredLoop?(animation.time>animation.duration||animation.time<0)&&(animation.direction*=-1,animation.time>animation.duration&&(animation.time=animation.duration,animation.directionBackwards=!0),animation.time<0&&(animation.time=0,animation.directionBackwards=!1)):(animation.time=animation.time%animation.duration,animation.time<0&&(animation.time+=animation.duration));var keyframe=animation.startFrame+THREE.Math.clamp(Math.floor(animation.time/frameTime),0,animation.length-1),weight=animation.weight;keyframe!==animation.currentFrame&&(this.morphTargetInfluences[animation.lastFrame]=0,this.morphTargetInfluences[animation.currentFrame]=1*weight,this.morphTargetInfluences[keyframe]=0,animation.lastFrame=animation.currentFrame,animation.currentFrame=keyframe);var mix=animation.time%frameTime/frameTime;animation.directionBackwards&&(mix=1-mix),this.morphTargetInfluences[animation.currentFrame]=mix*weight,this.morphTargetInfluences[animation.lastFrame]=(1-mix)*weight}}},THREE.LensFlarePlugin=function(){function createProgram(shader,precision){var program=_gl.createProgram(),fragmentShader=_gl.createShader(_gl.FRAGMENT_SHADER),vertexShader=_gl.createShader(_gl.VERTEX_SHADER),prefix="precision "+precision+" float;\n";return _gl.shaderSource(fragmentShader,prefix+shader.fragmentShader),_gl.shaderSource(vertexShader,prefix+shader.vertexShader),_gl.compileShader(fragmentShader),_gl.compileShader(vertexShader),_gl.attachShader(program,fragmentShader),_gl.attachShader(program,vertexShader),_gl.linkProgram(program),program}var _gl,_renderer,_precision,flares=[],_lensFlare={};this.init=function(renderer){_gl=renderer.context,_renderer=renderer,_precision=renderer.getPrecision(),_lensFlare.vertices=new Float32Array(16),_lensFlare.faces=new Uint16Array(6);var i=0;_lensFlare.vertices[i++]=-1,_lensFlare.vertices[i++]=-1,_lensFlare.vertices[i++]=0,_lensFlare.vertices[i++]=0,_lensFlare.vertices[i++]=1,_lensFlare.vertices[i++]=-1,_lensFlare.vertices[i++]=1,_lensFlare.vertices[i++]=0,_lensFlare.vertices[i++]=1,_lensFlare.vertices[i++]=1,_lensFlare.vertices[i++]=1,_lensFlare.vertices[i++]=1,_lensFlare.vertices[i++]=-1,_lensFlare.vertices[i++]=1,_lensFlare.vertices[i++]=0,_lensFlare.vertices[i++]=1,i=0,_lensFlare.faces[i++]=0,_lensFlare.faces[i++]=1,_lensFlare.faces[i++]=2,_lensFlare.faces[i++]=0,_lensFlare.faces[i++]=2,_lensFlare.faces[i++]=3,_lensFlare.vertexBuffer=_gl.createBuffer(),_lensFlare.elementBuffer=_gl.createBuffer(),_gl.bindBuffer(_gl.ARRAY_BUFFER,_lensFlare.vertexBuffer),_gl.bufferData(_gl.ARRAY_BUFFER,_lensFlare.vertices,_gl.STATIC_DRAW),_gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER,_lensFlare.elementBuffer),_gl.bufferData(_gl.ELEMENT_ARRAY_BUFFER,_lensFlare.faces,_gl.STATIC_DRAW),_lensFlare.tempTexture=_gl.createTexture(),_lensFlare.occlusionTexture=_gl.createTexture(),_gl.bindTexture(_gl.TEXTURE_2D,_lensFlare.tempTexture),_gl.texImage2D(_gl.TEXTURE_2D,0,_gl.RGB,16,16,0,_gl.RGB,_gl.UNSIGNED_BYTE,null),_gl.texParameteri(_gl.TEXTURE_2D,_gl.TEXTURE_WRAP_S,_gl.CLAMP_TO_EDGE),_gl.texParameteri(_gl.TEXTURE_2D,_gl.TEXTURE_WRAP_T,_gl.CLAMP_TO_EDGE),_gl.texParameteri(_gl.TEXTURE_2D,_gl.TEXTURE_MAG_FILTER,_gl.NEAREST),_gl.texParameteri(_gl.TEXTURE_2D,_gl.TEXTURE_MIN_FILTER,_gl.NEAREST),_gl.bindTexture(_gl.TEXTURE_2D,_lensFlare.occlusionTexture),_gl.texImage2D(_gl.TEXTURE_2D,0,_gl.RGBA,16,16,0,_gl.RGBA,_gl.UNSIGNED_BYTE,null),_gl.texParameteri(_gl.TEXTURE_2D,_gl.TEXTURE_WRAP_S,_gl.CLAMP_TO_EDGE),_gl.texParameteri(_gl.TEXTURE_2D,_gl.TEXTURE_WRAP_T,_gl.CLAMP_TO_EDGE),_gl.texParameteri(_gl.TEXTURE_2D,_gl.TEXTURE_MAG_FILTER,_gl.NEAREST),_gl.texParameteri(_gl.TEXTURE_2D,_gl.TEXTURE_MIN_FILTER,_gl.NEAREST),_gl.getParameter(_gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS)<=0?(_lensFlare.hasVertexTexture=!1,_lensFlare.program=createProgram(THREE.ShaderFlares.lensFlare,_precision)):(_lensFlare.hasVertexTexture=!0,_lensFlare.program=createProgram(THREE.ShaderFlares.lensFlareVertexTexture,_precision)),_lensFlare.attributes={},_lensFlare.uniforms={},_lensFlare.attributes.vertex=_gl.getAttribLocation(_lensFlare.program,"position"),_lensFlare.attributes.uv=_gl.getAttribLocation(_lensFlare.program,"uv"),_lensFlare.uniforms.renderType=_gl.getUniformLocation(_lensFlare.program,"renderType"),_lensFlare.uniforms.map=_gl.getUniformLocation(_lensFlare.program,"map"),_lensFlare.uniforms.occlusionMap=_gl.getUniformLocation(_lensFlare.program,"occlusionMap"),_lensFlare.uniforms.opacity=_gl.getUniformLocation(_lensFlare.program,"opacity"),_lensFlare.uniforms.color=_gl.getUniformLocation(_lensFlare.program,"color"),_lensFlare.uniforms.scale=_gl.getUniformLocation(_lensFlare.program,"scale"),_lensFlare.uniforms.rotation=_gl.getUniformLocation(_lensFlare.program,"rotation"),_lensFlare.uniforms.screenPosition=_gl.getUniformLocation(_lensFlare.program,"screenPosition")},this.render=function(scene,camera,viewportWidth,viewportHeight){if(flares.length=0,scene.traverseVisible(function(child){child instanceof THREE.LensFlare&&flares.push(child)}),0!==flares.length){var tempPosition=new THREE.Vector3,invAspect=viewportHeight/viewportWidth,halfViewportWidth=.5*viewportWidth,halfViewportHeight=.5*viewportHeight,size=16/viewportHeight,scale=new THREE.Vector2(size*invAspect,size),screenPosition=new THREE.Vector3(1,1,0),screenPositionPixels=new THREE.Vector2(1,1),uniforms=_lensFlare.uniforms,attributes=_lensFlare.attributes;_gl.useProgram(_lensFlare.program),_gl.enableVertexAttribArray(_lensFlare.attributes.vertex),_gl.enableVertexAttribArray(_lensFlare.attributes.uv),_gl.uniform1i(uniforms.occlusionMap,0),_gl.uniform1i(uniforms.map,1),_gl.bindBuffer(_gl.ARRAY_BUFFER,_lensFlare.vertexBuffer),_gl.vertexAttribPointer(attributes.vertex,2,_gl.FLOAT,!1,16,0),_gl.vertexAttribPointer(attributes.uv,2,_gl.FLOAT,!1,16,8),_gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER,_lensFlare.elementBuffer),_gl.disable(_gl.CULL_FACE),_gl.depthMask(!1);for(var i=0,l=flares.length;l>i;i++){size=16/viewportHeight,scale.set(size*invAspect,size);var flare=flares[i];if(tempPosition.set(flare.matrixWorld.elements[12],flare.matrixWorld.elements[13],flare.matrixWorld.elements[14]),tempPosition.applyMatrix4(camera.matrixWorldInverse),tempPosition.applyProjection(camera.projectionMatrix),screenPosition.copy(tempPosition),screenPositionPixels.x=screenPosition.x*halfViewportWidth+halfViewportWidth,screenPositionPixels.y=screenPosition.y*halfViewportHeight+halfViewportHeight,_lensFlare.hasVertexTexture||screenPositionPixels.x>0&&screenPositionPixels.x<viewportWidth&&screenPositionPixels.y>0&&screenPositionPixels.y<viewportHeight){_gl.activeTexture(_gl.TEXTURE1),_gl.bindTexture(_gl.TEXTURE_2D,_lensFlare.tempTexture),_gl.copyTexImage2D(_gl.TEXTURE_2D,0,_gl.RGB,screenPositionPixels.x-8,screenPositionPixels.y-8,16,16,0),_gl.uniform1i(uniforms.renderType,0),_gl.uniform2f(uniforms.scale,scale.x,scale.y),_gl.uniform3f(uniforms.screenPosition,screenPosition.x,screenPosition.y,screenPosition.z),_gl.disable(_gl.BLEND),_gl.enable(_gl.DEPTH_TEST),_gl.drawElements(_gl.TRIANGLES,6,_gl.UNSIGNED_SHORT,0),_gl.activeTexture(_gl.TEXTURE0),_gl.bindTexture(_gl.TEXTURE_2D,_lensFlare.occlusionTexture),_gl.copyTexImage2D(_gl.TEXTURE_2D,0,_gl.RGBA,screenPositionPixels.x-8,screenPositionPixels.y-8,16,16,0),_gl.uniform1i(uniforms.renderType,1),_gl.disable(_gl.DEPTH_TEST),_gl.activeTexture(_gl.TEXTURE1),_gl.bindTexture(_gl.TEXTURE_2D,_lensFlare.tempTexture),_gl.drawElements(_gl.TRIANGLES,6,_gl.UNSIGNED_SHORT,0),flare.positionScreen.copy(screenPosition),flare.customUpdateCallback?flare.customUpdateCallback(flare):flare.updateLensFlares(),_gl.uniform1i(uniforms.renderType,2),_gl.enable(_gl.BLEND);for(var j=0,jl=flare.lensFlares.length;jl>j;j++){var sprite=flare.lensFlares[j];sprite.opacity>.001&&sprite.scale>.001&&(screenPosition.x=sprite.x,screenPosition.y=sprite.y,screenPosition.z=sprite.z,size=sprite.size*sprite.scale/viewportHeight,scale.x=size*invAspect,scale.y=size,_gl.uniform3f(uniforms.screenPosition,screenPosition.x,screenPosition.y,screenPosition.z),_gl.uniform2f(uniforms.scale,scale.x,scale.y),_gl.uniform1f(uniforms.rotation,sprite.rotation),_gl.uniform1f(uniforms.opacity,sprite.opacity),_gl.uniform3f(uniforms.color,sprite.color.r,sprite.color.g,sprite.color.b),_renderer.setBlending(sprite.blending,sprite.blendEquation,sprite.blendSrc,sprite.blendDst),_renderer.setTexture(sprite.texture,1),_gl.drawElements(_gl.TRIANGLES,6,_gl.UNSIGNED_SHORT,0))}}}_gl.enable(_gl.CULL_FACE),_gl.enable(_gl.DEPTH_TEST),_gl.depthMask(!0)}}},THREE.ShadowMapPlugin=function(){function projectObject(scene,object,shadowCamera){if(object.visible){var webglObjects=scene.__webglObjects[object.id];if(webglObjects&&object.castShadow&&(object.frustumCulled===!1||_frustum.intersectsObject(object)===!0))for(var i=0,l=webglObjects.length;l>i;i++){var webglObject=webglObjects[i];object._modelViewMatrix.multiplyMatrices(shadowCamera.matrixWorldInverse,object.matrixWorld),_renderList.push(webglObject)}for(var i=0,l=object.children.length;l>i;i++)projectObject(scene,object.children[i],shadowCamera)}}function createVirtualLight(light,cascade){var virtualLight=new THREE.DirectionalLight;virtualLight.isVirtual=!0,virtualLight.onlyShadow=!0,virtualLight.castShadow=!0,virtualLight.shadowCameraNear=light.shadowCameraNear,virtualLight.shadowCameraFar=light.shadowCameraFar,virtualLight.shadowCameraLeft=light.shadowCameraLeft,virtualLight.shadowCameraRight=light.shadowCameraRight,virtualLight.shadowCameraBottom=light.shadowCameraBottom,virtualLight.shadowCameraTop=light.shadowCameraTop,virtualLight.shadowCameraVisible=light.shadowCameraVisible,virtualLight.shadowDarkness=light.shadowDarkness,virtualLight.shadowBias=light.shadowCascadeBias[cascade],virtualLight.shadowMapWidth=light.shadowCascadeWidth[cascade],virtualLight.shadowMapHeight=light.shadowCascadeHeight[cascade],virtualLight.pointsWorld=[],virtualLight.pointsFrustum=[];for(var pointsWorld=virtualLight.pointsWorld,pointsFrustum=virtualLight.pointsFrustum,i=0;8>i;i++)pointsWorld[i]=new THREE.Vector3,pointsFrustum[i]=new THREE.Vector3;var nearZ=light.shadowCascadeNearZ[cascade],farZ=light.shadowCascadeFarZ[cascade];return pointsFrustum[0].set(-1,-1,nearZ),pointsFrustum[1].set(1,-1,nearZ),pointsFrustum[2].set(-1,1,nearZ),pointsFrustum[3].set(1,1,nearZ),pointsFrustum[4].set(-1,-1,farZ),pointsFrustum[5].set(1,-1,farZ),pointsFrustum[6].set(-1,1,farZ),pointsFrustum[7].set(1,1,farZ),virtualLight}function updateVirtualLight(light,cascade){var virtualLight=light.shadowCascadeArray[cascade];virtualLight.position.copy(light.position),virtualLight.target.position.copy(light.target.position),virtualLight.lookAt(virtualLight.target),virtualLight.shadowCameraVisible=light.shadowCameraVisible,virtualLight.shadowDarkness=light.shadowDarkness,virtualLight.shadowBias=light.shadowCascadeBias[cascade];var nearZ=light.shadowCascadeNearZ[cascade],farZ=light.shadowCascadeFarZ[cascade],pointsFrustum=virtualLight.pointsFrustum;pointsFrustum[0].z=nearZ,pointsFrustum[1].z=nearZ,pointsFrustum[2].z=nearZ,pointsFrustum[3].z=nearZ,pointsFrustum[4].z=farZ,pointsFrustum[5].z=farZ,pointsFrustum[6].z=farZ,pointsFrustum[7].z=farZ}function updateShadowCamera(camera,light){var shadowCamera=light.shadowCamera,pointsFrustum=light.pointsFrustum,pointsWorld=light.pointsWorld;_min.set(1/0,1/0,1/0),_max.set(-1/0,-1/0,-1/0);for(var i=0;8>i;i++){var p=pointsWorld[i];p.copy(pointsFrustum[i]),THREE.ShadowMapPlugin.__projector.unprojectVector(p,camera),p.applyMatrix4(shadowCamera.matrixWorldInverse),p.x<_min.x&&(_min.x=p.x),p.x>_max.x&&(_max.x=p.x),p.y<_min.y&&(_min.y=p.y),p.y>_max.y&&(_max.y=p.y),p.z<_min.z&&(_min.z=p.z),p.z>_max.z&&(_max.z=p.z)}shadowCamera.left=_min.x,shadowCamera.right=_max.x,shadowCamera.top=_max.y,shadowCamera.bottom=_min.y,shadowCamera.updateProjectionMatrix()}function getObjectMaterial(object){return object.material instanceof THREE.MeshFaceMaterial?object.material.materials[0]:object.material}var _gl,_renderer,_depthMaterial,_depthMaterialMorph,_depthMaterialSkin,_depthMaterialMorphSkin,_frustum=new THREE.Frustum,_projScreenMatrix=new THREE.Matrix4,_min=new THREE.Vector3,_max=new THREE.Vector3,_matrixPosition=new THREE.Vector3,_renderList=[];this.init=function(renderer){_gl=renderer.context,_renderer=renderer;var depthShader=THREE.ShaderLib.depthRGBA,depthUniforms=THREE.UniformsUtils.clone(depthShader.uniforms);_depthMaterial=new THREE.ShaderMaterial({fragmentShader:depthShader.fragmentShader,vertexShader:depthShader.vertexShader,uniforms:depthUniforms}),_depthMaterialMorph=new THREE.ShaderMaterial({fragmentShader:depthShader.fragmentShader,vertexShader:depthShader.vertexShader,uniforms:depthUniforms,morphTargets:!0}),_depthMaterialSkin=new THREE.ShaderMaterial({fragmentShader:depthShader.fragmentShader,vertexShader:depthShader.vertexShader,uniforms:depthUniforms,skinning:!0}),_depthMaterialMorphSkin=new THREE.ShaderMaterial({fragmentShader:depthShader.fragmentShader,vertexShader:depthShader.vertexShader,uniforms:depthUniforms,morphTargets:!0,skinning:!0}),_depthMaterial._shadowPass=!0,_depthMaterialMorph._shadowPass=!0,_depthMaterialSkin._shadowPass=!0,_depthMaterialMorphSkin._shadowPass=!0},this.render=function(scene,camera){_renderer.shadowMapEnabled&&_renderer.shadowMapAutoUpdate&&this.update(scene,camera)},this.update=function(scene,camera){var i,il,j,jl,n,shadowMap,shadowMatrix,shadowCamera,buffer,material,webglObject,object,light,lights=[],k=0,fog=null;for(_gl.clearColor(1,1,1,1),_gl.disable(_gl.BLEND),_gl.enable(_gl.CULL_FACE),_gl.frontFace(_gl.CCW),_gl.cullFace(_renderer.shadowMapCullFace===THREE.CullFaceFront?_gl.FRONT:_gl.BACK),_renderer.setDepthTest(!0),i=0,il=scene.__lights.length;il>i;i++)if(light=scene.__lights[i],light.castShadow)if(light instanceof THREE.DirectionalLight&&light.shadowCascade)for(n=0;n<light.shadowCascadeCount;n++){var virtualLight;if(light.shadowCascadeArray[n])virtualLight=light.shadowCascadeArray[n];else{virtualLight=createVirtualLight(light,n),virtualLight.originalCamera=camera;var gyro=new THREE.Gyroscope;gyro.position.copy(light.shadowCascadeOffset),gyro.add(virtualLight),gyro.add(virtualLight.target),camera.add(gyro),light.shadowCascadeArray[n]=virtualLight,console.log("Created virtualLight",virtualLight)}updateVirtualLight(light,n),lights[k]=virtualLight,k++}else lights[k]=light,k++;for(i=0,il=lights.length;il>i;i++){if(light=lights[i],!light.shadowMap){var shadowFilter=THREE.LinearFilter;_renderer.shadowMapType===THREE.PCFSoftShadowMap&&(shadowFilter=THREE.NearestFilter);var pars={minFilter:shadowFilter,magFilter:shadowFilter,format:THREE.RGBAFormat};light.shadowMap=new THREE.WebGLRenderTarget(light.shadowMapWidth,light.shadowMapHeight,pars),light.shadowMapSize=new THREE.Vector2(light.shadowMapWidth,light.shadowMapHeight),light.shadowMatrix=new THREE.Matrix4}if(!light.shadowCamera){if(light instanceof THREE.SpotLight)light.shadowCamera=new THREE.PerspectiveCamera(light.shadowCameraFov,light.shadowMapWidth/light.shadowMapHeight,light.shadowCameraNear,light.shadowCameraFar);else{if(!(light instanceof THREE.DirectionalLight)){console.error("Unsupported light type for shadow");continue}light.shadowCamera=new THREE.OrthographicCamera(light.shadowCameraLeft,light.shadowCameraRight,light.shadowCameraTop,light.shadowCameraBottom,light.shadowCameraNear,light.shadowCameraFar)}scene.add(light.shadowCamera),scene.autoUpdate===!0&&scene.updateMatrixWorld()}light.shadowCameraVisible&&!light.cameraHelper&&(light.cameraHelper=new THREE.CameraHelper(light.shadowCamera),light.shadowCamera.add(light.cameraHelper)),light.isVirtual&&virtualLight.originalCamera==camera&&updateShadowCamera(camera,light),shadowMap=light.shadowMap,shadowMatrix=light.shadowMatrix,shadowCamera=light.shadowCamera,shadowCamera.position.setFromMatrixPosition(light.matrixWorld),_matrixPosition.setFromMatrixPosition(light.target.matrixWorld),shadowCamera.lookAt(_matrixPosition),shadowCamera.updateMatrixWorld(),shadowCamera.matrixWorldInverse.getInverse(shadowCamera.matrixWorld),light.cameraHelper&&(light.cameraHelper.visible=light.shadowCameraVisible),light.shadowCameraVisible&&light.cameraHelper.update(),shadowMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),shadowMatrix.multiply(shadowCamera.projectionMatrix),shadowMatrix.multiply(shadowCamera.matrixWorldInverse),_projScreenMatrix.multiplyMatrices(shadowCamera.projectionMatrix,shadowCamera.matrixWorldInverse),_frustum.setFromMatrix(_projScreenMatrix),_renderer.setRenderTarget(shadowMap),_renderer.clear(),_renderList.length=0,projectObject(scene,scene,shadowCamera);var objectMaterial,useMorphing,useSkinning;for(j=0,jl=_renderList.length;jl>j;j++)webglObject=_renderList[j],object=webglObject.object,buffer=webglObject.buffer,objectMaterial=getObjectMaterial(object),useMorphing=void 0!==object.geometry.morphTargets&&object.geometry.morphTargets.length>0&&objectMaterial.morphTargets,useSkinning=object instanceof THREE.SkinnedMesh&&objectMaterial.skinning,material=object.customDepthMaterial?object.customDepthMaterial:useSkinning?useMorphing?_depthMaterialMorphSkin:_depthMaterialSkin:useMorphing?_depthMaterialMorph:_depthMaterial,_renderer.setMaterialFaces(objectMaterial),buffer instanceof THREE.BufferGeometry?_renderer.renderBufferDirect(shadowCamera,scene.__lights,fog,material,buffer,object):_renderer.renderBuffer(shadowCamera,scene.__lights,fog,material,buffer,object);var renderList=scene.__webglObjectsImmediate;for(j=0,jl=renderList.length;jl>j;j++)webglObject=renderList[j],object=webglObject.object,object.visible&&object.castShadow&&(object._modelViewMatrix.multiplyMatrices(shadowCamera.matrixWorldInverse,object.matrixWorld),_renderer.renderImmediateObject(shadowCamera,scene.__lights,fog,_depthMaterial,object))}var clearColor=_renderer.getClearColor(),clearAlpha=_renderer.getClearAlpha();_gl.clearColor(clearColor.r,clearColor.g,clearColor.b,clearAlpha),_gl.enable(_gl.BLEND),_renderer.shadowMapCullFace===THREE.CullFaceFront&&_gl.cullFace(_gl.BACK)}},THREE.ShadowMapPlugin.__projector=new THREE.Projector,THREE.SpritePlugin=function(){function createProgram(){var program=_gl.createProgram(),vertexShader=_gl.createShader(_gl.VERTEX_SHADER),fragmentShader=_gl.createShader(_gl.FRAGMENT_SHADER);return _gl.shaderSource(vertexShader,["precision "+_renderer.getPrecision()+" float;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n")),_gl.shaderSource(fragmentShader,["precision "+_renderer.getPrecision()+" float;","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")),_gl.compileShader(vertexShader),_gl.compileShader(fragmentShader),_gl.attachShader(program,vertexShader),_gl.attachShader(program,fragmentShader),_gl.linkProgram(program),program}function painterSortStable(a,b){return a.z!==b.z?b.z-a.z:b.id-a.id}var _gl,_renderer,_texture,vertices,faces,vertexBuffer,elementBuffer,program,attributes,uniforms,sprites=[];this.init=function(renderer){_gl=renderer.context,_renderer=renderer,vertices=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),faces=new Uint16Array([0,1,2,0,2,3]),vertexBuffer=_gl.createBuffer(),elementBuffer=_gl.createBuffer(),_gl.bindBuffer(_gl.ARRAY_BUFFER,vertexBuffer),_gl.bufferData(_gl.ARRAY_BUFFER,vertices,_gl.STATIC_DRAW),_gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER,elementBuffer),_gl.bufferData(_gl.ELEMENT_ARRAY_BUFFER,faces,_gl.STATIC_DRAW),program=createProgram(),attributes={position:_gl.getAttribLocation(program,"position"),uv:_gl.getAttribLocation(program,"uv")},uniforms={uvOffset:_gl.getUniformLocation(program,"uvOffset"),uvScale:_gl.getUniformLocation(program,"uvScale"),rotation:_gl.getUniformLocation(program,"rotation"),scale:_gl.getUniformLocation(program,"scale"),color:_gl.getUniformLocation(program,"color"),map:_gl.getUniformLocation(program,"map"),opacity:_gl.getUniformLocation(program,"opacity"),modelViewMatrix:_gl.getUniformLocation(program,"modelViewMatrix"),projectionMatrix:_gl.getUniformLocation(program,"projectionMatrix"),fogType:_gl.getUniformLocation(program,"fogType"),fogDensity:_gl.getUniformLocation(program,"fogDensity"),fogNear:_gl.getUniformLocation(program,"fogNear"),fogFar:_gl.getUniformLocation(program,"fogFar"),fogColor:_gl.getUniformLocation(program,"fogColor"),alphaTest:_gl.getUniformLocation(program,"alphaTest")};var canvas=document.createElement("canvas");canvas.width=8,canvas.height=8;var context=canvas.getContext("2d");context.fillStyle="white",context.fillRect(0,0,8,8),_texture=new THREE.Texture(canvas),_texture.needsUpdate=!0},this.render=function(scene,camera){if(sprites.length=0,scene.traverseVisible(function(child){child instanceof THREE.Sprite&&sprites.push(child)}),0!==sprites.length){_gl.useProgram(program),_gl.enableVertexAttribArray(attributes.position),_gl.enableVertexAttribArray(attributes.uv),_gl.disable(_gl.CULL_FACE),_gl.enable(_gl.BLEND),_gl.bindBuffer(_gl.ARRAY_BUFFER,vertexBuffer),_gl.vertexAttribPointer(attributes.position,2,_gl.FLOAT,!1,16,0),_gl.vertexAttribPointer(attributes.uv,2,_gl.FLOAT,!1,16,8),_gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER,elementBuffer),_gl.uniformMatrix4fv(uniforms.projectionMatrix,!1,camera.projectionMatrix.elements),_gl.activeTexture(_gl.TEXTURE0),_gl.uniform1i(uniforms.map,0);
var oldFogType=0,sceneFogType=0,fog=scene.fog;fog?(_gl.uniform3f(uniforms.fogColor,fog.color.r,fog.color.g,fog.color.b),fog instanceof THREE.Fog?(_gl.uniform1f(uniforms.fogNear,fog.near),_gl.uniform1f(uniforms.fogFar,fog.far),_gl.uniform1i(uniforms.fogType,1),oldFogType=1,sceneFogType=1):fog instanceof THREE.FogExp2&&(_gl.uniform1f(uniforms.fogDensity,fog.density),_gl.uniform1i(uniforms.fogType,2),oldFogType=2,sceneFogType=2)):(_gl.uniform1i(uniforms.fogType,0),oldFogType=0,sceneFogType=0);for(var i=0,l=sprites.length;l>i;i++){var sprite=sprites[i],material=sprite.material;sprite._modelViewMatrix.multiplyMatrices(camera.matrixWorldInverse,sprite.matrixWorld),sprite.z=-sprite._modelViewMatrix.elements[14]}sprites.sort(painterSortStable);for(var scale=[],i=0,l=sprites.length;l>i;i++){var sprite=sprites[i],material=sprite.material;_gl.uniform1f(uniforms.alphaTest,material.alphaTest),_gl.uniformMatrix4fv(uniforms.modelViewMatrix,!1,sprite._modelViewMatrix.elements),scale[0]=sprite.scale.x,scale[1]=sprite.scale.y;var fogType=0;scene.fog&&material.fog&&(fogType=sceneFogType),oldFogType!==fogType&&(_gl.uniform1i(uniforms.fogType,fogType),oldFogType=fogType),null!==material.map?(_gl.uniform2f(uniforms.uvOffset,material.map.offset.x,material.map.offset.y),_gl.uniform2f(uniforms.uvScale,material.map.repeat.x,material.map.repeat.y)):(_gl.uniform2f(uniforms.uvOffset,0,0),_gl.uniform2f(uniforms.uvScale,1,1)),_gl.uniform1f(uniforms.opacity,material.opacity),_gl.uniform3f(uniforms.color,material.color.r,material.color.g,material.color.b),_gl.uniform1f(uniforms.rotation,material.rotation),_gl.uniform2fv(uniforms.scale,scale),_renderer.setBlending(material.blending,material.blendEquation,material.blendSrc,material.blendDst),_renderer.setDepthTest(material.depthTest),_renderer.setDepthWrite(material.depthWrite),material.map&&material.map.image&&material.map.image.width?_renderer.setTexture(material.map,0):_renderer.setTexture(_texture,0),_gl.drawElements(_gl.TRIANGLES,6,_gl.UNSIGNED_SHORT,0)}_gl.enable(_gl.CULL_FACE)}}},THREE.DepthPassPlugin=function(){function projectObject(scene,object,camera){if(object.visible){var webglObjects=scene.__webglObjects[object.id];if(webglObjects&&(object.frustumCulled===!1||_frustum.intersectsObject(object)===!0))for(var i=0,l=webglObjects.length;l>i;i++){var webglObject=webglObjects[i];object._modelViewMatrix.multiplyMatrices(camera.matrixWorldInverse,object.matrixWorld),_renderList.push(webglObject)}for(var i=0,l=object.children.length;l>i;i++)projectObject(scene,object.children[i],camera)}}function getObjectMaterial(object){return object.material instanceof THREE.MeshFaceMaterial?object.material.materials[0]:object.material}this.enabled=!1,this.renderTarget=null;var _gl,_renderer,_depthMaterial,_depthMaterialMorph,_depthMaterialSkin,_depthMaterialMorphSkin,_frustum=new THREE.Frustum,_projScreenMatrix=new THREE.Matrix4,_renderList=[];this.init=function(renderer){_gl=renderer.context,_renderer=renderer;var depthShader=THREE.ShaderLib.depthRGBA,depthUniforms=THREE.UniformsUtils.clone(depthShader.uniforms);_depthMaterial=new THREE.ShaderMaterial({fragmentShader:depthShader.fragmentShader,vertexShader:depthShader.vertexShader,uniforms:depthUniforms}),_depthMaterialMorph=new THREE.ShaderMaterial({fragmentShader:depthShader.fragmentShader,vertexShader:depthShader.vertexShader,uniforms:depthUniforms,morphTargets:!0}),_depthMaterialSkin=new THREE.ShaderMaterial({fragmentShader:depthShader.fragmentShader,vertexShader:depthShader.vertexShader,uniforms:depthUniforms,skinning:!0}),_depthMaterialMorphSkin=new THREE.ShaderMaterial({fragmentShader:depthShader.fragmentShader,vertexShader:depthShader.vertexShader,uniforms:depthUniforms,morphTargets:!0,skinning:!0}),_depthMaterial._shadowPass=!0,_depthMaterialMorph._shadowPass=!0,_depthMaterialSkin._shadowPass=!0,_depthMaterialMorphSkin._shadowPass=!0},this.render=function(scene,camera){this.enabled&&this.update(scene,camera)},this.update=function(scene,camera){var j,jl,buffer,material,webglObject,object,renderList,fog=null;_gl.clearColor(1,1,1,1),_gl.disable(_gl.BLEND),_renderer.setDepthTest(!0),scene.autoUpdate===!0&&scene.updateMatrixWorld(),camera.matrixWorldInverse.getInverse(camera.matrixWorld),_projScreenMatrix.multiplyMatrices(camera.projectionMatrix,camera.matrixWorldInverse),_frustum.setFromMatrix(_projScreenMatrix),_renderer.setRenderTarget(this.renderTarget),_renderer.clear(),_renderList.length=0,projectObject(scene,scene,camera);var objectMaterial,useMorphing,useSkinning;for(j=0,jl=_renderList.length;jl>j;j++)webglObject=_renderList[j],object=webglObject.object,buffer=webglObject.buffer,object instanceof THREE.PointCloud&&!object.customDepthMaterial||(objectMaterial=getObjectMaterial(object),objectMaterial&&_renderer.setMaterialFaces(object.material),useMorphing=void 0!==object.geometry.morphTargets&&object.geometry.morphTargets.length>0&&objectMaterial.morphTargets,useSkinning=object instanceof THREE.SkinnedMesh&&objectMaterial.skinning,material=object.customDepthMaterial?object.customDepthMaterial:useSkinning?useMorphing?_depthMaterialMorphSkin:_depthMaterialSkin:useMorphing?_depthMaterialMorph:_depthMaterial,buffer instanceof THREE.BufferGeometry?_renderer.renderBufferDirect(camera,scene.__lights,fog,material,buffer,object):_renderer.renderBuffer(camera,scene.__lights,fog,material,buffer,object));for(renderList=scene.__webglObjectsImmediate,j=0,jl=renderList.length;jl>j;j++)webglObject=renderList[j],object=webglObject.object,object.visible&&(object._modelViewMatrix.multiplyMatrices(camera.matrixWorldInverse,object.matrixWorld),_renderer.renderImmediateObject(camera,scene.__lights,fog,_depthMaterial,object));var clearColor=_renderer.getClearColor(),clearAlpha=_renderer.getClearAlpha();_gl.clearColor(clearColor.r,clearColor.g,clearColor.b,clearAlpha),_gl.enable(_gl.BLEND)}},THREE.ShaderFlares={lensFlareVertexTexture:{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},lensFlare:{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision mediump float;","uniform lowp int renderType;","uniform sampler2D map;","uniform sampler2D occlusionMap;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","float visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;","visibility = ( 1.0 - visibility / 4.0 );","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * visibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")}},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=THREE),exports.THREE=THREE):this.THREE=THREE},{}]},{},[32]);